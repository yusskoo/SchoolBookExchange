(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function bR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var cg={exports:{}},Zc={},ug={exports:{}},Ue={};var OE;function RR(){if(OE)return Ue;OE=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),w=Symbol.iterator;function T(F){return F===null||typeof F!="object"?null:(F=w&&F[w]||F["@@iterator"],typeof F=="function"?F:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,O={};function L(F,K,Re){this.props=F,this.context=K,this.refs=O,this.updater=Re||D}L.prototype.isReactComponent={},L.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},L.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function se(){}se.prototype=L.prototype;function oe(F,K,Re){this.props=F,this.context=K,this.refs=O,this.updater=Re||D}var Z=oe.prototype=new se;Z.constructor=oe,S(Z,L.prototype),Z.isPureReactComponent=!0;var ge=Array.isArray,ne=Object.prototype.hasOwnProperty,ae={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function b(F,K,Re){var Pe,Fe={},je=null,Je=null;if(K!=null)for(Pe in K.ref!==void 0&&(Je=K.ref),K.key!==void 0&&(je=""+K.key),K)ne.call(K,Pe)&&!A.hasOwnProperty(Pe)&&(Fe[Pe]=K[Pe]);var qe=arguments.length-2;if(qe===1)Fe.children=Re;else if(1<qe){for(var tt=Array(qe),xe=0;xe<qe;xe++)tt[xe]=arguments[xe+2];Fe.children=tt}if(F&&F.defaultProps)for(Pe in qe=F.defaultProps,qe)Fe[Pe]===void 0&&(Fe[Pe]=qe[Pe]);return{$$typeof:n,type:F,key:je,ref:Je,props:Fe,_owner:ae.current}}function C(F,K){return{$$typeof:n,type:F.type,key:K,ref:F.ref,props:F.props,_owner:F._owner}}function R(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function N(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Re){return K[Re]})}var j=/\/+/g;function P(F,K){return typeof F=="object"&&F!==null&&F.key!=null?N(""+F.key):K.toString(36)}function Oe(F,K,Re,Pe,Fe){var je=typeof F;(je==="undefined"||je==="boolean")&&(F=null);var Je=!1;if(F===null)Je=!0;else switch(je){case"string":case"number":Je=!0;break;case"object":switch(F.$$typeof){case n:case e:Je=!0}}if(Je)return Je=F,Fe=Fe(Je),F=Pe===""?"."+P(Je,0):Pe,ge(Fe)?(Re="",F!=null&&(Re=F.replace(j,"$&/")+"/"),Oe(Fe,K,Re,"",function(xe){return xe})):Fe!=null&&(R(Fe)&&(Fe=C(Fe,Re+(!Fe.key||Je&&Je.key===Fe.key?"":(""+Fe.key).replace(j,"$&/")+"/")+F)),K.push(Fe)),1;if(Je=0,Pe=Pe===""?".":Pe+":",ge(F))for(var qe=0;qe<F.length;qe++){je=F[qe];var tt=Pe+P(je,qe);Je+=Oe(je,K,Re,tt,Fe)}else if(tt=T(F),typeof tt=="function")for(F=tt.call(F),qe=0;!(je=F.next()).done;)je=je.value,tt=Pe+P(je,qe++),Je+=Oe(je,K,Re,tt,Fe);else if(je==="object")throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Je}function it(F,K,Re){if(F==null)return F;var Pe=[],Fe=0;return Oe(F,Pe,"","",function(je){return K.call(Re,je,Fe++)}),Pe}function ue(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(Re){(F._status===0||F._status===-1)&&(F._status=1,F._result=Re)},function(Re){(F._status===0||F._status===-1)&&(F._status=2,F._result=Re)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var Ne={current:null},re={transition:null},ye={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:re,ReactCurrentOwner:ae};function he(){throw Error("act(...) is not supported in production builds of React.")}return Ue.Children={map:it,forEach:function(F,K,Re){it(F,function(){K.apply(this,arguments)},Re)},count:function(F){var K=0;return it(F,function(){K++}),K},toArray:function(F){return it(F,function(K){return K})||[]},only:function(F){if(!R(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Ue.Component=L,Ue.Fragment=t,Ue.Profiler=s,Ue.PureComponent=oe,Ue.StrictMode=r,Ue.Suspense=f,Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ye,Ue.act=he,Ue.cloneElement=function(F,K,Re){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Pe=S({},F.props),Fe=F.key,je=F.ref,Je=F._owner;if(K!=null){if(K.ref!==void 0&&(je=K.ref,Je=ae.current),K.key!==void 0&&(Fe=""+K.key),F.type&&F.type.defaultProps)var qe=F.type.defaultProps;for(tt in K)ne.call(K,tt)&&!A.hasOwnProperty(tt)&&(Pe[tt]=K[tt]===void 0&&qe!==void 0?qe[tt]:K[tt])}var tt=arguments.length-2;if(tt===1)Pe.children=Re;else if(1<tt){qe=Array(tt);for(var xe=0;xe<tt;xe++)qe[xe]=arguments[xe+2];Pe.children=qe}return{$$typeof:n,type:F.type,key:Fe,ref:je,props:Pe,_owner:Je}},Ue.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:a,_context:F},F.Consumer=F},Ue.createElement=b,Ue.createFactory=function(F){var K=b.bind(null,F);return K.type=F,K},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(F){return{$$typeof:u,render:F}},Ue.isValidElement=R,Ue.lazy=function(F){return{$$typeof:g,_payload:{_status:-1,_result:F},_init:ue}},Ue.memo=function(F,K){return{$$typeof:p,type:F,compare:K===void 0?null:K}},Ue.startTransition=function(F){var K=re.transition;re.transition={};try{F()}finally{re.transition=K}},Ue.unstable_act=he,Ue.useCallback=function(F,K){return Ne.current.useCallback(F,K)},Ue.useContext=function(F){return Ne.current.useContext(F)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(F){return Ne.current.useDeferredValue(F)},Ue.useEffect=function(F,K){return Ne.current.useEffect(F,K)},Ue.useId=function(){return Ne.current.useId()},Ue.useImperativeHandle=function(F,K,Re){return Ne.current.useImperativeHandle(F,K,Re)},Ue.useInsertionEffect=function(F,K){return Ne.current.useInsertionEffect(F,K)},Ue.useLayoutEffect=function(F,K){return Ne.current.useLayoutEffect(F,K)},Ue.useMemo=function(F,K){return Ne.current.useMemo(F,K)},Ue.useReducer=function(F,K,Re){return Ne.current.useReducer(F,K,Re)},Ue.useRef=function(F){return Ne.current.useRef(F)},Ue.useState=function(F){return Ne.current.useState(F)},Ue.useSyncExternalStore=function(F,K,Re){return Ne.current.useSyncExternalStore(F,K,Re)},Ue.useTransition=function(){return Ne.current.useTransition()},Ue.version="18.3.1",Ue}var LE;function Cy(){return LE||(LE=1,ug.exports=RR()),ug.exports}var ME;function PR(){if(ME)return Zc;ME=1;var n=Cy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,f,p){var g,w={},T=null,D=null;p!==void 0&&(T=""+p),f.key!==void 0&&(T=""+f.key),f.ref!==void 0&&(D=f.ref);for(g in f)r.call(f,g)&&!a.hasOwnProperty(g)&&(w[g]=f[g]);if(u&&u.defaultProps)for(g in f=u.defaultProps,f)w[g]===void 0&&(w[g]=f[g]);return{$$typeof:e,type:u,key:T,ref:D,props:w,_owner:s.current}}return Zc.Fragment=t,Zc.jsx=l,Zc.jsxs=l,Zc}var FE;function kR(){return FE||(FE=1,cg.exports=PR()),cg.exports}var v=kR(),fe=Cy();const CR=bR(fe);var qh={},dg={exports:{}},jn={},hg={exports:{}},fg={};var jE;function NR(){return jE||(jE=1,(function(n){function e(re,ye){var he=re.length;re.push(ye);e:for(;0<he;){var F=he-1>>>1,K=re[F];if(0<s(K,ye))re[F]=ye,re[he]=K,he=F;else break e}}function t(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var ye=re[0],he=re.pop();if(he!==ye){re[0]=he;e:for(var F=0,K=re.length,Re=K>>>1;F<Re;){var Pe=2*(F+1)-1,Fe=re[Pe],je=Pe+1,Je=re[je];if(0>s(Fe,he))je<K&&0>s(Je,Fe)?(re[F]=Je,re[je]=he,F=je):(re[F]=Fe,re[Pe]=he,F=Pe);else if(je<K&&0>s(Je,he))re[F]=Je,re[je]=he,F=je;else break e}}return ye}function s(re,ye){var he=re.sortIndex-ye.sortIndex;return he!==0?he:re.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var f=[],p=[],g=1,w=null,T=3,D=!1,S=!1,O=!1,L=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(re){for(var ye=t(p);ye!==null;){if(ye.callback===null)r(p);else if(ye.startTime<=re)r(p),ye.sortIndex=ye.expirationTime,e(f,ye);else break;ye=t(p)}}function ge(re){if(O=!1,Z(re),!S)if(t(f)!==null)S=!0,ue(ne);else{var ye=t(p);ye!==null&&Ne(ge,ye.startTime-re)}}function ne(re,ye){S=!1,O&&(O=!1,se(b),b=-1),D=!0;var he=T;try{for(Z(ye),w=t(f);w!==null&&(!(w.expirationTime>ye)||re&&!N());){var F=w.callback;if(typeof F=="function"){w.callback=null,T=w.priorityLevel;var K=F(w.expirationTime<=ye);ye=n.unstable_now(),typeof K=="function"?w.callback=K:w===t(f)&&r(f),Z(ye)}else r(f);w=t(f)}if(w!==null)var Re=!0;else{var Pe=t(p);Pe!==null&&Ne(ge,Pe.startTime-ye),Re=!1}return Re}finally{w=null,T=he,D=!1}}var ae=!1,A=null,b=-1,C=5,R=-1;function N(){return!(n.unstable_now()-R<C)}function j(){if(A!==null){var re=n.unstable_now();R=re;var ye=!0;try{ye=A(!0,re)}finally{ye?P():(ae=!1,A=null)}}else ae=!1}var P;if(typeof oe=="function")P=function(){oe(j)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,it=Oe.port2;Oe.port1.onmessage=j,P=function(){it.postMessage(null)}}else P=function(){L(j,0)};function ue(re){A=re,ae||(ae=!0,P())}function Ne(re,ye){b=L(function(){re(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_continueExecution=function(){S||D||(S=!0,ue(ne))},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(re){switch(T){case 1:case 2:case 3:var ye=3;break;default:ye=T}var he=T;T=ye;try{return re()}finally{T=he}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(re,ye){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var he=T;T=re;try{return ye()}finally{T=he}},n.unstable_scheduleCallback=function(re,ye,he){var F=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?F+he:F):he=F,re){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=he+K,re={id:g++,callback:ye,priorityLevel:re,startTime:he,expirationTime:K,sortIndex:-1},he>F?(re.sortIndex=he,e(p,re),t(f)===null&&re===t(p)&&(O?(se(b),b=-1):O=!0,Ne(ge,he-F))):(re.sortIndex=K,e(f,re),S||D||(S=!0,ue(ne))),re},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(re){var ye=T;return function(){var he=T;T=ye;try{return re.apply(this,arguments)}finally{T=he}}}})(fg)),fg}var UE;function DR(){return UE||(UE=1,hg.exports=NR()),hg.exports}var BE;function VR(){if(BE)return jn;BE=1;var n=Cy(),e=DR();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},w={};function T(i){return f.call(w,i)?!0:f.call(g,i)?!1:p.test(i)?w[i]=!0:(g[i]=!0,!1)}function D(i,o,c,h){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function S(i,o,c,h){if(o===null||typeof o>"u"||D(i,o,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function O(i,o,c,h,m,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=c,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){L[i]=new O(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];L[o]=new O(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){L[i]=new O(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){L[i]=new O(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){L[i]=new O(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){L[i]=new O(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){L[i]=new O(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){L[i]=new O(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){L[i]=new O(i,5,!1,i.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function oe(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(se,oe);L[o]=new O(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(se,oe);L[o]=new O(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(se,oe);L[o]=new O(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){L[i]=new O(i,1,!1,i.toLowerCase(),null,!1,!1)}),L.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){L[i]=new O(i,1,!1,i.toLowerCase(),null,!0,!0)});function Z(i,o,c,h){var m=L.hasOwnProperty(o)?L[o]:null;(m!==null?m.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(S(o,c,m,h)&&(c=null),h||m===null?T(o)&&(c===null?i.removeAttribute(o):i.setAttribute(o,""+c)):m.mustUseProperty?i[m.propertyName]=c===null?m.type===3?!1:"":c:(o=m.attributeName,h=m.attributeNamespace,c===null?i.removeAttribute(o):(m=m.type,c=m===3||m===4&&c===!0?"":""+c,h?i.setAttributeNS(h,o,c):i.setAttribute(o,c))))}var ge=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ne=Symbol.for("react.element"),ae=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),Oe=Symbol.for("react.suspense_list"),it=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),re=Symbol.iterator;function ye(i){return i===null||typeof i!="object"?null:(i=re&&i[re]||i["@@iterator"],typeof i=="function"?i:null)}var he=Object.assign,F;function K(i){if(F===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+i}var Re=!1;function Pe(i,o){if(!i||Re)return"";Re=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(q){var h=q}Reflect.construct(i,[],o)}else{try{o.call()}catch(q){h=q}i.call(o.prototype)}else{try{throw Error()}catch(q){h=q}i()}}catch(q){if(q&&h&&typeof q.stack=="string"){for(var m=q.stack.split(`
`),y=h.stack.split(`
`),I=m.length-1,k=y.length-1;1<=I&&0<=k&&m[I]!==y[k];)k--;for(;1<=I&&0<=k;I--,k--)if(m[I]!==y[k]){if(I!==1||k!==1)do if(I--,k--,0>k||m[I]!==y[k]){var V=`
`+m[I].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=I&&0<=k);break}}}finally{Re=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?K(i):""}function Fe(i){switch(i.tag){case 5:return K(i.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return i=Pe(i.type,!1),i;case 11:return i=Pe(i.type.render,!1),i;case 1:return i=Pe(i.type,!0),i;default:return""}}function je(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case A:return"Fragment";case ae:return"Portal";case C:return"Profiler";case b:return"StrictMode";case P:return"Suspense";case Oe:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case N:return(i.displayName||"Context")+".Consumer";case R:return(i._context.displayName||"Context")+".Provider";case j:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case it:return o=i.displayName||null,o!==null?o:je(i.type)||"Memo";case ue:o=i._payload,i=i._init;try{return je(i(o))}catch{}}return null}function Je(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return je(o);case 8:return o===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function qe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function tt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function xe(i){var o=tt(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,y=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return m.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ke(i){i._valueTracker||(i._valueTracker=xe(i))}function wt(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return i&&(h=tt(i)?i.checked?"true":"false":i.value),i=h,i!==c?(o.setValue(i),!0):!1}function Et(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Nn(i,o){var c=o.checked;return he({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function Qt(i,o){var c=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;c=qe(o.value!=null?o.value:c),i._wrapperState={initialChecked:h,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function jt(i,o){o=o.checked,o!=null&&Z(i,"checked",o,!1)}function Jt(i,o){jt(i,o);var c=qe(o.value),h=o.type;if(c!=null)h==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?at(i,o.type,c):o.hasOwnProperty("defaultValue")&&at(i,o.type,qe(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function ya(i,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,c||o===i.value||(i.value=o),i.defaultValue=o}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function at(i,o,c){(o!=="number"||Et(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var At=Array.isArray;function Dn(i,o,c,h){if(i=i.options,o){o={};for(var m=0;m<c.length;m++)o["$"+c[m]]=!0;for(c=0;c<i.length;c++)m=o.hasOwnProperty("$"+i[c].value),i[c].selected!==m&&(i[c].selected=m),m&&h&&(i[c].defaultSelected=!0)}else{for(c=""+qe(c),o=null,m=0;m<i.length;m++){if(i[m].value===c){i[m].selected=!0,h&&(i[m].defaultSelected=!0);return}o!==null||i[m].disabled||(o=i[m])}o!==null&&(o.selected=!0)}}function io(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return he({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function lc(i,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(t(92));if(At(c)){if(1<c.length)throw Error(t(93));c=c[0]}o=c}o==null&&(o=""),c=o}i._wrapperState={initialValue:qe(c)}}function kd(i,o){var c=qe(o.value),h=qe(o.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),o.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),h!=null&&(i.defaultValue=""+h)}function Js(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function cc(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _a(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?cc(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ys,Cd=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,h,m){MSApp.execUnsafeLocalFunction(function(){return i(o,c,h,m)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Ys=Ys||document.createElement("div"),Ys.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ys.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function oo(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var Xs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nd=["Webkit","ms","Moz","O"];Object.keys(Xs).forEach(function(i){Nd.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Xs[o]=Xs[i]})});function Zs(i,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Xs.hasOwnProperty(i)&&Xs[i]?(""+o).trim():o+"px"}function va(i,o){i=i.style;for(var c in o)if(o.hasOwnProperty(c)){var h=c.indexOf("--")===0,m=Zs(c,o[c],h);c==="float"&&(c="cssFloat"),h?i.setProperty(c,m):i[c]=m}}var uc=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wr(i,o){if(o){if(uc[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function wa(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ei=null;function Ea(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var _s=null,vs=null,bt=null;function dc(i){if(i=Fc(i)){if(typeof _s!="function")throw Error(t(280));var o=i.stateNode;o&&(o=ih(o),_s(i.stateNode,i.type,o))}}function ti(i){vs?bt?bt.push(i):bt=[i]:vs=i}function ni(){if(vs){var i=vs,o=bt;if(bt=vs=null,dc(i),o)for(i=0;i<o.length;i++)dc(o[i])}}function Dd(i,o){return i(o)}function Vd(){}var Or=!1;function Od(i,o,c){if(Or)return i(o,c);Or=!0;try{return Dd(i,o,c)}finally{Or=!1,(vs!==null||bt!==null)&&(Vd(),ni())}}function ao(i,o){var c=i.stateNode;if(c===null)return null;var h=ih(c);if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,o,typeof c));return c}var ri=!1;if(u)try{var si={};Object.defineProperty(si,"passive",{get:function(){ri=!0}}),window.addEventListener("test",si,si),window.removeEventListener("test",si,si)}catch{ri=!1}function Ld(i,o,c,h,m,y,I,k,V){var q=Array.prototype.slice.call(arguments,3);try{o.apply(c,q)}catch(X){this.onError(X)}}var ws=!1,Lr=null,Ia=!1,lr=null,Md={onError:function(i){ws=!0,Lr=i}};function Fd(i,o,c,h,m,y,I,k,V){ws=!1,Lr=null,Ld.apply(Md,arguments)}function hc(i,o,c,h,m,y,I,k,V){if(Fd.apply(this,arguments),ws){if(ws){var q=Lr;ws=!1,Lr=null}else throw Error(t(198));Ia||(Ia=!0,lr=q)}}function Er(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function fc(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function jd(i){if(Er(i)!==i)throw Error(t(188))}function Ud(i){var o=i.alternate;if(!o){if(o=Er(i),o===null)throw Error(t(188));return o!==i?null:i}for(var c=i,h=o;;){var m=c.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){c=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===c)return jd(m),i;if(y===h)return jd(m),o;y=y.sibling}throw Error(t(188))}if(c.return!==h.return)c=m,h=y;else{for(var I=!1,k=m.child;k;){if(k===c){I=!0,c=m,h=y;break}if(k===h){I=!0,h=m,c=y;break}k=k.sibling}if(!I){for(k=y.child;k;){if(k===c){I=!0,c=y,h=m;break}if(k===h){I=!0,h=y,c=m;break}k=k.sibling}if(!I)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:o}function Bd(i){return i=Ud(i),i!==null?lo(i):null}function lo(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=lo(i);if(o!==null)return o;i=i.sibling}return null}var pc=e.unstable_scheduleCallback,Ta=e.unstable_cancelCallback,co=e.unstable_shouldYield,Es=e.unstable_requestPaint,dt=e.unstable_now,Up=e.unstable_getCurrentPriorityLevel,xa=e.unstable_ImmediatePriority,mc=e.unstable_UserBlockingPriority,uo=e.unstable_NormalPriority,gc=e.unstable_LowPriority,Sa=e.unstable_IdlePriority,ho=null,Gn=null;function zd(i){if(Gn&&typeof Gn.onCommitFiberRoot=="function")try{Gn.onCommitFiberRoot(ho,i,void 0,(i.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:fo,Mr=Math.log,cr=Math.LN2;function fo(i){return i>>>=0,i===0?32:31-(Mr(i)/cr|0)|0}var Fr=64,ii=4194304;function Ze(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Is(i,o){var c=i.pendingLanes;if(c===0)return 0;var h=0,m=i.suspendedLanes,y=i.pingedLanes,I=c&268435455;if(I!==0){var k=I&~m;k!==0?h=Ze(k):(y&=I,y!==0&&(h=Ze(y)))}else I=c&~m,I!==0?h=Ze(I):y!==0&&(h=Ze(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&m)===0&&(m=h&-h,y=o&-o,m>=y||m===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=c&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)c=31-Kn(o),m=1<<c,h|=i[c],o&=~m;return h}function po(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mo(i,o){for(var c=i.suspendedLanes,h=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-Kn(y),k=1<<I,V=m[I];V===-1?((k&c)===0||(k&h)!==0)&&(m[I]=po(k,o)):V<=o&&(i.expiredLanes|=k),y&=~k}}function yc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function _c(){var i=Fr;return Fr<<=1,(Fr&4194240)===0&&(Fr=64),i}function vc(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function go(i,o,c){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Kn(o),i[o]=c}function Bp(i,o){var c=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<c;){var m=31-Kn(c),y=1<<m;o[m]=0,h[m]=-1,i[m]=-1,c&=~y}}function wc(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var h=31-Kn(c),m=1<<h;m&o|i[h]&o&&(i[h]|=o),c&=~m}}var We=0;function jr(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Ec,Aa,Ic,Tc,xc,Ur=!1,ba=[],Br=null,zr=null,on=null,yo=new Map,Ts=new Map,Qn=[],$d="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oi(i,o){switch(i){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":on=null;break;case"pointerover":case"pointerout":yo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ts.delete(o.pointerId)}}function Ir(i,o,c,h,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},o!==null&&(o=Fc(o),o!==null&&Aa(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),i)}function qd(i,o,c,h,m){switch(o){case"focusin":return Br=Ir(Br,i,o,c,h,m),!0;case"dragenter":return zr=Ir(zr,i,o,c,h,m),!0;case"mouseover":return on=Ir(on,i,o,c,h,m),!0;case"pointerover":var y=m.pointerId;return yo.set(y,Ir(yo.get(y)||null,i,o,c,h,m)),!0;case"gotpointercapture":return y=m.pointerId,Ts.set(y,Ir(Ts.get(y)||null,i,o,c,h,m)),!0}return!1}function Ra(i){var o=Eo(i.target);if(o!==null){var c=Er(o);if(c!==null){if(o=c.tag,o===13){if(o=fc(c),o!==null){i.blockedOn=o,xc(i.priority,function(){Ic(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ot(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=Pa(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);ei=h,c.target.dispatchEvent(h),ei=null}else return o=Fc(c),o!==null&&Aa(o),i.blockedOn=c,!1;o.shift()}return!0}function Wd(i,o,c){ot(i)&&c.delete(o)}function zp(){Ur=!1,Br!==null&&ot(Br)&&(Br=null),zr!==null&&ot(zr)&&(zr=null),on!==null&&ot(on)&&(on=null),yo.forEach(Wd),Ts.forEach(Wd)}function ai(i,o){i.blockedOn===o&&(i.blockedOn=null,Ur||(Ur=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zp)))}function li(i){function o(m){return ai(m,i)}if(0<ba.length){ai(ba[0],i);for(var c=1;c<ba.length;c++){var h=ba[c];h.blockedOn===i&&(h.blockedOn=null)}}for(Br!==null&&ai(Br,i),zr!==null&&ai(zr,i),on!==null&&ai(on,i),yo.forEach(o),Ts.forEach(o),c=0;c<Qn.length;c++)h=Qn[c],h.blockedOn===i&&(h.blockedOn=null);for(;0<Qn.length&&(c=Qn[0],c.blockedOn===null);)Ra(c),c.blockedOn===null&&Qn.shift()}var xs=ge.ReactCurrentBatchConfig,Ss=!0;function $r(i,o,c,h){var m=We,y=xs.transition;xs.transition=null;try{We=1,Sc(i,o,c,h)}finally{We=m,xs.transition=y}}function Hd(i,o,c,h){var m=We,y=xs.transition;xs.transition=null;try{We=4,Sc(i,o,c,h)}finally{We=m,xs.transition=y}}function Sc(i,o,c,h){if(Ss){var m=Pa(i,o,c,h);if(m===null)Zp(i,o,h,qr,c),oi(i,h);else if(qd(m,i,o,c,h))h.stopPropagation();else if(oi(i,h),o&4&&-1<$d.indexOf(i)){for(;m!==null;){var y=Fc(m);if(y!==null&&Ec(y),y=Pa(i,o,c,h),y===null&&Zp(i,o,h,qr,c),y===m)break;m=y}m!==null&&h.stopPropagation()}else Zp(i,o,h,null,c)}}var qr=null;function Pa(i,o,c,h){if(qr=null,i=Ea(h),i=Eo(i),i!==null)if(o=Er(i),o===null)i=null;else if(c=o.tag,c===13){if(i=fc(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return qr=i,null}function ka(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Up()){case xa:return 1;case mc:return 4;case uo:case gc:return 16;case Sa:return 536870912;default:return 16}default:return 16}}var Jn=null,Ca=null,As=null;function Gd(){if(As)return As;var i,o=Ca,c=o.length,h,m="value"in Jn?Jn.value:Jn.textContent,y=m.length;for(i=0;i<c&&o[i]===m[i];i++);var I=c-i;for(h=1;h<=I&&o[c-h]===m[y-h];h++);return As=m.slice(i,1<h?1-h:void 0)}function _o(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Wr(){return!0}function Ac(){return!1}function mn(i){function o(c,h,m,y,I){this._reactName=c,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var k in i)i.hasOwnProperty(k)&&(c=i[k],this[k]=c?c(y):y[k]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Wr:Ac,this.isPropagationStopped=Ac,this}return he(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),o}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vo=mn(Hr),ci=he({},Hr,{view:0,detail:0}),Na=mn(ci),Da,Va,Yn,wo=he({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ve,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Yn&&(Yn&&i.type==="mousemove"?(Da=i.screenX-Yn.screenX,Va=i.screenY-Yn.screenY):Va=Da=0,Yn=i),Da)},movementY:function(i){return"movementY"in i?i.movementY:Va}}),bc=mn(wo),Kd=he({},wo,{dataTransfer:0}),Qd=mn(Kd),Oa=he({},ci,{relatedTarget:0}),an=mn(Oa),Jd=he({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Yd=mn(Jd),ui=he({},Hr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),d=mn(ui),_=he({},Hr,{data:0}),E=mn(_),x={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function le(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=H[i])?!!o[i]:!1}function Ve(){return le}var Nt=he({},ci,{key:function(i){if(i.key){var o=x[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=_o(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?z[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ve,charCode:function(i){return i.type==="keypress"?_o(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?_o(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),nt=mn(Nt),Ut=he({},wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xn=mn(Ut),bs=he({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ve}),Gr=mn(bs),Kr=he({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),La=mn(Kr),Rc=he({},wo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Eb=mn(Rc),Ib=[9,13,27,32],$p=u&&"CompositionEvent"in window,Pc=null;u&&"documentMode"in document&&(Pc=document.documentMode);var Tb=u&&"TextEvent"in window&&!Pc,bv=u&&(!$p||Pc&&8<Pc&&11>=Pc),Rv=" ",Pv=!1;function kv(i,o){switch(i){case"keyup":return Ib.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cv(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ma=!1;function xb(i,o){switch(i){case"compositionend":return Cv(o);case"keypress":return o.which!==32?null:(Pv=!0,Rv);case"textInput":return i=o.data,i===Rv&&Pv?null:i;default:return null}}function Sb(i,o){if(Ma)return i==="compositionend"||!$p&&kv(i,o)?(i=Gd(),As=Ca=Jn=null,Ma=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return bv&&o.locale!=="ko"?null:o.data;default:return null}}var Ab={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nv(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Ab[i.type]:o==="textarea"}function Dv(i,o,c,h){ti(h),o=nh(o,"onChange"),0<o.length&&(c=new vo("onChange","change",null,c,h),i.push({event:c,listeners:o}))}var kc=null,Cc=null;function bb(i){Yv(i,0)}function Xd(i){var o=za(i);if(wt(o))return i}function Rb(i,o){if(i==="change")return o}var Vv=!1;if(u){var qp;if(u){var Wp="oninput"in document;if(!Wp){var Ov=document.createElement("div");Ov.setAttribute("oninput","return;"),Wp=typeof Ov.oninput=="function"}qp=Wp}else qp=!1;Vv=qp&&(!document.documentMode||9<document.documentMode)}function Lv(){kc&&(kc.detachEvent("onpropertychange",Mv),Cc=kc=null)}function Mv(i){if(i.propertyName==="value"&&Xd(Cc)){var o=[];Dv(o,Cc,i,Ea(i)),Od(bb,o)}}function Pb(i,o,c){i==="focusin"?(Lv(),kc=o,Cc=c,kc.attachEvent("onpropertychange",Mv)):i==="focusout"&&Lv()}function kb(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Xd(Cc)}function Cb(i,o){if(i==="click")return Xd(o)}function Nb(i,o){if(i==="input"||i==="change")return Xd(o)}function Db(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Tr=typeof Object.is=="function"?Object.is:Db;function Nc(i,o){if(Tr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var m=c[h];if(!f.call(o,m)||!Tr(i[m],o[m]))return!1}return!0}function Fv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function jv(i,o){var c=Fv(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=o&&h>=o)return{node:c,offset:o-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Fv(c)}}function Uv(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Uv(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Bv(){for(var i=window,o=Et();o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=Et(i.document)}return o}function Hp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Vb(i){var o=Bv(),c=i.focusedElem,h=i.selectionRange;if(o!==c&&c&&c.ownerDocument&&Uv(c.ownerDocument.documentElement,c)){if(h!==null&&Hp(c)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(i,c.value.length);else if(i=(o=c.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var m=c.textContent.length,y=Math.min(h.start,m);h=h.end===void 0?y:Math.min(h.end,m),!i.extend&&y>h&&(m=h,h=y,y=m),m=jv(c,y);var I=jv(c,h);m&&I&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=c;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)i=o[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Ob=u&&"documentMode"in document&&11>=document.documentMode,Fa=null,Gp=null,Dc=null,Kp=!1;function zv(i,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Kp||Fa==null||Fa!==Et(h)||(h=Fa,"selectionStart"in h&&Hp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Dc&&Nc(Dc,h)||(Dc=h,h=nh(Gp,"onSelect"),0<h.length&&(o=new vo("onSelect","select",null,o,c),i.push({event:o,listeners:h}),o.target=Fa)))}function Zd(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var ja={animationend:Zd("Animation","AnimationEnd"),animationiteration:Zd("Animation","AnimationIteration"),animationstart:Zd("Animation","AnimationStart"),transitionend:Zd("Transition","TransitionEnd")},Qp={},$v={};u&&($v=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);function eh(i){if(Qp[i])return Qp[i];if(!ja[i])return i;var o=ja[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in $v)return Qp[i]=o[c];return i}var qv=eh("animationend"),Wv=eh("animationiteration"),Hv=eh("animationstart"),Gv=eh("transitionend"),Kv=new Map,Qv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function di(i,o){Kv.set(i,o),a(o,[i])}for(var Jp=0;Jp<Qv.length;Jp++){var Yp=Qv[Jp],Lb=Yp.toLowerCase(),Mb=Yp[0].toUpperCase()+Yp.slice(1);di(Lb,"on"+Mb)}di(qv,"onAnimationEnd"),di(Wv,"onAnimationIteration"),di(Hv,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(Gv,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vc));function Jv(i,o,c){var h=i.type||"unknown-event";i.currentTarget=c,hc(h,o,void 0,i),i.currentTarget=null}function Yv(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],m=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var k=h[I],V=k.instance,q=k.currentTarget;if(k=k.listener,V!==y&&m.isPropagationStopped())break e;Jv(m,k,q),y=V}else for(I=0;I<h.length;I++){if(k=h[I],V=k.instance,q=k.currentTarget,k=k.listener,V!==y&&m.isPropagationStopped())break e;Jv(m,k,q),y=V}}}if(Ia)throw i=lr,Ia=!1,lr=null,i}function ht(i,o){var c=o[im];c===void 0&&(c=o[im]=new Set);var h=i+"__bubble";c.has(h)||(Xv(o,i,2,!1),c.add(h))}function Xp(i,o,c){var h=0;o&&(h|=4),Xv(c,i,h,o)}var th="_reactListening"+Math.random().toString(36).slice(2);function Oc(i){if(!i[th]){i[th]=!0,r.forEach(function(c){c!=="selectionchange"&&(Fb.has(c)||Xp(c,!1,i),Xp(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[th]||(o[th]=!0,Xp("selectionchange",!1,o))}}function Xv(i,o,c,h){switch(ka(o)){case 1:var m=$r;break;case 4:m=Hd;break;default:m=Sc}c=m.bind(null,o,c,i),m=void 0,!ri||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),h?m!==void 0?i.addEventListener(o,c,{capture:!0,passive:m}):i.addEventListener(o,c,!0):m!==void 0?i.addEventListener(o,c,{passive:m}):i.addEventListener(o,c,!1)}function Zp(i,o,c,h,m){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var k=h.stateNode.containerInfo;if(k===m||k.nodeType===8&&k.parentNode===m)break;if(I===4)for(I=h.return;I!==null;){var V=I.tag;if((V===3||V===4)&&(V=I.stateNode.containerInfo,V===m||V.nodeType===8&&V.parentNode===m))return;I=I.return}for(;k!==null;){if(I=Eo(k),I===null)return;if(V=I.tag,V===5||V===6){h=y=I;continue e}k=k.parentNode}}h=h.return}Od(function(){var q=y,X=Ea(c),te=[];e:{var J=Kv.get(i);if(J!==void 0){var me=vo,ve=i;switch(i){case"keypress":if(_o(c)===0)break e;case"keydown":case"keyup":me=nt;break;case"focusin":ve="focus",me=an;break;case"focusout":ve="blur",me=an;break;case"beforeblur":case"afterblur":me=an;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=bc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=Qd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=Gr;break;case qv:case Wv:case Hv:me=Yd;break;case Gv:me=La;break;case"scroll":me=Na;break;case"wheel":me=Eb;break;case"copy":case"cut":case"paste":me=d;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Xn}var Ee=(o&4)!==0,Dt=!Ee&&i==="scroll",B=Ee?J!==null?J+"Capture":null:J;Ee=[];for(var M=q,$;M!==null;){$=M;var ie=$.stateNode;if($.tag===5&&ie!==null&&($=ie,B!==null&&(ie=ao(M,B),ie!=null&&Ee.push(Lc(M,ie,$)))),Dt)break;M=M.return}0<Ee.length&&(J=new me(J,ve,null,c,X),te.push({event:J,listeners:Ee}))}}if((o&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",me=i==="mouseout"||i==="pointerout",J&&c!==ei&&(ve=c.relatedTarget||c.fromElement)&&(Eo(ve)||ve[Rs]))break e;if((me||J)&&(J=X.window===X?X:(J=X.ownerDocument)?J.defaultView||J.parentWindow:window,me?(ve=c.relatedTarget||c.toElement,me=q,ve=ve?Eo(ve):null,ve!==null&&(Dt=Er(ve),ve!==Dt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(me=null,ve=q),me!==ve)){if(Ee=bc,ie="onMouseLeave",B="onMouseEnter",M="mouse",(i==="pointerout"||i==="pointerover")&&(Ee=Xn,ie="onPointerLeave",B="onPointerEnter",M="pointer"),Dt=me==null?J:za(me),$=ve==null?J:za(ve),J=new Ee(ie,M+"leave",me,c,X),J.target=Dt,J.relatedTarget=$,ie=null,Eo(X)===q&&(Ee=new Ee(B,M+"enter",ve,c,X),Ee.target=$,Ee.relatedTarget=Dt,ie=Ee),Dt=ie,me&&ve)t:{for(Ee=me,B=ve,M=0,$=Ee;$;$=Ua($))M++;for($=0,ie=B;ie;ie=Ua(ie))$++;for(;0<M-$;)Ee=Ua(Ee),M--;for(;0<$-M;)B=Ua(B),$--;for(;M--;){if(Ee===B||B!==null&&Ee===B.alternate)break t;Ee=Ua(Ee),B=Ua(B)}Ee=null}else Ee=null;me!==null&&Zv(te,J,me,Ee,!1),ve!==null&&Dt!==null&&Zv(te,Dt,ve,Ee,!0)}}e:{if(J=q?za(q):window,me=J.nodeName&&J.nodeName.toLowerCase(),me==="select"||me==="input"&&J.type==="file")var Ie=Rb;else if(Nv(J))if(Vv)Ie=Nb;else{Ie=kb;var Ae=Pb}else(me=J.nodeName)&&me.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(Ie=Cb);if(Ie&&(Ie=Ie(i,q))){Dv(te,Ie,c,X);break e}Ae&&Ae(i,J,q),i==="focusout"&&(Ae=J._wrapperState)&&Ae.controlled&&J.type==="number"&&at(J,"number",J.value)}switch(Ae=q?za(q):window,i){case"focusin":(Nv(Ae)||Ae.contentEditable==="true")&&(Fa=Ae,Gp=q,Dc=null);break;case"focusout":Dc=Gp=Fa=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,zv(te,c,X);break;case"selectionchange":if(Ob)break;case"keydown":case"keyup":zv(te,c,X)}var be;if($p)e:{switch(i){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Ma?kv(i,c)&&(Ce="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Ce="onCompositionStart");Ce&&(bv&&c.locale!=="ko"&&(Ma||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Ma&&(be=Gd()):(Jn=X,Ca="value"in Jn?Jn.value:Jn.textContent,Ma=!0)),Ae=nh(q,Ce),0<Ae.length&&(Ce=new E(Ce,i,null,c,X),te.push({event:Ce,listeners:Ae}),be?Ce.data=be:(be=Cv(c),be!==null&&(Ce.data=be)))),(be=Tb?xb(i,c):Sb(i,c))&&(q=nh(q,"onBeforeInput"),0<q.length&&(X=new E("onBeforeInput","beforeinput",null,c,X),te.push({event:X,listeners:q}),X.data=be))}Yv(te,o)})}function Lc(i,o,c){return{instance:i,listener:o,currentTarget:c}}function nh(i,o){for(var c=o+"Capture",h=[];i!==null;){var m=i,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=ao(i,c),y!=null&&h.unshift(Lc(i,y,m)),y=ao(i,o),y!=null&&h.push(Lc(i,y,m))),i=i.return}return h}function Ua(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Zv(i,o,c,h,m){for(var y=o._reactName,I=[];c!==null&&c!==h;){var k=c,V=k.alternate,q=k.stateNode;if(V!==null&&V===h)break;k.tag===5&&q!==null&&(k=q,m?(V=ao(c,y),V!=null&&I.unshift(Lc(c,V,k))):m||(V=ao(c,y),V!=null&&I.push(Lc(c,V,k)))),c=c.return}I.length!==0&&i.push({event:o,listeners:I})}var jb=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function ew(i){return(typeof i=="string"?i:""+i).replace(jb,`
`).replace(Ub,"")}function rh(i,o,c){if(o=ew(o),ew(i)!==o&&c)throw Error(t(425))}function sh(){}var em=null,tm=null;function nm(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,Bb=typeof clearTimeout=="function"?clearTimeout:void 0,tw=typeof Promise=="function"?Promise:void 0,zb=typeof queueMicrotask=="function"?queueMicrotask:typeof tw<"u"?function(i){return tw.resolve(null).then(i).catch($b)}:rm;function $b(i){setTimeout(function(){throw i})}function sm(i,o){var c=o,h=0;do{var m=c.nextSibling;if(i.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(h===0){i.removeChild(m),li(o);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=m}while(c);li(o)}function hi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function nw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}var Ba=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Ba,Mc="__reactProps$"+Ba,Rs="__reactContainer$"+Ba,im="__reactEvents$"+Ba,qb="__reactListeners$"+Ba,Wb="__reactHandles$"+Ba;function Eo(i){var o=i[Qr];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Rs]||c[Qr]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=nw(i);i!==null;){if(c=i[Qr])return c;i=nw(i)}return o}i=c,c=i.parentNode}return null}function Fc(i){return i=i[Qr]||i[Rs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function za(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function ih(i){return i[Mc]||null}var om=[],$a=-1;function fi(i){return{current:i}}function ft(i){0>$a||(i.current=om[$a],om[$a]=null,$a--)}function lt(i,o){$a++,om[$a]=i.current,i.current=o}var pi={},gn=fi(pi),Vn=fi(!1),Io=pi;function qa(i,o){var c=i.type.contextTypes;if(!c)return pi;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in c)m[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=m),m}function On(i){return i=i.childContextTypes,i!=null}function oh(){ft(Vn),ft(gn)}function rw(i,o,c){if(gn.current!==pi)throw Error(t(168));lt(gn,o),lt(Vn,c)}function sw(i,o,c){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var m in h)if(!(m in o))throw Error(t(108,Je(i)||"Unknown",m));return he({},c,h)}function ah(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||pi,Io=gn.current,lt(gn,i),lt(Vn,Vn.current),!0}function iw(i,o,c){var h=i.stateNode;if(!h)throw Error(t(169));c?(i=sw(i,o,Io),h.__reactInternalMemoizedMergedChildContext=i,ft(Vn),ft(gn),lt(gn,i)):ft(Vn),lt(Vn,c)}var Ps=null,lh=!1,am=!1;function ow(i){Ps===null?Ps=[i]:Ps.push(i)}function Hb(i){lh=!0,ow(i)}function mi(){if(!am&&Ps!==null){am=!0;var i=0,o=We;try{var c=Ps;for(We=1;i<c.length;i++){var h=c[i];do h=h(!0);while(h!==null)}Ps=null,lh=!1}catch(m){throw Ps!==null&&(Ps=Ps.slice(i+1)),pc(xa,mi),m}finally{We=o,am=!1}}return null}var Wa=[],Ha=0,ch=null,uh=0,ur=[],dr=0,To=null,ks=1,Cs="";function xo(i,o){Wa[Ha++]=uh,Wa[Ha++]=ch,ch=i,uh=o}function aw(i,o,c){ur[dr++]=ks,ur[dr++]=Cs,ur[dr++]=To,To=i;var h=ks;i=Cs;var m=32-Kn(h)-1;h&=~(1<<m),c+=1;var y=32-Kn(o)+m;if(30<y){var I=m-m%5;y=(h&(1<<I)-1).toString(32),h>>=I,m-=I,ks=1<<32-Kn(o)+m|c<<m|h,Cs=y+i}else ks=1<<y|c<<m|h,Cs=i}function lm(i){i.return!==null&&(xo(i,1),aw(i,1,0))}function cm(i){for(;i===ch;)ch=Wa[--Ha],Wa[Ha]=null,uh=Wa[--Ha],Wa[Ha]=null;for(;i===To;)To=ur[--dr],ur[dr]=null,Cs=ur[--dr],ur[dr]=null,ks=ur[--dr],ur[dr]=null}var Zn=null,er=null,gt=!1,xr=null;function lw(i,o){var c=mr(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=i,o=i.deletions,o===null?(i.deletions=[c],i.flags|=16):o.push(c)}function cw(i,o){switch(i.tag){case 5:var c=i.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Zn=i,er=hi(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Zn=i,er=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=To!==null?{id:ks,overflow:Cs}:null,i.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=mr(18,null,null,0),c.stateNode=o,c.return=i,i.child=c,Zn=i,er=null,!0):!1;default:return!1}}function um(i){return(i.mode&1)!==0&&(i.flags&128)===0}function dm(i){if(gt){var o=er;if(o){var c=o;if(!cw(i,o)){if(um(i))throw Error(t(418));o=hi(c.nextSibling);var h=Zn;o&&cw(i,o)?lw(h,c):(i.flags=i.flags&-4097|2,gt=!1,Zn=i)}}else{if(um(i))throw Error(t(418));i.flags=i.flags&-4097|2,gt=!1,Zn=i}}}function uw(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Zn=i}function dh(i){if(i!==Zn)return!1;if(!gt)return uw(i),gt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!nm(i.type,i.memoizedProps)),o&&(o=er)){if(um(i))throw dw(),Error(t(418));for(;o;)lw(i,o),o=hi(o.nextSibling)}if(uw(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(o===0){er=hi(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}i=i.nextSibling}er=null}}else er=Zn?hi(i.stateNode.nextSibling):null;return!0}function dw(){for(var i=er;i;)i=hi(i.nextSibling)}function Ga(){er=Zn=null,gt=!1}function hm(i){xr===null?xr=[i]:xr.push(i)}var Gb=ge.ReactCurrentBatchConfig;function jc(i,o,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,i));var m=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var k=m.refs;I===null?delete k[y]:k[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function hh(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function hw(i){var o=i._init;return o(i._payload)}function fw(i){function o(B,M){if(i){var $=B.deletions;$===null?(B.deletions=[M],B.flags|=16):$.push(M)}}function c(B,M){if(!i)return null;for(;M!==null;)o(B,M),M=M.sibling;return null}function h(B,M){for(B=new Map;M!==null;)M.key!==null?B.set(M.key,M):B.set(M.index,M),M=M.sibling;return B}function m(B,M){return B=Ti(B,M),B.index=0,B.sibling=null,B}function y(B,M,$){return B.index=$,i?($=B.alternate,$!==null?($=$.index,$<M?(B.flags|=2,M):$):(B.flags|=2,M)):(B.flags|=1048576,M)}function I(B){return i&&B.alternate===null&&(B.flags|=2),B}function k(B,M,$,ie){return M===null||M.tag!==6?(M=rg($,B.mode,ie),M.return=B,M):(M=m(M,$),M.return=B,M)}function V(B,M,$,ie){var Ie=$.type;return Ie===A?X(B,M,$.props.children,ie,$.key):M!==null&&(M.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ue&&hw(Ie)===M.type)?(ie=m(M,$.props),ie.ref=jc(B,M,$),ie.return=B,ie):(ie=Lh($.type,$.key,$.props,null,B.mode,ie),ie.ref=jc(B,M,$),ie.return=B,ie)}function q(B,M,$,ie){return M===null||M.tag!==4||M.stateNode.containerInfo!==$.containerInfo||M.stateNode.implementation!==$.implementation?(M=sg($,B.mode,ie),M.return=B,M):(M=m(M,$.children||[]),M.return=B,M)}function X(B,M,$,ie,Ie){return M===null||M.tag!==7?(M=No($,B.mode,ie,Ie),M.return=B,M):(M=m(M,$),M.return=B,M)}function te(B,M,$){if(typeof M=="string"&&M!==""||typeof M=="number")return M=rg(""+M,B.mode,$),M.return=B,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case ne:return $=Lh(M.type,M.key,M.props,null,B.mode,$),$.ref=jc(B,null,M),$.return=B,$;case ae:return M=sg(M,B.mode,$),M.return=B,M;case ue:var ie=M._init;return te(B,ie(M._payload),$)}if(At(M)||ye(M))return M=No(M,B.mode,$,null),M.return=B,M;hh(B,M)}return null}function J(B,M,$,ie){var Ie=M!==null?M.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return Ie!==null?null:k(B,M,""+$,ie);if(typeof $=="object"&&$!==null){switch($.$$typeof){case ne:return $.key===Ie?V(B,M,$,ie):null;case ae:return $.key===Ie?q(B,M,$,ie):null;case ue:return Ie=$._init,J(B,M,Ie($._payload),ie)}if(At($)||ye($))return Ie!==null?null:X(B,M,$,ie,null);hh(B,$)}return null}function me(B,M,$,ie,Ie){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return B=B.get($)||null,k(M,B,""+ie,Ie);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case ne:return B=B.get(ie.key===null?$:ie.key)||null,V(M,B,ie,Ie);case ae:return B=B.get(ie.key===null?$:ie.key)||null,q(M,B,ie,Ie);case ue:var Ae=ie._init;return me(B,M,$,Ae(ie._payload),Ie)}if(At(ie)||ye(ie))return B=B.get($)||null,X(M,B,ie,Ie,null);hh(M,ie)}return null}function ve(B,M,$,ie){for(var Ie=null,Ae=null,be=M,Ce=M=0,Zt=null;be!==null&&Ce<$.length;Ce++){be.index>Ce?(Zt=be,be=null):Zt=be.sibling;var Ye=J(B,be,$[Ce],ie);if(Ye===null){be===null&&(be=Zt);break}i&&be&&Ye.alternate===null&&o(B,be),M=y(Ye,M,Ce),Ae===null?Ie=Ye:Ae.sibling=Ye,Ae=Ye,be=Zt}if(Ce===$.length)return c(B,be),gt&&xo(B,Ce),Ie;if(be===null){for(;Ce<$.length;Ce++)be=te(B,$[Ce],ie),be!==null&&(M=y(be,M,Ce),Ae===null?Ie=be:Ae.sibling=be,Ae=be);return gt&&xo(B,Ce),Ie}for(be=h(B,be);Ce<$.length;Ce++)Zt=me(be,B,Ce,$[Ce],ie),Zt!==null&&(i&&Zt.alternate!==null&&be.delete(Zt.key===null?Ce:Zt.key),M=y(Zt,M,Ce),Ae===null?Ie=Zt:Ae.sibling=Zt,Ae=Zt);return i&&be.forEach(function(xi){return o(B,xi)}),gt&&xo(B,Ce),Ie}function Ee(B,M,$,ie){var Ie=ye($);if(typeof Ie!="function")throw Error(t(150));if($=Ie.call($),$==null)throw Error(t(151));for(var Ae=Ie=null,be=M,Ce=M=0,Zt=null,Ye=$.next();be!==null&&!Ye.done;Ce++,Ye=$.next()){be.index>Ce?(Zt=be,be=null):Zt=be.sibling;var xi=J(B,be,Ye.value,ie);if(xi===null){be===null&&(be=Zt);break}i&&be&&xi.alternate===null&&o(B,be),M=y(xi,M,Ce),Ae===null?Ie=xi:Ae.sibling=xi,Ae=xi,be=Zt}if(Ye.done)return c(B,be),gt&&xo(B,Ce),Ie;if(be===null){for(;!Ye.done;Ce++,Ye=$.next())Ye=te(B,Ye.value,ie),Ye!==null&&(M=y(Ye,M,Ce),Ae===null?Ie=Ye:Ae.sibling=Ye,Ae=Ye);return gt&&xo(B,Ce),Ie}for(be=h(B,be);!Ye.done;Ce++,Ye=$.next())Ye=me(be,B,Ce,Ye.value,ie),Ye!==null&&(i&&Ye.alternate!==null&&be.delete(Ye.key===null?Ce:Ye.key),M=y(Ye,M,Ce),Ae===null?Ie=Ye:Ae.sibling=Ye,Ae=Ye);return i&&be.forEach(function(AR){return o(B,AR)}),gt&&xo(B,Ce),Ie}function Dt(B,M,$,ie){if(typeof $=="object"&&$!==null&&$.type===A&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case ne:e:{for(var Ie=$.key,Ae=M;Ae!==null;){if(Ae.key===Ie){if(Ie=$.type,Ie===A){if(Ae.tag===7){c(B,Ae.sibling),M=m(Ae,$.props.children),M.return=B,B=M;break e}}else if(Ae.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ue&&hw(Ie)===Ae.type){c(B,Ae.sibling),M=m(Ae,$.props),M.ref=jc(B,Ae,$),M.return=B,B=M;break e}c(B,Ae);break}else o(B,Ae);Ae=Ae.sibling}$.type===A?(M=No($.props.children,B.mode,ie,$.key),M.return=B,B=M):(ie=Lh($.type,$.key,$.props,null,B.mode,ie),ie.ref=jc(B,M,$),ie.return=B,B=ie)}return I(B);case ae:e:{for(Ae=$.key;M!==null;){if(M.key===Ae)if(M.tag===4&&M.stateNode.containerInfo===$.containerInfo&&M.stateNode.implementation===$.implementation){c(B,M.sibling),M=m(M,$.children||[]),M.return=B,B=M;break e}else{c(B,M);break}else o(B,M);M=M.sibling}M=sg($,B.mode,ie),M.return=B,B=M}return I(B);case ue:return Ae=$._init,Dt(B,M,Ae($._payload),ie)}if(At($))return ve(B,M,$,ie);if(ye($))return Ee(B,M,$,ie);hh(B,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,M!==null&&M.tag===6?(c(B,M.sibling),M=m(M,$),M.return=B,B=M):(c(B,M),M=rg($,B.mode,ie),M.return=B,B=M),I(B)):c(B,M)}return Dt}var Ka=fw(!0),pw=fw(!1),fh=fi(null),ph=null,Qa=null,fm=null;function pm(){fm=Qa=ph=null}function mm(i){var o=fh.current;ft(fh),i._currentValue=o}function gm(i,o,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===c)break;i=i.return}}function Ja(i,o){ph=i,fm=Qa=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Ln=!0),i.firstContext=null)}function hr(i){var o=i._currentValue;if(fm!==i)if(i={context:i,memoizedValue:o,next:null},Qa===null){if(ph===null)throw Error(t(308));Qa=i,ph.dependencies={lanes:0,firstContext:i}}else Qa=Qa.next=i;return o}var So=null;function ym(i){So===null?So=[i]:So.push(i)}function mw(i,o,c,h){var m=o.interleaved;return m===null?(c.next=c,ym(o)):(c.next=m.next,m.next=c),o.interleaved=c,Ns(i,h)}function Ns(i,o){i.lanes|=o;var c=i.alternate;for(c!==null&&(c.lanes|=o),c=i,i=i.return;i!==null;)i.childLanes|=o,c=i.alternate,c!==null&&(c.childLanes|=o),c=i,i=i.return;return c.tag===3?c.stateNode:null}var gi=!1;function _m(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gw(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ds(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function yi(i,o,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Qe&2)!==0){var m=h.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),h.pending=o,Ns(i,c)}return m=h.interleaved,m===null?(o.next=o,ym(h)):(o.next=m.next,m.next=o),h.interleaved=o,Ns(i,c)}function mh(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,wc(i,c)}}function yw(i,o){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var m=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var I={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};y===null?m=y=I:y=y.next=I,c=c.next}while(c!==null);y===null?m=y=o:y=y.next=o}else m=y=o;c={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}function gh(i,o,c,h){var m=i.updateQueue;gi=!1;var y=m.firstBaseUpdate,I=m.lastBaseUpdate,k=m.shared.pending;if(k!==null){m.shared.pending=null;var V=k,q=V.next;V.next=null,I===null?y=q:I.next=q,I=V;var X=i.alternate;X!==null&&(X=X.updateQueue,k=X.lastBaseUpdate,k!==I&&(k===null?X.firstBaseUpdate=q:k.next=q,X.lastBaseUpdate=V))}if(y!==null){var te=m.baseState;I=0,X=q=V=null,k=y;do{var J=k.lane,me=k.eventTime;if((h&J)===J){X!==null&&(X=X.next={eventTime:me,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var ve=i,Ee=k;switch(J=o,me=c,Ee.tag){case 1:if(ve=Ee.payload,typeof ve=="function"){te=ve.call(me,te,J);break e}te=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Ee.payload,J=typeof ve=="function"?ve.call(me,te,J):ve,J==null)break e;te=he({},te,J);break e;case 2:gi=!0}}k.callback!==null&&k.lane!==0&&(i.flags|=64,J=m.effects,J===null?m.effects=[k]:J.push(k))}else me={eventTime:me,lane:J,tag:k.tag,payload:k.payload,callback:k.callback,next:null},X===null?(q=X=me,V=te):X=X.next=me,I|=J;if(k=k.next,k===null){if(k=m.shared.pending,k===null)break;J=k,k=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);if(X===null&&(V=te),m.baseState=V,m.firstBaseUpdate=q,m.lastBaseUpdate=X,o=m.shared.interleaved,o!==null){m=o;do I|=m.lane,m=m.next;while(m!==o)}else y===null&&(m.shared.lanes=0);Ro|=I,i.lanes=I,i.memoizedState=te}}function _w(i,o,c){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],m=h.callback;if(m!==null){if(h.callback=null,h=c,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var Uc={},Jr=fi(Uc),Bc=fi(Uc),zc=fi(Uc);function Ao(i){if(i===Uc)throw Error(t(174));return i}function vm(i,o){switch(lt(zc,o),lt(Bc,i),lt(Jr,Uc),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:_a(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=_a(o,i)}ft(Jr),lt(Jr,o)}function Ya(){ft(Jr),ft(Bc),ft(zc)}function vw(i){Ao(zc.current);var o=Ao(Jr.current),c=_a(o,i.type);o!==c&&(lt(Bc,i),lt(Jr,c))}function wm(i){Bc.current===i&&(ft(Jr),ft(Bc))}var It=fi(0);function yh(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Em=[];function Im(){for(var i=0;i<Em.length;i++)Em[i]._workInProgressVersionPrimary=null;Em.length=0}var _h=ge.ReactCurrentDispatcher,Tm=ge.ReactCurrentBatchConfig,bo=0,Tt=null,Wt=null,Yt=null,vh=!1,$c=!1,qc=0,Kb=0;function yn(){throw Error(t(321))}function xm(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!Tr(i[c],o[c]))return!1;return!0}function Sm(i,o,c,h,m,y){if(bo=y,Tt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,_h.current=i===null||i.memoizedState===null?Xb:Zb,i=c(h,m),$c){y=0;do{if($c=!1,qc=0,25<=y)throw Error(t(301));y+=1,Yt=Wt=null,o.updateQueue=null,_h.current=eR,i=c(h,m)}while($c)}if(_h.current=Ih,o=Wt!==null&&Wt.next!==null,bo=0,Yt=Wt=Tt=null,vh=!1,o)throw Error(t(300));return i}function Am(){var i=qc!==0;return qc=0,i}function Yr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Tt.memoizedState=Yt=i:Yt=Yt.next=i,Yt}function fr(){if(Wt===null){var i=Tt.alternate;i=i!==null?i.memoizedState:null}else i=Wt.next;var o=Yt===null?Tt.memoizedState:Yt.next;if(o!==null)Yt=o,Wt=i;else{if(i===null)throw Error(t(310));Wt=i,i={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Yt===null?Tt.memoizedState=Yt=i:Yt=Yt.next=i}return Yt}function Wc(i,o){return typeof o=="function"?o(i):o}function bm(i){var o=fr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var h=Wt,m=h.baseQueue,y=c.pending;if(y!==null){if(m!==null){var I=m.next;m.next=y.next,y.next=I}h.baseQueue=m=y,c.pending=null}if(m!==null){y=m.next,h=h.baseState;var k=I=null,V=null,q=y;do{var X=q.lane;if((bo&X)===X)V!==null&&(V=V.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),h=q.hasEagerState?q.eagerState:i(h,q.action);else{var te={lane:X,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};V===null?(k=V=te,I=h):V=V.next=te,Tt.lanes|=X,Ro|=X}q=q.next}while(q!==null&&q!==y);V===null?I=h:V.next=k,Tr(h,o.memoizedState)||(Ln=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=V,c.lastRenderedState=h}if(i=c.interleaved,i!==null){m=i;do y=m.lane,Tt.lanes|=y,Ro|=y,m=m.next;while(m!==i)}else m===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Rm(i){var o=fr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var h=c.dispatch,m=c.pending,y=o.memoizedState;if(m!==null){c.pending=null;var I=m=m.next;do y=i(y,I.action),I=I.next;while(I!==m);Tr(y,o.memoizedState)||(Ln=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,h]}function ww(){}function Ew(i,o){var c=Tt,h=fr(),m=o(),y=!Tr(h.memoizedState,m);if(y&&(h.memoizedState=m,Ln=!0),h=h.queue,Pm(xw.bind(null,c,h,i),[i]),h.getSnapshot!==o||y||Yt!==null&&Yt.memoizedState.tag&1){if(c.flags|=2048,Hc(9,Tw.bind(null,c,h,m,o),void 0,null),Xt===null)throw Error(t(349));(bo&30)!==0||Iw(c,o,m)}return m}function Iw(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Tt.updateQueue,o===null?(o={lastEffect:null,stores:null},Tt.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function Tw(i,o,c,h){o.value=c,o.getSnapshot=h,Sw(o)&&Aw(i)}function xw(i,o,c){return c(function(){Sw(o)&&Aw(i)})}function Sw(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!Tr(i,c)}catch{return!0}}function Aw(i){var o=Ns(i,1);o!==null&&Rr(o,i,1,-1)}function bw(i){var o=Yr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wc,lastRenderedState:i},o.queue=i,i=i.dispatch=Yb.bind(null,Tt,i),[o.memoizedState,i]}function Hc(i,o,c,h){return i={tag:i,create:o,destroy:c,deps:h,next:null},o=Tt.updateQueue,o===null?(o={lastEffect:null,stores:null},Tt.updateQueue=o,o.lastEffect=i.next=i):(c=o.lastEffect,c===null?o.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,o.lastEffect=i)),i}function Rw(){return fr().memoizedState}function wh(i,o,c,h){var m=Yr();Tt.flags|=i,m.memoizedState=Hc(1|o,c,void 0,h===void 0?null:h)}function Eh(i,o,c,h){var m=fr();h=h===void 0?null:h;var y=void 0;if(Wt!==null){var I=Wt.memoizedState;if(y=I.destroy,h!==null&&xm(h,I.deps)){m.memoizedState=Hc(o,c,y,h);return}}Tt.flags|=i,m.memoizedState=Hc(1|o,c,y,h)}function Pw(i,o){return wh(8390656,8,i,o)}function Pm(i,o){return Eh(2048,8,i,o)}function kw(i,o){return Eh(4,2,i,o)}function Cw(i,o){return Eh(4,4,i,o)}function Nw(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Dw(i,o,c){return c=c!=null?c.concat([i]):null,Eh(4,4,Nw.bind(null,o,i),c)}function km(){}function Vw(i,o){var c=fr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&xm(o,h[1])?h[0]:(c.memoizedState=[i,o],i)}function Ow(i,o){var c=fr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&xm(o,h[1])?h[0]:(i=i(),c.memoizedState=[i,o],i)}function Lw(i,o,c){return(bo&21)===0?(i.baseState&&(i.baseState=!1,Ln=!0),i.memoizedState=c):(Tr(c,o)||(c=_c(),Tt.lanes|=c,Ro|=c,i.baseState=!0),o)}function Qb(i,o){var c=We;We=c!==0&&4>c?c:4,i(!0);var h=Tm.transition;Tm.transition={};try{i(!1),o()}finally{We=c,Tm.transition=h}}function Mw(){return fr().memoizedState}function Jb(i,o,c){var h=Ei(i);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},Fw(i))jw(o,c);else if(c=mw(i,o,c,h),c!==null){var m=bn();Rr(c,i,h,m),Uw(c,o,h)}}function Yb(i,o,c){var h=Ei(i),m={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(Fw(i))jw(o,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,k=y(I,c);if(m.hasEagerState=!0,m.eagerState=k,Tr(k,I)){var V=o.interleaved;V===null?(m.next=m,ym(o)):(m.next=V.next,V.next=m),o.interleaved=m;return}}catch{}c=mw(i,o,m,h),c!==null&&(m=bn(),Rr(c,i,h,m),Uw(c,o,h))}}function Fw(i){var o=i.alternate;return i===Tt||o!==null&&o===Tt}function jw(i,o){$c=vh=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function Uw(i,o,c){if((c&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,wc(i,c)}}var Ih={readContext:hr,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},Xb={readContext:hr,useCallback:function(i,o){return Yr().memoizedState=[i,o===void 0?null:o],i},useContext:hr,useEffect:Pw,useImperativeHandle:function(i,o,c){return c=c!=null?c.concat([i]):null,wh(4194308,4,Nw.bind(null,o,i),c)},useLayoutEffect:function(i,o){return wh(4194308,4,i,o)},useInsertionEffect:function(i,o){return wh(4,2,i,o)},useMemo:function(i,o){var c=Yr();return o=o===void 0?null:o,i=i(),c.memoizedState=[i,o],i},useReducer:function(i,o,c){var h=Yr();return o=c!==void 0?c(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=Jb.bind(null,Tt,i),[h.memoizedState,i]},useRef:function(i){var o=Yr();return i={current:i},o.memoizedState=i},useState:bw,useDebugValue:km,useDeferredValue:function(i){return Yr().memoizedState=i},useTransition:function(){var i=bw(!1),o=i[0];return i=Qb.bind(null,i[1]),Yr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,c){var h=Tt,m=Yr();if(gt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=o(),Xt===null)throw Error(t(349));(bo&30)!==0||Iw(h,o,c)}m.memoizedState=c;var y={value:c,getSnapshot:o};return m.queue=y,Pw(xw.bind(null,h,y,i),[i]),h.flags|=2048,Hc(9,Tw.bind(null,h,y,c,o),void 0,null),c},useId:function(){var i=Yr(),o=Xt.identifierPrefix;if(gt){var c=Cs,h=ks;c=(h&~(1<<32-Kn(h)-1)).toString(32)+c,o=":"+o+"R"+c,c=qc++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=Kb++,o=":"+o+"r"+c.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Zb={readContext:hr,useCallback:Vw,useContext:hr,useEffect:Pm,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Cw,useMemo:Ow,useReducer:bm,useRef:Rw,useState:function(){return bm(Wc)},useDebugValue:km,useDeferredValue:function(i){var o=fr();return Lw(o,Wt.memoizedState,i)},useTransition:function(){var i=bm(Wc)[0],o=fr().memoizedState;return[i,o]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Mw,unstable_isNewReconciler:!1},eR={readContext:hr,useCallback:Vw,useContext:hr,useEffect:Pm,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Cw,useMemo:Ow,useReducer:Rm,useRef:Rw,useState:function(){return Rm(Wc)},useDebugValue:km,useDeferredValue:function(i){var o=fr();return Wt===null?o.memoizedState=i:Lw(o,Wt.memoizedState,i)},useTransition:function(){var i=Rm(Wc)[0],o=fr().memoizedState;return[i,o]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Mw,unstable_isNewReconciler:!1};function Sr(i,o){if(i&&i.defaultProps){o=he({},o),i=i.defaultProps;for(var c in i)o[c]===void 0&&(o[c]=i[c]);return o}return o}function Cm(i,o,c,h){o=i.memoizedState,c=c(h,o),c=c==null?o:he({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Th={isMounted:function(i){return(i=i._reactInternals)?Er(i)===i:!1},enqueueSetState:function(i,o,c){i=i._reactInternals;var h=bn(),m=Ei(i),y=Ds(h,m);y.payload=o,c!=null&&(y.callback=c),o=yi(i,y,m),o!==null&&(Rr(o,i,m,h),mh(o,i,m))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var h=bn(),m=Ei(i),y=Ds(h,m);y.tag=1,y.payload=o,c!=null&&(y.callback=c),o=yi(i,y,m),o!==null&&(Rr(o,i,m,h),mh(o,i,m))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=bn(),h=Ei(i),m=Ds(c,h);m.tag=2,o!=null&&(m.callback=o),o=yi(i,m,h),o!==null&&(Rr(o,i,h,c),mh(o,i,h))}};function Bw(i,o,c,h,m,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Nc(c,h)||!Nc(m,y):!0}function zw(i,o,c){var h=!1,m=pi,y=o.contextType;return typeof y=="object"&&y!==null?y=hr(y):(m=On(o)?Io:gn.current,h=o.contextTypes,y=(h=h!=null)?qa(i,m):pi),o=new o(c,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Th,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=y),o}function $w(i,o,c,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==i&&Th.enqueueReplaceState(o,o.state,null)}function Nm(i,o,c,h){var m=i.stateNode;m.props=c,m.state=i.memoizedState,m.refs={},_m(i);var y=o.contextType;typeof y=="object"&&y!==null?m.context=hr(y):(y=On(o)?Io:gn.current,m.context=qa(i,y)),m.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(Cm(i,o,y,c),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&Th.enqueueReplaceState(m,m.state,null),gh(i,c,m,h),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function Xa(i,o){try{var c="",h=o;do c+=Fe(h),h=h.return;while(h);var m=c}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:m,digest:null}}function Dm(i,o,c){return{value:i,source:null,stack:c??null,digest:o??null}}function Vm(i,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var tR=typeof WeakMap=="function"?WeakMap:Map;function qw(i,o,c){c=Ds(-1,c),c.tag=3,c.payload={element:null};var h=o.value;return c.callback=function(){kh||(kh=!0,Qm=h),Vm(i,o)},c}function Ww(i,o,c){c=Ds(-1,c),c.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var m=o.value;c.payload=function(){return h(m)},c.callback=function(){Vm(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(c.callback=function(){Vm(i,o),typeof h!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),c}function Hw(i,o,c){var h=i.pingCache;if(h===null){h=i.pingCache=new tR;var m=new Set;h.set(o,m)}else m=h.get(o),m===void 0&&(m=new Set,h.set(o,m));m.has(c)||(m.add(c),i=mR.bind(null,i,o,c),o.then(i,i))}function Gw(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Kw(i,o,c,h,m){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=Ds(-1,1),o.tag=2,yi(c,o,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var nR=ge.ReactCurrentOwner,Ln=!1;function An(i,o,c,h){o.child=i===null?pw(o,null,c,h):Ka(o,i.child,c,h)}function Qw(i,o,c,h,m){c=c.render;var y=o.ref;return Ja(o,m),h=Sm(i,o,c,h,y,m),c=Am(),i!==null&&!Ln?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,Vs(i,o,m)):(gt&&c&&lm(o),o.flags|=1,An(i,o,h,m),o.child)}function Jw(i,o,c,h,m){if(i===null){var y=c.type;return typeof y=="function"&&!ng(y)&&y.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=y,Yw(i,o,y,h,m)):(i=Lh(c.type,null,h,o,o.mode,m),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&m)===0){var I=y.memoizedProps;if(c=c.compare,c=c!==null?c:Nc,c(I,h)&&i.ref===o.ref)return Vs(i,o,m)}return o.flags|=1,i=Ti(y,h),i.ref=o.ref,i.return=o,o.child=i}function Yw(i,o,c,h,m){if(i!==null){var y=i.memoizedProps;if(Nc(y,h)&&i.ref===o.ref)if(Ln=!1,o.pendingProps=h=y,(i.lanes&m)!==0)(i.flags&131072)!==0&&(Ln=!0);else return o.lanes=i.lanes,Vs(i,o,m)}return Om(i,o,c,h,m)}function Xw(i,o,c){var h=o.pendingProps,m=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(el,tr),tr|=c;else{if((c&1073741824)===0)return i=y!==null?y.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,lt(el,tr),tr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:c,lt(el,tr),tr|=h}else y!==null?(h=y.baseLanes|c,o.memoizedState=null):h=c,lt(el,tr),tr|=h;return An(i,o,m,c),o.child}function Zw(i,o){var c=o.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function Om(i,o,c,h,m){var y=On(c)?Io:gn.current;return y=qa(o,y),Ja(o,m),c=Sm(i,o,c,h,y,m),h=Am(),i!==null&&!Ln?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,Vs(i,o,m)):(gt&&h&&lm(o),o.flags|=1,An(i,o,c,m),o.child)}function eE(i,o,c,h,m){if(On(c)){var y=!0;ah(o)}else y=!1;if(Ja(o,m),o.stateNode===null)Sh(i,o),zw(o,c,h),Nm(o,c,h,m),h=!0;else if(i===null){var I=o.stateNode,k=o.memoizedProps;I.props=k;var V=I.context,q=c.contextType;typeof q=="object"&&q!==null?q=hr(q):(q=On(c)?Io:gn.current,q=qa(o,q));var X=c.getDerivedStateFromProps,te=typeof X=="function"||typeof I.getSnapshotBeforeUpdate=="function";te||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(k!==h||V!==q)&&$w(o,I,h,q),gi=!1;var J=o.memoizedState;I.state=J,gh(o,h,I,m),V=o.memoizedState,k!==h||J!==V||Vn.current||gi?(typeof X=="function"&&(Cm(o,c,X,h),V=o.memoizedState),(k=gi||Bw(o,c,k,h,J,V,q))?(te||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=V),I.props=h,I.state=V,I.context=q,h=k):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,gw(i,o),k=o.memoizedProps,q=o.type===o.elementType?k:Sr(o.type,k),I.props=q,te=o.pendingProps,J=I.context,V=c.contextType,typeof V=="object"&&V!==null?V=hr(V):(V=On(c)?Io:gn.current,V=qa(o,V));var me=c.getDerivedStateFromProps;(X=typeof me=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(k!==te||J!==V)&&$w(o,I,h,V),gi=!1,J=o.memoizedState,I.state=J,gh(o,h,I,m);var ve=o.memoizedState;k!==te||J!==ve||Vn.current||gi?(typeof me=="function"&&(Cm(o,c,me,h),ve=o.memoizedState),(q=gi||Bw(o,c,q,h,J,ve,V)||!1)?(X||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,ve,V),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,ve,V)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||k===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=ve),I.props=h,I.state=ve,I.context=V,h=q):(typeof I.componentDidUpdate!="function"||k===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),h=!1)}return Lm(i,o,c,h,y,m)}function Lm(i,o,c,h,m,y){Zw(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return m&&iw(o,c,!1),Vs(i,o,y);h=o.stateNode,nR.current=o;var k=I&&typeof c.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=Ka(o,i.child,null,y),o.child=Ka(o,null,k,y)):An(i,o,k,y),o.memoizedState=h.state,m&&iw(o,c,!0),o.child}function tE(i){var o=i.stateNode;o.pendingContext?rw(i,o.pendingContext,o.pendingContext!==o.context):o.context&&rw(i,o.context,!1),vm(i,o.containerInfo)}function nE(i,o,c,h,m){return Ga(),hm(m),o.flags|=256,An(i,o,c,h),o.child}var Mm={dehydrated:null,treeContext:null,retryLane:0};function Fm(i){return{baseLanes:i,cachePool:null,transitions:null}}function rE(i,o,c){var h=o.pendingProps,m=It.current,y=!1,I=(o.flags&128)!==0,k;if((k=I)||(k=i!==null&&i.memoizedState===null?!1:(m&2)!==0),k?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),lt(It,m&1),i===null)return dm(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=Mh(I,h,0,null),i=No(i,h,c,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=Fm(c),o.memoizedState=Mm,i):jm(o,I));if(m=i.memoizedState,m!==null&&(k=m.dehydrated,k!==null))return rR(i,o,I,h,k,m,c);if(y){y=h.fallback,I=o.mode,m=i.child,k=m.sibling;var V={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==m?(h=o.child,h.childLanes=0,h.pendingProps=V,o.deletions=null):(h=Ti(m,V),h.subtreeFlags=m.subtreeFlags&14680064),k!==null?y=Ti(k,y):(y=No(y,I,c,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?Fm(c):{baseLanes:I.baseLanes|c,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~c,o.memoizedState=Mm,h}return y=i.child,i=y.sibling,h=Ti(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=c),h.return=o,h.sibling=null,i!==null&&(c=o.deletions,c===null?(o.deletions=[i],o.flags|=16):c.push(i)),o.child=h,o.memoizedState=null,h}function jm(i,o){return o=Mh({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function xh(i,o,c,h){return h!==null&&hm(h),Ka(o,i.child,null,c),i=jm(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function rR(i,o,c,h,m,y,I){if(c)return o.flags&256?(o.flags&=-257,h=Dm(Error(t(422))),xh(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,m=o.mode,h=Mh({mode:"visible",children:h.children},m,0,null),y=No(y,m,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&Ka(o,i.child,null,I),o.child.memoizedState=Fm(I),o.memoizedState=Mm,y);if((o.mode&1)===0)return xh(i,o,I,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var k=h.dgst;return h=k,y=Error(t(419)),h=Dm(y,h,void 0),xh(i,o,I,h)}if(k=(I&i.childLanes)!==0,Ln||k){if(h=Xt,h!==null){switch(I&-I){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(h.suspendedLanes|I))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,Ns(i,m),Rr(h,i,m,-1))}return tg(),h=Dm(Error(t(421))),xh(i,o,I,h)}return m.data==="$?"?(o.flags|=128,o.child=i.child,o=gR.bind(null,i),m._reactRetry=o,null):(i=y.treeContext,er=hi(m.nextSibling),Zn=o,gt=!0,xr=null,i!==null&&(ur[dr++]=ks,ur[dr++]=Cs,ur[dr++]=To,ks=i.id,Cs=i.overflow,To=o),o=jm(o,h.children),o.flags|=4096,o)}function sE(i,o,c){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),gm(i.return,o,c)}function Um(i,o,c,h,m){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:m}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=m)}function iE(i,o,c){var h=o.pendingProps,m=h.revealOrder,y=h.tail;if(An(i,o,h.children,c),h=It.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&sE(i,c,o);else if(i.tag===19)sE(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(lt(It,h),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(c=o.child,m=null;c!==null;)i=c.alternate,i!==null&&yh(i)===null&&(m=c),c=c.sibling;c=m,c===null?(m=o.child,o.child=null):(m=c.sibling,c.sibling=null),Um(o,!1,m,c,y);break;case"backwards":for(c=null,m=o.child,o.child=null;m!==null;){if(i=m.alternate,i!==null&&yh(i)===null){o.child=m;break}i=m.sibling,m.sibling=c,c=m,m=i}Um(o,!0,c,null,y);break;case"together":Um(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Sh(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Vs(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),Ro|=o.lanes,(c&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,c=Ti(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=Ti(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function sR(i,o,c){switch(o.tag){case 3:tE(o),Ga();break;case 5:vw(o);break;case 1:On(o.type)&&ah(o);break;case 4:vm(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,m=o.memoizedProps.value;lt(fh,h._currentValue),h._currentValue=m;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(lt(It,It.current&1),o.flags|=128,null):(c&o.child.childLanes)!==0?rE(i,o,c):(lt(It,It.current&1),i=Vs(i,o,c),i!==null?i.sibling:null);lt(It,It.current&1);break;case 19:if(h=(c&o.childLanes)!==0,(i.flags&128)!==0){if(h)return iE(i,o,c);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),lt(It,It.current),h)break;return null;case 22:case 23:return o.lanes=0,Xw(i,o,c)}return Vs(i,o,c)}var oE,Bm,aE,lE;oE=function(i,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Bm=function(){},aE=function(i,o,c,h){var m=i.memoizedProps;if(m!==h){i=o.stateNode,Ao(Jr.current);var y=null;switch(c){case"input":m=Nn(i,m),h=Nn(i,h),y=[];break;case"select":m=he({},m,{value:void 0}),h=he({},h,{value:void 0}),y=[];break;case"textarea":m=io(i,m),h=io(i,h),y=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=sh)}wr(c,h);var I;c=null;for(q in m)if(!h.hasOwnProperty(q)&&m.hasOwnProperty(q)&&m[q]!=null)if(q==="style"){var k=m[q];for(I in k)k.hasOwnProperty(I)&&(c||(c={}),c[I]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(s.hasOwnProperty(q)?y||(y=[]):(y=y||[]).push(q,null));for(q in h){var V=h[q];if(k=m?.[q],h.hasOwnProperty(q)&&V!==k&&(V!=null||k!=null))if(q==="style")if(k){for(I in k)!k.hasOwnProperty(I)||V&&V.hasOwnProperty(I)||(c||(c={}),c[I]="");for(I in V)V.hasOwnProperty(I)&&k[I]!==V[I]&&(c||(c={}),c[I]=V[I])}else c||(y||(y=[]),y.push(q,c)),c=V;else q==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,k=k?k.__html:void 0,V!=null&&k!==V&&(y=y||[]).push(q,V)):q==="children"?typeof V!="string"&&typeof V!="number"||(y=y||[]).push(q,""+V):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(s.hasOwnProperty(q)?(V!=null&&q==="onScroll"&&ht("scroll",i),y||k===V||(y=[])):(y=y||[]).push(q,V))}c&&(y=y||[]).push("style",c);var q=y;(o.updateQueue=q)&&(o.flags|=4)}},lE=function(i,o,c,h){c!==h&&(o.flags|=4)};function Gc(i,o){if(!gt)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function _n(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(o)for(var m=i.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=h,i.childLanes=c,o}function iR(i,o,c){var h=o.pendingProps;switch(cm(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(o),null;case 1:return On(o.type)&&oh(),_n(o),null;case 3:return h=o.stateNode,Ya(),ft(Vn),ft(gn),Im(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(dh(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xr!==null&&(Xm(xr),xr=null))),Bm(i,o),_n(o),null;case 5:wm(o);var m=Ao(zc.current);if(c=o.type,i!==null&&o.stateNode!=null)aE(i,o,c,h,m),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return _n(o),null}if(i=Ao(Jr.current),dh(o)){h=o.stateNode,c=o.type;var y=o.memoizedProps;switch(h[Qr]=o,h[Mc]=y,i=(o.mode&1)!==0,c){case"dialog":ht("cancel",h),ht("close",h);break;case"iframe":case"object":case"embed":ht("load",h);break;case"video":case"audio":for(m=0;m<Vc.length;m++)ht(Vc[m],h);break;case"source":ht("error",h);break;case"img":case"image":case"link":ht("error",h),ht("load",h);break;case"details":ht("toggle",h);break;case"input":Qt(h,y),ht("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},ht("invalid",h);break;case"textarea":lc(h,y),ht("invalid",h)}wr(c,y),m=null;for(var I in y)if(y.hasOwnProperty(I)){var k=y[I];I==="children"?typeof k=="string"?h.textContent!==k&&(y.suppressHydrationWarning!==!0&&rh(h.textContent,k,i),m=["children",k]):typeof k=="number"&&h.textContent!==""+k&&(y.suppressHydrationWarning!==!0&&rh(h.textContent,k,i),m=["children",""+k]):s.hasOwnProperty(I)&&k!=null&&I==="onScroll"&&ht("scroll",h)}switch(c){case"input":Ke(h),ya(h,y,!0);break;case"textarea":Ke(h),Js(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=sh)}h=m,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=cc(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(c,{is:h.is}):(i=I.createElement(c),c==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,c),i[Qr]=o,i[Mc]=h,oE(i,o,!1,!1),o.stateNode=i;e:{switch(I=wa(c,h),c){case"dialog":ht("cancel",i),ht("close",i),m=h;break;case"iframe":case"object":case"embed":ht("load",i),m=h;break;case"video":case"audio":for(m=0;m<Vc.length;m++)ht(Vc[m],i);m=h;break;case"source":ht("error",i),m=h;break;case"img":case"image":case"link":ht("error",i),ht("load",i),m=h;break;case"details":ht("toggle",i),m=h;break;case"input":Qt(i,h),m=Nn(i,h),ht("invalid",i);break;case"option":m=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},m=he({},h,{value:void 0}),ht("invalid",i);break;case"textarea":lc(i,h),m=io(i,h),ht("invalid",i);break;default:m=h}wr(c,m),k=m;for(y in k)if(k.hasOwnProperty(y)){var V=k[y];y==="style"?va(i,V):y==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&Cd(i,V)):y==="children"?typeof V=="string"?(c!=="textarea"||V!=="")&&oo(i,V):typeof V=="number"&&oo(i,""+V):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?V!=null&&y==="onScroll"&&ht("scroll",i):V!=null&&Z(i,y,V,I))}switch(c){case"input":Ke(i),ya(i,h,!1);break;case"textarea":Ke(i),Js(i);break;case"option":h.value!=null&&i.setAttribute("value",""+qe(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?Dn(i,!!h.multiple,y,!1):h.defaultValue!=null&&Dn(i,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=sh)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return _n(o),null;case 6:if(i&&o.stateNode!=null)lE(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(c=Ao(zc.current),Ao(Jr.current),dh(o)){if(h=o.stateNode,c=o.memoizedProps,h[Qr]=o,(y=h.nodeValue!==c)&&(i=Zn,i!==null))switch(i.tag){case 3:rh(h.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&rh(h.nodeValue,c,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Qr]=o,o.stateNode=h}return _n(o),null;case 13:if(ft(It),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(gt&&er!==null&&(o.mode&1)!==0&&(o.flags&128)===0)dw(),Ga(),o.flags|=98560,y=!1;else if(y=dh(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Qr]=o}else Ga(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_n(o),y=!1}else xr!==null&&(Xm(xr),xr=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=c,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(It.current&1)!==0?Ht===0&&(Ht=3):tg())),o.updateQueue!==null&&(o.flags|=4),_n(o),null);case 4:return Ya(),Bm(i,o),i===null&&Oc(o.stateNode.containerInfo),_n(o),null;case 10:return mm(o.type._context),_n(o),null;case 17:return On(o.type)&&oh(),_n(o),null;case 19:if(ft(It),y=o.memoizedState,y===null)return _n(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Gc(y,!1);else{if(Ht!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=yh(i),I!==null){for(o.flags|=128,Gc(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=c,c=o.child;c!==null;)y=c,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return lt(It,It.current&1|2),o.child}i=i.sibling}y.tail!==null&&dt()>tl&&(o.flags|=128,h=!0,Gc(y,!1),o.lanes=4194304)}else{if(!h)if(i=yh(I),i!==null){if(o.flags|=128,h=!0,c=i.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Gc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!gt)return _n(o),null}else 2*dt()-y.renderingStartTime>tl&&c!==1073741824&&(o.flags|=128,h=!0,Gc(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(c=y.last,c!==null?c.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=dt(),o.sibling=null,c=It.current,lt(It,h?c&1|2:c&1),o):(_n(o),null);case 22:case 23:return eg(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(tr&1073741824)!==0&&(_n(o),o.subtreeFlags&6&&(o.flags|=8192)):_n(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function oR(i,o){switch(cm(o),o.tag){case 1:return On(o.type)&&oh(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Ya(),ft(Vn),ft(gn),Im(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return wm(o),null;case 13:if(ft(It),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Ga()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return ft(It),null;case 4:return Ya(),null;case 10:return mm(o.type._context),null;case 22:case 23:return eg(),null;case 24:return null;default:return null}}var Ah=!1,vn=!1,aR=typeof WeakSet=="function"?WeakSet:Set,_e=null;function Za(i,o){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Rt(i,o,h)}else c.current=null}function zm(i,o,c){try{c()}catch(h){Rt(i,o,h)}}var cE=!1;function lR(i,o){if(em=Ss,i=Bv(),Hp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var I=0,k=-1,V=-1,q=0,X=0,te=i,J=null;t:for(;;){for(var me;te!==c||m!==0&&te.nodeType!==3||(k=I+m),te!==y||h!==0&&te.nodeType!==3||(V=I+h),te.nodeType===3&&(I+=te.nodeValue.length),(me=te.firstChild)!==null;)J=te,te=me;for(;;){if(te===i)break t;if(J===c&&++q===m&&(k=I),J===y&&++X===h&&(V=I),(me=te.nextSibling)!==null)break;te=J,J=te.parentNode}te=me}c=k===-1||V===-1?null:{start:k,end:V}}else c=null}c=c||{start:0,end:0}}else c=null;for(tm={focusedElem:i,selectionRange:c},Ss=!1,_e=o;_e!==null;)if(o=_e,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,_e=i;else for(;_e!==null;){o=_e;try{var ve=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var Ee=ve.memoizedProps,Dt=ve.memoizedState,B=o.stateNode,M=B.getSnapshotBeforeUpdate(o.elementType===o.type?Ee:Sr(o.type,Ee),Dt);B.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var $=o.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){Rt(o,o.return,ie)}if(i=o.sibling,i!==null){i.return=o.return,_e=i;break}_e=o.return}return ve=cE,cE=!1,ve}function Kc(i,o,c){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&i)===i){var y=m.destroy;m.destroy=void 0,y!==void 0&&zm(o,c,y)}m=m.next}while(m!==h)}}function bh(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&i)===i){var h=c.create;c.destroy=h()}c=c.next}while(c!==o)}}function $m(i){var o=i.ref;if(o!==null){var c=i.stateNode;i.tag,i=c,typeof o=="function"?o(i):o.current=i}}function uE(i){var o=i.alternate;o!==null&&(i.alternate=null,uE(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Qr],delete o[Mc],delete o[im],delete o[qb],delete o[Wb])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function dE(i){return i.tag===5||i.tag===3||i.tag===4}function hE(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||dE(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function qm(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(i,o):c.insertBefore(i,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(i,c)):(o=c,o.appendChild(i)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=sh));else if(h!==4&&(i=i.child,i!==null))for(qm(i,o,c),i=i.sibling;i!==null;)qm(i,o,c),i=i.sibling}function Wm(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(Wm(i,o,c),i=i.sibling;i!==null;)Wm(i,o,c),i=i.sibling}var ln=null,Ar=!1;function _i(i,o,c){for(c=c.child;c!==null;)fE(i,o,c),c=c.sibling}function fE(i,o,c){if(Gn&&typeof Gn.onCommitFiberUnmount=="function")try{Gn.onCommitFiberUnmount(ho,c)}catch{}switch(c.tag){case 5:vn||Za(c,o);case 6:var h=ln,m=Ar;ln=null,_i(i,o,c),ln=h,Ar=m,ln!==null&&(Ar?(i=ln,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):ln.removeChild(c.stateNode));break;case 18:ln!==null&&(Ar?(i=ln,c=c.stateNode,i.nodeType===8?sm(i.parentNode,c):i.nodeType===1&&sm(i,c),li(i)):sm(ln,c.stateNode));break;case 4:h=ln,m=Ar,ln=c.stateNode.containerInfo,Ar=!0,_i(i,o,c),ln=h,Ar=m;break;case 0:case 11:case 14:case 15:if(!vn&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var y=m,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&zm(c,o,I),m=m.next}while(m!==h)}_i(i,o,c);break;case 1:if(!vn&&(Za(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(k){Rt(c,o,k)}_i(i,o,c);break;case 21:_i(i,o,c);break;case 22:c.mode&1?(vn=(h=vn)||c.memoizedState!==null,_i(i,o,c),vn=h):_i(i,o,c);break;default:_i(i,o,c)}}function pE(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new aR),o.forEach(function(h){var m=yR.bind(null,i,h);c.has(h)||(c.add(h),h.then(m,m))})}}function br(i,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var m=c[h];try{var y=i,I=o,k=I;e:for(;k!==null;){switch(k.tag){case 5:ln=k.stateNode,Ar=!1;break e;case 3:ln=k.stateNode.containerInfo,Ar=!0;break e;case 4:ln=k.stateNode.containerInfo,Ar=!0;break e}k=k.return}if(ln===null)throw Error(t(160));fE(y,I,m),ln=null,Ar=!1;var V=m.alternate;V!==null&&(V.return=null),m.return=null}catch(q){Rt(m,o,q)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)mE(o,i),o=o.sibling}function mE(i,o){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(br(o,i),Xr(i),h&4){try{Kc(3,i,i.return),bh(3,i)}catch(Ee){Rt(i,i.return,Ee)}try{Kc(5,i,i.return)}catch(Ee){Rt(i,i.return,Ee)}}break;case 1:br(o,i),Xr(i),h&512&&c!==null&&Za(c,c.return);break;case 5:if(br(o,i),Xr(i),h&512&&c!==null&&Za(c,c.return),i.flags&32){var m=i.stateNode;try{oo(m,"")}catch(Ee){Rt(i,i.return,Ee)}}if(h&4&&(m=i.stateNode,m!=null)){var y=i.memoizedProps,I=c!==null?c.memoizedProps:y,k=i.type,V=i.updateQueue;if(i.updateQueue=null,V!==null)try{k==="input"&&y.type==="radio"&&y.name!=null&&jt(m,y),wa(k,I);var q=wa(k,y);for(I=0;I<V.length;I+=2){var X=V[I],te=V[I+1];X==="style"?va(m,te):X==="dangerouslySetInnerHTML"?Cd(m,te):X==="children"?oo(m,te):Z(m,X,te,q)}switch(k){case"input":Jt(m,y);break;case"textarea":kd(m,y);break;case"select":var J=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var me=y.value;me!=null?Dn(m,!!y.multiple,me,!1):J!==!!y.multiple&&(y.defaultValue!=null?Dn(m,!!y.multiple,y.defaultValue,!0):Dn(m,!!y.multiple,y.multiple?[]:"",!1))}m[Mc]=y}catch(Ee){Rt(i,i.return,Ee)}}break;case 6:if(br(o,i),Xr(i),h&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,y=i.memoizedProps;try{m.nodeValue=y}catch(Ee){Rt(i,i.return,Ee)}}break;case 3:if(br(o,i),Xr(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{li(o.containerInfo)}catch(Ee){Rt(i,i.return,Ee)}break;case 4:br(o,i),Xr(i);break;case 13:br(o,i),Xr(i),m=i.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(Km=dt())),h&4&&pE(i);break;case 22:if(X=c!==null&&c.memoizedState!==null,i.mode&1?(vn=(q=vn)||X,br(o,i),vn=q):br(o,i),Xr(i),h&8192){if(q=i.memoizedState!==null,(i.stateNode.isHidden=q)&&!X&&(i.mode&1)!==0)for(_e=i,X=i.child;X!==null;){for(te=_e=X;_e!==null;){switch(J=_e,me=J.child,J.tag){case 0:case 11:case 14:case 15:Kc(4,J,J.return);break;case 1:Za(J,J.return);var ve=J.stateNode;if(typeof ve.componentWillUnmount=="function"){h=J,c=J.return;try{o=h,ve.props=o.memoizedProps,ve.state=o.memoizedState,ve.componentWillUnmount()}catch(Ee){Rt(h,c,Ee)}}break;case 5:Za(J,J.return);break;case 22:if(J.memoizedState!==null){_E(te);continue}}me!==null?(me.return=J,_e=me):_E(te)}X=X.sibling}e:for(X=null,te=i;;){if(te.tag===5){if(X===null){X=te;try{m=te.stateNode,q?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(k=te.stateNode,V=te.memoizedProps.style,I=V!=null&&V.hasOwnProperty("display")?V.display:null,k.style.display=Zs("display",I))}catch(Ee){Rt(i,i.return,Ee)}}}else if(te.tag===6){if(X===null)try{te.stateNode.nodeValue=q?"":te.memoizedProps}catch(Ee){Rt(i,i.return,Ee)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;X===te&&(X=null),te=te.return}X===te&&(X=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:br(o,i),Xr(i),h&4&&pE(i);break;case 21:break;default:br(o,i),Xr(i)}}function Xr(i){var o=i.flags;if(o&2){try{e:{for(var c=i.return;c!==null;){if(dE(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(oo(m,""),h.flags&=-33);var y=hE(i);Wm(i,y,m);break;case 3:case 4:var I=h.stateNode.containerInfo,k=hE(i);qm(i,k,I);break;default:throw Error(t(161))}}catch(V){Rt(i,i.return,V)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function cR(i,o,c){_e=i,gE(i)}function gE(i,o,c){for(var h=(i.mode&1)!==0;_e!==null;){var m=_e,y=m.child;if(m.tag===22&&h){var I=m.memoizedState!==null||Ah;if(!I){var k=m.alternate,V=k!==null&&k.memoizedState!==null||vn;k=Ah;var q=vn;if(Ah=I,(vn=V)&&!q)for(_e=m;_e!==null;)I=_e,V=I.child,I.tag===22&&I.memoizedState!==null?vE(m):V!==null?(V.return=I,_e=V):vE(m);for(;y!==null;)_e=y,gE(y),y=y.sibling;_e=m,Ah=k,vn=q}yE(i)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,_e=y):yE(i)}}function yE(i){for(;_e!==null;){var o=_e;if((o.flags&8772)!==0){var c=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:vn||bh(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!vn)if(c===null)h.componentDidMount();else{var m=o.elementType===o.type?c.memoizedProps:Sr(o.type,c.memoizedProps);h.componentDidUpdate(m,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&_w(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}_w(o,I,c)}break;case 5:var k=o.stateNode;if(c===null&&o.flags&4){c=k;var V=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&c.focus();break;case"img":V.src&&(c.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var q=o.alternate;if(q!==null){var X=q.memoizedState;if(X!==null){var te=X.dehydrated;te!==null&&li(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}vn||o.flags&512&&$m(o)}catch(J){Rt(o,o.return,J)}}if(o===i){_e=null;break}if(c=o.sibling,c!==null){c.return=o.return,_e=c;break}_e=o.return}}function _E(i){for(;_e!==null;){var o=_e;if(o===i){_e=null;break}var c=o.sibling;if(c!==null){c.return=o.return,_e=c;break}_e=o.return}}function vE(i){for(;_e!==null;){var o=_e;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{bh(4,o)}catch(V){Rt(o,c,V)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var m=o.return;try{h.componentDidMount()}catch(V){Rt(o,m,V)}}var y=o.return;try{$m(o)}catch(V){Rt(o,y,V)}break;case 5:var I=o.return;try{$m(o)}catch(V){Rt(o,I,V)}}}catch(V){Rt(o,o.return,V)}if(o===i){_e=null;break}var k=o.sibling;if(k!==null){k.return=o.return,_e=k;break}_e=o.return}}var uR=Math.ceil,Rh=ge.ReactCurrentDispatcher,Hm=ge.ReactCurrentOwner,pr=ge.ReactCurrentBatchConfig,Qe=0,Xt=null,Bt=null,cn=0,tr=0,el=fi(0),Ht=0,Qc=null,Ro=0,Ph=0,Gm=0,Jc=null,Mn=null,Km=0,tl=1/0,Os=null,kh=!1,Qm=null,vi=null,Ch=!1,wi=null,Nh=0,Yc=0,Jm=null,Dh=-1,Vh=0;function bn(){return(Qe&6)!==0?dt():Dh!==-1?Dh:Dh=dt()}function Ei(i){return(i.mode&1)===0?1:(Qe&2)!==0&&cn!==0?cn&-cn:Gb.transition!==null?(Vh===0&&(Vh=_c()),Vh):(i=We,i!==0||(i=window.event,i=i===void 0?16:ka(i.type)),i)}function Rr(i,o,c,h){if(50<Yc)throw Yc=0,Jm=null,Error(t(185));go(i,c,h),((Qe&2)===0||i!==Xt)&&(i===Xt&&((Qe&2)===0&&(Ph|=c),Ht===4&&Ii(i,cn)),Fn(i,h),c===1&&Qe===0&&(o.mode&1)===0&&(tl=dt()+500,lh&&mi()))}function Fn(i,o){var c=i.callbackNode;mo(i,o);var h=Is(i,i===Xt?cn:0);if(h===0)c!==null&&Ta(c),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(c!=null&&Ta(c),o===1)i.tag===0?Hb(EE.bind(null,i)):ow(EE.bind(null,i)),zb(function(){(Qe&6)===0&&mi()}),c=null;else{switch(jr(h)){case 1:c=xa;break;case 4:c=mc;break;case 16:c=uo;break;case 536870912:c=Sa;break;default:c=uo}c=PE(c,wE.bind(null,i))}i.callbackPriority=o,i.callbackNode=c}}function wE(i,o){if(Dh=-1,Vh=0,(Qe&6)!==0)throw Error(t(327));var c=i.callbackNode;if(nl()&&i.callbackNode!==c)return null;var h=Is(i,i===Xt?cn:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=Oh(i,h);else{o=h;var m=Qe;Qe|=2;var y=TE();(Xt!==i||cn!==o)&&(Os=null,tl=dt()+500,ko(i,o));do try{fR();break}catch(k){IE(i,k)}while(!0);pm(),Rh.current=y,Qe=m,Bt!==null?o=0:(Xt=null,cn=0,o=Ht)}if(o!==0){if(o===2&&(m=yc(i),m!==0&&(h=m,o=Ym(i,m))),o===1)throw c=Qc,ko(i,0),Ii(i,h),Fn(i,dt()),c;if(o===6)Ii(i,h);else{if(m=i.current.alternate,(h&30)===0&&!dR(m)&&(o=Oh(i,h),o===2&&(y=yc(i),y!==0&&(h=y,o=Ym(i,y))),o===1))throw c=Qc,ko(i,0),Ii(i,h),Fn(i,dt()),c;switch(i.finishedWork=m,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:Co(i,Mn,Os);break;case 3:if(Ii(i,h),(h&130023424)===h&&(o=Km+500-dt(),10<o)){if(Is(i,0)!==0)break;if(m=i.suspendedLanes,(m&h)!==h){bn(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=rm(Co.bind(null,i,Mn,Os),o);break}Co(i,Mn,Os);break;case 4:if(Ii(i,h),(h&4194240)===h)break;for(o=i.eventTimes,m=-1;0<h;){var I=31-Kn(h);y=1<<I,I=o[I],I>m&&(m=I),h&=~y}if(h=m,h=dt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*uR(h/1960))-h,10<h){i.timeoutHandle=rm(Co.bind(null,i,Mn,Os),h);break}Co(i,Mn,Os);break;case 5:Co(i,Mn,Os);break;default:throw Error(t(329))}}}return Fn(i,dt()),i.callbackNode===c?wE.bind(null,i):null}function Ym(i,o){var c=Jc;return i.current.memoizedState.isDehydrated&&(ko(i,o).flags|=256),i=Oh(i,o),i!==2&&(o=Mn,Mn=c,o!==null&&Xm(o)),i}function Xm(i){Mn===null?Mn=i:Mn.push.apply(Mn,i)}function dR(i){for(var o=i;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var m=c[h],y=m.getSnapshot;m=m.value;try{if(!Tr(y(),m))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ii(i,o){for(o&=~Gm,o&=~Ph,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var c=31-Kn(o),h=1<<c;i[c]=-1,o&=~h}}function EE(i){if((Qe&6)!==0)throw Error(t(327));nl();var o=Is(i,0);if((o&1)===0)return Fn(i,dt()),null;var c=Oh(i,o);if(i.tag!==0&&c===2){var h=yc(i);h!==0&&(o=h,c=Ym(i,h))}if(c===1)throw c=Qc,ko(i,0),Ii(i,o),Fn(i,dt()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Co(i,Mn,Os),Fn(i,dt()),null}function Zm(i,o){var c=Qe;Qe|=1;try{return i(o)}finally{Qe=c,Qe===0&&(tl=dt()+500,lh&&mi())}}function Po(i){wi!==null&&wi.tag===0&&(Qe&6)===0&&nl();var o=Qe;Qe|=1;var c=pr.transition,h=We;try{if(pr.transition=null,We=1,i)return i()}finally{We=h,pr.transition=c,Qe=o,(Qe&6)===0&&mi()}}function eg(){tr=el.current,ft(el)}function ko(i,o){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,Bb(c)),Bt!==null)for(c=Bt.return;c!==null;){var h=c;switch(cm(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&oh();break;case 3:Ya(),ft(Vn),ft(gn),Im();break;case 5:wm(h);break;case 4:Ya();break;case 13:ft(It);break;case 19:ft(It);break;case 10:mm(h.type._context);break;case 22:case 23:eg()}c=c.return}if(Xt=i,Bt=i=Ti(i.current,null),cn=tr=o,Ht=0,Qc=null,Gm=Ph=Ro=0,Mn=Jc=null,So!==null){for(o=0;o<So.length;o++)if(c=So[o],h=c.interleaved,h!==null){c.interleaved=null;var m=h.next,y=c.pending;if(y!==null){var I=y.next;y.next=m,h.next=I}c.pending=h}So=null}return i}function IE(i,o){do{var c=Bt;try{if(pm(),_h.current=Ih,vh){for(var h=Tt.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}vh=!1}if(bo=0,Yt=Wt=Tt=null,$c=!1,qc=0,Hm.current=null,c===null||c.return===null){Ht=1,Qc=o,Bt=null;break}e:{var y=i,I=c.return,k=c,V=o;if(o=cn,k.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var q=V,X=k,te=X.tag;if((X.mode&1)===0&&(te===0||te===11||te===15)){var J=X.alternate;J?(X.updateQueue=J.updateQueue,X.memoizedState=J.memoizedState,X.lanes=J.lanes):(X.updateQueue=null,X.memoizedState=null)}var me=Gw(I);if(me!==null){me.flags&=-257,Kw(me,I,k,y,o),me.mode&1&&Hw(y,q,o),o=me,V=q;var ve=o.updateQueue;if(ve===null){var Ee=new Set;Ee.add(V),o.updateQueue=Ee}else ve.add(V);break e}else{if((o&1)===0){Hw(y,q,o),tg();break e}V=Error(t(426))}}else if(gt&&k.mode&1){var Dt=Gw(I);if(Dt!==null){(Dt.flags&65536)===0&&(Dt.flags|=256),Kw(Dt,I,k,y,o),hm(Xa(V,k));break e}}y=V=Xa(V,k),Ht!==4&&(Ht=2),Jc===null?Jc=[y]:Jc.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var B=qw(y,V,o);yw(y,B);break e;case 1:k=V;var M=y.type,$=y.stateNode;if((y.flags&128)===0&&(typeof M.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(vi===null||!vi.has($)))){y.flags|=65536,o&=-o,y.lanes|=o;var ie=Ww(y,k,o);yw(y,ie);break e}}y=y.return}while(y!==null)}SE(c)}catch(Ie){o=Ie,Bt===c&&c!==null&&(Bt=c=c.return);continue}break}while(!0)}function TE(){var i=Rh.current;return Rh.current=Ih,i===null?Ih:i}function tg(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Xt===null||(Ro&268435455)===0&&(Ph&268435455)===0||Ii(Xt,cn)}function Oh(i,o){var c=Qe;Qe|=2;var h=TE();(Xt!==i||cn!==o)&&(Os=null,ko(i,o));do try{hR();break}catch(m){IE(i,m)}while(!0);if(pm(),Qe=c,Rh.current=h,Bt!==null)throw Error(t(261));return Xt=null,cn=0,Ht}function hR(){for(;Bt!==null;)xE(Bt)}function fR(){for(;Bt!==null&&!co();)xE(Bt)}function xE(i){var o=RE(i.alternate,i,tr);i.memoizedProps=i.pendingProps,o===null?SE(i):Bt=o,Hm.current=null}function SE(i){var o=i;do{var c=o.alternate;if(i=o.return,(o.flags&32768)===0){if(c=iR(c,o,tr),c!==null){Bt=c;return}}else{if(c=oR(c,o),c!==null){c.flags&=32767,Bt=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ht=6,Bt=null;return}}if(o=o.sibling,o!==null){Bt=o;return}Bt=o=i}while(o!==null);Ht===0&&(Ht=5)}function Co(i,o,c){var h=We,m=pr.transition;try{pr.transition=null,We=1,pR(i,o,c,h)}finally{pr.transition=m,We=h}return null}function pR(i,o,c,h){do nl();while(wi!==null);if((Qe&6)!==0)throw Error(t(327));c=i.finishedWork;var m=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=c.lanes|c.childLanes;if(Bp(i,y),i===Xt&&(Bt=Xt=null,cn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Ch||(Ch=!0,PE(uo,function(){return nl(),null})),y=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||y){y=pr.transition,pr.transition=null;var I=We;We=1;var k=Qe;Qe|=4,Hm.current=null,lR(i,c),mE(c,i),Vb(tm),Ss=!!em,tm=em=null,i.current=c,cR(c),Es(),Qe=k,We=I,pr.transition=y}else i.current=c;if(Ch&&(Ch=!1,wi=i,Nh=m),y=i.pendingLanes,y===0&&(vi=null),zd(c.stateNode),Fn(i,dt()),o!==null)for(h=i.onRecoverableError,c=0;c<o.length;c++)m=o[c],h(m.value,{componentStack:m.stack,digest:m.digest});if(kh)throw kh=!1,i=Qm,Qm=null,i;return(Nh&1)!==0&&i.tag!==0&&nl(),y=i.pendingLanes,(y&1)!==0?i===Jm?Yc++:(Yc=0,Jm=i):Yc=0,mi(),null}function nl(){if(wi!==null){var i=jr(Nh),o=pr.transition,c=We;try{if(pr.transition=null,We=16>i?16:i,wi===null)var h=!1;else{if(i=wi,wi=null,Nh=0,(Qe&6)!==0)throw Error(t(331));var m=Qe;for(Qe|=4,_e=i.current;_e!==null;){var y=_e,I=y.child;if((_e.flags&16)!==0){var k=y.deletions;if(k!==null){for(var V=0;V<k.length;V++){var q=k[V];for(_e=q;_e!==null;){var X=_e;switch(X.tag){case 0:case 11:case 15:Kc(8,X,y)}var te=X.child;if(te!==null)te.return=X,_e=te;else for(;_e!==null;){X=_e;var J=X.sibling,me=X.return;if(uE(X),X===q){_e=null;break}if(J!==null){J.return=me,_e=J;break}_e=me}}}var ve=y.alternate;if(ve!==null){var Ee=ve.child;if(Ee!==null){ve.child=null;do{var Dt=Ee.sibling;Ee.sibling=null,Ee=Dt}while(Ee!==null)}}_e=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,_e=I;else e:for(;_e!==null;){if(y=_e,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Kc(9,y,y.return)}var B=y.sibling;if(B!==null){B.return=y.return,_e=B;break e}_e=y.return}}var M=i.current;for(_e=M;_e!==null;){I=_e;var $=I.child;if((I.subtreeFlags&2064)!==0&&$!==null)$.return=I,_e=$;else e:for(I=M;_e!==null;){if(k=_e,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:bh(9,k)}}catch(Ie){Rt(k,k.return,Ie)}if(k===I){_e=null;break e}var ie=k.sibling;if(ie!==null){ie.return=k.return,_e=ie;break e}_e=k.return}}if(Qe=m,mi(),Gn&&typeof Gn.onPostCommitFiberRoot=="function")try{Gn.onPostCommitFiberRoot(ho,i)}catch{}h=!0}return h}finally{We=c,pr.transition=o}}return!1}function AE(i,o,c){o=Xa(c,o),o=qw(i,o,1),i=yi(i,o,1),o=bn(),i!==null&&(go(i,1,o),Fn(i,o))}function Rt(i,o,c){if(i.tag===3)AE(i,i,c);else for(;o!==null;){if(o.tag===3){AE(o,i,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(vi===null||!vi.has(h))){i=Xa(c,i),i=Ww(o,i,1),o=yi(o,i,1),i=bn(),o!==null&&(go(o,1,i),Fn(o,i));break}}o=o.return}}function mR(i,o,c){var h=i.pingCache;h!==null&&h.delete(o),o=bn(),i.pingedLanes|=i.suspendedLanes&c,Xt===i&&(cn&c)===c&&(Ht===4||Ht===3&&(cn&130023424)===cn&&500>dt()-Km?ko(i,0):Gm|=c),Fn(i,o)}function bE(i,o){o===0&&((i.mode&1)===0?o=1:(o=ii,ii<<=1,(ii&130023424)===0&&(ii=4194304)));var c=bn();i=Ns(i,o),i!==null&&(go(i,o,c),Fn(i,c))}function gR(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),bE(i,c)}function yR(i,o){var c=0;switch(i.tag){case 13:var h=i.stateNode,m=i.memoizedState;m!==null&&(c=m.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),bE(i,c)}var RE;RE=function(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps||Vn.current)Ln=!0;else{if((i.lanes&c)===0&&(o.flags&128)===0)return Ln=!1,sR(i,o,c);Ln=(i.flags&131072)!==0}else Ln=!1,gt&&(o.flags&1048576)!==0&&aw(o,uh,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;Sh(i,o),i=o.pendingProps;var m=qa(o,gn.current);Ja(o,c),m=Sm(null,o,h,i,m,c);var y=Am();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,On(h)?(y=!0,ah(o)):y=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,_m(o),m.updater=Th,o.stateNode=m,m._reactInternals=o,Nm(o,h,i,c),o=Lm(null,o,h,!0,y,c)):(o.tag=0,gt&&y&&lm(o),An(null,o,m,c),o=o.child),o;case 16:h=o.elementType;e:{switch(Sh(i,o),i=o.pendingProps,m=h._init,h=m(h._payload),o.type=h,m=o.tag=vR(h),i=Sr(h,i),m){case 0:o=Om(null,o,h,i,c);break e;case 1:o=eE(null,o,h,i,c);break e;case 11:o=Qw(null,o,h,i,c);break e;case 14:o=Jw(null,o,h,Sr(h.type,i),c);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Om(i,o,h,m,c);case 1:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),eE(i,o,h,m,c);case 3:e:{if(tE(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,m=y.element,gw(i,o),gh(o,h,null,c);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){m=Xa(Error(t(423)),o),o=nE(i,o,h,c,m);break e}else if(h!==m){m=Xa(Error(t(424)),o),o=nE(i,o,h,c,m);break e}else for(er=hi(o.stateNode.containerInfo.firstChild),Zn=o,gt=!0,xr=null,c=pw(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Ga(),h===m){o=Vs(i,o,c);break e}An(i,o,h,c)}o=o.child}return o;case 5:return vw(o),i===null&&dm(o),h=o.type,m=o.pendingProps,y=i!==null?i.memoizedProps:null,I=m.children,nm(h,m)?I=null:y!==null&&nm(h,y)&&(o.flags|=32),Zw(i,o),An(i,o,I,c),o.child;case 6:return i===null&&dm(o),null;case 13:return rE(i,o,c);case 4:return vm(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=Ka(o,null,h,c):An(i,o,h,c),o.child;case 11:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Qw(i,o,h,m,c);case 7:return An(i,o,o.pendingProps,c),o.child;case 8:return An(i,o,o.pendingProps.children,c),o.child;case 12:return An(i,o,o.pendingProps.children,c),o.child;case 10:e:{if(h=o.type._context,m=o.pendingProps,y=o.memoizedProps,I=m.value,lt(fh,h._currentValue),h._currentValue=I,y!==null)if(Tr(y.value,I)){if(y.children===m.children&&!Vn.current){o=Vs(i,o,c);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var k=y.dependencies;if(k!==null){I=y.child;for(var V=k.firstContext;V!==null;){if(V.context===h){if(y.tag===1){V=Ds(-1,c&-c),V.tag=2;var q=y.updateQueue;if(q!==null){q=q.shared;var X=q.pending;X===null?V.next=V:(V.next=X.next,X.next=V),q.pending=V}}y.lanes|=c,V=y.alternate,V!==null&&(V.lanes|=c),gm(y.return,c,o),k.lanes|=c;break}V=V.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=c,k=I.alternate,k!==null&&(k.lanes|=c),gm(I,c,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}An(i,o,m.children,c),o=o.child}return o;case 9:return m=o.type,h=o.pendingProps.children,Ja(o,c),m=hr(m),h=h(m),o.flags|=1,An(i,o,h,c),o.child;case 14:return h=o.type,m=Sr(h,o.pendingProps),m=Sr(h.type,m),Jw(i,o,h,m,c);case 15:return Yw(i,o,o.type,o.pendingProps,c);case 17:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Sh(i,o),o.tag=1,On(h)?(i=!0,ah(o)):i=!1,Ja(o,c),zw(o,h,m),Nm(o,h,m,c),Lm(null,o,h,!0,i,c);case 19:return iE(i,o,c);case 22:return Xw(i,o,c)}throw Error(t(156,o.tag))};function PE(i,o){return pc(i,o)}function _R(i,o,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(i,o,c,h){return new _R(i,o,c,h)}function ng(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vR(i){if(typeof i=="function")return ng(i)?1:0;if(i!=null){if(i=i.$$typeof,i===j)return 11;if(i===it)return 14}return 2}function Ti(i,o){var c=i.alternate;return c===null?(c=mr(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Lh(i,o,c,h,m,y){var I=2;if(h=i,typeof i=="function")ng(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case A:return No(c.children,m,y,o);case b:I=8,m|=8;break;case C:return i=mr(12,c,o,m|2),i.elementType=C,i.lanes=y,i;case P:return i=mr(13,c,o,m),i.elementType=P,i.lanes=y,i;case Oe:return i=mr(19,c,o,m),i.elementType=Oe,i.lanes=y,i;case Ne:return Mh(c,m,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case R:I=10;break e;case N:I=9;break e;case j:I=11;break e;case it:I=14;break e;case ue:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=mr(I,c,o,m),o.elementType=i,o.type=h,o.lanes=y,o}function No(i,o,c,h){return i=mr(7,i,h,o),i.lanes=c,i}function Mh(i,o,c,h){return i=mr(22,i,h,o),i.elementType=Ne,i.lanes=c,i.stateNode={isHidden:!1},i}function rg(i,o,c){return i=mr(6,i,null,o),i.lanes=c,i}function sg(i,o,c){return o=mr(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function wR(i,o,c,h,m){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vc(0),this.expirationTimes=vc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vc(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function ig(i,o,c,h,m,y,I,k,V){return i=new wR(i,o,c,k,V),o===1?(o=1,y===!0&&(o|=8)):o=0,y=mr(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},_m(y),i}function ER(i,o,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ae,key:h==null?null:""+h,children:i,containerInfo:o,implementation:c}}function kE(i){if(!i)return pi;i=i._reactInternals;e:{if(Er(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(On(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(On(c))return sw(i,c,o)}return o}function CE(i,o,c,h,m,y,I,k,V){return i=ig(c,h,!0,i,m,y,I,k,V),i.context=kE(null),c=i.current,h=bn(),m=Ei(c),y=Ds(h,m),y.callback=o??null,yi(c,y,m),i.current.lanes=m,go(i,m,h),Fn(i,h),i}function Fh(i,o,c,h){var m=o.current,y=bn(),I=Ei(m);return c=kE(c),o.context===null?o.context=c:o.pendingContext=c,o=Ds(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=yi(m,o,I),i!==null&&(Rr(i,m,I,y),mh(i,m,I)),I}function jh(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function NE(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function og(i,o){NE(i,o),(i=i.alternate)&&NE(i,o)}function IR(){return null}var DE=typeof reportError=="function"?reportError:function(i){console.error(i)};function ag(i){this._internalRoot=i}Uh.prototype.render=ag.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Fh(i,o,null,null)},Uh.prototype.unmount=ag.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Po(function(){Fh(null,i,null,null)}),o[Rs]=null}};function Uh(i){this._internalRoot=i}Uh.prototype.unstable_scheduleHydration=function(i){if(i){var o=Tc();i={blockedOn:null,target:i,priority:o};for(var c=0;c<Qn.length&&o!==0&&o<Qn[c].priority;c++);Qn.splice(c,0,i),c===0&&Ra(i)}};function lg(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Bh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function VE(){}function TR(i,o,c,h,m){if(m){if(typeof h=="function"){var y=h;h=function(){var q=jh(I);y.call(q)}}var I=CE(o,h,i,0,null,!1,!1,"",VE);return i._reactRootContainer=I,i[Rs]=I.current,Oc(i.nodeType===8?i.parentNode:i),Po(),I}for(;m=i.lastChild;)i.removeChild(m);if(typeof h=="function"){var k=h;h=function(){var q=jh(V);k.call(q)}}var V=ig(i,0,!1,null,null,!1,!1,"",VE);return i._reactRootContainer=V,i[Rs]=V.current,Oc(i.nodeType===8?i.parentNode:i),Po(function(){Fh(o,V,c,h)}),V}function zh(i,o,c,h,m){var y=c._reactRootContainer;if(y){var I=y;if(typeof m=="function"){var k=m;m=function(){var V=jh(I);k.call(V)}}Fh(o,I,i,m)}else I=TR(c,o,i,m,h);return jh(I)}Ec=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var c=Ze(o.pendingLanes);c!==0&&(wc(o,c|1),Fn(o,dt()),(Qe&6)===0&&(tl=dt()+500,mi()))}break;case 13:Po(function(){var h=Ns(i,1);if(h!==null){var m=bn();Rr(h,i,1,m)}}),og(i,1)}},Aa=function(i){if(i.tag===13){var o=Ns(i,134217728);if(o!==null){var c=bn();Rr(o,i,134217728,c)}og(i,134217728)}},Ic=function(i){if(i.tag===13){var o=Ei(i),c=Ns(i,o);if(c!==null){var h=bn();Rr(c,i,o,h)}og(i,o)}},Tc=function(){return We},xc=function(i,o){var c=We;try{return We=i,o()}finally{We=c}},_s=function(i,o,c){switch(o){case"input":if(Jt(i,c),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==i&&h.form===i.form){var m=ih(h);if(!m)throw Error(t(90));wt(h),Jt(h,m)}}}break;case"textarea":kd(i,c);break;case"select":o=c.value,o!=null&&Dn(i,!!c.multiple,o,!1)}},Dd=Zm,Vd=Po;var xR={usingClientEntryPoint:!1,Events:[Fc,za,ih,ti,ni,Zm]},Xc={findFiberByHostInstance:Eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SR={bundleType:Xc.bundleType,version:Xc.version,rendererPackageName:Xc.rendererPackageName,rendererConfig:Xc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ge.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Bd(i),i===null?null:i.stateNode},findFiberByHostInstance:Xc.findFiberByHostInstance||IR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{ho=$h.inject(SR),Gn=$h}catch{}}return jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR,jn.createPortal=function(i,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lg(o))throw Error(t(200));return ER(i,o,null,c)},jn.createRoot=function(i,o){if(!lg(i))throw Error(t(299));var c=!1,h="",m=DE;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=ig(i,1,!1,null,null,c,!1,h,m),i[Rs]=o.current,Oc(i.nodeType===8?i.parentNode:i),new ag(o)},jn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Bd(o),i=i===null?null:i.stateNode,i},jn.flushSync=function(i){return Po(i)},jn.hydrate=function(i,o,c){if(!Bh(o))throw Error(t(200));return zh(null,i,o,!0,c)},jn.hydrateRoot=function(i,o,c){if(!lg(i))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,m=!1,y="",I=DE;if(c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(I=c.onRecoverableError)),o=CE(o,null,i,1,c??null,m,!1,y,I),i[Rs]=o.current,Oc(i),h)for(i=0;i<h.length;i++)c=h[i],m=c._getVersion,m=m(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,m]:o.mutableSourceEagerHydrationData.push(c,m);return new Uh(o)},jn.render=function(i,o,c){if(!Bh(o))throw Error(t(200));return zh(null,i,o,!1,c)},jn.unmountComponentAtNode=function(i){if(!Bh(i))throw Error(t(40));return i._reactRootContainer?(Po(function(){zh(null,null,i,!1,function(){i._reactRootContainer=null,i[Rs]=null})}),!0):!1},jn.unstable_batchedUpdates=Zm,jn.unstable_renderSubtreeIntoContainer=function(i,o,c,h){if(!Bh(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return zh(i,o,c,!1,h)},jn.version="18.3.1-next-f1338f8080-20240426",jn}var zE;function OR(){if(zE)return dg.exports;zE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dg.exports=VR(),dg.exports}var $E;function LR(){if($E)return qh;$E=1;var n=OR();return qh.createRoot=n.createRoot,qh.hydrateRoot=n.hydrateRoot,qh}var MR=LR();const FR="modulepreload",jR=function(n){return"/SchoolBookExchange/"+n},qE={},ns=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var l=p;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");s=p(t.map(g=>{if(g=jR(g),g in qE)return;qE[g]=!0;const w=g.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${T}`))return;const D=document.createElement("link");if(D.rel=w?"stylesheet":FR,w||(D.as="script"),D.crossOrigin="",D.href=g,f&&D.setAttribute("nonce",f),document.head.appendChild(D),w)return new Promise((S,O)=>{D.addEventListener("load",S),D.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return s.then(u=>{for(const f of u||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})};const UR=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BR=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),WE=n=>{const e=BR(n);return e.charAt(0).toUpperCase()+e.slice(1)},bT=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),zR=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var $R={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qR=fe.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:l,...u},f)=>fe.createElement("svg",{ref:f,...$R,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:bT("lucide",s),...!a&&!zR(u)&&{"aria-hidden":"true"},...u},[...l.map(([p,g])=>fe.createElement(p,g)),...Array.isArray(a)?a:[a]]));const Ge=(n,e)=>{const t=fe.forwardRef(({className:r,...s},a)=>fe.createElement(qR,{ref:a,iconNode:e,className:bT(`lucide-${UR(WE(n))}`,`lucide-${n}`,r),...s}));return t.displayName=WE(n),t};const WR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],RT=Ge("arrow-right",WR);const HR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Mg=Ge("bell",HR);const GR=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],KR=Ge("book-open",GR);const QR=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],JR=Ge("book",QR);const YR=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],XR=Ge("calendar",YR);const ZR=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],PT=Ge("camera",ZR);const eP=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tP=Ge("chevron-down",eP);const nP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ny=Ge("chevron-left",nP);const rP=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kT=Ge("chevron-right",rP);const sP=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Fg=Ge("coins",sP);const iP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],oP=Ge("external-link",iP);const aP=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lP=Ge("eye",aP);const cP=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],uP=Ge("flame",cP);const dP=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],CT=Ge("gift",dP);const hP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],fP=Ge("heart",hP);const pP=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],HE=Ge("house",pP);const mP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],gP=Ge("image",mP);const yP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],_P=Ge("log-out",yP);const vP=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],wP=Ge("mail",vP);const EP=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Du=Ge("message-circle",EP);const IP=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],TP=Ge("palette",IP);const xP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],SP=Ge("plus",xP);const AP=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],NT=Ge("repeat",AP);const bP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],RP=Ge("search",bP);const PP=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],kP=Ge("send",PP);const CP=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],NP=Ge("share-2",CP);const DP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],VP=Ge("shield-check",DP);const OP=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],DT=Ge("sparkles",OP);const LP=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],MP=Ge("star",LP);const FP=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],jP=Ge("store",FP);const UP=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],BP=Ge("trash-2",UP);const zP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],$P=Ge("user",zP);const qP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ls=Ge("x",qP);const WP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],VT=Ge("zap",WP),HP=()=>{};var GE={};const OT=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},GP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],u=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},LT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,u=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,g=a>>2,w=(a&3)<<4|u>>4;let T=(u&15)<<2|p>>6,D=p&63;f||(D=64,l||(T=64)),r.push(t[g],t[w],t[T],t[D])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(OT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):GP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],u=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const w=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||u==null||p==null||w==null)throw new KP;const T=a<<2|u>>4;if(r.push(T),p!==64){const D=u<<4&240|p>>2;if(r.push(D),w!==64){const S=p<<6&192|w;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class KP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QP=function(n){const e=OT(n);return LT.encodeByteArray(e,!0)},vf=function(n){return QP(n).replace(/\./g,"")},Dy=function(n){try{return LT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function wf(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!JP(t)||(n[t]=wf(n[t],e[t]));return n}function JP(n){return n!=="__proto__"}function Vy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const YP=()=>Vy().__FIREBASE_DEFAULTS__,XP=()=>{if(typeof process>"u"||typeof GE>"u")return;const n=GE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ZP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Dy(n[1]);return e&&JSON.parse(e)},Oy=()=>{try{return HP()||YP()||XP()||ZP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ly=()=>Oy()?.config,ek=n=>Oy()?.[`_${n}`];class tk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Yi(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function My(n){return(await fetch(n,{credentials:"include"})).ok}function nk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[vf(JSON.stringify(t)),vf(JSON.stringify(l)),""].join(".")}const _u={};function rk(){const n={prod:[],emulator:[]};for(const e of Object.keys(_u))_u[e]?n.emulator.push(e):n.prod.push(e);return n}function sk(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let KE=!1;function Fy(n,e){if(typeof window>"u"||typeof document>"u"||!Yi(window.location.host)||_u[n]===e||_u[n]||KE)return;_u[n]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",a=rk().prod.length>0;function l(){const T=document.getElementById(r);T&&T.remove()}function u(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,D){T.setAttribute("width","24"),T.setAttribute("id",D),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{KE=!0,l()},T}function g(T,D){T.setAttribute("id",D),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function w(){const T=sk(r),D=t("text"),S=document.getElementById(D)||document.createElement("span"),O=t("learnmore"),L=document.getElementById(O)||document.createElement("a"),se=t("preprendIcon"),oe=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Z=T.element;u(Z),g(L,O);const ge=p();f(oe,se),Z.append(oe,S,L,ge),document.body.appendChild(Z)}a?(S.innerText="Preview backend disconnected.",oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",D)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ik(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function Qf(){const n=Oy()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ok(){return typeof window<"u"||MT()}function MT(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ak(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jT(){const n=xt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function UT(){return!Qf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function BT(){return!Qf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Vu(){try{return typeof indexedDB=="object"}catch{return!1}}function lk(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const ck="FirebaseError";class rn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=ck,Object.setPrototypeOf(this,rn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,da.prototype.create)}}class da{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?uk(a,r):"Error",u=`${this.serviceName}: ${l} (${s}).`;return new rn(s,u,r)}}function uk(n,e){return n.replace(dk,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const dk=/\{\$([^}]+)}/g;function QE(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function hk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ui(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(JE(a)&&JE(l)){if(!Ui(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function JE(n){return n!==null&&typeof n=="object"}function Kl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ml(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function uu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function zT(n,e){const t=new fk(n,e);return t.subscribe.bind(t)}class fk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");pk(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=pg),s.error===void 0&&(s.error=pg),s.complete===void 0&&(s.complete=pg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pk(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function pg(){}function Se(n){return n&&n._delegate?n._delegate:n}class _r{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Vo="[DEFAULT]";class mk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new tk;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yk(e))try{this.getOrInitializeService({instanceIdentifier:Vo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Vo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vo){return this.instances.has(e)}getOptions(e=Vo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);r===u&&l.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gk(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vo){return this.component?this.component.multipleInstances?e:Vo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gk(n){return n===Vo?void 0:n}function yk(n){return n.instantiationMode==="EAGER"}class $T{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new mk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Uy=[];var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const qT={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},_k=Be.INFO,vk={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},wk=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=vk[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Jf{constructor(e){this.name=e,this._logLevel=_k,this._logHandler=wk,this._userLogHandler=null,Uy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}function Ek(n){Uy.forEach(e=>{e.setLogLevel(n)})}function Ik(n,e){for(const t of Uy){let r=null;e&&e.level&&(r=qT[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,a,...l)=>{const u=l.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");a>=(r??s.logLevel)&&n({level:Be[a].toLowerCase(),message:u,args:l,type:s.name})}}}const Tk=(n,e)=>e.some(t=>n instanceof t);let YE,XE;function xk(){return YE||(YE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Sk(){return XE||(XE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const WT=new WeakMap,jg=new WeakMap,HT=new WeakMap,mg=new WeakMap,By=new WeakMap;function Ak(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Oi(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&WT.set(t,n)}).catch(()=>{}),By.set(e,n),e}function bk(n){if(jg.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});jg.set(n,e)}let Ug={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||HT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Oi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Rk(n){Ug=n(Ug)}function Pk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(gg(this),e,...t);return HT.set(r,e.sort?e.sort():[e]),Oi(r)}:Sk().includes(n)?function(...e){return n.apply(gg(this),e),Oi(WT.get(this))}:function(...e){return Oi(n.apply(gg(this),e))}}function kk(n){return typeof n=="function"?Pk(n):(n instanceof IDBTransaction&&bk(n),Tk(n,xk())?new Proxy(n,Ug):n)}function Oi(n){if(n instanceof IDBRequest)return Ak(n);if(mg.has(n))return mg.get(n);const e=kk(n);return e!==n&&(mg.set(n,e),By.set(e,n)),e}const gg=n=>By.get(n);function Ck(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),u=Oi(l);return r&&l.addEventListener("upgradeneeded",f=>{r(Oi(l.result),f.oldVersion,f.newVersion,Oi(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const Nk=["get","getKey","getAll","getAllKeys","count"],Dk=["put","add","delete","clear"],yg=new Map;function ZE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(yg.get(e))return yg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Dk.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Nk.includes(t)))return;const a=async function(l,...u){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(u.shift())),(await Promise.all([p[t](...u),s&&f.done]))[0]};return yg.set(e,a),a}Rk(n=>({...n,get:(e,t,r)=>ZE(e,t)||n.get(e,t,r),has:(e,t)=>!!ZE(e,t)||n.has(e,t)}));class Vk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Ok(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Ok(n){return n.getComponent()?.type==="VERSION"}const Ef="@firebase/app",Bg="0.14.6";const js=new Jf("@firebase/app"),Lk="@firebase/app-compat",Mk="@firebase/analytics-compat",Fk="@firebase/analytics",jk="@firebase/app-check-compat",Uk="@firebase/app-check",Bk="@firebase/auth",zk="@firebase/auth-compat",$k="@firebase/database",qk="@firebase/data-connect",Wk="@firebase/database-compat",Hk="@firebase/functions",Gk="@firebase/functions-compat",Kk="@firebase/installations",Qk="@firebase/installations-compat",Jk="@firebase/messaging",Yk="@firebase/messaging-compat",Xk="@firebase/performance",Zk="@firebase/performance-compat",eC="@firebase/remote-config",tC="@firebase/remote-config-compat",nC="@firebase/storage",rC="@firebase/storage-compat",sC="@firebase/firestore",iC="@firebase/ai",oC="@firebase/firestore-compat",aC="firebase",lC="12.6.0";const Bi="[DEFAULT]",cC={[Ef]:"fire-core",[Lk]:"fire-core-compat",[Fk]:"fire-analytics",[Mk]:"fire-analytics-compat",[Uk]:"fire-app-check",[jk]:"fire-app-check-compat",[Bk]:"fire-auth",[zk]:"fire-auth-compat",[$k]:"fire-rtdb",[qk]:"fire-data-connect",[Wk]:"fire-rtdb-compat",[Hk]:"fire-fn",[Gk]:"fire-fn-compat",[Kk]:"fire-iid",[Qk]:"fire-iid-compat",[Jk]:"fire-fcm",[Yk]:"fire-fcm-compat",[Xk]:"fire-perf",[Zk]:"fire-perf-compat",[eC]:"fire-rc",[tC]:"fire-rc-compat",[nC]:"fire-gcs",[rC]:"fire-gcs-compat",[sC]:"fire-fst",[oC]:"fire-fst-compat",[iC]:"fire-vertex","fire-js":"fire-js",[aC]:"fire-js-all"};const zi=new Map,Tl=new Map,xl=new Map;function Ou(n,e){try{n.container.addComponent(e)}catch(t){js.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function GT(n,e){n.container.addOrOverwriteComponent(e)}function Us(n){const e=n.name;if(xl.has(e))return js.debug(`There were multiple attempts to register component ${e}.`),!1;xl.set(e,n);for(const t of zi.values())Ou(t,n);for(const t of Tl.values())Ou(t,n);return!0}function KT(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function uC(n,e,t=Bi){KT(n,e).clearInstance(t)}function zy(n){return n.options!==void 0}function QT(n){return zy(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function mt(n){return n==null?!1:n.settings!==void 0}function dC(){xl.clear()}const hC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ir=new da("app","Firebase",hC);let JT=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ir.create("app-deleted",{appName:this._name})}};function eI(n,e){const t=Dy(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,a=new Date().getTime();s-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class fC extends JT{constructor(e,t,r,s){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:r,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,s);else{const u=e;super(u.options,l,s)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&eI(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&eI(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,or(Ef,Bg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){qy(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ir.create("server-app-deleted")}}const Xi=lC;function $y(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Bi,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ir.create("bad-app-name",{appName:String(s)});if(t||(t=Ly()),!t)throw ir.create("no-options");const a=zi.get(s);if(a){if(Ui(t,a.options)&&Ui(r,a.config))return a;throw ir.create("duplicate-app",{appName:s})}const l=new $T(s);for(const f of xl.values())l.addComponent(f);const u=new JT(t,r,l);return zi.set(s,u),u}function pC(n,e={}){if(ok()&&!MT())throw ir.create("invalid-server-app-environment");let t,r=e||{};if(n&&(zy(n)?t=n.options:QT(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=Ly()),!t)throw ir.create("no-options");const s={...r,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const a=g=>[...g].reduce((w,T)=>Math.imul(31,w)+T.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ir.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(s)),u=Tl.get(l);if(u)return u.incRefCount(r.releaseOnDeref),u;const f=new $T(l);for(const g of xl.values())f.addComponent(g);const p=new fC(t,r,l,f);return Tl.set(l,p),p}function mC(n=Bi){const e=zi.get(n);if(!e&&n===Bi&&Ly())return $y();if(!e)throw ir.create("no-app",{appName:n});return e}function gC(){return Array.from(zi.values())}async function qy(n){let e=!1;const t=n.name;zi.has(t)?(e=!0,zi.delete(t)):Tl.has(t)&&n.decRefCount()<=0&&(Tl.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function or(n,e,t){let r=cC[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),js.warn(l.join(" "));return}Us(new _r(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function YT(n,e){if(n!==null&&typeof n!="function")throw ir.create("invalid-log-argument");Ik(n,e)}function XT(n){Ek(n)}const yC="firebase-heartbeat-database",_C=1,Lu="firebase-heartbeat-store";let _g=null;function ZT(){return _g||(_g=Ck(yC,_C,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ir.create("idb-open",{originalErrorMessage:n.message})})),_g}async function vC(n){try{const t=(await ZT()).transaction(Lu),r=await t.objectStore(Lu).get(e1(n));return await t.done,r}catch(e){if(e instanceof rn)js.warn(e.message);else{const t=ir.create("idb-get",{originalErrorMessage:e?.message});js.warn(t.message)}}}async function tI(n,e){try{const r=(await ZT()).transaction(Lu,"readwrite");await r.objectStore(Lu).put(e,e1(n)),await r.done}catch(t){if(t instanceof rn)js.warn(t.message);else{const r=ir.create("idb-set",{originalErrorMessage:t?.message});js.warn(r.message)}}}function e1(n){return`${n.name}!${n.options.appId}`}const wC=1024,EC=30;class IC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=nI();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>EC){const s=SC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){js.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nI(),{heartbeatsToSend:t,unsentEntries:r}=TC(this._heartbeatsCache.heartbeats),s=vf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return js.warn(e),""}}}function nI(){return new Date().toISOString().substring(0,10)}function TC(n,e=wC){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),rI(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),rI(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class xC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vu()?lk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function rI(n){return vf(JSON.stringify({version:2,heartbeats:n})).length}function SC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function AC(n){Us(new _r("platform-logger",e=>new Vk(e),"PRIVATE")),Us(new _r("heartbeat",e=>new IC(e),"PRIVATE")),or(Ef,Bg,n),or(Ef,Bg,"esm2020"),or("fire-js","")}AC("");const bC=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:rn,SDK_VERSION:Xi,_DEFAULT_ENTRY_NAME:Bi,_addComponent:Ou,_addOrOverwriteComponent:GT,_apps:zi,_clearComponents:dC,_components:xl,_getProvider:KT,_isFirebaseApp:zy,_isFirebaseServerApp:mt,_isFirebaseServerAppSettings:QT,_registerComponent:Us,_removeServiceInstance:uC,_serverApps:Tl,deleteApp:qy,getApp:mC,getApps:gC,initializeApp:$y,initializeServerApp:pC,onLog:YT,registerVersion:or,setLogLevel:XT},Symbol.toStringTag,{value:"Module"}));class RC{constructor(e,t){this._delegate=e,this.firebase=t,Ou(e,new _r("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),qy(this._delegate)))}_getService(e,t=Bi){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Bi){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ou(this._delegate,e)}_addOrOverwriteComponent(e){GT(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const PC={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},sI=new da("app-compat","Firebase",PC);function kC(n){const e={},t={__esModule:!0,initializeApp:a,app:s,registerVersion:or,setLogLevel:XT,onLog:YT,apps:null,SDK_VERSION:Xi,INTERNAL:{registerComponent:u,removeApp:r,useAsService:f,modularAPIs:bC}};t.default=t,Object.defineProperty(t,"apps",{get:l});function r(p){delete e[p]}function s(p){if(p=p||Bi,!QE(e,p))throw sI.create("no-app",{appName:p});return e[p]}s.App=n;function a(p,g={}){const w=$y(p,g);if(QE(e,w.name))return e[w.name];const T=new n(w,t);return e[w.name]=T,T}function l(){return Object.keys(e).map(p=>e[p])}function u(p){const g=p.name,w=g.replace("-compat","");if(Us(p)&&p.type==="PUBLIC"){const T=(D=s())=>{if(typeof D[w]!="function")throw sI.create("invalid-app-argument",{appName:g});return D[w]()};p.serviceProps!==void 0&&wf(T,p.serviceProps),t[w]=T,n.prototype[w]=function(...D){return this._getService.bind(this,g).apply(this,p.multipleInstances?D:[])}}return p.type==="PUBLIC"?t[w]:null}function f(p,g){return g==="serverAuth"?null:g}return t}function t1(){const n=kC(RC);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:t1,extendNamespace:e,createSubscribe:zT,ErrorFactory:da,deepExtend:wf};function e(t){wf(n,t)}return n}const CC=t1();const iI=new Jf("@firebase/app-compat"),NC="@firebase/app-compat",DC="0.5.6";function VC(n){or(NC,DC,n)}try{const n=Vy();if(n.firebase!==void 0){iI.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&iI.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const hn=CC;VC();var OC="firebase",LC="12.7.0";hn.registerVersion(OC,LC,"app-compat");const eu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},rl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function MC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function n1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FC=MC,jC=n1,r1=new da("auth","Firebase",n1());const If=new Jf("@firebase/auth");function UC(n,...e){If.logLevel<=Be.WARN&&If.warn(`Auth (${Xi}): ${n}`,...e)}function ef(n,...e){If.logLevel<=Be.ERROR&&If.error(`Auth (${Xi}): ${n}`,...e)}function pn(n,...e){throw Hy(n,...e)}function Gt(n,...e){return Hy(n,...e)}function Wy(n,e,t){const r={...jC(),[e]:t};return new da("auth","Firebase",r).create(e,{appName:n.name})}function sn(n){return Wy(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ql(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&pn(n,"argument-error"),Wy(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return r1.create(n,...e)}function ee(n,e,...t){if(!n)throw Hy(e,...t)}function cs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ef(e),new Error(e)}function Dr(n,e){n||cs(e)}function Mu(){return typeof self<"u"&&self.location?.href||""}function Gy(){return oI()==="http:"||oI()==="https:"}function oI(){return typeof self<"u"&&self.location?.protocol||null}function BC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gy()||FT()||"connection"in navigator)?navigator.onLine:!0}function zC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class rd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Dr(t>e,"Short delay should be less than long delay!"),this.isMobile=ik()||jy()}get(){return BC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ky(n,e){Dr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class s1{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $C={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const qC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WC=new rd(3e4,6e4);function kt(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ct(n,e,t,r,s={}){return i1(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const u=Kl({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return ak()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Yi(n.emulatorConfig.host)&&(p.credentials="include"),s1.fetch()(await o1(n,n.config.apiHost,t,u),p)})}async function i1(n,e,t){n._canInitEmulator=!1;const r={...$C,...e};try{const s=new GC(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw du(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const u=a.ok?l.errorMessage:l.error.message,[f,p]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw du(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw du(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw du(n,"user-disabled",l);const g=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Wy(n,g,p);pn(n,g)}}catch(s){if(s instanceof rn)throw s;pn(n,"network-request-failed",{message:String(s)})}}async function qs(n,e,t,r,s={}){const a=await Ct(n,e,t,r,s);return"mfaPendingCredential"in a&&pn(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function o1(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?Ky(n.config,s):`${n.config.apiScheme}://${s}`;return qC.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function HC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Gt(this.auth,"network-request-failed")),WC.get())})}}function du(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Gt(n,e,r);return s.customData._tokenResponse=t,s}function aI(n){return n!==void 0&&n.getResponse!==void 0}function lI(n){return n!==void 0&&n.enterprise!==void 0}class a1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return HC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KC(n){return(await Ct(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function l1(n,e){return Ct(n,"GET","/v2/recaptchaConfig",kt(n,e))}async function QC(n,e){return Ct(n,"POST","/v1/accounts:delete",e)}async function JC(n,e){return Ct(n,"POST","/v1/accounts:update",e)}async function Tf(n,e){return Ct(n,"POST","/v1/accounts:lookup",e)}function vu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YC(n,e=!1){const t=Se(n),r=await t.getIdToken(e),s=Yf(r);ee(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a?.sign_in_provider;return{claims:s,token:r,authTime:vu(vg(s.auth_time)),issuedAtTime:vu(vg(s.iat)),expirationTime:vu(vg(s.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function vg(n){return Number(n)*1e3}function Yf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ef("JWT malformed, contained fewer than 3 sections"),null;try{const s=Dy(t);return s?JSON.parse(s):(ef("Failed to decode base64 JWT payload"),null)}catch(s){return ef("Caught error parsing JWT payload as JSON",s?.toString()),null}}function cI(n){const e=Yf(n);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Bs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof rn&&XC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function XC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class ZC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class zg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vu(this.lastLoginAt),this.creationTime=vu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Fu(n){const e=n.auth,t=await n.getIdToken(),r=await Bs(n,Tf(e,{idToken:t}));ee(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const a=s.providerUserInfo?.length?c1(s.providerUserInfo):[],l=tN(n.providerData,a),u=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!l?.length,p=u?f:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new zg(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function eN(n){const e=Se(n);await Fu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function c1(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function nN(n,e){const t=await i1(n,{},async()=>{const r=Kl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await o1(n,s,"/v1/token",`key=${a}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:r};return n.emulatorConfig&&Yi(n.emulatorConfig.host)&&(f.credentials="include"),s1.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rN(n,e){return Ct(n,"POST","/v2/accounts:revokeToken",kt(n,e))}class yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const t=cI(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await nN(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new yl;return r&&(ee(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(ee(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yl,this.toJSON())}_performRefresh(){return cs("not implemented")}}function Si(n,e){ee(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class kr{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ZC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new zg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Bs(this,this.stsTokenManager.getToken(this.auth,e));return ee(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return YC(this,e)}reload(){return eN(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Fu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mt(this.auth.app))return Promise.reject(sn(this.auth));const e=await this.getIdToken();return await Bs(this,QC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:w,emailVerified:T,isAnonymous:D,providerData:S,stsTokenManager:O}=t;ee(w&&O,e,"internal-error");const L=yl.fromJSON(this.name,O);ee(typeof w=="string",e,"internal-error"),Si(r,e.name),Si(s,e.name),ee(typeof T=="boolean",e,"internal-error"),ee(typeof D=="boolean",e,"internal-error"),Si(a,e.name),Si(l,e.name),Si(u,e.name),Si(f,e.name),Si(p,e.name),Si(g,e.name);const se=new kr({uid:w,auth:e,email:s,emailVerified:T,displayName:r,isAnonymous:D,photoURL:l,phoneNumber:a,tenantId:u,stsTokenManager:L,createdAt:p,lastLoginAt:g});return S&&Array.isArray(S)&&(se.providerData=S.map(oe=>({...oe}))),f&&(se._redirectEventId=f),se}static async _fromIdTokenResponse(e,t,r=!1){const s=new yl;s.updateFromServerResponse(t);const a=new kr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Fu(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ee(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?c1(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!a?.length,u=new yl;u.updateFromIdToken(r);const f=new kr({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new zg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(f,p),f}}const uI=new Map;function sr(n){Dr(n instanceof Function,"Expected a class definition");let e=uI.get(n);return e?(Dr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uI.set(n,e),e)}class u1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}u1.type="NONE";const Sl=u1;function Go(n,e,t){return`firebase:${n}:${e}:${t}`}class _l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Go(this.userKey,s.apiKey,a),this.fullPersistenceKey=Go("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Tf(this.auth,{idToken:e}).catch(()=>{});return t?kr._fromGetAccountInfoResponse(this.auth,t,e):null}return kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _l(sr(Sl),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||sr(Sl);const l=Go(r,e.config.apiKey,e.name);let u=null;for(const p of t)try{const g=await p._get(l);if(g){let w;if(typeof g=="string"){const T=await Tf(e,{idToken:g}).catch(()=>{});if(!T)break;w=await kr._fromGetAccountInfoResponse(e,T,g)}else w=kr._fromJSON(e,g);p!==a&&(u=w),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new _l(a,e,r):(a=f[0],u&&await a._set(l,u.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new _l(a,e,r))}}function dI(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(p1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m1(e))return"Blackberry";if(g1(e))return"Webos";if(h1(e))return"Safari";if((e.includes("chrome/")||f1(e))&&!e.includes("edge/"))return"Chrome";if(sd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function d1(n=xt()){return/firefox\//i.test(n)}function h1(n=xt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f1(n=xt()){return/crios\//i.test(n)}function p1(n=xt()){return/iemobile/i.test(n)}function sd(n=xt()){return/android/i.test(n)}function m1(n=xt()){return/blackberry/i.test(n)}function g1(n=xt()){return/webos/i.test(n)}function id(n=xt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function sN(n=xt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function iN(n=xt()){return id(n)&&!!window.navigator?.standalone}function oN(){return jT()&&document.documentMode===10}function y1(n=xt()){return id(n)||sd(n)||g1(n)||m1(n)||/windows phone/i.test(n)||p1(n)}function _1(n,e=[]){let t;switch(n){case"Browser":t=dI(xt());break;case"Worker":t=`${dI(xt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xi}/${r}`}class aN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,u)=>{try{const f=e(a);l(f)}catch(f){u(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function lN(n,e={}){return Ct(n,"GET","/v2/passwordPolicy",kt(n,e))}const cN=6;class uN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??cN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class dN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hI(this),this.idTokenSubscription=new hI(this),this.beforeStateQueue=new aN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=sr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Tf(this,{idToken:e}),r=await kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(mt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=r?._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&u?.user&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fu(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mt(this.app))return Promise.reject(sn(this));const t=e?Se(e):null;return t&&ee(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mt(this.app)?Promise.reject(sn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mt(this.app)?Promise.reject(sn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lN(this),t=new uN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new da("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await rN(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&sr(e)||this._popupRedirectResolver;ee(t,this,"argument-error"),this.redirectPersistenceManager=await _l.create(this,[sr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(u,this,"internal-error"),u.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(mt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&UC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function St(n){return Se(n)}class hI{constructor(e){this.auth=e,this.observer=null,this.addObserver=zT(t=>this.observer=t)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let od={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hN(n){od=n}function Qy(n){return od.loadJS(n)}function fN(){return od.recaptchaV2Script}function pN(){return od.recaptchaEnterpriseScript}function mN(){return od.gapiScript}function v1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const gN=500,yN=6e4,Wh=1e12;class _N{constructor(e){this.auth=e,this.counter=Wh,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new EN(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||Wh;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Wh;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Wh;return this._widgets.get(t)?.execute(),""}}class vN{constructor(){this.enterprise=new wN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class wN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class EN{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ee(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=IN(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},yN)},gN))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function IN(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const TN="recaptcha-enterprise",wu="NO_RECAPTCHA";class w1{constructor(e){this.type=TN,this.auth=St(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,u)=>{l1(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const p=new a1(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,l(p.siteKey)}}).catch(f=>{u(f)})})}function s(a,l,u){const f=window.grecaptcha;lI(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{l(p)}).catch(()=>{l(wu)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new vN().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{r(this.auth).then(u=>{if(!t&&lI(window.grecaptcha))s(u,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=pN();f.length!==0&&(f+=u),Qy(f).then(()=>{s(u,a,l)}).catch(p=>{l(p)})}}).catch(u=>{l(u)})})}}async function tu(n,e,t,r=!1,s=!1){const a=new w1(n);let l;if(s)l=wu;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const f=u.phoneEnrollmentInfo.phoneNumber,p=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const f=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Li(n,e,t,r,s){if(s==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await tu(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await tu(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)});else if(s==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const a=await tu(n,e,t);return r(n,a).catch(async l=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const u=await tu(n,e,t,!1,!0);return r(n,u)}return Promise.reject(l)})}else{const a=await tu(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(s+" provider is not supported.")}async function xN(n){const e=St(n),t=await l1(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new a1(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new w1(e).verify()}function SN(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(sr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function AN(n,e,t){const r=St(n);ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!t?.disableWarnings,a=E1(e),{host:l,port:u}=bN(e),f=u===null?"":`:${u}`,p={url:`${a}//${l}${f}/`},g=Object.freeze({host:l,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ee(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ee(Ui(p,r.config.emulator)&&Ui(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,Yi(l)?(My(`${a}//${l}${f}`),Fy("Auth",!0)):s||RN()}function E1(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function bN(n){const e=E1(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:fI(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:fI(l)}}}function fI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function RN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Jl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return cs("not implemented")}_getIdTokenResponse(e){return cs("not implemented")}_linkToIdToken(e,t){return cs("not implemented")}_getReauthenticationResolver(e){return cs("not implemented")}}async function I1(n,e){return Ct(n,"POST","/v1/accounts:resetPassword",kt(n,e))}async function PN(n,e){return Ct(n,"POST","/v1/accounts:update",e)}async function kN(n,e){return Ct(n,"POST","/v1/accounts:signUp",e)}async function CN(n,e){return Ct(n,"POST","/v1/accounts:update",kt(n,e))}async function NN(n,e){return qs(n,"POST","/v1/accounts:signInWithPassword",kt(n,e))}async function Xf(n,e){return Ct(n,"POST","/v1/accounts:sendOobCode",kt(n,e))}async function DN(n,e){return Xf(n,e)}async function VN(n,e){return Xf(n,e)}async function ON(n,e){return Xf(n,e)}async function LN(n,e){return Xf(n,e)}async function MN(n,e){return qs(n,"POST","/v1/accounts:signInWithEmailLink",kt(n,e))}async function FN(n,e){return qs(n,"POST","/v1/accounts:signInWithEmailLink",kt(n,e))}class ju extends Jl{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ju(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Li(e,t,"signInWithPassword",NN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return MN(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Li(e,r,"signUpPassword",kN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return FN(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Fs(n,e){return qs(n,"POST","/v1/accounts:signInWithIdp",kt(n,e))}const jN="http://localhost";class ms extends Jl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ms(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...a}=t;if(!r||!s)return null;const l=new ms(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Fs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Fs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fs(e,t)}buildRequest(){const e={requestUri:jN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Kl(t)}return e}}async function pI(n,e){return Ct(n,"POST","/v1/accounts:sendVerificationCode",kt(n,e))}async function UN(n,e){return qs(n,"POST","/v1/accounts:signInWithPhoneNumber",kt(n,e))}async function BN(n,e){const t=await qs(n,"POST","/v1/accounts:signInWithPhoneNumber",kt(n,e));if(t.temporaryProof)throw du(n,"account-exists-with-different-credential",t);return t}const zN={USER_NOT_FOUND:"user-not-found"};async function $N(n,e){const t={...e,operation:"REAUTH"};return qs(n,"POST","/v1/accounts:signInWithPhoneNumber",kt(n,t),zN)}class Ko extends Jl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ko({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ko({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return UN(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return BN(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return $N(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a}=e;return!r&&!t&&!s&&!a?null:new Ko({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a})}}function qN(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function WN(n){const e=ml(uu(n)).link,t=e?ml(uu(e)).deep_link_id:null,r=ml(uu(n)).deep_link_id;return(r?ml(uu(r)).link:null)||r||t||e||n}class Zf{constructor(e){const t=ml(uu(e)),r=t.apiKey??null,s=t.oobCode??null,a=qN(t.mode??null);ee(r&&s&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=WN(e);try{return new Zf(t)}catch{return null}}}class Zi{constructor(){this.providerId=Zi.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Zf.parseLink(t);return ee(r,"argument-error"),ju._fromEmailAndCode(e,r.code,r.tenantId)}}Zi.PROVIDER_ID="password";Zi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ws{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Yl extends Ws{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class vl extends Yl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ee("providerId"in t&&"signInMethod"in t,"argument-error"),ms._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return ee(e.idToken||e.accessToken,"argument-error"),ms._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return vl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return vl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:a,nonce:l,providerId:u}=e;if(!r&&!s&&!t&&!a||!u)return null;try{return new vl(u)._credential({idToken:t,accessToken:r,nonce:l,pendingToken:a})}catch{return null}}}class rs extends Yl{constructor(){super("facebook.com")}static credential(e){return ms._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rs.credential(e.oauthAccessToken)}catch{return null}}}rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";rs.PROVIDER_ID="facebook.com";class ss extends Yl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ms._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ss.credential(t,r)}catch{return null}}}ss.GOOGLE_SIGN_IN_METHOD="google.com";ss.PROVIDER_ID="google.com";class is extends Yl{constructor(){super("github.com")}static credential(e){return ms._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return is.credential(e.oauthAccessToken)}catch{return null}}}is.GITHUB_SIGN_IN_METHOD="github.com";is.PROVIDER_ID="github.com";const HN="http://localhost";class Al extends Jl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Fs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Fs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:a}=t;return!r||!s||!a||r!==s?null:new Al(r,a)}static _create(e,t){return new Al(e,t)}buildRequest(){return{requestUri:HN,returnSecureToken:!0,pendingToken:this.pendingToken}}}const GN="saml.";class xf extends Ws{constructor(e){ee(e.startsWith(GN),"argument-error"),super(e)}static credentialFromResult(e){return xf.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return xf.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Al.fromJSON(e);return ee(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Al._create(r,t)}catch{return null}}}class os extends Yl{constructor(){super("twitter.com")}static credential(e,t){return ms._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return os.credential(t,r)}catch{return null}}}os.TWITTER_SIGN_IN_METHOD="twitter.com";os.PROVIDER_ID="twitter.com";async function T1(n,e){return qs(n,"POST","/v1/accounts:signUp",kt(n,e))}class vr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await kr._fromIdTokenResponse(e,r,s),l=mI(r);return new vr({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=mI(r);return new vr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function mI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function KN(n){if(mt(n.app))return Promise.reject(sn(n));const e=St(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new vr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await T1(e,{returnSecureToken:!0}),r=await vr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Sf extends rn{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Sf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Sf(e,t,r,s)}}function x1(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Sf._fromErrorAndOperation(n,a,e,r):a})}function S1(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function QN(n,e){const t=Se(n);await ep(!0,t,e);const{providerUserInfo:r}=await JC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=S1(r||[]);return t.providerData=t.providerData.filter(a=>s.has(a.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Jy(n,e,t=!1){const r=await Bs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return vr._forOperation(n,"link",r)}async function ep(n,e,t){await Fu(e);const r=S1(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ee(r.has(t)===n,e.auth,s)}async function A1(n,e,t=!1){const{auth:r}=n;if(mt(r.app))return Promise.reject(sn(r));const s="reauthenticate";try{const a=await Bs(n,x1(r,s,e,n),t);ee(a.idToken,r,"internal-error");const l=Yf(a.idToken);ee(l,r,"internal-error");const{sub:u}=l;return ee(n.uid===u,r,"user-mismatch"),vr._forOperation(n,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&pn(r,"user-mismatch"),a}}async function b1(n,e,t=!1){if(mt(n.app))return Promise.reject(sn(n));const r="signIn",s=await x1(n,r,e),a=await vr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}async function tp(n,e){return b1(St(n),e)}async function R1(n,e){const t=Se(n);return await ep(!1,t,e.providerId),Jy(t,e)}async function P1(n,e){return A1(Se(n),e)}async function JN(n,e){return qs(n,"POST","/v1/accounts:signInWithCustomToken",kt(n,e))}async function YN(n,e){if(mt(n.app))return Promise.reject(sn(n));const t=St(n),r=await JN(t,{token:e,returnSecureToken:!0}),s=await vr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}class ad{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Yy._fromServerResponse(e,t):"totpInfo"in t?Xy._fromServerResponse(e,t):pn(e,"internal-error")}}class Yy extends ad{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Yy(t)}}class Xy extends ad{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Xy(t)}}function np(n,e,t){ee(t.url?.length>0,n,"invalid-continue-uri"),ee(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),ee(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ee(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ee(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Zy(n){const e=St(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function XN(n,e,t){const r=St(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&np(r,s,t),await Li(r,s,"getOobCode",VN,"EMAIL_PASSWORD_PROVIDER")}async function ZN(n,e,t){await I1(Se(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zy(n),r})}async function e2(n,e){await CN(Se(n),{oobCode:e})}async function k1(n,e){const t=Se(n),r=await I1(t,{oobCode:e}),s=r.requestType;switch(ee(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ee(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ee(r.mfaInfo,t,"internal-error");default:ee(r.email,t,"internal-error")}let a=null;return r.mfaInfo&&(a=ad._fromServerResponse(St(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:a},operation:s}}async function t2(n,e){const{data:t}=await k1(Se(n),e);return t.email}async function n2(n,e,t){if(mt(n.app))return Promise.reject(sn(n));const r=St(n),l=await Li(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",T1,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&Zy(n),f}),u=await vr._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(u.user),u}function r2(n,e,t){return mt(n.app)?Promise.reject(sn(n)):tp(Se(n),Zi.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zy(n),r})}async function s2(n,e,t){const r=St(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,u){ee(u.handleCodeInApp,r,"argument-error"),u&&np(r,l,u)}a(s,t),await Li(r,s,"getOobCode",ON,"EMAIL_PASSWORD_PROVIDER")}function i2(n,e){return Zf.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function o2(n,e,t){if(mt(n.app))return Promise.reject(sn(n));const r=Se(n),s=Zi.credentialWithLink(e,t||Mu());return ee(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),tp(r,s)}async function a2(n,e){return Ct(n,"POST","/v1/accounts:createAuthUri",kt(n,e))}async function l2(n,e){const t=Gy()?Mu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await a2(Se(n),r);return s||[]}async function c2(n,e){const t=Se(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&np(t.auth,s,e);const{email:a}=await DN(t.auth,s);a!==n.email&&await n.reload()}async function u2(n,e,t){const r=Se(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&np(r.auth,a,t);const{email:l}=await LN(r.auth,a);l!==n.email&&await n.reload()}async function d2(n,e){return Ct(n,"POST","/v1/accounts:update",e)}async function h2(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Se(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await Bs(r,d2(r.auth,a));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const u=r.providerData.find(({providerId:f})=>f==="password");u&&(u.displayName=r.displayName,u.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function f2(n,e){const t=Se(n);return mt(t.auth.app)?Promise.reject(sn(t.auth)):C1(t,e,null)}function p2(n,e){return C1(Se(n),null,e)}async function C1(n,e,t){const{auth:r}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await Bs(n,PN(r,a));await n._updateTokensIfNecessary(l,!0)}function m2(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const s=Yf(n.idToken)?.firebase?.sign_in_provider;if(s){const a=s!=="anonymous"&&s!=="custom"?s:null;return new wl(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new g2(r,t);case"github.com":return new y2(r,t);case"google.com":return new _2(r,t);case"twitter.com":return new v2(r,t,n.screenName||null);case"custom":case"anonymous":return new wl(r,null);default:return new wl(r,e,t)}}class wl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class N1 extends wl{constructor(e,t,r,s){super(e,t,r),this.username=s}}class g2 extends wl{constructor(e,t){super(e,"facebook.com",t)}}class y2 extends N1{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class _2 extends wl{constructor(e,t){super(e,"google.com",t)}}class v2 extends N1{constructor(e,t,r){super(e,"twitter.com",t,r)}}function w2(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:m2(t)}class zo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new zo("enroll",e,t)}static _fromMfaPendingCredential(e){return new zo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return zo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return zo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class e_{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=St(e),s=t.customData._serverResponse,a=(s.mfaInfo||[]).map(u=>ad._fromServerResponse(r,u));ee(s.mfaPendingCredential,r,"internal-error");const l=zo._fromMfaPendingCredential(s.mfaPendingCredential);return new e_(l,a,async u=>{const f=await u._process(r,l);delete s.mfaInfo,delete s.mfaPendingCredential;const p={...s,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const g=await vr._fromIdTokenResponse(r,t.operationType,p);return await r._updateCurrentUser(g.user),g;case"reauthenticate":return ee(t.user,r,"internal-error"),vr._forOperation(t.user,t.operationType,p);default:pn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function E2(n,e){const t=Se(n),r=e;return ee(e.customData.operationType,t,"argument-error"),ee(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),e_._fromError(t,r)}function gI(n,e){return Ct(n,"POST","/v2/accounts/mfaEnrollment:start",kt(n,e))}function I2(n,e){return Ct(n,"POST","/v2/accounts/mfaEnrollment:finalize",kt(n,e))}function T2(n,e){return Ct(n,"POST","/v2/accounts/mfaEnrollment:withdraw",kt(n,e))}class t_{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>ad._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new t_(e)}async getSession(){return zo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),a=await Bs(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Bs(this.user,T2(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const wg=new WeakMap;function x2(n){const e=Se(n);return wg.has(e)||wg.set(e,t_._fromUser(e)),wg.get(e)}const Af="__sak";class D1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Af,"1"),this.storage.removeItem(Af),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const S2=1e3,A2=10;class V1 extends D1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=y1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);oN()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,A2):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},S2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}V1.type="LOCAL";const n_=V1;class O1 extends D1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}O1.type="SESSION";const Xo=O1;function b2(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new rp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const u=Array.from(l).map(async p=>p(t.origin,a)),f=await b2(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rp.receivers=[];function ld(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class R2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((u,f)=>{const p=ld("",20);s.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(w){const T=w;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),u(T.data.response);break;default:clearTimeout(g),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function $t(){return window}function P2(n){$t().location.href=n}function r_(){return typeof $t().WorkerGlobalScope<"u"&&typeof $t().importScripts=="function"}async function k2(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function C2(){return navigator?.serviceWorker?.controller||null}function N2(){return r_()?self:null}const L1="firebaseLocalStorageDb",D2=1,bf="firebaseLocalStorage",M1="fbase_key";class cd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sp(n,e){return n.transaction([bf],e?"readwrite":"readonly").objectStore(bf)}function V2(){const n=indexedDB.deleteDatabase(L1);return new cd(n).toPromise()}function $g(){const n=indexedDB.open(L1,D2);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(bf,{keyPath:M1})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(bf)?e(r):(r.close(),await V2(),e(await $g()))})})}async function yI(n,e,t){const r=sp(n,!0).put({[M1]:e,value:t});return new cd(r).toPromise()}async function O2(n,e){const t=sp(n,!1).get(e),r=await new cd(t).toPromise();return r===void 0?null:r.value}function _I(n,e){const t=sp(n,!0).delete(e);return new cd(t).toPromise()}const L2=800,M2=3;class F1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $g(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>M2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return r_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rp._getInstance(N2()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await k2(),!this.activeServiceWorker)return;this.sender=new R2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||C2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $g();return await yI(e,Af,"1"),await _I(e,Af),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>yI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>O2(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_I(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=sp(s,!1).getAll();return new cd(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),L2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}F1.type="LOCAL";const Uu=F1;function vI(n,e){return Ct(n,"POST","/v2/accounts/mfaSignIn:start",kt(n,e))}function F2(n,e){return Ct(n,"POST","/v2/accounts/mfaSignIn:finalize",kt(n,e))}const Eg=v1("rcb"),j2=new rd(3e4,6e4);class U2{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!$t().grecaptcha?.render}load(e,t=""){return ee(B2(t),e,"argument-error"),this.shouldResolveImmediately(t)&&aI($t().grecaptcha)?Promise.resolve($t().grecaptcha):new Promise((r,s)=>{const a=$t().setTimeout(()=>{s(Gt(e,"network-request-failed"))},j2.get());$t()[Eg]=()=>{$t().clearTimeout(a),delete $t()[Eg];const u=$t().grecaptcha;if(!u||!aI(u)){s(Gt(e,"internal-error"));return}const f=u.render;u.render=(p,g)=>{const w=f(p,g);return this.counter++,w},this.hostLanguage=t,r(u)};const l=`${fN()}?${Kl({onload:Eg,render:"explicit",hl:t})}`;Qy(l).catch(()=>{clearTimeout(a),s(Gt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!$t().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function B2(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class z2{async load(e){return new _N(e)}clearedOneInstance(){}}const Eu="recaptcha",$2={theme:"light",type:"image"};let q2=class{constructor(e,t,r={...$2}){this.parameters=r,this.type=Eu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=St(e),this.isInvisible=this.parameters.size==="invisible",ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ee(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new z2:new U2,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),s(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ee(!this.parameters.sitekey,this.auth,"argument-error"),ee(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=$t()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ee(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ee(Gy()&&!r_(),this.auth,"internal-error"),await W2(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await KC(this.auth);ee(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ee(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function W2(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class s_{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ko._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function H2(n,e,t){if(mt(n.app))return Promise.reject(sn(n));const r=St(n),s=await ip(r,e,Se(t));return new s_(s,a=>tp(r,a))}async function G2(n,e,t){const r=Se(n);await ep(!1,r,"phone");const s=await ip(r.auth,e,Se(t));return new s_(s,a=>R1(r,a))}async function K2(n,e,t){const r=Se(n);if(mt(r.auth.app))return Promise.reject(sn(r.auth));const s=await ip(r.auth,e,Se(t));return new s_(s,a=>P1(r,a))}async function ip(n,e,t){if(!n._getRecaptchaConfig())try{await xN(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const s=r.session;if("phoneNumber"in r){ee(s.type==="enroll",n,"internal-error");const a={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Li(n,a,"mfaSmsEnrollment",async(p,g)=>{if(g.phoneEnrollmentInfo.captchaResponse===wu){ee(t?.type===Eu,p,"argument-error");const w=await Ig(p,g,t);return gI(p,w)}return gI(p,g)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{ee(s.type==="signin",n,"internal-error");const a=r.multiFactorHint?.uid||r.multiFactorUid;ee(a,n,"missing-multi-factor-info");const l={mfaPendingCredential:s.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Li(n,l,"mfaSmsSignIn",async(g,w)=>{if(w.phoneSignInInfo.captchaResponse===wu){ee(t?.type===Eu,g,"argument-error");const T=await Ig(g,w,t);return vI(g,T)}return vI(g,w)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Li(n,s,"sendVerificationCode",async(f,p)=>{if(p.captchaResponse===wu){ee(t?.type===Eu,f,"argument-error");const g=await Ig(f,p,t);return pI(f,g)}return pI(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function Q2(n,e){const t=Se(n);if(mt(t.auth.app))return Promise.reject(sn(t.auth));await Jy(t,e)}async function Ig(n,e,t){ee(t.type===Eu,n,"argument-error");const r=await t.verify();ee(typeof r=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const a=s.phoneEnrollmentInfo.phoneNumber,l=s.phoneEnrollmentInfo.captchaResponse,u=s.phoneEnrollmentInfo.clientType,f=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r,captchaResponse:l,clientType:u,recaptchaVersion:f}}),s}else if("phoneSignInInfo"in s){const a=s.phoneSignInInfo.captchaResponse,l=s.phoneSignInInfo.clientType,u=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:a,clientType:l,recaptchaVersion:u}}),s}else return Object.assign(s,{recaptchaToken:r}),s}let Zo=class tf{constructor(e){this.providerId=tf.PROVIDER_ID,this.auth=St(e)}verifyPhoneNumber(e,t){return ip(this.auth,e,Se(t))}static credential(e,t){return Ko._fromVerification(e,t)}static credentialFromResult(e){const t=e;return tf.credentialFromTaggedObject(t)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Ko._fromTokenResponse(t,r):null}};Zo.PROVIDER_ID="phone";Zo.PHONE_SIGN_IN_METHOD="phone";function ha(n,e){return e?sr(e):(ee(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class i_ extends Jl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function J2(n){return b1(n.auth,new i_(n),n.bypassAuthState)}function Y2(n){const{auth:e,user:t}=n;return ee(t,e,"internal-error"),A1(t,new i_(n),n.bypassAuthState)}async function X2(n){const{auth:e,user:t}=n;return ee(t,e,"internal-error"),Jy(t,new i_(n),n.bypassAuthState)}class j1{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return J2;case"linkViaPopup":case"linkViaRedirect":return X2;case"reauthViaPopup":case"reauthViaRedirect":return Y2;default:pn(this.auth,"internal-error")}}resolve(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Z2=new rd(2e3,1e4);async function eD(n,e,t){if(mt(n.app))return Promise.reject(Gt(n,"operation-not-supported-in-this-environment"));const r=St(n);Ql(n,e,Ws);const s=ha(r,t);return new Ls(r,"signInViaPopup",e,s).executeNotNull()}async function tD(n,e,t){const r=Se(n);if(mt(r.auth.app))return Promise.reject(Gt(r.auth,"operation-not-supported-in-this-environment"));Ql(r.auth,e,Ws);const s=ha(r.auth,t);return new Ls(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function nD(n,e,t){const r=Se(n);Ql(r.auth,e,Ws);const s=ha(r.auth,t);return new Ls(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Ls extends j1{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Ls.currentPopupAction&&Ls.currentPopupAction.cancel(),Ls.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){Dr(this.filter.length===1,"Popup operations only handle one event");const e=ld();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Gt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Gt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ls.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Z2.get())};e()}}Ls.currentPopupAction=null;const rD="pendingRedirect",Iu=new Map;class sD extends j1{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Iu.get(this.auth._key());if(!e){try{const r=await iD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Iu.set(this.auth._key(),e)}return this.bypassAuthState||Iu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iD(n,e){const t=B1(e),r=U1(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function o_(n,e){return U1(n)._set(B1(e),"true")}function oD(){Iu.clear()}function a_(n,e){Iu.set(n._key(),e)}function U1(n){return sr(n._redirectPersistence)}function B1(n){return Go(rD,n.config.apiKey,n.name)}function aD(n,e,t){return lD(n,e,t)}async function lD(n,e,t){if(mt(n.app))return Promise.reject(sn(n));const r=St(n);Ql(n,e,Ws),await r._initializationPromise;const s=ha(r,t);return await o_(s,r),s._openRedirect(r,e,"signInViaRedirect")}function cD(n,e,t){return uD(n,e,t)}async function uD(n,e,t){const r=Se(n);if(Ql(r.auth,e,Ws),mt(r.auth.app))return Promise.reject(sn(r.auth));await r.auth._initializationPromise;const s=ha(r.auth,t);await o_(s,r.auth);const a=await z1(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",a)}function dD(n,e,t){return hD(n,e,t)}async function hD(n,e,t){const r=Se(n);Ql(r.auth,e,Ws),await r.auth._initializationPromise;const s=ha(r.auth,t);await ep(!1,r,e.providerId),await o_(s,r.auth);const a=await z1(r);return s._openRedirect(r.auth,e,"linkViaRedirect",a)}async function fD(n,e){return await St(n)._initializationPromise,op(n,e,!1)}async function op(n,e,t=!1){if(mt(n.app))return Promise.reject(sn(n));const r=St(n),s=ha(r,e),l=await new sD(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}async function z1(n){const e=ld(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const pD=600*1e3;class $1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!q1(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Gt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pD&&this.cachedEventUids.clear(),this.cachedEventUids.has(wI(e))}saveEventToCache(e){this.cachedEventUids.add(wI(e)),this.lastProcessedEventTime=Date.now()}}function wI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function q1({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function mD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return q1(n);default:return!1}}async function W1(n,e={}){return Ct(n,"GET","/v1/projects",e)}const gD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yD=/^https?/;async function _D(n){if(n.config.emulator)return;const{authorizedDomains:e}=await W1(n);for(const t of e)try{if(vD(t))return}catch{}pn(n,"unauthorized-domain")}function vD(n){const e=Mu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!yD.test(t))return!1;if(gD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const wD=new rd(3e4,6e4);function EI(){const n=$t().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ED(n){return new Promise((e,t)=>{function r(){EI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{EI(),t(Gt(n,"network-request-failed"))},timeout:wD.get()})}if($t().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if($t().gapi?.load)r();else{const s=v1("iframefcb");return $t()[s]=()=>{gapi.load?r():t(Gt(n,"network-request-failed"))},Qy(`${mN()}?onload=${s}`).catch(a=>t(a))}}).catch(e=>{throw nf=null,e})}let nf=null;function ID(n){return nf=nf||ED(n),nf}const TD=new rd(5e3,15e3),xD="__/auth/iframe",SD="emulator/auth/iframe",AD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RD(n){const e=n.config;ee(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ky(e,SD):`https://${n.config.authDomain}/${xD}`,r={apiKey:e.apiKey,appName:n.name,v:Xi},s=bD.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Kl(r).slice(1)}`}async function PD(n){const e=await ID(n),t=$t().gapi;return ee(t,n,"internal-error"),e.open({where:document.body,url:RD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:AD,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=Gt(n,"network-request-failed"),u=$t().setTimeout(()=>{a(l)},TD.get());function f(){$t().clearTimeout(u),s(r)}r.ping(f).then(f,()=>{a(l)})}))}const kD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CD=500,ND=600,DD="_blank",VD="http://localhost";class II{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OD(n,e,t,r=CD,s=ND){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const f={...kD,width:r.toString(),height:s.toString(),top:a,left:l},p=xt().toLowerCase();t&&(u=f1(p)?DD:t),d1(p)&&(e=e||VD,f.scrollbars="yes");const g=Object.entries(f).reduce((T,[D,S])=>`${T}${D}=${S},`,"");if(iN(p)&&u!=="_self")return LD(e||"",u),new II(null);const w=window.open(e||"",u,g);ee(w,n,"popup-blocked");try{w.focus()}catch{}return new II(w)}function LD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const MD="__/auth/handler",FD="emulator/auth/handler",jD=encodeURIComponent("fac");async function qg(n,e,t,r,s,a){ee(n.config.authDomain,n,"auth-domain-config-required"),ee(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Xi,eventId:s};if(e instanceof Ws){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",hk(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,w]of Object.entries(a||{}))l[g]=w}if(e instanceof Yl){const g=e.getScopes().filter(w=>w!=="");g.length>0&&(l.scopes=g.join(","))}n.tenantId&&(l.tid=n.tenantId);const u=l;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const f=await n._getAppCheckToken(),p=f?`#${jD}=${encodeURIComponent(f)}`:"";return`${UD(n)}?${Kl(u).slice(1)}${p}`}function UD({config:n}){return n.emulator?Ky(n,FD):`https://${n.authDomain}/${MD}`}const Tg="webStorageSupport";class BD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xo,this._completeRedirectFn=op,this._overrideRedirectResult=a_}async _openPopup(e,t,r,s){Dr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await qg(e,t,r,Mu(),s);return OD(e,a,ld())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await qg(e,t,r,Mu(),s);return P2(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(Dr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await PD(e),r=new $1(e);return t.register("authEvent",s=>(ee(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tg,{type:Tg},s=>{const a=s?.[0]?.[Tg];a!==void 0&&t(!!a),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_D(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return y1()||h1()||id()}}const zD=BD;class $D{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return cs("unexpected MultiFactorSessionType")}}}class l_ extends $D{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new l_(e)}_finalizeEnroll(e,t,r){return I2(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return F2(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class H1{constructor(){}static assertion(e){return l_._fromCredential(e)}}H1.FACTOR_ID="phone";var TI="@firebase/auth",xI="1.12.0";class qD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function WD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HD(n){Us(new _r("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=r.options;ee(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_1(n)},p=new dN(r,s,a,f);return SN(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Us(new _r("auth-internal",e=>{const t=St(e.getProvider("auth").getImmediate());return(r=>new qD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),or(TI,xI,WD(n)),or(TI,xI,"esm2020")}const GD=300;ek("authIdTokenMaxAge");function KD(){return document.getElementsByTagName("head")?.[0]??document}hN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=Gt("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",KD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HD("Browser");function ea(){return window}const QD=2e3;async function JD(n,e,t){const{BuildInfo:r}=ea();Dr(e.sessionId,"AuthEvent did not contain a session ID");const s=await tV(e.sessionId),a={};return id()?a.ibi=r.packageName:sd()?a.apn=r.packageName:pn(n,"operation-not-supported-in-this-environment"),r.displayName&&(a.appDisplayName=r.displayName),a.sessionId=s,qg(n,t,e.type,void 0,e.eventId??void 0,a)}async function YD(n){const{BuildInfo:e}=ea(),t={};id()?t.iosBundleId=e.packageName:sd()?t.androidPackageName=e.packageName:pn(n,"operation-not-supported-in-this-environment"),await W1(n,t)}function XD(n){const{cordova:e}=ea();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,sN()?"_blank":"_system","location=yes"),t(s)})})}async function ZD(n,e,t){const{cordova:r}=ea();let s=()=>{};try{await new Promise((a,l)=>{let u=null;function f(){a();const w=r.plugins.browsertab?.close;typeof w=="function"&&w(),typeof t?.close=="function"&&t.close()}function p(){u||(u=window.setTimeout(()=>{l(Gt(n,"redirect-cancelled-by-user"))},QD))}function g(){document?.visibilityState==="visible"&&p()}e.addPassiveListener(f),document.addEventListener("resume",p,!1),sd()&&document.addEventListener("visibilitychange",g,!1),s=()=>{e.removePassiveListener(f),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",g,!1),u&&window.clearTimeout(u)}})}finally{s()}}function eV(n){const e=ea();ee(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ee(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ee(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function tV(n){const e=nV(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function nV(n){if(Dr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const rV=20;class sV extends $1{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function iV(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:lV(),postBody:null,tenantId:n.tenantId,error:Gt(n,"no-auth-event")}}function oV(n,e){return Wg()._set(Hg(n),e)}async function SI(n){const e=await Wg()._get(Hg(n));return e&&await Wg()._remove(Hg(n)),e}function aV(n,e){const t=uV(e);if(t.includes("/__/auth/callback")){const r=rf(t),a=(r.firebaseError?cV(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],l=a?Gt(a):null;return l?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function lV(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<rV;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Wg(){return sr(n_)}function Hg(n){return Go("authEvent",n.config.apiKey,n.name)}function cV(n){try{return JSON.parse(n)}catch{return null}}function uV(n){const e=rf(n),t=e.link?decodeURIComponent(e.link):void 0,r=rf(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return rf(s).link||s||r||t||n}function rf(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return ml(t.join("?"))}const dV=500;class hV{constructor(){this._redirectPersistence=Xo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=op,this._overrideRedirectResult=a_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new sV(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){pn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,s){eV(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),oD(),await this._originValidation(e);const l=iV(e,r,s);await oV(e,l);const u=await JD(e,l,t),f=await XD(u);return ZD(e,a,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YD(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:s,BuildInfo:a}=ea(),l=setTimeout(async()=>{await SI(e),t.onEvent(AI())},dV),u=async g=>{clearTimeout(l);const w=await SI(e);let T=null;w&&g?.url&&(T=aV(w,g.url)),t.onEvent(T||AI())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,u);const f=s,p=`${a.packageName.toLowerCase()}://`;ea().handleOpenURL=async g=>{if(g.toLowerCase().startsWith(p)&&u({url:g}),typeof f=="function")try{f(g)}catch(w){console.error(w)}}}}const fV=hV;function AI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Gt("no-auth-event")}}function pV(n,e){St(n)._logFramework(e)}var mV="@firebase/auth-compat",gV="0.6.2";const yV=1e3;function Tu(){return self?.location?.protocol||null}function _V(){return Tu()==="http:"||Tu()==="https:"}function G1(n=xt()){return!!((Tu()==="file:"||Tu()==="ionic:"||Tu()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function vV(){return jy()||Qf()}function wV(){return jT()&&document?.documentMode===11}function EV(n=xt()){return/Edge\/\d+/.test(n)}function IV(n=xt()){return wV()||EV(n)}function K1(){try{const n=self.localStorage,e=ld();if(n)return n.setItem(e,"1"),n.removeItem(e),IV()?Vu():!0}catch{return c_()&&Vu()}return!1}function c_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function xg(){return(_V()||FT()||G1())&&!vV()&&K1()&&!c_()}function Q1(){return G1()&&typeof document<"u"}async function TV(){return Q1()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},yV);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function xV(){return typeof window<"u"?window:null}const rr={LOCAL:"local",NONE:"none",SESSION:"session"},nu=ee,J1="persistence";function SV(n,e){if(nu(Object.values(rr).includes(e),n,"invalid-persistence-type"),jy()){nu(e!==rr.SESSION,n,"unsupported-persistence-type");return}if(Qf()){nu(e===rr.NONE,n,"unsupported-persistence-type");return}if(c_()){nu(e===rr.NONE||e===rr.LOCAL&&Vu(),n,"unsupported-persistence-type");return}nu(e===rr.NONE||K1(),n,"unsupported-persistence-type")}async function Gg(n){await n._initializationPromise;const e=Y1(),t=Go(J1,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function AV(n,e){const t=Y1();if(!t)return[];const r=Go(J1,n,e);switch(t.getItem(r)){case rr.NONE:return[Sl];case rr.LOCAL:return[Uu,Xo];case rr.SESSION:return[Xo];default:return[]}}function Y1(){try{return xV()?.sessionStorage||null}catch{return null}}const bV=ee;class Ci{constructor(){this.browserResolver=sr(zD),this.cordovaResolver=sr(fV),this.underlyingResolver=null,this._redirectPersistence=Xo,this._completeRedirectFn=op,this._overrideRedirectResult=a_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,s)}async _openRedirect(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Q1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return bV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await TV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function X1(n){return n.unwrap()}function RV(n){return n.wrapped()}function PV(n){return Z1(n)}function kV(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new CV(n,E2(n,e))}else if(t){const r=Z1(e),s=e;r&&(s.credential=r,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function Z1(n){const{_tokenResponse:e}=n instanceof rn?n.customData:n;if(!e)return null;if(!(n instanceof rn)&&"temporaryProof"in e&&"phoneNumber"in e)return Zo.credentialFromResult(n);const t=e.providerId;if(!t||t===eu.PASSWORD)return null;let r;switch(t){case eu.GOOGLE:r=ss;break;case eu.FACEBOOK:r=rs;break;case eu.GITHUB:r=is;break;case eu.TWITTER:r=os;break;default:const{oauthIdToken:s,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:u,nonce:f}=e;return!a&&!l&&!s&&!u?null:u?t.startsWith("saml.")?Al._create(t,u):ms._fromParams({providerId:t,signInMethod:t,pendingToken:u,idToken:s,accessToken:a}):new vl(t).credential({idToken:s,accessToken:a,rawNonce:f})}return n instanceof rn?r.credentialFromError(n):r.credentialFromResult(n)}function Un(n,e){return e.catch(t=>{throw t instanceof rn&&kV(n,t),t}).then(t=>{const r=t.operationType,s=t.user;return{operationType:r,credential:PV(t),additionalUserInfo:w2(t),user:ap.getOrCreate(s)}})}async function Kg(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Un(n,t.confirm(r))}}class CV{constructor(e,t){this.resolver=t,this.auth=RV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Un(X1(this.auth),this.resolver.resolveSignIn(e))}}let ap=class hu{constructor(e){this._delegate=e,this.multiFactor=x2(e)}static getOrCreate(e){return hu.USER_MAP.has(e)||hu.USER_MAP.set(e,new hu(e)),hu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Un(this.auth,R1(this._delegate,e))}async linkWithPhoneNumber(e,t){return Kg(this.auth,G2(this._delegate,e,t))}async linkWithPopup(e){return Un(this.auth,nD(this._delegate,e,Ci))}async linkWithRedirect(e){return await Gg(St(this.auth)),dD(this._delegate,e,Ci)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Un(this.auth,P1(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Kg(this.auth,K2(this._delegate,e,t))}reauthenticateWithPopup(e){return Un(this.auth,tD(this._delegate,e,Ci))}async reauthenticateWithRedirect(e){return await Gg(St(this.auth)),cD(this._delegate,e,Ci)}sendEmailVerification(e){return c2(this._delegate,e)}async unlink(e){return await QN(this._delegate,e),this}updateEmail(e){return f2(this._delegate,e)}updatePassword(e){return p2(this._delegate,e)}updatePhoneNumber(e){return Q2(this._delegate,e)}updateProfile(e){return h2(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return u2(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};ap.USER_MAP=new WeakMap;const ru=ee;class Qg{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;ru(r,"invalid-api-key",{appName:e.name}),ru(r,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?Ci:void 0;this._delegate=t.initialize({options:{persistence:NV(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(FC),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ap.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){AN(this._delegate,e,t)}applyActionCode(e){return e2(this._delegate,e)}checkActionCode(e){return k1(this._delegate,e)}confirmPasswordReset(e,t){return ZN(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Un(this._delegate,n2(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return l2(this._delegate,e)}isSignInWithEmailLink(e){return i2(this._delegate,e)}async getRedirectResult(){ru(xg(),this._delegate,"operation-not-supported-in-this-environment");const e=await fD(this._delegate,Ci);return e?Un(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){pV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:s,error:a,complete:l}=bI(e,t,r);return this._delegate.onAuthStateChanged(s,a,l)}onIdTokenChanged(e,t,r){const{next:s,error:a,complete:l}=bI(e,t,r);return this._delegate.onIdTokenChanged(s,a,l)}sendSignInLinkToEmail(e,t){return s2(this._delegate,e,t)}sendPasswordResetEmail(e,t){return XN(this._delegate,e,t||void 0)}async setPersistence(e){SV(this._delegate,e);let t;switch(e){case rr.SESSION:t=Xo;break;case rr.LOCAL:t=await sr(Uu)._isAvailable()?Uu:n_;break;case rr.NONE:t=Sl;break;default:return pn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Un(this._delegate,KN(this._delegate))}signInWithCredential(e){return Un(this._delegate,tp(this._delegate,e))}signInWithCustomToken(e){return Un(this._delegate,YN(this._delegate,e))}signInWithEmailAndPassword(e,t){return Un(this._delegate,r2(this._delegate,e,t))}signInWithEmailLink(e,t){return Un(this._delegate,o2(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Kg(this._delegate,H2(this._delegate,e,t))}async signInWithPopup(e){return ru(xg(),this._delegate,"operation-not-supported-in-this-environment"),Un(this._delegate,eD(this._delegate,e,Ci))}async signInWithRedirect(e){return ru(xg(),this._delegate,"operation-not-supported-in-this-environment"),await Gg(this._delegate),aD(this._delegate,e,Ci)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return t2(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Qg.Persistence=rr;function bI(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const s=r;return{next:l=>s(l&&ap.getOrCreate(l)),error:e,complete:t}}function NV(n,e){const t=AV(n,e);if(typeof self<"u"&&!t.includes(Uu)&&t.push(Uu),typeof window<"u")for(const r of[n_,Xo])t.includes(r)||t.push(r);return t.includes(Sl)||t.push(Sl),t}class u_{static credential(e,t){return Zo.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Zo(X1(hn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}u_.PHONE_SIGN_IN_METHOD=Zo.PHONE_SIGN_IN_METHOD;u_.PROVIDER_ID=Zo.PROVIDER_ID;const DV=ee;class VV{constructor(e,t,r=hn.app()){DV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new q2(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const OV="auth-compat";function LV(n){n.INTERNAL.registerComponent(new _r(OV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Qg(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:rl.EMAIL_SIGNIN,PASSWORD_RESET:rl.PASSWORD_RESET,RECOVER_EMAIL:rl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:rl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:rl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:rl.VERIFY_EMAIL}},EmailAuthProvider:Zi,FacebookAuthProvider:rs,GithubAuthProvider:is,GoogleAuthProvider:ss,OAuthProvider:vl,SAMLAuthProvider:xf,PhoneAuthProvider:u_,PhoneMultiFactorGenerator:H1,RecaptchaVerifier:VV,TwitterAuthProvider:os,Auth:Qg,AuthCredential:Jl,Error:rn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(mV,gV)}LV(hn);var RI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Mi,ex;(function(){var n;function e(A,b){function C(){}C.prototype=b.prototype,A.F=b.prototype,A.prototype=new C,A.prototype.constructor=A,A.D=function(R,N,j){for(var P=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)P[Oe-2]=arguments[Oe];return b.prototype[N].apply(R,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,b,C){C||(C=0);const R=Array(16);if(typeof b=="string")for(var N=0;N<16;++N)R[N]=b.charCodeAt(C++)|b.charCodeAt(C++)<<8|b.charCodeAt(C++)<<16|b.charCodeAt(C++)<<24;else for(N=0;N<16;++N)R[N]=b[C++]|b[C++]<<8|b[C++]<<16|b[C++]<<24;b=A.g[0],C=A.g[1],N=A.g[2];let j=A.g[3],P;P=b+(j^C&(N^j))+R[0]+3614090360&4294967295,b=C+(P<<7&4294967295|P>>>25),P=j+(N^b&(C^N))+R[1]+3905402710&4294967295,j=b+(P<<12&4294967295|P>>>20),P=N+(C^j&(b^C))+R[2]+606105819&4294967295,N=j+(P<<17&4294967295|P>>>15),P=C+(b^N&(j^b))+R[3]+3250441966&4294967295,C=N+(P<<22&4294967295|P>>>10),P=b+(j^C&(N^j))+R[4]+4118548399&4294967295,b=C+(P<<7&4294967295|P>>>25),P=j+(N^b&(C^N))+R[5]+1200080426&4294967295,j=b+(P<<12&4294967295|P>>>20),P=N+(C^j&(b^C))+R[6]+2821735955&4294967295,N=j+(P<<17&4294967295|P>>>15),P=C+(b^N&(j^b))+R[7]+4249261313&4294967295,C=N+(P<<22&4294967295|P>>>10),P=b+(j^C&(N^j))+R[8]+1770035416&4294967295,b=C+(P<<7&4294967295|P>>>25),P=j+(N^b&(C^N))+R[9]+2336552879&4294967295,j=b+(P<<12&4294967295|P>>>20),P=N+(C^j&(b^C))+R[10]+4294925233&4294967295,N=j+(P<<17&4294967295|P>>>15),P=C+(b^N&(j^b))+R[11]+2304563134&4294967295,C=N+(P<<22&4294967295|P>>>10),P=b+(j^C&(N^j))+R[12]+1804603682&4294967295,b=C+(P<<7&4294967295|P>>>25),P=j+(N^b&(C^N))+R[13]+4254626195&4294967295,j=b+(P<<12&4294967295|P>>>20),P=N+(C^j&(b^C))+R[14]+2792965006&4294967295,N=j+(P<<17&4294967295|P>>>15),P=C+(b^N&(j^b))+R[15]+1236535329&4294967295,C=N+(P<<22&4294967295|P>>>10),P=b+(N^j&(C^N))+R[1]+4129170786&4294967295,b=C+(P<<5&4294967295|P>>>27),P=j+(C^N&(b^C))+R[6]+3225465664&4294967295,j=b+(P<<9&4294967295|P>>>23),P=N+(b^C&(j^b))+R[11]+643717713&4294967295,N=j+(P<<14&4294967295|P>>>18),P=C+(j^b&(N^j))+R[0]+3921069994&4294967295,C=N+(P<<20&4294967295|P>>>12),P=b+(N^j&(C^N))+R[5]+3593408605&4294967295,b=C+(P<<5&4294967295|P>>>27),P=j+(C^N&(b^C))+R[10]+38016083&4294967295,j=b+(P<<9&4294967295|P>>>23),P=N+(b^C&(j^b))+R[15]+3634488961&4294967295,N=j+(P<<14&4294967295|P>>>18),P=C+(j^b&(N^j))+R[4]+3889429448&4294967295,C=N+(P<<20&4294967295|P>>>12),P=b+(N^j&(C^N))+R[9]+568446438&4294967295,b=C+(P<<5&4294967295|P>>>27),P=j+(C^N&(b^C))+R[14]+3275163606&4294967295,j=b+(P<<9&4294967295|P>>>23),P=N+(b^C&(j^b))+R[3]+4107603335&4294967295,N=j+(P<<14&4294967295|P>>>18),P=C+(j^b&(N^j))+R[8]+1163531501&4294967295,C=N+(P<<20&4294967295|P>>>12),P=b+(N^j&(C^N))+R[13]+2850285829&4294967295,b=C+(P<<5&4294967295|P>>>27),P=j+(C^N&(b^C))+R[2]+4243563512&4294967295,j=b+(P<<9&4294967295|P>>>23),P=N+(b^C&(j^b))+R[7]+1735328473&4294967295,N=j+(P<<14&4294967295|P>>>18),P=C+(j^b&(N^j))+R[12]+2368359562&4294967295,C=N+(P<<20&4294967295|P>>>12),P=b+(C^N^j)+R[5]+4294588738&4294967295,b=C+(P<<4&4294967295|P>>>28),P=j+(b^C^N)+R[8]+2272392833&4294967295,j=b+(P<<11&4294967295|P>>>21),P=N+(j^b^C)+R[11]+1839030562&4294967295,N=j+(P<<16&4294967295|P>>>16),P=C+(N^j^b)+R[14]+4259657740&4294967295,C=N+(P<<23&4294967295|P>>>9),P=b+(C^N^j)+R[1]+2763975236&4294967295,b=C+(P<<4&4294967295|P>>>28),P=j+(b^C^N)+R[4]+1272893353&4294967295,j=b+(P<<11&4294967295|P>>>21),P=N+(j^b^C)+R[7]+4139469664&4294967295,N=j+(P<<16&4294967295|P>>>16),P=C+(N^j^b)+R[10]+3200236656&4294967295,C=N+(P<<23&4294967295|P>>>9),P=b+(C^N^j)+R[13]+681279174&4294967295,b=C+(P<<4&4294967295|P>>>28),P=j+(b^C^N)+R[0]+3936430074&4294967295,j=b+(P<<11&4294967295|P>>>21),P=N+(j^b^C)+R[3]+3572445317&4294967295,N=j+(P<<16&4294967295|P>>>16),P=C+(N^j^b)+R[6]+76029189&4294967295,C=N+(P<<23&4294967295|P>>>9),P=b+(C^N^j)+R[9]+3654602809&4294967295,b=C+(P<<4&4294967295|P>>>28),P=j+(b^C^N)+R[12]+3873151461&4294967295,j=b+(P<<11&4294967295|P>>>21),P=N+(j^b^C)+R[15]+530742520&4294967295,N=j+(P<<16&4294967295|P>>>16),P=C+(N^j^b)+R[2]+3299628645&4294967295,C=N+(P<<23&4294967295|P>>>9),P=b+(N^(C|~j))+R[0]+4096336452&4294967295,b=C+(P<<6&4294967295|P>>>26),P=j+(C^(b|~N))+R[7]+1126891415&4294967295,j=b+(P<<10&4294967295|P>>>22),P=N+(b^(j|~C))+R[14]+2878612391&4294967295,N=j+(P<<15&4294967295|P>>>17),P=C+(j^(N|~b))+R[5]+4237533241&4294967295,C=N+(P<<21&4294967295|P>>>11),P=b+(N^(C|~j))+R[12]+1700485571&4294967295,b=C+(P<<6&4294967295|P>>>26),P=j+(C^(b|~N))+R[3]+2399980690&4294967295,j=b+(P<<10&4294967295|P>>>22),P=N+(b^(j|~C))+R[10]+4293915773&4294967295,N=j+(P<<15&4294967295|P>>>17),P=C+(j^(N|~b))+R[1]+2240044497&4294967295,C=N+(P<<21&4294967295|P>>>11),P=b+(N^(C|~j))+R[8]+1873313359&4294967295,b=C+(P<<6&4294967295|P>>>26),P=j+(C^(b|~N))+R[15]+4264355552&4294967295,j=b+(P<<10&4294967295|P>>>22),P=N+(b^(j|~C))+R[6]+2734768916&4294967295,N=j+(P<<15&4294967295|P>>>17),P=C+(j^(N|~b))+R[13]+1309151649&4294967295,C=N+(P<<21&4294967295|P>>>11),P=b+(N^(C|~j))+R[4]+4149444226&4294967295,b=C+(P<<6&4294967295|P>>>26),P=j+(C^(b|~N))+R[11]+3174756917&4294967295,j=b+(P<<10&4294967295|P>>>22),P=N+(b^(j|~C))+R[2]+718787259&4294967295,N=j+(P<<15&4294967295|P>>>17),P=C+(j^(N|~b))+R[9]+3951481745&4294967295,A.g[0]=A.g[0]+b&4294967295,A.g[1]=A.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+N&4294967295,A.g[3]=A.g[3]+j&4294967295}r.prototype.v=function(A,b){b===void 0&&(b=A.length);const C=b-this.blockSize,R=this.C;let N=this.h,j=0;for(;j<b;){if(N==0)for(;j<=C;)s(this,A,j),j+=this.blockSize;if(typeof A=="string"){for(;j<b;)if(R[N++]=A.charCodeAt(j++),N==this.blockSize){s(this,R),N=0;break}}else for(;j<b;)if(R[N++]=A[j++],N==this.blockSize){s(this,R),N=0;break}}this.h=N,this.o+=b},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var b=1;b<A.length-8;++b)A[b]=0;b=this.o*8;for(var C=A.length-8;C<A.length;++C)A[C]=b&255,b/=256;for(this.v(A),A=Array(16),b=0,C=0;C<4;++C)for(let R=0;R<32;R+=8)A[b++]=this.g[C]>>>R&255;return A};function a(A,b){var C=u;return Object.prototype.hasOwnProperty.call(C,A)?C[A]:C[A]=b(A)}function l(A,b){this.h=b;const C=[];let R=!0;for(let N=A.length-1;N>=0;N--){const j=A[N]|0;R&&j==b||(C[N]=j,R=!1)}this.g=C}var u={};function f(A){return-128<=A&&A<128?a(A,function(b){return new l([b|0],b<0?-1:0)}):new l([A|0],A<0?-1:0)}function p(A){if(isNaN(A)||!isFinite(A))return w;if(A<0)return L(p(-A));const b=[];let C=1;for(let R=0;A>=C;R++)b[R]=A/C|0,C*=4294967296;return new l(b,0)}function g(A,b){if(A.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(A.charAt(0)=="-")return L(g(A.substring(1),b));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=p(Math.pow(b,8));let R=w;for(let j=0;j<A.length;j+=8){var N=Math.min(8,A.length-j);const P=parseInt(A.substring(j,j+N),b);N<8?(N=p(Math.pow(b,N)),R=R.j(N).add(p(P))):(R=R.j(C),R=R.add(p(P)))}return R}var w=f(0),T=f(1),D=f(16777216);n=l.prototype,n.m=function(){if(O(this))return-L(this).m();let A=0,b=1;for(let C=0;C<this.g.length;C++){const R=this.i(C);A+=(R>=0?R:4294967296+R)*b,b*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(S(this))return"0";if(O(this))return"-"+L(this).toString(A);const b=p(Math.pow(A,6));var C=this;let R="";for(;;){const N=ge(C,b).g;C=se(C,N.j(b));let j=((C.g.length>0?C.g[0]:C.h)>>>0).toString(A);if(C=N,S(C))return j+R;for(;j.length<6;)j="0"+j;R=j+R}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function S(A){if(A.h!=0)return!1;for(let b=0;b<A.g.length;b++)if(A.g[b]!=0)return!1;return!0}function O(A){return A.h==-1}n.l=function(A){return A=se(this,A),O(A)?-1:S(A)?0:1};function L(A){const b=A.g.length,C=[];for(let R=0;R<b;R++)C[R]=~A.g[R];return new l(C,~A.h).add(T)}n.abs=function(){return O(this)?L(this):this},n.add=function(A){const b=Math.max(this.g.length,A.g.length),C=[];let R=0;for(let N=0;N<=b;N++){let j=R+(this.i(N)&65535)+(A.i(N)&65535),P=(j>>>16)+(this.i(N)>>>16)+(A.i(N)>>>16);R=P>>>16,j&=65535,P&=65535,C[N]=P<<16|j}return new l(C,C[C.length-1]&-2147483648?-1:0)};function se(A,b){return A.add(L(b))}n.j=function(A){if(S(this)||S(A))return w;if(O(this))return O(A)?L(this).j(L(A)):L(L(this).j(A));if(O(A))return L(this.j(L(A)));if(this.l(D)<0&&A.l(D)<0)return p(this.m()*A.m());const b=this.g.length+A.g.length,C=[];for(var R=0;R<2*b;R++)C[R]=0;for(R=0;R<this.g.length;R++)for(let N=0;N<A.g.length;N++){const j=this.i(R)>>>16,P=this.i(R)&65535,Oe=A.i(N)>>>16,it=A.i(N)&65535;C[2*R+2*N]+=P*it,oe(C,2*R+2*N),C[2*R+2*N+1]+=j*it,oe(C,2*R+2*N+1),C[2*R+2*N+1]+=P*Oe,oe(C,2*R+2*N+1),C[2*R+2*N+2]+=j*Oe,oe(C,2*R+2*N+2)}for(A=0;A<b;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=b;A<2*b;A++)C[A]=0;return new l(C,0)};function oe(A,b){for(;(A[b]&65535)!=A[b];)A[b+1]+=A[b]>>>16,A[b]&=65535,b++}function Z(A,b){this.g=A,this.h=b}function ge(A,b){if(S(b))throw Error("division by zero");if(S(A))return new Z(w,w);if(O(A))return b=ge(L(A),b),new Z(L(b.g),L(b.h));if(O(b))return b=ge(A,L(b)),new Z(L(b.g),b.h);if(A.g.length>30){if(O(A)||O(b))throw Error("slowDivide_ only works with positive integers.");for(var C=T,R=b;R.l(A)<=0;)C=ne(C),R=ne(R);var N=ae(C,1),j=ae(R,1);for(R=ae(R,2),C=ae(C,2);!S(R);){var P=j.add(R);P.l(A)<=0&&(N=N.add(C),j=P),R=ae(R,1),C=ae(C,1)}return b=se(A,N.j(b)),new Z(N,b)}for(N=w;A.l(b)>=0;){for(C=Math.max(1,Math.floor(A.m()/b.m())),R=Math.ceil(Math.log(C)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),j=p(C),P=j.j(b);O(P)||P.l(A)>0;)C-=R,j=p(C),P=j.j(b);S(j)&&(j=T),N=N.add(j),A=se(A,P)}return new Z(N,A)}n.B=function(A){return ge(this,A).h},n.and=function(A){const b=Math.max(this.g.length,A.g.length),C=[];for(let R=0;R<b;R++)C[R]=this.i(R)&A.i(R);return new l(C,this.h&A.h)},n.or=function(A){const b=Math.max(this.g.length,A.g.length),C=[];for(let R=0;R<b;R++)C[R]=this.i(R)|A.i(R);return new l(C,this.h|A.h)},n.xor=function(A){const b=Math.max(this.g.length,A.g.length),C=[];for(let R=0;R<b;R++)C[R]=this.i(R)^A.i(R);return new l(C,this.h^A.h)};function ne(A){const b=A.g.length+1,C=[];for(let R=0;R<b;R++)C[R]=A.i(R)<<1|A.i(R-1)>>>31;return new l(C,A.h)}function ae(A,b){const C=b>>5;b%=32;const R=A.g.length-C,N=[];for(let j=0;j<R;j++)N[j]=b>0?A.i(j+C)>>>b|A.i(j+C+1)<<32-b:A.i(j+C);return new l(N,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,ex=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=g,Mi=l}).apply(typeof RI<"u"?RI:typeof self<"u"?self:typeof window<"u"?window:{});var Hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var tx,fu,nx,sf,Jg,rx,sx,ix;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hh=="object"&&Hh];for(var _=0;_<d.length;++_){var E=d[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=t(this);function s(d,_){if(_)e:{var E=r;d=d.split(".");for(var x=0;x<d.length-1;x++){var z=d[x];if(!(z in E))break e;E=E[z]}d=d[d.length-1],x=E[d],_=_(x),_!=x&&_!=null&&e(E,d,{configurable:!0,writable:!0,value:_})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(_){var E=[],x;for(x in _)Object.prototype.hasOwnProperty.call(_,x)&&E.push([x,_[x]]);return E}});var a=a||{},l=this||self;function u(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function f(d,_,E){return d.call.apply(d.bind,arguments)}function p(d,_,E){return p=f,p.apply(null,arguments)}function g(d,_){var E=Array.prototype.slice.call(arguments,1);return function(){var x=E.slice();return x.push.apply(x,arguments),d.apply(this,x)}}function w(d,_){function E(){}E.prototype=_.prototype,d.Z=_.prototype,d.prototype=new E,d.prototype.constructor=d,d.Ob=function(x,z,H){for(var le=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)le[Ve-2]=arguments[Ve];return _.prototype[z].apply(x,le)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function D(d){const _=d.length;if(_>0){const E=Array(_);for(let x=0;x<_;x++)E[x]=d[x];return E}return[]}function S(d,_){for(let x=1;x<arguments.length;x++){const z=arguments[x];var E=typeof z;if(E=E!="object"?E:z?Array.isArray(z)?"array":E:"null",E=="array"||E=="object"&&typeof z.length=="number"){E=d.length||0;const H=z.length||0;d.length=E+H;for(let le=0;le<H;le++)d[E+le]=z[le]}else d.push(z)}}class O{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function L(d){l.setTimeout(()=>{throw d},0)}function se(){var d=A;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class oe{constructor(){this.h=this.g=null}add(_,E){const x=Z.get();x.set(_,E),this.h?this.h.next=x:this.g=x,this.h=x}}var Z=new O(()=>new ge,d=>d.reset());class ge{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,ae=!1,A=new oe,b=()=>{const d=Promise.resolve(void 0);ne=()=>{d.then(C)}};function C(){for(var d;d=se();){try{d.h.call(d.g)}catch(E){L(E)}var _=Z;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}ae=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const E=()=>{};l.addEventListener("test",E,_),l.removeEventListener("test",E,_)}catch{}return d})();function P(d){return/^[\s\xa0]*$/.test(d)}function Oe(d,_){N.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}w(Oe,N),Oe.prototype.init=function(d,_){const E=this.type=d.type,x=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(E=="mouseover"?_=d.fromElement:E=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Oe.Z.h.call(this)},Oe.prototype.h=function(){Oe.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var it="closure_listenable_"+(Math.random()*1e6|0),ue=0;function Ne(d,_,E,x,z){this.listener=d,this.proxy=null,this.src=_,this.type=E,this.capture=!!x,this.ha=z,this.key=++ue,this.da=this.fa=!1}function re(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ye(d,_,E){for(const x in d)_.call(E,d[x],x,d)}function he(d,_){for(const E in d)_.call(void 0,d[E],E,d)}function F(d){const _={};for(const E in d)_[E]=d[E];return _}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Re(d,_){let E,x;for(let z=1;z<arguments.length;z++){x=arguments[z];for(E in x)d[E]=x[E];for(let H=0;H<K.length;H++)E=K[H],Object.prototype.hasOwnProperty.call(x,E)&&(d[E]=x[E])}}function Pe(d){this.src=d,this.g={},this.h=0}Pe.prototype.add=function(d,_,E,x,z){const H=d.toString();d=this.g[H],d||(d=this.g[H]=[],this.h++);const le=je(d,_,x,z);return le>-1?(_=d[le],E||(_.fa=!1)):(_=new Ne(_,this.src,H,!!x,z),_.fa=E,d.push(_)),_};function Fe(d,_){const E=_.type;if(E in d.g){var x=d.g[E],z=Array.prototype.indexOf.call(x,_,void 0),H;(H=z>=0)&&Array.prototype.splice.call(x,z,1),H&&(re(_),d.g[E].length==0&&(delete d.g[E],d.h--))}}function je(d,_,E,x){for(let z=0;z<d.length;++z){const H=d[z];if(!H.da&&H.listener==_&&H.capture==!!E&&H.ha==x)return z}return-1}var Je="closure_lm_"+(Math.random()*1e6|0),qe={};function tt(d,_,E,x,z){if(Array.isArray(_)){for(let H=0;H<_.length;H++)tt(d,_[H],E,x,z);return null}return E=ya(E),d&&d[it]?d.J(_,E,u(x)?!!x.capture:!1,z):xe(d,_,E,!1,x,z)}function xe(d,_,E,x,z,H){if(!_)throw Error("Invalid event type");const le=u(z)?!!z.capture:!!z;let Ve=jt(d);if(Ve||(d[Je]=Ve=new Pe(d)),E=Ve.add(_,E,x,le,H),E.proxy)return E;if(x=Ke(),E.proxy=x,x.src=d,x.listener=E,d.addEventListener)j||(z=le),z===void 0&&(z=!1),d.addEventListener(_.toString(),x,z);else if(d.attachEvent)d.attachEvent(Nn(_.toString()),x);else if(d.addListener&&d.removeListener)d.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Ke(){function d(E){return _.call(d.src,d.listener,E)}const _=Qt;return d}function wt(d,_,E,x,z){if(Array.isArray(_))for(var H=0;H<_.length;H++)wt(d,_[H],E,x,z);else x=u(x)?!!x.capture:!!x,E=ya(E),d&&d[it]?(d=d.i,H=String(_).toString(),H in d.g&&(_=d.g[H],E=je(_,E,x,z),E>-1&&(re(_[E]),Array.prototype.splice.call(_,E,1),_.length==0&&(delete d.g[H],d.h--)))):d&&(d=jt(d))&&(_=d.g[_.toString()],d=-1,_&&(d=je(_,E,x,z)),(E=d>-1?_[d]:null)&&Et(E))}function Et(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[it])Fe(_.i,d);else{var E=d.type,x=d.proxy;_.removeEventListener?_.removeEventListener(E,x,d.capture):_.detachEvent?_.detachEvent(Nn(E),x):_.addListener&&_.removeListener&&_.removeListener(x),(E=jt(_))?(Fe(E,d),E.h==0&&(E.src=null,_[Je]=null)):re(d)}}}function Nn(d){return d in qe?qe[d]:qe[d]="on"+d}function Qt(d,_){if(d.da)d=!0;else{_=new Oe(_,this);const E=d.listener,x=d.ha||d.src;d.fa&&Et(d),d=E.call(x,_)}return d}function jt(d){return d=d[Je],d instanceof Pe?d:null}var Jt="__closure_events_fn_"+(Math.random()*1e9>>>0);function ya(d){return typeof d=="function"?d:(d[Jt]||(d[Jt]=function(_){return d.handleEvent(_)}),d[Jt])}function at(){R.call(this),this.i=new Pe(this),this.M=this,this.G=null}w(at,R),at.prototype[it]=!0,at.prototype.removeEventListener=function(d,_,E,x){wt(this,d,_,E,x)};function At(d,_){var E,x=d.G;if(x)for(E=[];x;x=x.G)E.push(x);if(d=d.M,x=_.type||_,typeof _=="string")_=new N(_,d);else if(_ instanceof N)_.target=_.target||d;else{var z=_;_=new N(x,d),Re(_,z)}z=!0;let H,le;if(E)for(le=E.length-1;le>=0;le--)H=_.g=E[le],z=Dn(H,x,!0,_)&&z;if(H=_.g=d,z=Dn(H,x,!0,_)&&z,z=Dn(H,x,!1,_)&&z,E)for(le=0;le<E.length;le++)H=_.g=E[le],z=Dn(H,x,!1,_)&&z}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const E=d.g[_];for(let x=0;x<E.length;x++)re(E[x]);delete d.g[_],d.h--}}this.G=null},at.prototype.J=function(d,_,E,x){return this.i.add(String(d),_,!1,E,x)},at.prototype.K=function(d,_,E,x){return this.i.add(String(d),_,!0,E,x)};function Dn(d,_,E,x){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let z=!0;for(let H=0;H<_.length;++H){const le=_[H];if(le&&!le.da&&le.capture==E){const Ve=le.listener,Nt=le.ha||le.src;le.fa&&Fe(d.i,le),z=Ve.call(Nt,x)!==!1&&z}}return z&&!x.defaultPrevented}function io(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:l.setTimeout(d,_||0)}function lc(d){d.g=io(()=>{d.g=null,d.i&&(d.i=!1,lc(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class kd extends R{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:lc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(d){R.call(this),this.h=d,this.g={}}w(Js,R);var cc=[];function _a(d){ye(d.g,function(_,E){this.g.hasOwnProperty(E)&&Et(_)},d),d.g={}}Js.prototype.N=function(){Js.Z.N.call(this),_a(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ys=l.JSON.stringify,Cd=l.JSON.parse,oo=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function Xs(){}function Nd(){}var Zs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function va(){N.call(this,"d")}w(va,N);function uc(){N.call(this,"c")}w(uc,N);var wr={},wa=null;function ei(){return wa=wa||new at}wr.Ia="serverreachability";function Ea(d){N.call(this,wr.Ia,d)}w(Ea,N);function _s(d){const _=ei();At(_,new Ea(_))}wr.STAT_EVENT="statevent";function vs(d,_){N.call(this,wr.STAT_EVENT,d),this.stat=_}w(vs,N);function bt(d){const _=ei();At(_,new vs(_,d))}wr.Ja="timingevent";function dc(d,_){N.call(this,wr.Ja,d),this.size=_}w(dc,N);function ti(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},_)}function ni(){this.g=!0}ni.prototype.ua=function(){this.g=!1};function Dd(d,_,E,x,z,H){d.info(function(){if(d.g)if(H){var le="",Ve=H.split("&");for(let nt=0;nt<Ve.length;nt++){var Nt=Ve[nt].split("=");if(Nt.length>1){const Ut=Nt[0];Nt=Nt[1];const Xn=Ut.split("_");le=Xn.length>=2&&Xn[1]=="type"?le+(Ut+"="+Nt+"&"):le+(Ut+"=redacted&")}}}else le=null;else le=H;return"XMLHTTP REQ ("+x+") [attempt "+z+"]: "+_+`
`+E+`
`+le})}function Vd(d,_,E,x,z,H,le){d.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+z+"]: "+_+`
`+E+`
`+H+" "+le})}function Or(d,_,E,x){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+ao(d,E)+(x?" "+x:"")})}function Od(d,_){d.info(function(){return"TIMEOUT: "+_})}ni.prototype.info=function(){};function ao(d,_){if(!d.g)return _;if(!_)return null;try{const H=JSON.parse(_);if(H){for(d=0;d<H.length;d++)if(Array.isArray(H[d])){var E=H[d];if(!(E.length<2)){var x=E[1];if(Array.isArray(x)&&!(x.length<1)){var z=x[0];if(z!="noop"&&z!="stop"&&z!="close")for(let le=1;le<x.length;le++)x[le]=""}}}}return Ys(H)}catch{return _}}var ri={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},si={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ld;function ws(){}w(ws,Xs),ws.prototype.g=function(){return new XMLHttpRequest},Ld=new ws;function Lr(d){return encodeURIComponent(String(d))}function Ia(d){var _=1;d=d.split(":");const E=[];for(;_>0&&d.length;)E.push(d.shift()),_--;return d.length&&E.push(d.join(":")),E}function lr(d,_,E,x){this.j=d,this.i=_,this.l=E,this.S=x||1,this.V=new Js(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Md}function Md(){this.i=null,this.g="",this.h=!1}var Fd={},hc={};function Er(d,_,E){d.M=1,d.A=Is(cr(_)),d.u=E,d.R=!0,fc(d,null)}function fc(d,_){d.F=Date.now(),lo(d),d.B=cr(d.A);var E=d.B,x=d.S;Array.isArray(x)||(x=[String(x)]),Tc(E.i,"t",x),d.C=0,E=d.j.L,d.h=new Md,d.g=Kd(d.j,E?_:null,!d.u),d.P>0&&(d.O=new kd(p(d.Y,d,d.g),d.P)),_=d.V,E=d.g,x=d.ba;var z="readystatechange";Array.isArray(z)||(z&&(cc[0]=z.toString()),z=cc);for(let H=0;H<z.length;H++){const le=tt(E,z[H],x||_.handleEvent,!1,_.h||_);if(!le)break;_.g[le.key]=le}_=d.J?F(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),_s(),Dd(d.i,d.v,d.B,d.l,d.S,d.u)}lr.prototype.ba=function(d){d=d.target;const _=this.O;_&&$r(d)==3?_.j():this.Y(d)},lr.prototype.Y=function(d){try{if(d==this.g)e:{const Ve=$r(this.g),Nt=this.g.ya(),nt=this.g.ca();if(!(Ve<3)&&(Ve!=3||this.g&&(this.h.h||this.g.la()||Hd(this.g)))){this.K||Ve!=4||Nt==7||(Nt==8||nt<=0?_s(3):_s(2)),Ta(this);var _=this.g.ca();this.X=_;var E=jd(this);if(this.o=_==200,Vd(this.i,this.v,this.B,this.l,this.S,Ve,_),this.o){if(this.U&&!this.L){t:{if(this.g){var x,z=this.g;if((x=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(x)){var H=x;break t}}H=null}if(d=H)Or(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,dt(this,d);else{this.o=!1,this.m=3,bt(12),Es(this),co(this);break e}}if(this.R){d=!0;let Ut;for(;!this.K&&this.C<E.length;)if(Ut=Bd(this,E),Ut==hc){Ve==4&&(this.m=4,bt(14),d=!1),Or(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==Fd){this.m=4,bt(15),Or(this.i,this.l,E,"[Invalid Chunk]"),d=!1;break}else Or(this.i,this.l,Ut,null),dt(this,Ut);if(Ud(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ve!=4||E.length!=0||this.h.h||(this.m=1,bt(16),d=!1),this.o=this.o&&d,!d)Or(this.i,this.l,E,"[Invalid Chunked Response]"),Es(this),co(this);else if(E.length>0&&!this.W){this.W=!0;var le=this.j;le.g==this&&le.aa&&!le.P&&(le.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),vo(le),le.P=!0,bt(11))}}else Or(this.i,this.l,E,null),dt(this,E);Ve==4&&Es(this),this.o&&!this.K&&(Ve==4?Da(this.j,this):(this.o=!1,lo(this)))}else Sc(this.g),_==400&&E.indexOf("Unknown SID")>0?(this.m=3,bt(12)):(this.m=0,bt(13)),Es(this),co(this)}}}catch{}};function jd(d){if(!Ud(d))return d.g.la();const _=Hd(d.g);if(_==="")return"";let E="";const x=_.length,z=$r(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Es(d),co(d),"";d.h.i=new l.TextDecoder}for(let H=0;H<x;H++)d.h.h=!0,E+=d.h.i.decode(_[H],{stream:!(z&&H==x-1)});return _.length=0,d.h.g+=E,d.C=0,d.h.g}function Ud(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Bd(d,_){var E=d.C,x=_.indexOf(`
`,E);return x==-1?hc:(E=Number(_.substring(E,x)),isNaN(E)?Fd:(x+=1,x+E>_.length?hc:(_=_.slice(x,x+E),d.C=x+E,_)))}lr.prototype.cancel=function(){this.K=!0,Es(this)};function lo(d){d.T=Date.now()+d.H,pc(d,d.H)}function pc(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=ti(p(d.aa,d),_)}function Ta(d){d.D&&(l.clearTimeout(d.D),d.D=null)}lr.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Od(this.i,this.B),this.M!=2&&(_s(),bt(17)),Es(this),this.m=2,co(this)):pc(this,this.T-d)};function co(d){d.j.I==0||d.K||Da(d.j,d)}function Es(d){Ta(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,_a(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function dt(d,_){try{var E=d.j;if(E.I!=0&&(E.g==d||gc(E.h,d))){if(!d.L&&gc(E.h,d)&&E.I==3){try{var x=E.Ba.g.parse(_)}catch{x=null}if(Array.isArray(x)&&x.length==3){var z=x;if(z[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<d.F)Na(E),Jn(E);else break e;Hr(E),bt(18)}}else E.xa=z[1],0<E.xa-E.K&&z[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=ti(p(E.Va,E),6e3));uo(E.h)<=1&&E.ta&&(E.ta=void 0)}else Yn(E,11)}else if((d.L||E.g==d)&&Na(E),!P(_))for(z=E.Ba.g.parse(_),_=0;_<z.length;_++){let nt=z[_];const Ut=nt[0];if(!(Ut<=E.K))if(E.K=Ut,nt=nt[1],E.I==2)if(nt[0]=="c"){E.M=nt[1],E.ba=nt[2];const Xn=nt[3];Xn!=null&&(E.ka=Xn,E.j.info("VER="+E.ka));const bs=nt[4];bs!=null&&(E.za=bs,E.j.info("SVER="+E.za));const Gr=nt[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(x=1.5*Gr,E.O=x,E.j.info("backChannelRequestTimeoutMs_="+x)),x=E;const Kr=d.g;if(Kr){const La=Kr.g?Kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(La){var H=x.h;H.g||La.indexOf("spdy")==-1&&La.indexOf("quic")==-1&&La.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Sa(H,H.h),H.h=null))}if(x.G){const Rc=Kr.g?Kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Rc&&(x.wa=Rc,Ze(x.J,x.G,Rc))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-d.F,E.j.info("Handshake RTT: "+E.T+"ms")),x=E;var le=d;if(x.na=bc(x,x.L?x.ba:null,x.W),le.L){ho(x.h,le);var Ve=le,Nt=x.O;Nt&&(Ve.H=Nt),Ve.D&&(Ta(Ve),lo(Ve)),x.g=le}else mn(x);E.i.length>0&&As(E)}else nt[0]!="stop"&&nt[0]!="close"||Yn(E,7);else E.I==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?Yn(E,7):ka(E):nt[0]!="noop"&&E.l&&E.l.qa(nt),E.A=0)}}_s(4)}catch{}}var Up=class{constructor(d,_){this.g=d,this.map=_}};function xa(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function mc(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function uo(d){return d.h?1:d.g?d.g.size:0}function gc(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function Sa(d,_){d.g?d.g.add(_):d.h=_}function ho(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}xa.prototype.cancel=function(){if(this.i=Gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Gn(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const E of d.g.values())_=_.concat(E.G);return _}return D(d.i)}var zd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kn(d,_){if(d){d=d.split("&");for(let E=0;E<d.length;E++){const x=d[E].indexOf("=");let z,H=null;x>=0?(z=d[E].substring(0,x),H=d[E].substring(x+1)):z=d[E],_(z,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Mr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof Mr?(this.l=d.l,fo(this,d.j),this.o=d.o,this.g=d.g,Fr(this,d.u),this.h=d.h,ii(this,xc(d.i)),this.m=d.m):d&&(_=String(d).match(zd))?(this.l=!1,fo(this,_[1]||"",!0),this.o=po(_[2]||""),this.g=po(_[3]||"",!0),Fr(this,_[4]),this.h=po(_[5]||"",!0),ii(this,_[6]||"",!0),this.m=po(_[7]||"")):(this.l=!1,this.i=new We(null,this.l))}Mr.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(mo(_,_c,!0),":");var E=this.g;return(E||_=="file")&&(d.push("//"),(_=this.o)&&d.push(mo(_,_c,!0),"@"),d.push(Lr(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&d.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&d.push("/"),d.push(mo(E,E.charAt(0)=="/"?go:vc,!0))),(E=this.i.toString())&&d.push("?",E),(E=this.m)&&d.push("#",mo(E,wc)),d.join("")},Mr.prototype.resolve=function(d){const _=cr(this);let E=!!d.j;E?fo(_,d.j):E=!!d.o,E?_.o=d.o:E=!!d.g,E?_.g=d.g:E=d.u!=null;var x=d.h;if(E)Fr(_,d.u);else if(E=!!d.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var z=_.h.lastIndexOf("/");z!=-1&&(x=_.h.slice(0,z+1)+x)}if(z=x,z==".."||z==".")x="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){x=z.lastIndexOf("/",0)==0,z=z.split("/");const H=[];for(let le=0;le<z.length;){const Ve=z[le++];Ve=="."?x&&le==z.length&&H.push(""):Ve==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),x&&le==z.length&&H.push("")):(H.push(Ve),x=!0)}x=H.join("/")}else x=z}return E?_.h=x:E=d.i.toString()!=="",E?ii(_,xc(d.i)):E=!!d.m,E&&(_.m=d.m),_};function cr(d){return new Mr(d)}function fo(d,_,E){d.j=E?po(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function Fr(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function ii(d,_,E){_ instanceof We?(d.i=_,ba(d.i,d.l)):(E||(_=mo(_,Bp)),d.i=new We(_,d.l))}function Ze(d,_,E){d.i.set(_,E)}function Is(d){return Ze(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function po(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function mo(d,_,E){return typeof d=="string"?(d=encodeURI(d).replace(_,yc),E&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function yc(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var _c=/[#\/\?@]/g,vc=/[#\?:]/g,go=/[#\?]/g,Bp=/[#\?@]/g,wc=/#/g;function We(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function jr(d){d.g||(d.g=new Map,d.h=0,d.i&&Kn(d.i,function(_,E){d.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}n=We.prototype,n.add=function(d,_){jr(this),this.i=null,d=Ur(this,d);let E=this.g.get(d);return E||this.g.set(d,E=[]),E.push(_),this.h+=1,this};function Ec(d,_){jr(d),_=Ur(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function Aa(d,_){return jr(d),_=Ur(d,_),d.g.has(_)}n.forEach=function(d,_){jr(this),this.g.forEach(function(E,x){E.forEach(function(z){d.call(_,z,x,this)},this)},this)};function Ic(d,_){jr(d);let E=[];if(typeof _=="string")Aa(d,_)&&(E=E.concat(d.g.get(Ur(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)E=E.concat(d[_]);return E}n.set=function(d,_){return jr(this),this.i=null,d=Ur(this,d),Aa(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},n.get=function(d,_){return d?(d=Ic(this,d),d.length>0?String(d[0]):_):_};function Tc(d,_,E){Ec(d,_),E.length>0&&(d.i=null,d.g.set(Ur(d,_),D(E)),d.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let x=0;x<_.length;x++){var E=_[x];const z=Lr(E);E=Ic(this,E);for(let H=0;H<E.length;H++){let le=z;E[H]!==""&&(le+="="+Lr(E[H])),d.push(le)}}return this.i=d.join("&")};function xc(d){const _=new We;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function Ur(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function ba(d,_){_&&!d.j&&(jr(d),d.i=null,d.g.forEach(function(E,x){const z=x.toLowerCase();x!=z&&(Ec(this,x),Tc(this,z,E))},d)),d.j=_}function Br(d,_){const E=new ni;if(l.Image){const x=new Image;x.onload=g(on,E,"TestLoadImage: loaded",!0,_,x),x.onerror=g(on,E,"TestLoadImage: error",!1,_,x),x.onabort=g(on,E,"TestLoadImage: abort",!1,_,x),x.ontimeout=g(on,E,"TestLoadImage: timeout",!1,_,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=d}else _(!1)}function zr(d,_){const E=new ni,x=new AbortController,z=setTimeout(()=>{x.abort(),on(E,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:x.signal}).then(H=>{clearTimeout(z),H.ok?on(E,"TestPingServer: ok",!0,_):on(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(z),on(E,"TestPingServer: error",!1,_)})}function on(d,_,E,x,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),x(E)}catch{}}function yo(){this.g=new oo}function Ts(d){this.i=d.Sb||null,this.h=d.ab||!1}w(Ts,Xs),Ts.prototype.g=function(){return new Qn(this.i,this.h)};function Qn(d,_){at.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Qn,at),n=Qn.prototype,n.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,Ir(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||l).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,oi(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ir(this)),this.g&&(this.readyState=3,Ir(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$d(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function $d(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?oi(this):Ir(this),this.readyState==3&&$d(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,oi(this))},n.Na=function(d){this.g&&(this.response=d,oi(this))},n.ga=function(){this.g&&oi(this)};function oi(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Ir(d)}n.setRequestHeader=function(d,_){this.A.append(d,_)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,d.push(E[0]+": "+E[1]),E=_.next();return d.join(`\r
`)};function Ir(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Qn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function qd(d){let _="";return ye(d,function(E,x){_+=x,_+=":",_+=E,_+=`\r
`}),_}function Ra(d,_,E){e:{for(x in E){var x=!1;break e}x=!0}x||(E=qd(E),typeof d=="string"?E!=null&&Lr(E):Ze(d,_,E))}function ot(d){at.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(ot,at);var Wd=/^https?$/i,zp=["POST","PUT"];n=ot.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,_,E,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ld.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch(H){ai(this,H);return}if(d=E||"",E=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var z in x)E.set(z,x[z]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const H of x.keys())E.set(H,x.get(H));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(E.keys()).find(H=>H.toLowerCase()=="content-type"),z=l.FormData&&d instanceof l.FormData,!(Array.prototype.indexOf.call(zp,_,void 0)>=0)||x||z||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,le]of E)this.g.setRequestHeader(H,le);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(H){ai(this,H)}};function ai(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,li(d),Ss(d)}function li(d){d.A||(d.A=!0,At(d,"complete"),At(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,At(this,"complete"),At(this,"abort"),Ss(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ss(this,!0)),ot.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?xs(this):this.Xa())},n.Xa=function(){xs(this)};function xs(d){if(d.h&&typeof a<"u"){if(d.v&&$r(d)==4)setTimeout(d.Ca.bind(d),0);else if(At(d,"readystatechange"),$r(d)==4){d.h=!1;try{const H=d.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var x;if(x=H===0){let le=String(d.D).match(zd)[1]||null;!le&&l.self&&l.self.location&&(le=l.self.location.protocol.slice(0,-1)),x=!Wd.test(le?le.toLowerCase():"")}E=x}if(E)At(d,"complete"),At(d,"success");else{d.o=6;try{var z=$r(d)>2?d.g.statusText:""}catch{z=""}d.l=z+" ["+d.ca()+"]",li(d)}}finally{Ss(d)}}}}function Ss(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const E=d.g;d.g=null,_||At(d,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function $r(d){return d.g?d.g.readyState:0}n.ca=function(){try{return $r(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),Cd(_)}};function Hd(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Sc(d){const _={};d=(d.g&&$r(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<d.length;x++){if(P(d[x]))continue;var E=Ia(d[x]);const z=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const H=_[z]||[];_[z]=H,H.push(E)}he(_,function(x){return x.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qr(d,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[d]||_}function Pa(d){this.za=0,this.i=[],this.j=new ni,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qr("baseRetryDelayMs",5e3,d),this.Za=qr("retryDelaySeedMs",1e4,d),this.Ta=qr("forwardChannelMaxRetries",2,d),this.va=qr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new xa(d&&d.concurrentRequestLimit),this.Ba=new yo,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Pa.prototype,n.ka=8,n.I=1,n.connect=function(d,_,E,x){bt(0),this.W=d,this.H=_||{},E&&x!==void 0&&(this.H.OSID=E,this.H.OAID=x),this.F=this.X,this.J=bc(this,null,this.W),As(this)};function ka(d){if(Ca(d),d.I==3){var _=d.V++,E=cr(d.J);if(Ze(E,"SID",d.M),Ze(E,"RID",_),Ze(E,"TYPE","terminate"),Wr(d,E),_=new lr(d,d.j,_),_.M=2,_.A=Is(cr(E)),E=!1,l.navigator&&l.navigator.sendBeacon)try{E=l.navigator.sendBeacon(_.A.toString(),"")}catch{}!E&&l.Image&&(new Image().src=_.A,E=!0),E||(_.g=Kd(_.j,null),_.g.ea(_.A)),_.F=Date.now(),lo(_)}wo(d)}function Jn(d){d.g&&(vo(d),d.g.cancel(),d.g=null)}function Ca(d){Jn(d),d.v&&(l.clearTimeout(d.v),d.v=null),Na(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&l.clearTimeout(d.m),d.m=null)}function As(d){if(!mc(d.h)&&!d.m){d.m=!0;var _=d.Ea;ne||b(),ae||(ne(),ae=!0),A.add(_,d),d.D=0}}function Gd(d,_){return uo(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=ti(p(d.Ea,d,_),Va(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const z=new lr(this,this.j,d);let H=this.o;if(this.U&&(H?(H=F(H),Re(H,this.U)):H=this.U),this.u!==null||this.R||(z.J=H,H=null),this.S)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var x=this.i[E];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(_+=x,_>4096){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=Ac(this,z,_),E=cr(this.J),Ze(E,"RID",d),Ze(E,"CVER",22),this.G&&Ze(E,"X-HTTP-Session-Id",this.G),Wr(this,E),H&&(this.R?_="headers="+Lr(qd(H))+"&"+_:this.u&&Ra(E,this.u,H)),Sa(this.h,z),this.Ra&&Ze(E,"TYPE","init"),this.S?(Ze(E,"$req",_),Ze(E,"SID","null"),z.U=!0,Er(z,E,null)):Er(z,E,_),this.I=2}}else this.I==3&&(d?_o(this,d):this.i.length==0||mc(this.h)||_o(this))};function _o(d,_){var E;_?E=_.l:E=d.V++;const x=cr(d.J);Ze(x,"SID",d.M),Ze(x,"RID",E),Ze(x,"AID",d.K),Wr(d,x),d.u&&d.o&&Ra(x,d.u,d.o),E=new lr(d,d.j,E,d.D+1),d.u===null&&(E.J=d.o),_&&(d.i=_.G.concat(d.i)),_=Ac(d,E,1e3),E.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Sa(d.h,E),Er(E,x,_)}function Wr(d,_){d.H&&ye(d.H,function(E,x){Ze(_,x,E)}),d.l&&ye({},function(E,x){Ze(_,x,E)})}function Ac(d,_,E){E=Math.min(d.i.length,E);const x=d.l?p(d.l.Ka,d.l,d):null;e:{var z=d.i;let Ve=-1;for(;;){const Nt=["count="+E];Ve==-1?E>0?(Ve=z[0].g,Nt.push("ofs="+Ve)):Ve=0:Nt.push("ofs="+Ve);let nt=!0;for(let Ut=0;Ut<E;Ut++){var H=z[Ut].g;const Xn=z[Ut].map;if(H-=Ve,H<0)Ve=Math.max(0,z[Ut].g-100),nt=!1;else try{H="req"+H+"_"||"";try{var le=Xn instanceof Map?Xn:Object.entries(Xn);for(const[bs,Gr]of le){let Kr=Gr;u(Gr)&&(Kr=Ys(Gr)),Nt.push(H+bs+"="+encodeURIComponent(Kr))}}catch(bs){throw Nt.push(H+"type="+encodeURIComponent("_badmap")),bs}}catch{x&&x(Xn)}}if(nt){le=Nt.join("&");break e}}le=void 0}return d=d.i.splice(0,E),_.G=d,le}function mn(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;ne||b(),ae||(ne(),ae=!0),A.add(_,d),d.A=0}}function Hr(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=ti(p(d.Da,d),Va(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,ci(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=ti(p(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,bt(10),Jn(this),ci(this))};function vo(d){d.B!=null&&(l.clearTimeout(d.B),d.B=null)}function ci(d){d.g=new lr(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=cr(d.na);Ze(_,"RID","rpc"),Ze(_,"SID",d.M),Ze(_,"AID",d.K),Ze(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ze(_,"TO",d.ia),Ze(_,"TYPE","xmlhttp"),Wr(d,_),d.u&&d.o&&Ra(_,d.u,d.o),d.O&&(d.g.H=d.O);var E=d.g;d=d.ba,E.M=1,E.A=Is(cr(_)),E.u=null,E.R=!0,fc(E,d)}n.Va=function(){this.C!=null&&(this.C=null,Jn(this),Hr(this),bt(19))};function Na(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function Da(d,_){var E=null;if(d.g==_){Na(d),vo(d),d.g=null;var x=2}else if(gc(d.h,_))E=_.G,ho(d.h,_),x=1;else return;if(d.I!=0){if(_.o)if(x==1){E=_.u?_.u.length:0,_=Date.now()-_.F;var z=d.D;x=ei(),At(x,new dc(x,E)),As(d)}else mn(d);else if(z=_.m,z==3||z==0&&_.X>0||!(x==1&&Gd(d,_)||x==2&&Hr(d)))switch(E&&E.length>0&&(_=d.h,_.i=_.i.concat(E)),z){case 1:Yn(d,5);break;case 4:Yn(d,10);break;case 3:Yn(d,6);break;default:Yn(d,2)}}}function Va(d,_){let E=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(E*=2),E*_}function Yn(d,_){if(d.j.info("Error code "+_),_==2){var E=p(d.bb,d),x=d.Ua;const z=!x;x=new Mr(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||fo(x,"https"),Is(x),z?Br(x.toString(),E):zr(x.toString(),E)}else bt(2);d.I=0,d.l&&d.l.pa(_),wo(d),Ca(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function wo(d){if(d.I=0,d.ja=[],d.l){const _=Gn(d.h);(_.length!=0||d.i.length!=0)&&(S(d.ja,_),S(d.ja,d.i),d.h.i.length=0,D(d.i),d.i.length=0),d.l.oa()}}function bc(d,_,E){var x=E instanceof Mr?cr(E):new Mr(E);if(x.g!="")_&&(x.g=_+"."+x.g),Fr(x,x.u);else{var z=l.location;x=z.protocol,_=_?_+"."+z.hostname:z.hostname,z=+z.port;const H=new Mr(null);x&&fo(H,x),_&&(H.g=_),z&&Fr(H,z),E&&(H.h=E),x=H}return E=d.G,_=d.wa,E&&_&&Ze(x,E,_),Ze(x,"VER",d.ka),Wr(d,x),x}function Kd(d,_,E){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new ot(new Ts({ab:E})):new ot(d.ma),_.Fa(d.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qd(){}n=Qd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Oa(){}Oa.prototype.g=function(d,_){return new an(d,_)};function an(d,_){at.call(this),this.g=new Pa(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!P(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!P(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new ui(this)}w(an,at),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){ka(this.g)},an.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var E={};E.__data__=d,d=E}else this.v&&(E={},E.__data__=Ys(d),d=E);_.i.push(new Up(_.Ya++,d)),_.I==3&&As(_)},an.prototype.N=function(){this.g.l=null,delete this.j,ka(this.g),delete this.g,an.Z.N.call(this)};function Jd(d){va.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const E in _){d=E;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}w(Jd,va);function Yd(){uc.call(this),this.status=1}w(Yd,uc);function ui(d){this.g=d}w(ui,Qd),ui.prototype.ra=function(){At(this.g,"a")},ui.prototype.qa=function(d){At(this.g,new Jd(d))},ui.prototype.pa=function(d){At(this.g,new Yd)},ui.prototype.oa=function(){At(this.g,"b")},Oa.prototype.createWebChannel=Oa.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,ix=function(){return new Oa},sx=function(){return ei()},rx=wr,Jg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ri.NO_ERROR=0,ri.TIMEOUT=8,ri.HTTP_ERROR=6,sf=ri,si.COMPLETE="complete",nx=si,Nd.EventType=Zs,Zs.OPEN="a",Zs.CLOSE="b",Zs.ERROR="c",Zs.MESSAGE="d",at.prototype.listen=at.prototype.J,fu=Nd,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,tx=ot}).apply(typeof Hh<"u"?Hh:typeof self<"u"?self:typeof window<"u"?window:{});const PI="@firebase/firestore",kI="4.9.3";class nn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nn.UNAUTHENTICATED=new nn(null),nn.GOOGLE_CREDENTIALS=new nn("google-credentials-uid"),nn.FIRST_PARTY=new nn("first-party-uid"),nn.MOCK_USER=new nn("mock-user");let Xl="12.7.0";const $i=new Jf("@firebase/firestore");function ul(){return $i.logLevel}function MV(n){$i.setLogLevel(n)}function Y(n,...e){if($i.logLevel<=Be.DEBUG){const t=e.map(d_);$i.debug(`Firestore (${Xl}): ${n}`,...t)}}function Ot(n,...e){if($i.logLevel<=Be.ERROR){const t=e.map(d_);$i.error(`Firestore (${Xl}): ${n}`,...t)}}function gs(n,...e){if($i.logLevel<=Be.WARN){const t=e.map(d_);$i.warn(`Firestore (${Xl}): ${n}`,...t)}}function d_(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function pe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ox(n,r,t)}function ox(n,e,t){let r=`FIRESTORE (${Xl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ot(r),new Error(r)}function we(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||ox(e,s,r)}function FV(n,e){n||pe(57014,e)}function de(n,e){return n}const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends rn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ax{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(nn.UNAUTHENTICATED)))}shutdown(){}}class UV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class BV{constructor(e){this.t=e,this.currentUser=nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){we(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new fn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new fn,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},u=f=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new fn)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string",31837,{l:r}),new ax(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new nn(e)}}class zV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=nn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $V{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new zV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(nn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class CI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,mt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){we(this.o===void 0,3512);const r=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new CI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(we(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new CI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function WV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class h_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=WV(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function De(n,e){return n<e?-1:n>e?1:0}function Yg(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),a=e.charAt(r);if(s!==a)return Sg(s)===Sg(a)?De(s,a):Sg(s)?1:-1}return De(n.length,e.length)}const HV=55296,GV=57343;function Sg(n){const e=n.charCodeAt(0);return e>=HV&&e<=GV}function bl(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function lx(n){return n+"\0"}const NI="__name__";class es{constructor(e,t,r){t===void 0?t=0:t>e.length&&pe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&pe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return es.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof es?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=es.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return De(e.length,t.length)}static compareSegments(e,t){const r=es.isNumericId(e),s=es.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?es.extractNumericId(e).compare(es.extractNumericId(t)):Yg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mi.fromString(e.substring(4,e.length-2))}}class ze extends es{construct(e,t,r){return new ze(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ze(t)}static emptyPath(){return new ze([])}}const KV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _t extends es{construct(e,t,r){return new _t(e,t,r)}static isValidIdentifier(e){return KV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_t.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===NI}static keyField(){return new _t([NI])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new Q(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new Q(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Q(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else u==="`"?(l=!l,s++):u!=="."||l?(r+=u,s++):(a(),s++)}if(a(),l)throw new Q(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _t(t)}static emptyPath(){return new _t([])}}class ce{constructor(e){this.path=e}static fromPath(e){return new ce(ze.fromString(e))}static fromName(e){return new ce(ze.fromString(e).popFirst(5))}static empty(){return new ce(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new ze(e.slice()))}}function f_(n,e,t){if(!t)throw new Q(W.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cx(n,e,t,r){if(e===!0&&r===!0)throw new Q(W.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function DI(n){if(!ce.isDocumentKey(n))throw new Q(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function VI(n){if(ce.isDocumentKey(n))throw new Q(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ux(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":pe(12329,{type:typeof n})}function Xe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Q(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lp(n);throw new Q(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function dx(n,e){if(e<=0)throw new Q(W.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function qt(n,e){const t={typeString:n};return e&&(t.value=e),t}function ud(n,e){if(!ux(n))throw new Q(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Q(W.INVALID_ARGUMENT,t);return!0}const OI=-62135596800,LI=1e6;class et{static now(){return et.fromMillis(Date.now())}static fromDate(e){return et.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*LI);return new et(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Q(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Q(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OI)throw new Q(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/LI}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ud(e,et._jsonSchema))return new et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-OI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}et._jsonSchemaVersion="firestore/timestamp/1.0",et._jsonSchema={type:qt("string",et._jsonSchemaVersion),seconds:qt("number"),nanoseconds:qt("number")};class Te{static fromTimestamp(e){return new Te(e)}static min(){return new Te(new et(0,0))}static max(){return new Te(new et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Rl=-1;class Rf{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Xg(n){return n.fields.find((e=>e.kind===2))}function Oo(n){return n.fields.filter((e=>e.kind!==2))}Rf.UNKNOWN_ID=-1;class of{constructor(e,t){this.fieldPath=e,this.kind=t}}class Bu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Bu(0,ar.min())}}function hx(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Te.fromTimestamp(r===1e9?new et(t+1,0):new et(t,r));return new ar(s,ce.empty(),e)}function fx(n){return new ar(n.readTime,n.key,Rl)}class ar{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ar(Te.min(),ce.empty(),Rl)}static max(){return new ar(Te.max(),ce.empty(),Rl)}}function p_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ce.comparator(n.documentKey,e.documentKey),t!==0?t:De(n.largestBatchId,e.largestBatchId))}const px="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function eo(n){if(n.code!==W.FAILED_PRECONDITION||n.message!==px)throw n;Y("LocalStore","Unexpectedly lost primary lease")}class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):U.reject(t)}static resolve(e){return new U(((t,r)=>{t(e)}))}static reject(e){return new U(((t,r)=>{r(e)}))}static waitFor(e){return new U(((t,r)=>{let s=0,a=0,l=!1;e.forEach((u=>{++s,u.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=U.resolve(!1);for(const r of e)t=t.next((s=>s?U.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new U(((r,s)=>{const a=e.length,l=new Array(a);let u=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((g=>{l[p]=g,++u,u===a&&r(l)}),(g=>s(g)))}}))}static doWhile(e,t){return new U(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}const nr="SimpleDb";class cp{static open(e,t,r,s){try{return new cp(t,e.transaction(s,r))}catch(a){throw new xu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new fn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new xu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=m_(r.target.error);this.S.reject(new xu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Y(nr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new JV(t)}}class hs{static delete(e){return Y(nr,"Removing database:",e),Mo(Vy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Vu())return!1;if(hs.F())return!0;const e=xt(),t=hs.M(e),r=0<t&&t<10,s=gx(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,hs.M(xt())===12.2&&Ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Y(nr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new xu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new Q(W.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new Q(W.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new xu(e,l))},s.onupgradeneeded=a=>{Y(nr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{Y(nr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=cp.open(this.db,e,a?"readonly":"readwrite",r),f=s(u).next((p=>(u.C(),p))).catch((p=>(u.abort(p),U.reject(p)))).toPromise();return f.catch((()=>{})),await u.D,f}catch(u){const f=u,p=f.name!=="FirebaseError"&&l<3;if(Y(nr,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function gx(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class QV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Mo(this.U.delete())}}class xu extends Q{constructor(e,t){super(W.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function to(n){return n.name==="IndexedDbTransactionError"}class JV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Y(nr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Y(nr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mo(r)}add(e){return Y(nr,"ADD",this.store.name,e,e),Mo(this.store.add(e))}get(e){return Mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),Y(nr,"GET",this.store.name,e,t),t)))}delete(e){return Y(nr,"DELETE",this.store.name,e),Mo(this.store.delete(e))}count(){return Y(nr,"COUNT",this.store.name),Mo(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new U(((l,u)=>{a.onerror=f=>{u(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.H(a,((u,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new U(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){Y(nr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const s=this.cursor(r);return this.H(s,((a,l,u)=>u.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}te(e){const t=this.cursor({});return new U(((r,s)=>{t.onerror=a=>{const l=m_(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():r()})):r()}}))}H(e,t){const r=[];return new U(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void s();const f=new QV(u),p=t(u.primaryKey,u.value,f);if(p instanceof U){const g=p.catch((w=>(f.done(),U.reject(w))));r.push(g)}f.isDone?s():f.G===null?u.continue():u.continue(f.G)}})).next((()=>U.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Mo(n){return new U(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=m_(r.target.error);t(s)}}))}let MI=!1;function m_(n){const e=hs.M(xt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return MI||(MI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Su="IndexBackfiller";class YV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Y(Su,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Y(Su,`Documents written: ${t}`)}catch(t){to(t)?Y(Su,"Ignoring IndexedDB error during index backfill: ",t):await eo(t)}await this.re(6e4)}))}}class XV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let s=t,a=!0;return U.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return Y(Su,`Processing collection: ${l}`),this.oe(e,l,s).next((u=>{s-=u,r.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((u=>(Y(Su,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=fx(a);p_(l,r)>0&&(r=l)})),new ar(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bn.ce=-1;const Fi=-1;function dd(n){return n==null}function zu(n){return n===0&&1/n==-1/0}function yx(n){return typeof n=="number"&&Number.isInteger(n)&&!zu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Pf="";function xn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=FI(e)),e=ZV(n.get(t),e);return FI(e)}function ZV(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Pf:t+="";break;default:t+=a}}return t}function FI(n){return n+Pf+""}function us(n){const e=n.length;if(we(e>=2,64408,{path:n}),e===2)return we(n.charAt(0)===Pf&&n.charAt(1)==="",56145,{path:n}),ze.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Pf,a);switch((l<0||l>t)&&pe(50515,{path:n}),n.charAt(l+1)){case"":const u=n.substring(a,l);let f;s.length===0?f=u:(s+=u,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:pe(61167,{path:n})}a=l+2}return new ze(r)}const Lo="remoteDocuments",hd="owner",sl="owner",$u="mutationQueues",eO="userId",Pr="mutations",jI="batchId",$o="userMutationsIndex",UI=["userId","batchId"];function af(n,e){return[n,xn(e)]}function _x(n,e,t){return[n,xn(e),t]}const tO={},Pl="documentMutations",kf="remoteDocumentsV14",nO=["prefixPath","collectionGroup","readTime","documentId"],lf="documentKeyIndex",rO=["prefixPath","collectionGroup","documentId"],vx="collectionGroupIndex",sO=["collectionGroup","readTime","prefixPath","documentId"],qu="remoteDocumentGlobal",Zg="remoteDocumentGlobalKey",kl="targets",wx="queryTargetsIndex",iO=["canonicalId","targetId"],Cl="targetDocuments",oO=["targetId","path"],g_="documentTargetsIndex",aO=["path","targetId"],Cf="targetGlobalKey",Qo="targetGlobal",Wu="collectionParents",lO=["collectionId","parent"],Nl="clientMetadata",cO="clientId",up="bundles",uO="bundleId",dp="namedQueries",dO="name",y_="indexConfiguration",hO="indexId",ey="collectionGroupIndex",fO="collectionGroup",Au="indexState",pO=["indexId","uid"],Ex="sequenceNumberIndex",mO=["uid","sequenceNumber"],bu="indexEntries",gO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ix="documentKeyIndex",yO=["indexId","uid","orderedDocumentKey"],hp="documentOverlays",_O=["userId","collectionPath","documentId"],ty="collectionPathOverlayIndex",vO=["userId","collectionPath","largestBatchId"],Tx="collectionGroupOverlayIndex",wO=["userId","collectionGroup","largestBatchId"],__="globals",EO="name",xx=[$u,Pr,Pl,Lo,kl,hd,Qo,Cl,Nl,qu,Wu,up,dp],IO=[...xx,hp],Sx=[$u,Pr,Pl,kf,kl,hd,Qo,Cl,Nl,qu,Wu,up,dp,hp],Ax=Sx,v_=[...Ax,y_,Au,bu],TO=v_,bx=[...v_,__],xO=bx;class ny extends mx{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Kt(n,e){const t=de(n);return hs.O(t.le,e)}function BI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function no(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Rx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ut{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new ut(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gh(this.root,e,this.comparator,!0)}}class Gh{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??un.RED,this.left=s??un.EMPTY,this.right=a??un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new un(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return un.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pe(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1;un.EMPTY=new class{constructor(){this.size=0}get key(){throw pe(57766)}get value(){throw pe(16141)}get color(){throw pe(16727)}get left(){throw pe(29726)}get right(){throw pe(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class st{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zI(this.data.getIterator())}getIteratorFrom(e){return new zI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class zI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function il(n){return n.hasNext()?n.getNext():void 0}class zn{constructor(e){this.fields=e,e.sort(_t.comparator)}static empty(){return new zn([])}unionWith(e){let t=new st(_t.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Px extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function SO(){return typeof atob<"u"}class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Px("Invalid base64 string: "+a):a}})(e);return new Pt(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new Pt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const AO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zs(n){if(we(!!n,39018),typeof n=="string"){let e=0;const t=AO.exec(n);if(we(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(n.seconds),nanos:yt(n.nanos)}}function yt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function $s(n){return typeof n=="string"?Pt.fromBase64String(n):Pt.fromUint8Array(n)}const kx="server_timestamp",Cx="__type__",Nx="__previous_value__",Dx="__local_write_time__";function fp(n){return(n?.mapValue?.fields||{})[Cx]?.stringValue===kx}function pp(n){const e=n.mapValue.fields[Nx];return fp(e)?pp(e):e}function Hu(n){const e=zs(n.mapValue.fields[Dx].timestampValue);return new et(e.seconds,e.nanos)}class bO{constructor(e,t,r,s,a,l,u,f,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=g}}const ry="(default)";class qi{constructor(e,t){this.projectId=e,this.database=t||ry}static empty(){return new qi("","")}get isDefaultDatabase(){return this.database===ry}isEqual(e){return e instanceof qi&&e.projectId===this.projectId&&e.database===this.database}}const w_="__type__",Vx="__max__",Ni={mapValue:{fields:{__type__:{stringValue:Vx}}}},E_="__vector__",Dl="value",cf={nullValue:"NULL_VALUE"};function Wi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fp(n)?4:Ox(n)?9007199254740991:mp(n)?10:11:pe(28295,{value:n})}function ys(n,e){if(n===e)return!0;const t=Wi(n);if(t!==Wi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Hu(n).isEqual(Hu(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=zs(s.timestampValue),u=zs(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return $s(s.bytesValue).isEqual($s(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return yt(s.geoPointValue.latitude)===yt(a.geoPointValue.latitude)&&yt(s.geoPointValue.longitude)===yt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return yt(s.integerValue)===yt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=yt(s.doubleValue),u=yt(a.doubleValue);return l===u?zu(l)===zu(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return bl(n.arrayValue.values||[],e.arrayValue.values||[],ys);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},u=a.mapValue.fields||{};if(BI(l)!==BI(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!ys(l[f],u[f])))return!1;return!0})(n,e);default:return pe(52216,{left:n})}}function Gu(n,e){return(n.values||[]).find((t=>ys(t,e)))!==void 0}function Hi(n,e){if(n===e)return 0;const t=Wi(n),r=Wi(e);if(t!==r)return De(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return De(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const u=yt(a.integerValue||a.doubleValue),f=yt(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(n,e);case 3:return $I(n.timestampValue,e.timestampValue);case 4:return $I(Hu(n),Hu(e));case 5:return Yg(n.stringValue,e.stringValue);case 6:return(function(a,l){const u=$s(a),f=$s(l);return u.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const u=a.split("/"),f=l.split("/");for(let p=0;p<u.length&&p<f.length;p++){const g=De(u[p],f[p]);if(g!==0)return g}return De(u.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const u=De(yt(a.latitude),yt(l.latitude));return u!==0?u:De(yt(a.longitude),yt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return qI(n.arrayValue,e.arrayValue);case 10:return(function(a,l){const u=a.fields||{},f=l.fields||{},p=u[Dl]?.arrayValue,g=f[Dl]?.arrayValue,w=De(p?.values?.length||0,g?.values?.length||0);return w!==0?w:qI(p,g)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Ni.mapValue&&l===Ni.mapValue)return 0;if(a===Ni.mapValue)return 1;if(l===Ni.mapValue)return-1;const u=a.fields||{},f=Object.keys(u),p=l.fields||{},g=Object.keys(p);f.sort(),g.sort();for(let w=0;w<f.length&&w<g.length;++w){const T=Yg(f[w],g[w]);if(T!==0)return T;const D=Hi(u[f[w]],p[g[w]]);if(D!==0)return D}return De(f.length,g.length)})(n.mapValue,e.mapValue);default:throw pe(23264,{he:t})}}function $I(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return De(n,e);const t=zs(n),r=zs(e),s=De(t.seconds,r.seconds);return s!==0?s:De(t.nanos,r.nanos)}function qI(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=Hi(t[s],r[s]);if(a)return a}return De(t.length,r.length)}function Vl(n){return sy(n)}function sy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=zs(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return $s(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ce.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=sy(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${sy(t.fields[l])}`;return s+"}"})(n.mapValue):pe(61005,{value:n})}function uf(n){switch(Wi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=pp(n);return e?16+uf(e):16;case 5:return 2*n.stringValue.length;case 6:return $s(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+uf(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return no(r.fields,((a,l)=>{s+=a.length+uf(l)})),s})(n.mapValue);default:throw pe(13486,{value:n})}}function ta(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function iy(n){return!!n&&"integerValue"in n}function Ku(n){return!!n&&"arrayValue"in n}function WI(n){return!!n&&"nullValue"in n}function HI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function df(n){return!!n&&"mapValue"in n}function mp(n){return(n?.mapValue?.fields||{})[w_]?.stringValue===E_}function Ru(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return no(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Ru(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ru(n.arrayValue.values[t]);return e}return{...n}}function Ox(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Vx}const Lx={mapValue:{fields:{[w_]:{stringValue:E_},[Dl]:{arrayValue:{}}}}};function RO(n){return"nullValue"in n?cf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ta(qi.empty(),ce.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?mp(n)?Lx:{mapValue:{}}:pe(35942,{value:n})}function PO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ta(qi.empty(),ce.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Lx:"mapValue"in n?mp(n)?{mapValue:{}}:Ni:pe(61959,{value:n})}function GI(n,e){const t=Hi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function KI(n,e){const t=Hi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!df(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ru(t)}setAll(e){let t=_t.emptyPath(),r={},s=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=u.popLast()}l?r[u.lastSegment()]=Ru(l):s.push(u.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());df(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ys(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];df(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){no(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new dn(Ru(this.value))}}function Mx(n){const e=[];return no(n.fields,((t,r)=>{const s=new _t([t]);if(df(r)){const a=Mx(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new zn(e)}class pt{constructor(e,t,r,s,a,l,u){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(e){return new pt(e,0,Te.min(),Te.min(),Te.min(),dn.empty(),0)}static newFoundDocument(e,t,r,s){return new pt(e,1,t,Te.min(),r,s,0)}static newNoDocument(e,t){return new pt(e,2,t,Te.min(),Te.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new pt(e,3,t,Te.min(),Te.min(),dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Gi{constructor(e,t){this.position=e,this.inclusive=t}}function QI(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=ce.comparator(ce.fromName(l.referenceValue),t.key):r=Hi(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function JI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ys(n.position[t],e.position[t]))return!1;return!0}class Qu{constructor(e,t="asc"){this.field=e,this.dir=t}}function kO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Fx{}class $e extends Fx{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new CO(e,t,r):t==="array-contains"?new VO(e,r):t==="in"?new qx(e,r):t==="not-in"?new OO(e,r):t==="array-contains-any"?new LO(e,r):new $e(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new NO(e,r):new DO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Hi(t,this.value)):t!==null&&Wi(this.value)===Wi(t)&&this.matchesComparison(Hi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rt extends Fx{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new rt(e,t)}matches(e){return Ol(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ol(n){return n.op==="and"}function oy(n){return n.op==="or"}function I_(n){return jx(n)&&Ol(n)}function jx(n){for(const e of n.filters)if(e instanceof rt)return!1;return!0}function ay(n){if(n instanceof $e)return n.field.canonicalString()+n.op.toString()+Vl(n.value);if(I_(n))return n.filters.map((e=>ay(e))).join(",");{const e=n.filters.map((t=>ay(t))).join(",");return`${n.op}(${e})`}}function Ux(n,e){return n instanceof $e?(function(r,s){return s instanceof $e&&r.op===s.op&&r.field.isEqual(s.field)&&ys(r.value,s.value)})(n,e):n instanceof rt?(function(r,s){return s instanceof rt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,u)=>a&&Ux(l,s.filters[u])),!0):!1})(n,e):void pe(19439)}function Bx(n,e){const t=n.filters.concat(e);return rt.create(t,n.op)}function zx(n){return n instanceof $e?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vl(t.value)}`})(n):n instanceof rt?(function(t){return t.op.toString()+" {"+t.getFilters().map(zx).join(" ,")+"}"})(n):"Filter"}class CO extends $e{constructor(e,t,r){super(e,t,r),this.key=ce.fromName(r.referenceValue)}matches(e){const t=ce.comparator(e.key,this.key);return this.matchesComparison(t)}}class NO extends $e{constructor(e,t){super(e,"in",t),this.keys=$x("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class DO extends $e{constructor(e,t){super(e,"not-in",t),this.keys=$x("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $x(n,e){return(e.arrayValue?.values||[]).map((t=>ce.fromName(t.referenceValue)))}class VO extends $e{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ku(t)&&Gu(t.arrayValue,this.value)}}class qx extends $e{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Gu(this.value.arrayValue,t)}}class OO extends $e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Gu(this.value.arrayValue,t)}}class LO extends $e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ku(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Gu(this.value.arrayValue,r)))}}class MO{constructor(e,t=null,r=[],s=[],a=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=u,this.Te=null}}function ly(n,e=null,t=[],r=[],s=null,a=null,l=null){return new MO(n,e,t,r,s,a,l)}function na(n){const e=de(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ay(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),dd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Vl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Vl(r))).join(",")),e.Te=t}return e.Te}function fd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!kO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ux(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!JI(n.startAt,e.startAt)&&JI(n.endAt,e.endAt)}function Nf(n){return ce.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Df(n,e){return n.filters.filter((t=>t instanceof $e&&t.field.isEqual(e)))}function YI(n,e,t){let r=cf,s=!0;for(const a of Df(n,e)){let l=cf,u=!0;switch(a.op){case"<":case"<=":l=RO(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,u=!1;break;case"!=":case"not-in":l=cf}GI({value:r,inclusive:s},{value:l,inclusive:u})<0&&(r=l,s=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];GI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function XI(n,e,t){let r=Ni,s=!0;for(const a of Df(n,e)){let l=Ni,u=!0;switch(a.op){case">=":case">":l=PO(a.value),u=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,u=!1;break;case"!=":case"not-in":l=Ni}KI({value:r,inclusive:s},{value:l,inclusive:u})>0&&(r=l,s=u)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];KI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}class Hs{constructor(e,t=null,r=[],s=[],a=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Wx(n,e,t,r,s,a,l,u){return new Hs(n,e,t,r,s,a,l,u)}function Zl(n){return new Hs(n)}function ZI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function T_(n){return n.collectionGroup!==null}function El(n){const e=de(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new st(_t.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(u=u.add(p.field))}))})),u})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Qu(a,r))})),t.has(_t.keyField().canonicalString())||e.Ie.push(new Qu(_t.keyField(),r))}return e.Ie}function kn(n){const e=de(n);return e.Ee||(e.Ee=FO(e,El(n))),e.Ee}function FO(n,e){if(n.limitType==="F")return ly(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Qu(s.field,a)}));const t=n.endAt?new Gi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Gi(n.startAt.position,n.startAt.inclusive):null;return ly(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cy(n,e){const t=n.filters.concat([e]);return new Hs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vf(n,e,t){return new Hs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pd(n,e){return fd(kn(n),kn(e))&&n.limitType===e.limitType}function Hx(n){return`${na(kn(n))}|lt:${n.limitType}`}function dl(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>zx(s))).join(", ")}]`),dd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Vl(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Vl(s))).join(",")),`Target(${r})`})(kn(n))}; limitType=${n.limitType})`}function md(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ce.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of El(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,u,f){const p=QI(l,u,f);return l.inclusive?p<=0:p<0})(r.startAt,El(r),s)||r.endAt&&!(function(l,u,f){const p=QI(l,u,f);return l.inclusive?p>=0:p>0})(r.endAt,El(r),s))})(n,e)}function Gx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Kx(n){return(e,t)=>{let r=!1;for(const s of El(n)){const a=jO(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function jO(n,e,t){const r=n.field.isKeyField()?ce.comparator(e.key,t.key):(function(a,l,u){const f=l.data.field(a),p=u.data.field(a);return f!==null&&p!==null?Hi(f,p):pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return pe(19790,{direction:n.dir})}}class Gs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){no(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return Rx(this.inner)}size(){return this.innerSize}}const UO=new ut(ce.comparator);function $n(){return UO}const Qx=new ut(ce.comparator);function pu(...n){let e=Qx;for(const t of n)e=e.insert(t.key,t);return e}function Jx(n){let e=Qx;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ds(){return Pu()}function Yx(){return Pu()}function Pu(){return new Gs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const BO=new ut(ce.comparator),zO=new st(ce.comparator);function Me(...n){let e=zO;for(const t of n)e=e.add(t);return e}const $O=new st(De);function x_(){return $O}function S_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zu(e)?"-0":e}}function Xx(n){return{integerValue:""+n}}function Zx(n,e){return yx(e)?Xx(e):S_(n,e)}class gp{constructor(){this._=void 0}}function qO(n,e,t){return n instanceof Ll?(function(s,a){const l={fields:{[Cx]:{stringValue:kx},[Dx]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&fp(a)&&(a=pp(a)),a&&(l.fields[Nx]=a),{mapValue:l}})(t,e):n instanceof ra?tS(n,e):n instanceof sa?nS(n,e):(function(s,a){const l=eS(s,a),u=e0(l)+e0(s.Ae);return iy(l)&&iy(s.Ae)?Xx(u):S_(s.serializer,u)})(n,e)}function WO(n,e,t){return n instanceof ra?tS(n,e):n instanceof sa?nS(n,e):t}function eS(n,e){return n instanceof Ml?(function(r){return iy(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Ll extends gp{}class ra extends gp{constructor(e){super(),this.elements=e}}function tS(n,e){const t=rS(e);for(const r of n.elements)t.some((s=>ys(s,r)))||t.push(r);return{arrayValue:{values:t}}}class sa extends gp{constructor(e){super(),this.elements=e}}function nS(n,e){let t=rS(e);for(const r of n.elements)t=t.filter((s=>!ys(s,r)));return{arrayValue:{values:t}}}class Ml extends gp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function e0(n){return yt(n.integerValue||n.doubleValue)}function rS(n){return Ku(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class gd{constructor(e,t){this.field=e,this.transform=t}}function HO(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof ra&&s instanceof ra||r instanceof sa&&s instanceof sa?bl(r.elements,s.elements,ys):r instanceof Ml&&s instanceof Ml?ys(r.Ae,s.Ae):r instanceof Ll&&s instanceof Ll})(n.transform,e.transform)}class GO{constructor(e,t){this.version=e,this.transformResults=t}}class vt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vt}static exists(e){return new vt(void 0,e)}static updateTime(e){return new vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class yp{}function sS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new tc(n.key,vt.none()):new ec(n.key,n.data,vt.none());{const t=n.data,r=dn.empty();let s=new st(_t.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new Ks(n.key,r,new zn(s.toArray()),vt.none())}}function KO(n,e,t){n instanceof ec?(function(s,a,l){const u=s.value.clone(),f=n0(s.fieldTransforms,a,l.transformResults);u.setAll(f),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Ks?(function(s,a,l){if(!hf(s.precondition,a))return void a.convertToUnknownDocument(l.version);const u=n0(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(iS(s)),f.setAll(u),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function ku(n,e,t,r){return n instanceof ec?(function(a,l,u,f){if(!hf(a.precondition,l))return u;const p=a.value.clone(),g=r0(a.fieldTransforms,f,l);return p.setAll(g),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ks?(function(a,l,u,f){if(!hf(a.precondition,l))return u;const p=r0(a.fieldTransforms,f,l),g=l.data;return g.setAll(iS(a)),g.setAll(p),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((w=>w.field)))})(n,e,t,r):(function(a,l,u){return hf(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function QO(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=eS(r.transform,s||null);a!=null&&(t===null&&(t=dn.empty()),t.set(r.field,a))}return t||null}function t0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bl(r,s,((a,l)=>HO(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ec extends yp{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ks extends yp{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function iS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function n0(n,e,t){const r=new Map;we(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,u=e.data.field(a.field);r.set(a.field,WO(l,u,t[s]))}return r}function r0(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,qO(a,l,e))}return r}class tc extends yp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A_ extends yp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class b_{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&KO(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ku(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ku(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Yx();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=t.has(s.key)?null:u;const f=sS(l,u);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Te.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Me())}isEqual(e){return this.batchId===e.batchId&&bl(this.mutations,e.mutations,((t,r)=>t0(t,r)))&&bl(this.baseMutations,e.baseMutations,((t,r)=>t0(t,r)))}}class R_{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){we(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return BO})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new R_(e,t,r,s)}}class P_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class JO{constructor(e,t){this.count=e,this.unchangedNames=t}}var zt,He;function oS(n){switch(n){case W.OK:return pe(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return pe(15467,{code:n})}}function aS(n){if(n===void 0)return Ot("GRPC error has no .code"),W.UNKNOWN;switch(n){case zt.OK:return W.OK;case zt.CANCELLED:return W.CANCELLED;case zt.UNKNOWN:return W.UNKNOWN;case zt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case zt.INTERNAL:return W.INTERNAL;case zt.UNAVAILABLE:return W.UNAVAILABLE;case zt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case zt.NOT_FOUND:return W.NOT_FOUND;case zt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case zt.ABORTED:return W.ABORTED;case zt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case zt.DATA_LOSS:return W.DATA_LOSS;default:return pe(39323,{code:n})}}(He=zt||(zt={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";function lS(){return new TextEncoder}const YO=new Mi([4294967295,4294967295],0);function s0(n){const e=lS().encode(n),t=new ex;return t.update(e),new Uint8Array(t.digest())}function i0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Mi([t,r],0),new Mi([s,a],0)]}class k_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mu(`Invalid padding: ${t}`);if(r<0)throw new mu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Mi.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Mi.fromNumber(r)));return s.compare(YO)===1&&(s=new Mi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=s0(e),[r,s]=i0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);if(!this.we(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new k_(a,s,t);return r.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=s0(e),[r,s]=i0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class mu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class yd{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,_d.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new yd(Te.min(),s,new ut(De),$n(),Me())}}class _d{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new _d(r,t,Me(),Me(),Me())}}class ff{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class cS{constructor(e,t){this.targetId=e,this.Ce=t}}class uS{constructor(e,t,r=Pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class o0{constructor(){this.ve=0,this.Fe=a0(),this.Me=Pt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Me(),t=Me(),r=Me();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:pe(38017,{changeType:a})}})),new _d(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=a0()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class XO{constructor(e){this.Ge=e,this.ze=new Map,this.je=$n(),this.Je=Kh(),this.He=Kh(),this.Ye=new ut(De)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:pe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(Nf(a))if(r===0){const l=new ce(a.path);this.et(t,l,pt.newNoDocument(l,Te.min()))}else we(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const u=this.ut(e),f=u?this.ct(u,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,u;try{l=$s(r).toUint8Array()}catch(f){if(f instanceof Px)return gs("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new k_(l,s,a)}catch(f){return gs(f instanceof mu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(u)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const u=this.ot(l);if(u){if(a.current&&Nf(u.target)){const f=new ce(u.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,pt.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let r=Me();this.He.forEach(((a,l)=>{let u=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new yd(e,t,this.Ye,this.je,r);return this.je=$n(),this.Je=Kh(),this.He=Kh(),this.Ye=new ut(De),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new o0,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new st(De),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new st(De),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Y("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new o0),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Kh(){return new ut(ce.comparator)}function a0(){return new ut(ce.comparator)}const ZO={asc:"ASCENDING",desc:"DESCENDING"},eL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tL={and:"AND",or:"OR"};class nL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function uy(n,e){return n.useProto3Json||dd(e)?e:{value:e}}function Fl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function rL(n,e){return Fl(n,e.toTimestamp())}function Lt(n){return we(!!n,49232),Te.fromTimestamp((function(t){const r=zs(t);return new et(r.seconds,r.nanos)})(n))}function C_(n,e){return dy(n,e).canonicalString()}function dy(n,e){const t=(function(s){return new ze(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function hS(n){const e=ze.fromString(n);return we(IS(e),10190,{key:e.toString()}),e}function Ju(n,e){return C_(n.databaseId,e.path)}function fs(n,e){const t=hS(e);if(t.get(1)!==n.databaseId.projectId)throw new Q(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Q(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ce(mS(t))}function fS(n,e){return C_(n.databaseId,e)}function pS(n){const e=hS(n);return e.length===4?ze.emptyPath():mS(e)}function hy(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function mS(n){return we(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function l0(n,e,t){return{name:Ju(n,e),fields:t.value.mapValue.fields}}function gS(n,e,t){const r=fs(n,e.name),s=Lt(e.updateTime),a=e.createTime?Lt(e.createTime):Te.min(),l=new dn({mapValue:{fields:e.fields}}),u=pt.newFoundDocument(r,s,a,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function sL(n,e){return"found"in e?(function(r,s){we(!!s.found,43571),s.found.name,s.found.updateTime;const a=fs(r,s.found.name),l=Lt(s.found.updateTime),u=s.found.createTime?Lt(s.found.createTime):Te.min(),f=new dn({mapValue:{fields:s.found.fields}});return pt.newFoundDocument(a,l,u,f)})(n,e):"missing"in e?(function(r,s){we(!!s.missing,3894),we(!!s.readTime,22933);const a=fs(r,s.missing),l=Lt(s.readTime);return pt.newNoDocument(a,l)})(n,e):pe(7234,{result:e})}function iL(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:pe(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,g){return p.useProto3Json?(we(g===void 0||typeof g=="string",58123),Pt.fromBase64String(g||"")):(we(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Pt.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(p){const g=p.code===void 0?W.UNKNOWN:aS(p.code);return new Q(g,p.message||"")})(l);t=new uS(r,s,a,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=fs(n,r.document.name),a=Lt(r.document.updateTime),l=r.document.createTime?Lt(r.document.createTime):Te.min(),u=new dn({mapValue:{fields:r.document.fields}}),f=pt.newFoundDocument(s,a,l,u),p=r.targetIds||[],g=r.removedTargetIds||[];t=new ff(p,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=fs(n,r.document),a=r.readTime?Lt(r.readTime):Te.min(),l=pt.newNoDocument(s,a),u=r.removedTargetIds||[];t=new ff([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=fs(n,r.document),a=r.removedTargetIds||[];t=new ff([],a,s,null)}else{if(!("filter"in e))return pe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new JO(s,a),u=r.targetId;t=new cS(u,l)}}return t}function Yu(n,e){let t;if(e instanceof ec)t={update:l0(n,e.key,e.value)};else if(e instanceof tc)t={delete:Ju(n,e.key)};else if(e instanceof Ks)t={update:l0(n,e.key,e.data),updateMask:dL(e.fieldMask)};else{if(!(e instanceof A_))return pe(16599,{Vt:e.type});t={verify:Ju(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const u=l.transform;if(u instanceof Ll)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ra)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof sa)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ml)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw pe(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:rL(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:pe(27497)})(n,e.precondition)),t}function fy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?vt.updateTime(Lt(a.updateTime)):a.exists!==void 0?vt.exists(a.exists):vt.none()})(e.currentDocument):vt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,u){let f=null;if("setToServerValue"in u)we(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),f=new Ll;else if("appendMissingElements"in u){const g=u.appendMissingElements.values||[];f=new ra(g)}else if("removeAllFromArray"in u){const g=u.removeAllFromArray.values||[];f=new sa(g)}else"increment"in u?f=new Ml(l,u.increment):pe(16584,{proto:u});const p=_t.fromServerFormat(u.fieldPath);return new gd(p,f)})(n,s))):[];if(e.update){e.update.name;const s=fs(n,e.update.name),a=new dn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new zn(p.map((g=>_t.fromServerFormat(g))))})(e.updateMask);return new Ks(s,a,l,t,r)}return new ec(s,a,t,r)}if(e.delete){const s=fs(n,e.delete);return new tc(s,t)}if(e.verify){const s=fs(n,e.verify);return new A_(s,t)}return pe(1463,{proto:e})}function oL(n,e){return n&&n.length>0?(we(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Lt(s.updateTime):Lt(a);return l.isEqual(Te.min())&&(l=Lt(a)),new GO(l,s.transformResults||[])})(t,e)))):[]}function yS(n,e){return{documents:[fS(n,e.path)]}}function _S(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=fS(n,s);const a=(function(p){if(p.length!==0)return ES(rt.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((g=>(function(T){return{field:hl(T.field),direction:lL(T.dir)}})(g)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=uy(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function vS(n){let e=pS(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){we(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=(function(w){const T=wS(w);return T instanceof rt&&I_(T)?T.getFilters():[T]})(t.where));let l=[];t.orderBy&&(l=(function(w){return w.map((T=>(function(S){return new Qu(fl(S.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(T)))})(t.orderBy));let u=null;t.limit&&(u=(function(w){let T;return T=typeof w=="object"?w.value:w,dd(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(w){const T=!!w.before,D=w.values||[];return new Gi(D,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(w){const T=!w.before,D=w.values||[];return new Gi(D,T)})(t.endAt)),Wx(e,s,l,a,u,"F",f,p)}function aL(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=fl(t.unaryFilter.field);return $e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=fl(t.unaryFilter.field);return $e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=fl(t.unaryFilter.field);return $e.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=fl(t.unaryFilter.field);return $e.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pe(61313);default:return pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return $e.create(fl(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pe(58110);default:return pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return rt.create(t.compositeFilter.filters.map((r=>wS(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return pe(1026)}})(t.compositeFilter.op))})(n):pe(30097,{filter:n})}function lL(n){return ZO[n]}function cL(n){return eL[n]}function uL(n){return tL[n]}function hl(n){return{fieldPath:n.canonicalString()}}function fl(n){return _t.fromServerFormat(n.fieldPath)}function ES(n){return n instanceof $e?(function(t){if(t.op==="=="){if(HI(t.value))return{unaryFilter:{field:hl(t.field),op:"IS_NAN"}};if(WI(t.value))return{unaryFilter:{field:hl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(HI(t.value))return{unaryFilter:{field:hl(t.field),op:"IS_NOT_NAN"}};if(WI(t.value))return{unaryFilter:{field:hl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hl(t.field),op:cL(t.op),value:t.value}}})(n):n instanceof rt?(function(t){const r=t.getFilters().map((s=>ES(s)));return r.length===1?r[0]:{compositeFilter:{op:uL(t.op),filters:r}}})(n):pe(54877,{filter:n})}function dL(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function IS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ms{constructor(e,t,r,s,a=Te.min(),l=Te.min(),u=Pt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Ms(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ms(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ms(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ms(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TS{constructor(e){this.yt=e}}function hL(n,e){let t;if(e.document)t=gS(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ce.fromSegments(e.noDocument.path),s=oa(e.noDocument.readTime);t=pt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return pe(56709);{const r=ce.fromSegments(e.unknownDocument.path),s=oa(e.unknownDocument.version);t=pt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new et(s[0],s[1]);return Te.fromTimestamp(a)})(e.readTime)),t}function c0(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Of(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:Ju(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Fl(a,l.version.toTimestamp()),createTime:Fl(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ia(e.version)};else{if(!e.isUnknownDocument())return pe(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:ia(e.version)}}return r}function Of(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ia(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function oa(n){const e=new et(n.seconds,n.nanoseconds);return Te.fromTimestamp(e)}function Fo(n,e){const t=(e.baseMutations||[]).map((a=>fy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const u=e.mutations[a+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>fy(n.yt,a))),s=et.fromMillis(e.localWriteTimeMs);return new b_(e.batchId,s,t,r)}function gu(n){const e=oa(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?oa(n.lastLimboFreeSnapshotVersion):Te.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return we(l===1,1966,{count:l}),kn(Zl(pS(a.documents[0])))})(n.query):(function(a){return kn(vS(a))})(n.query),new Ms(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Pt.fromBase64String(n.resumeToken))}function xS(n,e){const t=ia(e.snapshotVersion),r=ia(e.lastLimboFreeSnapshotVersion);let s;s=Nf(e.target)?yS(n.yt,e.target):_S(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:na(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function N_(n){const e=vS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vf(e,e.limit,"L"):e}function Ag(n,e){return new P_(e.largestBatchId,fy(n.yt,e.overlayMutation))}function u0(n,e){const t=e.path.lastSegment();return[n,xn(e.path.popLast()),t]}function d0(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ia(r.readTime),documentKey:xn(r.documentKey.path),largestBatchId:r.largestBatchId}}class fL{getBundleMetadata(e,t){return h0(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:oa(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return h0(e).put((function(s){return{bundleId:s.id,createTime:ia(Lt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return f0(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:N_(a.bundledQuery),readTime:oa(a.readTime)}})(r)}))}saveNamedQuery(e,t){return f0(e).put((function(s){return{name:s.name,readTime:ia(Lt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function h0(n){return Kt(n,up)}function f0(n){return Kt(n,dp)}class _p{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new _p(e,r)}getOverlay(e,t){return su(e).get(u0(this.userId,t)).next((r=>r?Ag(this.serializer,r):null))}getOverlays(e,t){const r=ds();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const u=new P_(t,l);s.push(this.St(e,u))})),U.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(xn(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(su(e).Z(ty,u))})),U.waitFor(a)}getOverlaysForCollection(e,t,r){const s=ds(),a=xn(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return su(e).J(ty,l).next((u=>{for(const f of u){const p=Ag(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=ds();let l;const u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return su(e).ee({index:Tx,range:u},((f,p,g)=>{const w=Ag(this.serializer,p);a.size()<s||w.largestBatchId===l?(a.set(w.getKey(),w),l=w.largestBatchId):g.done()})).next((()=>a))}St(e,t){return su(e).put((function(s,a,l){const[u,f,p]=u0(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Yu(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function su(n){return Kt(n,hp)}class pL{bt(e){return Kt(e,__)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Pt.fromUint8Array(r):Pt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class jo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(yt(e.integerValue));else if("doubleValue"in e){const r=yt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),zu(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=zs(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt($s(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Ox(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):mp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):pe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const s=Dl,a=r[s].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(yt(a)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),ce.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jo.Kt=new jo;const ol=255;function mL(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function p0(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=mL(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class gL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),r=p0(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=p0(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(ol),this.sn(255)}_n(){this.an(ol),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ol?(this.sn(ol),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ol?(this.an(ol),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class yL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class _L{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class iu{constructor(){this.cn=new gL,this.ln=new yL(this.cn),this.hn=new _L(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Uo{constructor(e,t,r,s){this.Tn=e,this.In=t,this.En=r,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Uo(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:pf(this.En),directionalValue:pf(this.dn),orderedDocumentKey:pf(t),documentKey:r.path.toArray()}}Vn(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ai(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=m0(n.En,e.En),t!==0?t:(t=m0(n.dn,e.dn),t!==0?t:ce.comparator(n.In,e.In)))}function m0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function pf(n){return BT()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function g0(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class y0{constructor(e){this.mn=new st(((t,r)=>_t.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(we(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Xg(e);if(t!==void 0&&!this.wn(t))return!1;const r=Oo(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.wn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!s.has(u.field.canonicalString())){const f=r[a];if(!this.Sn(u,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<r.length;++a){const u=r[a];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new st(_t.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new of(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new of(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new of(r.field,r.dir==="asc"?0:1)));return new Rf(Rf.UNKNOWN_ID,this.collectionId,t,Bu.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function SS(n){if(we(n instanceof $e||n instanceof rt,20012),n instanceof $e){if(n instanceof qx){const t=n.value.arrayValue?.values?.map((r=>$e.create(n.field,"==",r)))||[];return rt.create(t,"or")}return n}const e=n.filters.map((t=>SS(t)));return rt.create(e,n.op)}function vL(n){if(n.getFilters().length===0)return[];const e=gy(SS(n));return we(AS(e),7391),py(e)||my(e)?[e]:e.getFilters()}function py(n){return n instanceof $e}function my(n){return n instanceof rt&&I_(n)}function AS(n){return py(n)||my(n)||(function(t){if(t instanceof rt&&oy(t)){for(const r of t.getFilters())if(!py(r)&&!my(r))return!1;return!0}return!1})(n)}function gy(n){if(we(n instanceof $e||n instanceof rt,34018),n instanceof $e)return n;if(n.filters.length===1)return gy(n.filters[0]);const e=n.filters.map((r=>gy(r)));let t=rt.create(e,n.op);return t=Lf(t),AS(t)?t:(we(t instanceof rt,64498),we(Ol(t),40251),we(t.filters.length>1,57927),t.filters.reduce(((r,s)=>D_(r,s))))}function D_(n,e){let t;return we(n instanceof $e||n instanceof rt,38388),we(e instanceof $e||e instanceof rt,25473),t=n instanceof $e?e instanceof $e?(function(s,a){return rt.create([s,a],"and")})(n,e):_0(n,e):e instanceof $e?_0(e,n):(function(s,a){if(we(s.filters.length>0&&a.filters.length>0,48005),Ol(s)&&Ol(a))return Bx(s,a.getFilters());const l=oy(s)?s:a,u=oy(s)?a:s,f=l.filters.map((p=>D_(p,u)));return rt.create(f,"or")})(n,e),Lf(t)}function _0(n,e){if(Ol(e))return Bx(e,n.getFilters());{const t=e.filters.map((r=>D_(n,r)));return rt.create(t,"or")}}function Lf(n){if(we(n instanceof $e||n instanceof rt,11850),n instanceof $e)return n;const e=n.getFilters();if(e.length===1)return Lf(e[0]);if(jx(n))return n;const t=e.map((s=>Lf(s))),r=[];return t.forEach((s=>{s instanceof $e?r.push(s):s instanceof rt&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:rt.create(r,n.op)}class wL{constructor(){this.Cn=new V_}addToCollectionParentIndex(e,t){return this.Cn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(ar.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(ar.min())}updateCollectionGroup(e,t,r){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class V_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new st(ze.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new st(ze.comparator)).toArray()}}const v0="IndexedDbIndexManager",Qh=new Uint8Array(0);class EL{constructor(e,t){this.databaseId=t,this.vn=new V_,this.Fn=new Gs((r=>na(r)),((r,s)=>fd(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:xn(s)};return w0(e).put(a)}return U.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[lx(t),""],!1,!0);return w0(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(us(l.parent))}return r}))}addFieldIndex(e,t){const r=ou(e),s=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=ll(e);return a.next((u=>{l.put(d0(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=ou(e),s=ll(e),a=al(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ou(e),r=al(e),s=ll(e);return t.Z().next((()=>r.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return U.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new y0(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=al(e);let s=!0;const a=new Map;return U.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{s&&(s=!!u),a.set(l,u)})))).next((()=>{if(s){let l=Me();const u=[];return U.forEach(a,((f,p)=>{Y(v0,`Using index ${(function(Z){return`id=${Z.indexId}|cg=${Z.collectionGroup}|f=${Z.fields.map((ge=>`${ge.fieldPath}:${ge.kind}`)).join(",")}`})(f)} to execute ${na(t)}`);const g=(function(Z,ge){const ne=Xg(ge);if(ne===void 0)return null;for(const ae of Df(Z,ne.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null})(p,f),w=(function(Z,ge){const ne=new Map;for(const ae of Oo(ge))for(const A of Df(Z,ae.fieldPath))switch(A.op){case"==":case"in":ne.set(ae.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return ne.set(ae.fieldPath.canonicalString(),A.value),Array.from(ne.values())}return null})(p,f),T=(function(Z,ge){const ne=[];let ae=!0;for(const A of Oo(ge)){const b=A.kind===0?YI(Z,A.fieldPath,Z.startAt):XI(Z,A.fieldPath,Z.startAt);ne.push(b.value),ae&&(ae=b.inclusive)}return new Gi(ne,ae)})(p,f),D=(function(Z,ge){const ne=[];let ae=!0;for(const A of Oo(ge)){const b=A.kind===0?XI(Z,A.fieldPath,Z.endAt):YI(Z,A.fieldPath,Z.endAt);ne.push(b.value),ae&&(ae=b.inclusive)}return new Gi(ne,ae)})(p,f),S=this.On(f,p,T),O=this.On(f,p,D),L=this.Nn(f,p,w),se=this.Bn(f.indexId,g,S,T.inclusive,O,D.inclusive,L);return U.forEach(se,(oe=>r.Y(oe,t.limit).next((Z=>{Z.forEach((ge=>{const ne=ce.fromSegments(ge.documentKey);l.has(ne)||(l=l.add(ne),u.push(ne))}))}))))})).next((()=>u))}return U.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=vL(rt.create(e.filters,"and")).map((r=>ly(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,s,a,l,u){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),p=f/(t!=null?t.length:1),g=[];for(let w=0;w<f;++w){const T=t?this.Ln(t[w/p]):Qh,D=this.kn(e,T,r[w%p],s),S=this.qn(e,T,a[w%p],l),O=u.map((L=>this.kn(e,T,L,!0)));g.push(...this.createRange(D,S,O))}return g}kn(e,t,r,s){const a=new Uo(e,ce.empty(),t,r);return s?a:a.An()}qn(e,t,r,s){const a=new Uo(e,ce.empty(),t,r);return s?a.An():a}xn(e,t){const r=new y0(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const u of a)r.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let r=2;const s=this.Mn(t);return U.forEach(s,(a=>this.xn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let p=new st(_t.comparator),g=!1;for(const w of f.filters)for(const T of w.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?g=!0:p=p.add(T.field));for(const w of f.orderBy)w.field.isKeyField()||(p=p.add(w.field));return p.size+(g?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}Qn(e,t){const r=new iu;for(const s of Oo(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.Pn(s.kind);jo.Kt.Dt(a,l)}return r.un()}Ln(e){const t=new iu;return jo.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new iu;return jo.Kt.Dt(ta(this.databaseId,t),r.Pn((function(a){const l=Oo(a);return l.length===0?0:l[l.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let s=[];s.push(new iu);let a=0;for(const l of Oo(e)){const u=r[a++];for(const f of s)if(this.Un(t,l.fieldPath)&&Ku(u))s=this.Kn(s,l,u);else{const p=f.Pn(l.kind);jo.Kt.Dt(u,p)}}return this.Wn(s)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const u of s){const f=new iu;f.seed(u.un()),jo.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof $e&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=ou(e),s=ll(e);return(t?r.J(ey,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const l=[];return U.forEach(a,(u=>s.get([u.indexId,this.uid]).next((f=>{l.push((function(g,w){const T=w?new Bu(w.sequenceNumber,new ar(oa(w.readTime),new ce(us(w.documentKey)),w.largestBatchId)):Bu.empty(),D=g.fields.map((([S,O])=>new of(_t.fromServerFormat(S),O)));return new Rf(g.indexId,g.collectionGroup,D,T)})(u,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:De(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=ou(e),a=ll(e);return this.Gn(e).next((l=>s.J(ey,IDBKeyRange.bound(t,t)).next((u=>U.forEach(u,(f=>a.put(d0(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return U.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?U.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((u=>(r.set(s.collectionGroup,u),U.forEach(u,(f=>this.zn(e,s,f).next((p=>{const g=this.jn(a,f);return p.isEqual(g)?U.resolve():this.Jn(e,a,f,p,g)})))))))}))}Hn(e,t,r,s){return al(e).put(s.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,s){return al(e).delete(s.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const s=al(e);let a=new st(Ai);return s.ee({index:Ix,range:IDBKeyRange.only([r.indexId,this.uid,pf(this.$n(r,t))])},((l,u)=>{a=a.add(new Uo(r.indexId,t,g0(u.arrayValue),g0(u.directionalValue)))})).next((()=>a))}jn(e,t){let r=new st(Ai);const s=this.Qn(t,e);if(s==null)return r;const a=Xg(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Ku(l))for(const u of l.arrayValue.values||[])r=r.add(new Uo(t.indexId,e.key,this.Ln(u),s))}else r=r.add(new Uo(t.indexId,e.key,Qh,s));return r}Jn(e,t,r,s,a){Y(v0,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,g,w,T){const D=f.getIterator(),S=p.getIterator();let O=il(D),L=il(S);for(;O||L;){let se=!1,oe=!1;if(O&&L){const Z=g(O,L);Z<0?oe=!0:Z>0&&(se=!0)}else O!=null?oe=!0:se=!0;se?(w(L),L=il(S)):oe?(T(O),O=il(D)):(O=il(D),L=il(S))}})(s,a,Ai,(u=>{l.push(this.Hn(e,t,r,u))}),(u=>{l.push(this.Yn(e,t,r,u))})),U.waitFor(l)}Gn(e){let t=1;return ll(e).ee({index:Ex,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,u)=>Ai(l,u))).filter(((l,u,f)=>!u||Ai(l,f[u-1])!==0));const s=[];s.push(e);for(const l of r){const u=Ai(l,e),f=Ai(l,t);if(u===0)s[0]=e.An();else if(u>0&&f<0)s.push(l),s.push(l.An());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const u=s[l].Vn(this.uid,Qh,ce.empty()),f=s[l+1].Vn(this.uid,Qh,ce.empty());a.push(IDBKeyRange.bound(u,f))}return a}Zn(e,t){return Ai(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(E0)}getMinOffset(e,t){return U.mapArray(this.Mn(t),(r=>this.xn(e,r).next((s=>s||pe(44426))))).next(E0)}}function w0(n){return Kt(n,Wu)}function al(n){return Kt(n,bu)}function ou(n){return Kt(n,y_)}function ll(n){return Kt(n,Au)}function E0(n){we(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;p_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new ar(e.readTime,e.documentKey,t)}const I0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bS=41943040;class En{static withCacheSize(e){return new En(e,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function RS(n,e,t){const r=n.store(Pr),s=n.store(Pl),a=[],l=IDBKeyRange.only(t.batchId);let u=0;const f=r.ee({range:l},((g,w,T)=>(u++,T.delete())));a.push(f.next((()=>{we(u===1,47070,{batchId:t.batchId})})));const p=[];for(const g of t.mutations){const w=_x(e,g.key.path,t.batchId);a.push(s.delete(w)),p.push(g.key)}return U.waitFor(a).next((()=>p))}function Mf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw pe(14731);e=n.noDocument}return JSON.stringify(e).length}En.DEFAULT_COLLECTION_PERCENTILE=10,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,En.DEFAULT=new En(bS,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),En.DISABLED=new En(-1,0,0);class vp{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,t,r,s){we(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new vp(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bi(e).ee({index:$o,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=pl(e),l=bi(e);return l.add({}).next((u=>{we(typeof u=="number",49019);const f=new b_(u,t,r,s),p=(function(D,S,O){const L=O.baseMutations.map((oe=>Yu(D.yt,oe))),se=O.mutations.map((oe=>Yu(D.yt,oe)));return{userId:S,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:L,mutations:se}})(this.serializer,this.userId,f),g=[];let w=new st(((T,D)=>De(T.canonicalString(),D.canonicalString())));for(const T of s){const D=_x(this.userId,T.key.path,u);w=w.add(T.key.path.popLast()),g.push(l.put(p)),g.push(a.put(D,tO))}return w.forEach((T=>{g.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Xn[u]=f.keys()})),U.waitFor(g).next((()=>f))}))}lookupMutationBatch(e,t){return bi(e).get(t).next((r=>r?(we(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Fo(this.serializer,r)):null))}er(e,t){return this.Xn[t]?U.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return bi(e).ee({index:$o,range:s},((l,u,f)=>{u.userId===this.userId&&(we(u.batchId>=r,47524,{tr:r}),a=Fo(this.serializer,u)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Fi;return bi(e).ee({index:$o,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Fi],[this.userId,Number.POSITIVE_INFINITY]);return bi(e).J($o,t).next((r=>r.map((s=>Fo(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=af(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return pl(e).ee({range:s},((l,u,f)=>{const[p,g,w]=l,T=us(g);if(p===this.userId&&t.path.isEqual(T))return bi(e).get(w).next((D=>{if(!D)throw pe(61480,{nr:l,batchId:w});we(D.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:D.userId,batchId:w}),a.push(Fo(this.serializer,D))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new st(De);const s=[];return t.forEach((a=>{const l=af(this.userId,a.path),u=IDBKeyRange.lowerBound(l),f=pl(e).ee({range:u},((p,g,w)=>{const[T,D,S]=p,O=us(D);T===this.userId&&a.path.isEqual(O)?r=r.add(S):w.done()}));s.push(f)})),U.waitFor(s).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=af(this.userId,r),l=IDBKeyRange.lowerBound(a);let u=new st(De);return pl(e).ee({range:l},((f,p,g)=>{const[w,T,D]=f,S=us(T);w===this.userId&&r.isPrefixOf(S)?S.length===s&&(u=u.add(D)):g.done()})).next((()=>this.rr(e,u)))}rr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(bi(e).get(a).next((l=>{if(l===null)throw pe(35274,{batchId:a});we(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Fo(this.serializer,l))})))})),U.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return RS(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),U.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return U.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return pl(e).ee({range:r},((a,l,u)=>{if(a[0]===this.userId){const f=us(a[1]);s.push(f)}else u.done()})).next((()=>{we(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return PS(e,this.userId,t)}_r(e){return kS(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Fi,lastStreamToken:""}))}}function PS(n,e,t){const r=af(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return pl(n).ee({range:a,X:!0},((u,f,p)=>{const[g,w,T]=u;g===e&&w===s&&(l=!0),p.done()})).next((()=>l))}function bi(n){return Kt(n,Pr)}function pl(n){return Kt(n,Pl)}function kS(n){return Kt(n,$u)}class aa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new aa(0)}static cr(){return new aa(-1)}}class IL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new aa(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Te.fromTimestamp(new et(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>cl(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(we(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return cl(e).ee(((l,u)=>{const f=gu(u);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>U.waitFor(a))).next((()=>s))}forEachTarget(e,t){return cl(e).ee(((r,s)=>{const a=gu(s);t(a)}))}lr(e){return T0(e).get(Cf).next((t=>(we(t!==null,2888),t)))}hr(e,t){return T0(e).put(Cf,t)}Pr(e,t){return cl(e).put(xS(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=na(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return cl(e).ee({range:s,index:wx},((l,u,f)=>{const p=gu(u);fd(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=ki(e);return t.forEach((l=>{const u=xn(l.path);s.push(a.put({targetId:r,path:u})),s.push(this.referenceDelegate.addReference(e,r,l))})),U.waitFor(s)}removeMatchingKeys(e,t,r){const s=ki(e);return U.forEach(t,(a=>{const l=xn(a.path);return U.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=ki(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=ki(e);let a=Me();return s.ee({range:r,X:!0},((l,u,f)=>{const p=us(l[1]),g=new ce(p);a=a.add(g)})).next((()=>a))}containsKey(e,t){const r=xn(t.path),s=IDBKeyRange.bound([r],[lx(r)],!1,!0);let a=0;return ki(e).ee({index:g_,X:!0,range:s},(([l,u],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return cl(e).get(t).next((r=>r?gu(r):null))}}function cl(n){return Kt(n,kl)}function T0(n){return Kt(n,Qo)}function ki(n){return Kt(n,Cl)}const x0="LruGarbageCollector",TL=1048576;function S0([n,e],[t,r]){const s=De(n,t);return s===0?De(e,r):s}class xL{constructor(e){this.Ir=e,this.buffer=new st(S0),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();S0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class CS{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(x0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){to(t)?Y(x0,"Ignoring IndexedDB error during garbage collection: ",t):await eo(t)}await this.Vr(3e5)}))}}class SL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(Bn.ce);const r=new xL(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(I0)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),I0):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,a,l,u,f,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),s=this.params.maximumSequenceNumbersToCollect):s=w,l=Date.now(),this.nthSequenceNumber(e,s)))).next((w=>(r=w,u=Date.now(),this.removeTargets(e,r,t)))).next((w=>(a=w,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((w=>(p=Date.now(),ul()<=Be.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${s} in `+(u-l)+`ms
	Removed ${a} targets in `+(f-u)+`ms
	Removed ${w} documents in `+(p-f)+`ms
Total Duration: ${p-g}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:w}))))}}function NS(n,e){return new SL(n,e)}class AL{constructor(e,t){this.db=e,this.garbageCollector=NS(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,s)=>t(s)))}addReference(e,t,r){return Jh(e,r)}removeReference(e,t,r){return Jh(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Jh(e,t)}br(e,t){return(function(s,a){let l=!1;return kS(s).te((u=>PS(s,u,a).next((f=>(f&&(l=!0),U.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,u)=>{if(u<=t){const f=this.br(e,l).next((p=>{if(!p)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,Te.min()),ki(e).delete((function(w){return[0,xn(w.path)]})(l)))))}));s.push(f)}})).next((()=>U.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Jh(e,t)}Sr(e,t){const r=ki(e);let s,a=Bn.ce;return r.ee({index:g_},(([l,u],{path:f,sequenceNumber:p})=>{l===0?(a!==Bn.ce&&t(new ce(us(s)),a),a=p,s=f):a=Bn.ce})).next((()=>{a!==Bn.ce&&t(new ce(us(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Jh(n,e){return ki(n).put((function(r,s){return{targetId:0,path:xn(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}class DS{constructor(){this.changes=new Gs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?U.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Do(e).put(r)}removeEntry(e,t,r){return Do(e).delete((function(a,l){const u=a.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Of(l),u[u.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=pt.newInvalidDocument(t);return Do(e).ee({index:lf,range:IDBKeyRange.only(au(t))},((s,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:pt.newInvalidDocument(t)};return Do(e).ee({index:lf,range:IDBKeyRange.only(au(t))},((s,a)=>{r={document:this.Cr(t,a),size:Mf(a)}})).next((()=>r))}getEntries(e,t){let r=$n();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);r=r.insert(s,l)})).next((()=>r))}Mr(e,t){let r=$n(),s=new ut(ce.comparator);return this.Fr(e,t,((a,l)=>{const u=this.Cr(a,l);r=r.insert(a,u),s=s.insert(a,Mf(l))})).next((()=>({documents:r,Or:s})))}Fr(e,t,r){if(t.isEmpty())return U.resolve();let s=new st(R0);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(au(s.first()),au(s.last())),l=s.getIterator();let u=l.getNext();return Do(e).ee({index:lf,range:a},((f,p,g)=>{const w=ce.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;u&&R0(u,w)<0;)r(u,null),u=l.getNext();u&&u.isEqual(w)&&(r(u,p),u=l.hasNext()?l.getNext():null),u?g.j(au(u)):g.done()})).next((()=>{for(;u;)r(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),Of(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Do(e).J(IDBKeyRange.bound(u,f,!0)).next((p=>{a?.incrementDocumentReadCount(p.length);let g=$n();for(const w of p){const T=this.Cr(ce.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);T.isFoundDocument()&&(md(t,T)||s.has(T.key))&&(g=g.insert(T.key,T))}return g}))}getAllFromCollectionGroup(e,t,r,s){let a=$n();const l=b0(t,r),u=b0(t,ar.max());return Do(e).ee({index:vx,range:IDBKeyRange.bound(l,u,!0)},((f,p,g)=>{const w=this.Cr(ce.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(w.key,w),a.size===s&&g.done()})).next((()=>a))}newChangeBuffer(e){return new RL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return A0(e).get(Zg).next((t=>(we(!!t,20021),t)))}Dr(e,t){return A0(e).put(Zg,t)}Cr(e,t){if(t){const r=hL(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Te.min())))return r}return pt.newInvalidDocument(e)}}function VS(n){return new bL(n)}class RL extends DS{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Gs((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new st(((a,l)=>De(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const u=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,u.readTime)),l.isValidDocument()){const f=c0(this.Nr.serializer,l);s=s.add(a.path.popLast());const p=Mf(f);r+=p-u.size,t.push(this.Nr.addEntry(e,a,f))}else if(r-=u.size,this.trackRemovals){const f=c0(this.Nr.serializer,l.convertToNoDocument(Te.min()));t.push(this.Nr.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),U.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function A0(n){return Kt(n,qu)}function Do(n){return Kt(n,kf)}function au(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function b0(n,e){const t=e.documentKey.path.toArray();return[n,Of(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function R0(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=De(t[a],r[a]),s)return s;return s=De(t.length,r.length),s||(s=De(t[t.length-2],r[r.length-2]),s||De(t[t.length-1],r[r.length-1]))}class PL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class OS{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&ku(r.mutation,s,zn.empty(),et.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Me()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Me()){const s=ds();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=pu();return a.forEach(((u,f)=>{l=l.insert(u,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=ds();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Me())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,r,s){let a=$n();const l=Pu(),u=(function(){return Pu()})();return t.forEach(((f,p)=>{const g=r.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof Ks)?a=a.insert(p.key,p):g!==void 0?(l.set(p.key,g.mutation.getFieldMask()),ku(g.mutation,p,g.mutation.getFieldMask(),et.now())):l.set(p.key,zn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,g)=>l.set(p,g))),t.forEach(((p,g)=>u.set(p,new PL(g,l.get(p)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Pu();let s=new ut(((l,u)=>l-u)),a=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let g=r.get(f)||zn.empty();g=u.applyToLocalView(p,g),r.set(f,g);const w=(s.get(u.batchId)||Me()).add(f);s=s.insert(u.batchId,w)}))})).next((()=>{const l=[],u=s.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),p=f.key,g=f.value,w=Yx();g.forEach((T=>{if(!a.has(T)){const D=sS(t.get(T),r.get(T));D!==null&&w.set(T,D),a=a.add(T)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,w))}return U.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return ce.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):T_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):U.resolve(ds());let u=Rl,f=a;return l.next((p=>U.forEach(p,((g,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),a.get(g)?U.resolve():this.remoteDocumentCache.getEntry(e,g).next((T=>{f=f.insert(g,T)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Me()))).next((g=>({batchId:u,changes:Jx(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ce(t)).next((r=>{let s=pu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=pu();return this.indexManager.getCollectionParents(e,a).next((u=>U.forEach(u,(f=>{const p=(function(w,T){return new Hs(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((g=>{g.forEach(((w,T)=>{l=l.insert(w,T)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,p)=>{const g=p.getKey();l.get(g)===null&&(l=l.insert(g,pt.newInvalidDocument(g)))}));let u=pu();return l.forEach(((f,p)=>{const g=a.get(f);g!==void 0&&ku(g.mutation,p,zn.empty(),et.now()),md(t,p)&&(u=u.insert(f,p))})),u}))}}class kL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return U.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Lt(s.createTime)}})(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:N_(s.bundledQuery),readTime:Lt(s.readTime)}})(t)),U.resolve()}}class CL{constructor(){this.overlays=new ut(ce.comparator),this.qr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ds();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.St(e,t,a)})),U.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,t,r){const s=ds(),a=t.length+1,l=new ce(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return U.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new ut(((p,g)=>p-g));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let g=a.get(p.largestBatchId);g===null&&(g=ds(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=ds(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,g)=>u.set(p,g))),!(u.size()>=s)););return U.resolve(u)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new P_(t,r));let a=this.qr.get(t);a===void 0&&(a=Me(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class NL{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}}class O_{constructor(){this.Qr=new st(tn.$r),this.Ur=new st(tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new tn(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new tn(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ce(new ze([])),r=new tn(t,e),s=new tn(t,e+1),a=[];return this.Ur.forEachInRange([r,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ce(new ze([])),r=new tn(t,e),s=new tn(t,e+1);let a=Me();return this.Ur.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new tn(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class tn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ce.comparator(e.key,t.key)||De(e.Yr,t.Yr)}static Kr(e,t){return De(e.Yr,t.Yr)||ce.comparator(e.key,t.key)}}class DL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new st(tn.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new b_(a,t,r,s);this.mutationQueue.push(l);for(const u of s)this.Zr=this.Zr.add(new tn(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return U.resolve(l)}lookupMutationBatch(e,t){return U.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),a=s<0?0:s;return U.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Fi:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new tn(t,0),s=new tn(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,s],(l=>{const u=this.Xr(l.Yr);a.push(u)})),U.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new st(De);return t.forEach((s=>{const a=new tn(s,0),l=new tn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(u=>{r=r.add(u.Yr)}))})),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;ce.isDocumentKey(a)||(a=a.child(""));const l=new tn(new ce(a),0);let u=new st(De);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(u=u.add(f.Yr)),!0)}),l),U.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){we(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(t.mutations,(s=>{const a=new tn(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new tn(t,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class VL{constructor(e){this.ri=e,this.docs=(function(){return new ut(ce.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return U.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(t))}getEntries(e,t){let r=$n();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():pt.newInvalidDocument(s))})),U.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=$n();const l=t.path,u=new ce(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:p,value:{document:g}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||p_(fx(g),r)<=0||(s.has(g.key)||md(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return U.resolve(a)}getAllFromCollectionGroup(e,t,r,s){pe(9500)}ii(e,t){return U.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new OL(this)}getSize(e){return U.resolve(this.size)}}class OL extends DS{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),U.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class LL{constructor(e){this.persistence=e,this.si=new Gs((t=>na(t)),fd),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.oi=0,this._i=new O_,this.targetCount=0,this.ai=aa.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),U.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new aa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.Pr(t),U.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)})),U.waitFor(a).next((()=>s))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return U.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),U.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),U.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return U.resolve(r)}containsKey(e,t){return U.resolve(this._i.containsKey(t))}}class L_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Bn(0),this.li=!1,this.li=!0,this.hi=new NL,this.referenceDelegate=e(this),this.Pi=new LL(this),this.indexManager=new wL,this.remoteDocumentCache=(function(s){return new VL(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new TS(t),this.Ii=new kL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new CL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new DL(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Y("MemoryPersistence","Starting transaction:",e);const s=new ML(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return U.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class ML extends mx{constructor(e){super(),this.currentSequenceNumber=e}}class wp{constructor(e){this.persistence=e,this.Ri=new O_,this.Vi=null}static mi(e){return new wp(e)}get fi(){if(this.Vi)return this.Vi;throw pe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),U.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,(r=>{const s=ce.fromPath(r);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Te.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ff{constructor(e,t){this.persistence=e,this.pi=new Gs((r=>xn(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=NS(this,t)}static mi(e,t){return new Ff(e,t)}Ei(){}di(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return U.forEach(this.pi,((r,s)=>this.br(e,r,s).next((a=>a?U.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((u=>{u||(r++,a.removeEntry(l,Te.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=uf(e.data.value)),t}br(e,t,r){return U.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class FL{constructor(e){this.serializer=e}k(e,t,r,s){const a=new cp("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore(hd)})(e),(function(f){f.createObjectStore($u,{keyPath:eO}),f.createObjectStore(Pr,{keyPath:jI,autoIncrement:!0}).createIndex($o,UI,{unique:!0}),f.createObjectStore(Pl)})(e),P0(e),(function(f){f.createObjectStore(Lo)})(e));let l=U.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Cl),f.deleteObjectStore(kl),f.deleteObjectStore(Qo)})(e),P0(e)),l=l.next((()=>(function(f){const p=f.store(Qo),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Te.min().toTimestamp(),targetCount:0};return p.put(Cf,g)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,p){return p.store(Pr).J().next((w=>{f.deleteObjectStore(Pr),f.createObjectStore(Pr,{keyPath:jI,autoIncrement:!0}).createIndex($o,UI,{unique:!0});const T=p.store(Pr),D=w.map((S=>T.put(S)));return U.waitFor(D)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Nl,{keyPath:cO})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.yi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(qu)})(e),this.wi(a))))),r<7&&s>=7&&(l=l.next((()=>this.Si(a)))),r<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.Di(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(up,{keyPath:uO})})(e),(function(f){f.createObjectStore(dp,{keyPath:dO})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(hp,{keyPath:_O});p.createIndex(ty,vO,{unique:!1}),p.createIndex(Tx,wO,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(kf,{keyPath:nO});p.createIndex(lf,rO),p.createIndex(vx,sO)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Lo)))),r<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(y_,{keyPath:hO,autoIncrement:!0}).createIndex(ey,fO,{unique:!1}),f.createObjectStore(Au,{keyPath:pO}).createIndex(Ex,mO,{unique:!1}),f.createObjectStore(bu,{keyPath:gO}).createIndex(Ix,yO,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(Au).clear()})).next((()=>{t.objectStore(bu).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(__,{keyPath:EO})})(e)}))),r<18&&s>=18&&BT()&&(l=l.next((()=>{t.objectStore(Au).clear()})).next((()=>{t.objectStore(bu).clear()}))),l}wi(e){let t=0;return e.store(Lo).ee(((r,s)=>{t+=Mf(s)})).next((()=>{const r={byteSize:t};return e.store(qu).put(Zg,r)}))}yi(e){const t=e.store($u),r=e.store(Pr);return t.J().next((s=>U.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Fi],[a.userId,a.lastAcknowledgedBatchId]);return r.J($o,l).next((u=>U.forEach(u,(f=>{we(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Fo(this.serializer,f);return RS(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(Cl),r=e.store(Lo);return e.store(Qo).get(Cf).next((s=>{const a=[];return r.ee(((l,u)=>{const f=new ze(l),p=(function(w){return[0,xn(w)]})(f);a.push(t.get(p).next((g=>g?U.resolve():(w=>t.put({targetId:0,path:xn(w),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>U.waitFor(a)))}))}bi(e,t){e.createObjectStore(Wu,{keyPath:lO});const r=t.store(Wu),s=new V_,a=l=>{if(s.add(l)){const u=l.lastSegment(),f=l.popLast();return r.put({collectionId:u,parent:xn(f)})}};return t.store(Lo).ee({X:!0},((l,u)=>{const f=new ze(l);return a(f.popLast())})).next((()=>t.store(Pl).ee({X:!0},(([l,u,f],p)=>{const g=us(u);return a(g.popLast())}))))}Di(e){const t=e.store(kl);return t.ee(((r,s)=>{const a=gu(s),l=xS(this.serializer,a);return t.put(l)}))}Ci(e,t){const r=t.store(Lo),s=[];return r.ee(((a,l)=>{const u=t.store(kf),f=(function(w){return w.document?new ce(ze.fromString(w.document.name).popFirst(5)):w.noDocument?ce.fromSegments(w.noDocument.path):w.unknownDocument?ce.fromSegments(w.unknownDocument.path):pe(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(u.put(p))})).next((()=>U.waitFor(s)))}Fi(e,t){const r=t.store(Pr),s=VS(this.serializer),a=new L_(wp.mi,this.serializer.yt);return r.J().next((l=>{const u=new Map;return l.forEach((f=>{let p=u.get(f.userId)??Me();Fo(this.serializer,f).keys().forEach((g=>p=p.add(g))),u.set(f.userId,p)})),U.forEach(u,((f,p)=>{const g=new nn(p),w=_p.wt(this.serializer,g),T=a.getIndexManager(g),D=vp.wt(g,this.serializer,T,a.referenceDelegate);return new OS(s,D,w,T).recalculateAndSaveOverlaysForDocumentKeys(new ny(t,Bn.ce),f).next()}))}))}}function P0(n){n.createObjectStore(Cl,{keyPath:oO}).createIndex(g_,aO,{unique:!0}),n.createObjectStore(kl,{keyPath:"targetId"}).createIndex(wx,iO,{unique:!0}),n.createObjectStore(Qo)}const Ri="IndexedDbPersistence",bg=18e5,Rg=5e3,Pg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",LS="main";class M_{constructor(e,t,r,s,a,l,u,f,p,g,w=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=l,this.document=u,this.xi=p,this.Oi=g,this.Ni=w,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!M_.v())throw new Q(W.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new AL(this,s),this.$i=t+LS,this.serializer=new TS(f),this.Ui=new hs(this.$i,this.Ni,new FL(this.serializer)),this.hi=new pL,this.Pi=new IL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=VS(this.serializer),this.Ii=new fL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,g===!1&&Ot(Ri,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(W.FAILED_PRECONDITION,Pg);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Bn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Yh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(to(e))return Y(Ri,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Y(Ri,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return lu(e).get(sl).next((t=>U.resolve(this.es(t))))}ts(e){return Yh(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,bg)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Kt(t,Nl);return r.J().next((s=>{const a=this.ss(s,bg),l=s.filter((u=>a.indexOf(u)===-1));return U.forEach(l,(u=>r.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?U.resolve(!0):lu(e).get(sl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Rg)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Q(W.FAILED_PRECONDITION,Pg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yh(e).J().next((r=>this.ss(r,Rg).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,u=this.networkEnabled===s.networkEnabled;if(a||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Y(Ri,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[hd,Nl],(e=>{const t=new ny(e,Bn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Yh(e).J().next((t=>this.ss(t,bg).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return vp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new EL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return _p.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Y(Ri,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?xO:f===17?bx:f===16?TO:f===15?v_:f===14?Ax:f===13?Sx:f===12?IO:f===11?xx:void pe(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(u=>(l=new ny(u,this.ci?this.ci.next():Bn.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Q(W.FAILED_PRECONDITION,px);return r(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>r(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return lu(e).get(sl).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Rg)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Q(W.FAILED_PRECONDITION,Pg)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return lu(e).put(sl,t)}static v(){return hs.v()}Zi(e){const t=lu(e);return t.get(sl).next((r=>this.es(r)?(Y(Ri,"Releasing primary lease."),t.delete(sl)):U.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;UT()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Y(Ri,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ot(Ri,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ot("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function lu(n){return Kt(n,hd)}function Yh(n){return Kt(n,Nl)}function F_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class j_{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Me(),s=Me();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new j_(e,t.fromCache,r,s)}}class jL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class MS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return UT()?8:gx(xt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new jL;return this.Ss(e,t,l).next((u=>{if(a.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>a.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(ul()<=Be.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",dl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(ul()<=Be.DEBUG&&Y("QueryEngine","Query:",dl(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ul()<=Be.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",dl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kn(t))):U.resolve())}ys(e,t){if(ZI(t))return U.resolve(null);let r=kn(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Vf(t,null,"F"),r=kn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Me(...a);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.Ds(t,u);return this.Cs(t,p,l,f.readTime)?this.ys(e,Vf(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,r,s){return ZI(t)||s.isEqual(Te.min())?U.resolve(null):this.ps.getDocuments(e,r).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,r,s)?U.resolve(null):(ul()<=Be.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),dl(t)),this.vs(e,l,t,hx(s,Rl)).next((u=>u)))}))}Ds(e,t){let r=new st(Kx(e));return t.forEach(((s,a)=>{md(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,r){return ul()<=Be.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",dl(t)),this.ps.getDocumentsMatchingQuery(e,t,ar.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}const U_="LocalStore",UL=3e8;class BL{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ut(De),this.xs=new Gs((a=>na(a)),fd),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function FS(n,e,t,r){return new BL(n,e,t,r)}async function jS(n,e){const t=de(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],u=[];let f=Me();for(const p of s){l.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}for(const p of a){u.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(r,f).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:u})))}))}))}function zL(n,e){const t=de(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,p,g){const w=p.batch,T=w.keys();let D=U.resolve();return T.forEach((S=>{D=D.next((()=>g.getEntry(f,S))).next((O=>{const L=p.docVersions.get(S);we(L!==null,48541),O.version.compareTo(L)<0&&(w.applyToRemoteDocument(O,p),O.isValidDocument()&&(O.setReadTime(p.commitVersion),g.addEntry(O)))}))})),D.next((()=>u.mutationQueue.removeMutationBatch(f,w)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let f=Me();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(f=f.add(u.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function US(n){const e=de(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function $L(n,e){const t=de(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const u=[];e.targetChanges.forEach(((g,w)=>{const T=s.get(w);if(!T)return;u.push(t.Pi.removeMatchingKeys(a,g.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(a,g.addedDocuments,w))));let D=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(w)!==null?D=D.withResumeToken(Pt.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):g.resumeToken.approximateByteSize()>0&&(D=D.withResumeToken(g.resumeToken,r)),s=s.insert(w,D),(function(O,L,se){return O.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=UL?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(T,D,g)&&u.push(t.Pi.updateTargetData(a,D))}));let f=$n(),p=Me();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))})),u.push(BS(a,l,e.documentUpdates).next((g=>{f=g.ks,p=g.qs}))),!r.isEqual(Te.min())){const g=t.Pi.getLastRemoteSnapshotVersion(a).next((w=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));u.push(g)}return U.waitFor(u).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=s,a)))}function BS(n,e,t){let r=Me(),s=Me();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=$n();return t.forEach(((u,f)=>{const p=a.get(u);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(u)),f.isNoDocument()&&f.version.isEqual(Te.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):Y(U_,"Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",f.version)})),{ks:l,qs:s}}))}function qL(n,e){const t=de(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Fi),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function jl(n,e){const t=de(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((a=>a?(s=a,U.resolve(s)):t.Pi.allocateTargetId(r).next((l=>(s=new Ms(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Ul(n,e,t){const r=de(n),s=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!to(l))throw l;Y(U_,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function jf(n,e,t){const r=de(n);let s=Te.min(),a=Me();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,g){const w=de(f),T=w.xs.get(g);return T!==void 0?U.resolve(w.Ms.get(T)):w.Pi.getTargetData(p,g)})(r,l,kn(e)).next((u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,u.targetId).next((f=>{a=f}))})).next((()=>r.Fs.getDocumentsMatchingQuery(l,e,t?s:Te.min(),t?a:Me()))).next((u=>(qS(r,Gx(e),u),{documents:u,Qs:a})))))}function zS(n,e){const t=de(n),r=de(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>r.At(a,e).next((l=>l?l.target:null))))}function $S(n,e){const t=de(n),r=t.Os.get(e)||Te.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,hx(r,Rl),Number.MAX_SAFE_INTEGER))).then((s=>(qS(t,e,s),s)))}function qS(n,e,t){let r=n.Os.get(e)||Te.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}async function WL(n,e,t,r){const s=de(n);let a=Me(),l=$n();for(const p of t){const g=e.$s(p.metadata.name);p.document&&(a=a.add(g));const w=e.Us(p);w.setReadTime(e.Ks(p.metadata.readTime)),l=l.insert(g,w)}const u=s.Ns.newChangeBuffer({trackRemovals:!0}),f=await jl(s,(function(g){return kn(Zl(ze.fromString(`__bundle__/docs/${g}`)))})(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",(p=>BS(p,u,l).next((g=>(u.apply(p),g))).next((g=>s.Pi.removeMatchingKeysForTargetId(p,f.targetId).next((()=>s.Pi.addMatchingKeys(p,a,f.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(p,g.ks,g.qs))).next((()=>g.ks))))))}async function HL(n,e,t=Me()){const r=await jl(n,kn(N_(e.bundledQuery))),s=de(n);return s.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Lt(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return s.Ii.saveNamedQuery(a,e);const u=r.withResumeToken(Pt.EMPTY_BYTE_STRING,l);return s.Ms=s.Ms.insert(u.targetId,u),s.Pi.updateTargetData(a,u).next((()=>s.Pi.removeMatchingKeysForTargetId(a,r.targetId))).next((()=>s.Pi.addMatchingKeys(a,t,r.targetId))).next((()=>s.Ii.saveNamedQuery(a,e)))}))}const WS="firestore_clients";function k0(n,e){return`${WS}_${n}_${e}`}const HS="firestore_mutations";function C0(n,e,t){let r=`${HS}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const GS="firestore_targets";function kg(n,e){return`${GS}_${n}_${e}`}const ts="SharedClientState";class Uf{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Ws(e,t,r){const s=JSON.parse(r);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new Q(s.error.code,s.error.message))),l?new Uf(e,t,s.state,a):(Ot(ts,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let s,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(s=new Q(r.error.code,r.error.message))),a?new Cu(e,r.state,s):(Ot(ts,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,a=x_();for(let l=0;s&&l<r.activeTargetIds.length;++l)s=yx(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return s?new Bf(e,a):(Ot(ts,`Failed to parse client data for instance '${e}': ${t}`),null)}}class B_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new B_(t.clientId,t.onlineState):(Ot(ts,`Failed to parse online state: ${e}`),null)}}class yy{constructor(){this.activeTargetIds=x_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Cg{constructor(e,t,r,s,a){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new ut(De),this.started=!1,this.Xs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=k0(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new yy),this.ro=new RegExp(`^${WS}_${l}_([^_]*)$`),this.io=new RegExp(`^${HS}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${GS}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(k0(this.persistenceKey,r));if(s){const a=Bf.Ws(r,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(kg(this.persistenceKey,e));if(s){const a=Cu.Ws(e,s);a&&(r=a.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kg(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((s=>{this.Po(s)})),this.currentUser=e,r.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Y(ts,"READ",e,t),t}setItem(e,t){Y(ts,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Y(ts,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Y(ts,"EVENT",t.key,t.newValue),t.key===this.eo)return void Ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(a){let l=Bn.ce;if(a!=null)try{const u=JSON.parse(a);we(typeof u=="number",30636,{So:a}),l=u}catch(u){Ot(ts,"Failed to read sequence number from WebStorage",u)}return l})(t.newValue);r!==Bn.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const s=new Uf(this.currentUser,e,t,r),a=C0(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=C0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const s=kg(this.persistenceKey,e),a=new Cu(e,t,r);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return Bf.Ws(r,t)}fo(e,t){const r=this.io.exec(e),s=Number(r[1]),a=r[2]!==void 0?r[2]:null;return Uf.Ws(new nn(a),s,t)}yo(e,t){const r=this.so.exec(e),s=Number(r[1]);return Cu.Ws(s,t)}uo(e){return B_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Y(ts,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(r),l=[],u=[];return a.forEach((f=>{s.has(f)||l.push(f)})),s.forEach((f=>{a.has(f)||u.push(f)})),this.syncEngine.Fo(l,u).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=x_();return e.forEach(((r,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class KS{constructor(){this.Mo=new yy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class GL{Oo(e){}shutdown(){}}const N0="ConnectivityMonitor";class D0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(N0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(N0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Xh=null;function _y(){return Xh===null?Xh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xh++,"0x"+Xh.toString(16)}const Ng="RestConnection",KL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class QL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===ry?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,a){const l=_y(),u=this.zo(e,t.toUriEncodedString());Y(Ng,`Sending RPC '${e}' ${l}:`,u,r);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,a);const{host:p}=new URL(u),g=Yi(p);return this.Jo(e,u,f,r,g).then((w=>(Y(Ng,`Received RPC '${e}' ${l}: `,w),w)),(w=>{throw gs(Ng,`RPC '${e}' ${l} failed with error: `,w,"url: ",u,"request:",r),w}))}Ho(e,t,r,s,a,l){return this.Go(e,t,r,s,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Xl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const r=KL[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class JL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wn="WebChannelConnection";class YL extends QL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,a){const l=_y();return new Promise(((u,f)=>{const p=new tx;p.setWithCredentials(!0),p.listenOnce(nx.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case sf.NO_ERROR:const w=p.getResponseJson();Y(wn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(w)),u(w);break;case sf.TIMEOUT:Y(wn,`RPC '${e}' ${l} timed out`),f(new Q(W.DEADLINE_EXCEEDED,"Request time out"));break;case sf.HTTP_ERROR:const T=p.getStatus();if(Y(wn,`RPC '${e}' ${l} failed with status:`,T,"response text:",p.getResponseText()),T>0){let D=p.getResponseJson();Array.isArray(D)&&(D=D[0]);const S=D?.error;if(S&&S.status&&S.message){const O=(function(se){const oe=se.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(oe)>=0?oe:W.UNKNOWN})(S.status);f(new Q(O,S.message))}else f(new Q(W.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Q(W.UNAVAILABLE,"Connection failed."));break;default:pe(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Y(wn,`RPC '${e}' ${l} completed.`)}}));const g=JSON.stringify(s);Y(wn,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",g,r,15)}))}T_(e,t,r){const s=_y(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=ix(),u=sx(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const g=a.join("");Y(wn,`Creating RPC '${e}' stream ${s}: ${g}`,f);const w=l.createWebChannel(g,f);this.I_(w);let T=!1,D=!1;const S=new JL({Yo:L=>{D?Y(wn,`Not sending because RPC '${e}' stream ${s} is closed:`,L):(T||(Y(wn,`Opening RPC '${e}' stream ${s} transport.`),w.open(),T=!0),Y(wn,`RPC '${e}' stream ${s} sending:`,L),w.send(L))},Zo:()=>w.close()}),O=(L,se,oe)=>{L.listen(se,(Z=>{try{oe(Z)}catch(ge){setTimeout((()=>{throw ge}),0)}}))};return O(w,fu.EventType.OPEN,(()=>{D||(Y(wn,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),O(w,fu.EventType.CLOSE,(()=>{D||(D=!0,Y(wn,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(w))})),O(w,fu.EventType.ERROR,(L=>{D||(D=!0,gs(wn,`RPC '${e}' stream ${s} transport errored. Name:`,L.name,"Message:",L.message),S.a_(new Q(W.UNAVAILABLE,"The operation could not be completed")))})),O(w,fu.EventType.MESSAGE,(L=>{if(!D){const se=L.data[0];we(!!se,16349);const oe=se,Z=oe?.error||oe[0]?.error;if(Z){Y(wn,`RPC '${e}' stream ${s} received error:`,Z);const ge=Z.status;let ne=(function(b){const C=zt[b];if(C!==void 0)return aS(C)})(ge),ae=Z.message;ne===void 0&&(ne=W.INTERNAL,ae="Unknown error status: "+ge+" with message "+Z.message),D=!0,S.a_(new Q(ne,ae)),w.close()}else Y(wn,`RPC '${e}' stream ${s} received:`,se),S.u_(se)}})),O(u,rx.STAT_EVENT,(L=>{L.stat===Jg.PROXY?Y(wn,`RPC '${e}' stream ${s} detected buffering proxy`):L.stat===Jg.NOPROXY&&Y(wn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function QS(){return typeof window<"u"?window:null}function mf(){return typeof document<"u"?document:null}function vd(n){return new nL(n,!0)}class z_{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const V0="PersistentStream";class JS{constructor(e,t,r,s,a,l,u,f){this.Mi=e,this.S_=r,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ot(t.toString()),Ot("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new Q(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Y(V0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Y(V0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class XL extends JS{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=iL(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Te.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Te.min():l.readTime?Lt(l.readTime):Te.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=hy(this.serializer),t.addTarget=(function(a,l){let u;const f=l.target;if(u=Nf(f)?{documents:yS(a,f)}:{query:_S(a,f).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=dS(a,l.resumeToken);const p=uy(a,l.expectedCount);p!==null&&(u.expectedCount=p)}else if(l.snapshotVersion.compareTo(Te.min())>0){u.readTime=Fl(a,l.snapshotVersion.toTimestamp());const p=uy(a,l.expectedCount);p!==null&&(u.expectedCount=p)}return u})(this.serializer,e);const r=aL(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=hy(this.serializer),t.removeTarget=e,this.q_(t)}}class ZL extends JS{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=oL(e.writeResults,e.commitTime),r=Lt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=hy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Yu(this.serializer,r)))};this.q_(t)}}class e4{}class t4 extends e4{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(W.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,dy(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Q(W.UNKNOWN,a.toString())}))}Ho(e,t,r,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,dy(t,r),s,l,u,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Q(W.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class n4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ot(t),this.aa=!1):Y("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const la="RemoteStore";class r4{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{r.enqueueAndForget((async()=>{ro(this)&&(Y(la,"Restarting streams for network reachability change."),await(async function(f){const p=de(f);p.Ea.add(4),await nc(p),p.Ra.set("Unknown"),p.Ea.delete(4),await wd(p)})(this))}))})),this.Ra=new n4(r,s)}}async function wd(n){if(ro(n))for(const e of n.da)await e(!0)}async function nc(n){for(const e of n.da)await e(!1)}function Ep(n,e){const t=de(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),W_(t)?q_(t):sc(t).O_()&&$_(t,e))}function Bl(n,e){const t=de(n),r=sc(t);t.Ia.delete(e),r.O_()&&YS(t,e),t.Ia.size===0&&(r.O_()?r.L_():ro(t)&&t.Ra.set("Unknown"))}function $_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sc(n).Y_(e)}function YS(n,e){n.Va.Ue(e),sc(n).Z_(e)}function q_(n){n.Va=new XO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),sc(n).start(),n.Ra.ua()}function W_(n){return ro(n)&&!sc(n).x_()&&n.Ia.size>0}function ro(n){return de(n).Ea.size===0}function XS(n){n.Va=void 0}async function s4(n){n.Ra.set("Online")}async function i4(n){n.Ia.forEach(((e,t)=>{$_(n,e)}))}async function o4(n,e){XS(n),W_(n)?(n.Ra.ha(e),q_(n)):n.Ra.set("Unknown")}async function a4(n,e,t){if(n.Ra.set("Online"),e instanceof uS&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const u of a.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,l),s.Ia.delete(u),s.Va.removeTarget(u))})(n,e)}catch(r){Y(la,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zf(n,r)}else if(e instanceof ff?n.Va.Ze(e):e instanceof cS?n.Va.st(e):n.Va.tt(e),!t.isEqual(Te.min()))try{const r=await US(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const u=a.Va.Tt(l);return u.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const g=a.Ia.get(p);g&&a.Ia.set(p,g.withResumeToken(f.resumeToken,l))}})),u.targetMismatches.forEach(((f,p)=>{const g=a.Ia.get(f);if(!g)return;a.Ia.set(f,g.withResumeToken(Pt.EMPTY_BYTE_STRING,g.snapshotVersion)),YS(a,f);const w=new Ms(g.target,f,p,g.sequenceNumber);$_(a,w)})),a.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){Y(la,"Failed to raise snapshot:",r),await zf(n,r)}}async function zf(n,e,t){if(!to(e))throw e;n.Ea.add(1),await nc(n),n.Ra.set("Offline"),t||(t=()=>US(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Y(la,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await wd(n)}))}function ZS(n,e){return e().catch((t=>zf(n,t,e)))}async function rc(n){const e=de(n),t=Ki(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fi;for(;l4(e);)try{const s=await qL(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,c4(e,s)}catch(s){await zf(e,s)}eA(e)&&tA(e)}function l4(n){return ro(n)&&n.Ta.length<10}function c4(n,e){n.Ta.push(e);const t=Ki(n);t.O_()&&t.X_&&t.ea(e.mutations)}function eA(n){return ro(n)&&!Ki(n).x_()&&n.Ta.length>0}function tA(n){Ki(n).start()}async function u4(n){Ki(n).ra()}async function d4(n){const e=Ki(n);for(const t of n.Ta)e.ea(t.mutations)}async function h4(n,e,t){const r=n.Ta.shift(),s=R_.from(r,e,t);await ZS(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await rc(n)}async function f4(n,e){e&&Ki(n).X_&&await(async function(r,s){if((function(l){return oS(l)&&l!==W.ABORTED})(s.code)){const a=r.Ta.shift();Ki(r).B_(),await ZS(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await rc(r)}})(n,e),eA(n)&&tA(n)}async function O0(n,e){const t=de(n);t.asyncQueue.verifyOperationInProgress(),Y(la,"RemoteStore received new credentials");const r=ro(t);t.Ea.add(3),await nc(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await wd(t)}async function vy(n,e){const t=de(n);e?(t.Ea.delete(2),await wd(t)):e||(t.Ea.add(2),await nc(t),t.Ra.set("Unknown"))}function sc(n){return n.ma||(n.ma=(function(t,r,s){const a=de(t);return a.sa(),new XL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:s4.bind(null,n),t_:i4.bind(null,n),r_:o4.bind(null,n),H_:a4.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),W_(n)?q_(n):n.Ra.set("Unknown")):(await n.ma.stop(),XS(n))}))),n.ma}function Ki(n){return n.fa||(n.fa=(function(t,r,s){const a=de(t);return a.sa(),new ZL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:u4.bind(null,n),r_:f4.bind(null,n),ta:d4.bind(null,n),na:h4.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await rc(n)):(await n.fa.stop(),n.Ta.length>0&&(Y(la,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class H_{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,u=new H_(e,t,l,s,a);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ic(n,e){if(Ot("AsyncQueue",`${e}: ${n}`),to(n))return new Q(W.UNAVAILABLE,`${e}: ${n}`);throw n}class Il{static emptySet(e){return new Il(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ce.comparator(t.key,r.key):(t,r)=>ce.comparator(t.key,r.key),this.keyedMap=pu(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Il)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Il;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class L0{constructor(){this.ga=new ut(ce.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):pe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class zl{constructor(e,t,r,s,a,l,u,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new zl(e,t,Il.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class p4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class m4{constructor(){this.queries=M0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=de(t),a=s.queries;s.queries=M0(),a.forEach(((l,u)=>{for(const f of u.Sa)f.onError(r)}))})(this,new Q(W.ABORTED,"Firestore shutting down"))}}function M0(){return new Gs((n=>Hx(n)),pd)}async function G_(n,e){const t=de(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(r=2):(a=new p4,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const u=ic(l,`Initialization of query '${dl(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Q_(t)}async function K_(n,e){const t=de(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function g4(n,e){const t=de(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const u of l.Sa)u.Fa(s)&&(r=!0);l.wa=s}}r&&Q_(t)}function y4(n,e,t){const r=de(n),s=r.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);r.queries.delete(e)}function Q_(n){n.Ca.forEach((e=>{e.next()}))}var wy,F0;(F0=wy||(wy={})).Ma="default",F0.Cache="cache";class J_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new zl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=zl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wy.Cache}}class _4{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class j0{constructor(e){this.serializer=e}$s(e){return fs(this.serializer,e)}Us(e){return e.metadata.exists?gS(this.serializer,e.document,!1):pt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Lt(e)}}class v4{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=nA(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=ze.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new j0(this.serializer);for(const s of e)if(s.metadata.queries){const a=r.$s(s.metadata.name);for(const l of s.metadata.queries){const u=(t.get(l)||Me()).add(a);t.set(l,u)}}return t}async ja(e){const t=await WL(e,new j0(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await HL(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function nA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class rA{constructor(e){this.key=e}}class sA{constructor(e){this.key=e}}class iA{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Me(),this.mutatedKeys=Me(),this.eu=Kx(e),this.tu=new Il(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new L0,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,u=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,w)=>{const T=s.get(g),D=md(this.query,w)?w:null,S=!!T&&this.mutatedKeys.has(T.key),O=!!D&&(D.hasLocalMutations||this.mutatedKeys.has(D.key)&&D.hasCommittedMutations);let L=!1;T&&D?T.data.isEqual(D.data)?S!==O&&(r.track({type:3,doc:D}),L=!0):this.su(T,D)||(r.track({type:2,doc:D}),L=!0,(f&&this.eu(D,f)>0||p&&this.eu(D,p)<0)&&(u=!0)):!T&&D?(r.track({type:0,doc:D}),L=!0):T&&!D&&(r.track({type:1,doc:T}),L=!0,(f||p)&&(u=!0)),L&&(D?(l=l.add(D),a=O?a.add(g):a.delete(g)):(l=l.delete(g),a=a.delete(g)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{tu:l,iu:r,Cs:u,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((g,w)=>(function(D,S){const O=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe(20277,{Rt:L})}};return O(D)-O(S)})(g.type,w.type)||this.eu(g.doc,w.doc))),this.ou(r),s=s??!1;const u=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,l.length!==0||p?{snapshot:new zl(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new L0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Me(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new sA(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new rA(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Me();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return zl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const so="SyncEngine";class w4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class E4{constructor(e){this.key=e,this.hu=!1}}class I4{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Gs((u=>Hx(u)),pd),this.Iu=new Map,this.Eu=new Set,this.du=new ut(ce.comparator),this.Au=new Map,this.Ru=new O_,this.Vu={},this.mu=new Map,this.fu=aa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function T4(n,e,t=!0){const r=Ip(n);let s;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await oA(r,e,t,!0),s}async function x4(n,e){const t=Ip(n);await oA(t,e,!0,!1)}async function oA(n,e,t,r){const s=await jl(n.localStore,kn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let u;return r&&(u=await Y_(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&Ep(n.remoteStore,s),u}async function Y_(n,e,t,r,s){n.pu=(w,T,D)=>(async function(O,L,se,oe){let Z=L.view.ru(se);Z.Cs&&(Z=await jf(O.localStore,L.query,!1).then((({documents:A})=>L.view.ru(A,Z))));const ge=oe&&oe.targetChanges.get(L.targetId),ne=oe&&oe.targetMismatches.get(L.targetId)!=null,ae=L.view.applyChanges(Z,O.isPrimaryClient,ge,ne);return Ey(O,L.targetId,ae.au),ae.snapshot})(n,w,T,D);const a=await jf(n.localStore,e,!0),l=new iA(e,a.Qs),u=l.ru(a.documents),f=_d.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=l.applyChanges(u,n.isPrimaryClient,f);Ey(n,t,p.au);const g=new w4(e,t,l);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function S4(n,e,t){const r=de(n),s=r.Tu.get(e),a=r.Iu.get(s.targetId);if(a.length>1)return r.Iu.set(s.targetId,a.filter((l=>!pd(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Ul(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Bl(r.remoteStore,s.targetId),$l(r,s.targetId)})).catch(eo)):($l(r,s.targetId),await Ul(r.localStore,s.targetId,!0))}async function A4(n,e){const t=de(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Bl(t.remoteStore,r.targetId))}async function b4(n,e,t){const r=tv(n);try{const s=await(function(l,u){const f=de(l),p=et.now(),g=u.reduce(((D,S)=>D.add(S.key)),Me());let w,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(D=>{let S=$n(),O=Me();return f.Ns.getEntries(D,g).next((L=>{S=L,S.forEach(((se,oe)=>{oe.isValidDocument()||(O=O.add(se))}))})).next((()=>f.localDocuments.getOverlayedDocuments(D,S))).next((L=>{w=L;const se=[];for(const oe of u){const Z=QO(oe,w.get(oe.key).overlayedDocument);Z!=null&&se.push(new Ks(oe.key,Z,Mx(Z.value.mapValue),vt.exists(!0)))}return f.mutationQueue.addMutationBatch(D,p,se,u)})).next((L=>{T=L;const se=L.applyToLocalDocumentSet(w,O);return f.documentOverlayCache.saveOverlays(D,L.batchId,se)}))})).then((()=>({batchId:T.batchId,changes:Jx(w)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,u,f){let p=l.Vu[l.currentUser.toKey()];p||(p=new ut(De)),p=p.insert(u,f),l.Vu[l.currentUser.toKey()]=p})(r,s.batchId,t),await Qs(r,s.changes),await rc(r.remoteStore)}catch(s){const a=ic(s,"Failed to persist write");t.reject(a)}}async function aA(n,e){const t=de(n);try{const r=await $L(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(we(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?we(l.hu,14607):s.removedDocuments.size>0&&(we(l.hu,42227),l.hu=!1))})),await Qs(t,r,e)}catch(r){await eo(r)}}function U0(n,e,t){const r=de(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((a,l)=>{const u=l.view.va(e);u.snapshot&&s.push(u.snapshot)})),(function(l,u){const f=de(l);f.onlineState=u;let p=!1;f.queries.forEach(((g,w)=>{for(const T of w.Sa)T.va(u)&&(p=!0)})),p&&Q_(f)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function R4(n,e,t){const r=de(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),a=s&&s.key;if(a){let l=new ut(ce.comparator);l=l.insert(a,pt.newNoDocument(a,Te.min()));const u=Me().add(a),f=new yd(Te.min(),new Map,new ut(De),l,u);await aA(r,f),r.du=r.du.remove(a),r.Au.delete(e),ev(r)}else await Ul(r.localStore,e,!1).then((()=>$l(r,e,t))).catch(eo)}async function P4(n,e){const t=de(n),r=e.batch.batchId;try{const s=await zL(t.localStore,e);Z_(t,r,null),X_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Qs(t,s)}catch(s){await eo(s)}}async function k4(n,e,t){const r=de(n);try{const s=await(function(l,u){const f=de(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return f.mutationQueue.lookupMutationBatch(p,u).next((w=>(we(w!==null,37113),g=w.keys(),f.mutationQueue.removeMutationBatch(p,w)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,g,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>f.localDocuments.getDocuments(p,g)))}))})(r.localStore,e);Z_(r,e,t),X_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Qs(r,s)}catch(s){await eo(s)}}async function C4(n,e){const t=de(n);ro(t.remoteStore)||Y(so,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(l){const u=de(l);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>u.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===Fi)return void e.resolve();const s=t.mu.get(r)||[];s.push(e),t.mu.set(r,s)}catch(r){const s=ic(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function X_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Z_(n,e,t){const r=de(n);let s=r.Vu[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function $l(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||lA(n,r)}))}function lA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Bl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ev(n))}function Ey(n,e,t){for(const r of t)r instanceof rA?(n.Ru.addReference(r.key,e),N4(n,r)):r instanceof sA?(Y(so,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||lA(n,r.key)):pe(19791,{wu:r})}function N4(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Y(so,"New document in limbo: "+t),n.Eu.add(r),ev(n))}function ev(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ce(ze.fromString(e)),r=n.fu.next();n.Au.set(r,new E4(t)),n.du=n.du.insert(t,r),Ep(n.remoteStore,new Ms(kn(Zl(t.path)),r,"TargetPurposeLimboResolution",Bn.ce))}}async function Qs(n,e,t){const r=de(n),s=[],a=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,f)=>{l.push(r.pu(f,e,t).then((p=>{if((p||t)&&r.isPrimaryClient){const g=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;r.sharedClientState.updateQueryState(f.targetId,g?"current":"not-current")}if(p){s.push(p);const g=j_.As(f.targetId,p);a.push(g)}})))})),await Promise.all(l),r.Pu.H_(s),await(async function(f,p){const g=de(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>U.forEach(p,(T=>U.forEach(T.Es,(D=>g.persistence.referenceDelegate.addReference(w,T.targetId,D))).next((()=>U.forEach(T.ds,(D=>g.persistence.referenceDelegate.removeReference(w,T.targetId,D)))))))))}catch(w){if(!to(w))throw w;Y(U_,"Failed to update sequence numbers: "+w)}for(const w of p){const T=w.targetId;if(!w.fromCache){const D=g.Ms.get(T),S=D.snapshotVersion,O=D.withLastLimboFreeSnapshotVersion(S);g.Ms=g.Ms.insert(T,O)}}})(r.localStore,a))}async function D4(n,e){const t=de(n);if(!t.currentUser.isEqual(e)){Y(so,"User change. New user:",e.toKey());const r=await jS(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((u=>{u.forEach((f=>{f.reject(new Q(W.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Qs(t,r.Ls)}}function V4(n,e){const t=de(n),r=t.Au.get(e);if(r&&r.hu)return Me().add(r.key);{let s=Me();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const u=t.Tu.get(l);s=s.unionWith(u.view.nu)}return s}}async function O4(n,e){const t=de(n),r=await jf(t.localStore,e.query,!0),s=e.view.cu(r);return t.isPrimaryClient&&Ey(t,e.targetId,s.au),s}async function L4(n,e){const t=de(n);return $S(t.localStore,e).then((r=>Qs(t,r)))}async function M4(n,e,t,r){const s=de(n),a=await(function(u,f){const p=de(u),g=de(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(w=>g.er(w,f).next((T=>T?p.localDocuments.getDocuments(w,T):U.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await rc(s.remoteStore):t==="acknowledged"||t==="rejected"?(Z_(s,e,r||null),X_(s,e),(function(u,f){de(de(u).mutationQueue).ir(f)})(s.localStore,e)):pe(6720,"Unknown batchState",{Su:t}),await Qs(s,a)):Y(so,"Cannot apply mutation batch with id: "+e)}async function F4(n,e){const t=de(n);if(Ip(t),tv(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await B0(t,r.toArray());t.gu=!0,await vy(t.remoteStore,!0);for(const a of s)Ep(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const r=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):s=s.then((()=>($l(t,l),Ul(t.localStore,l,!0)))),Bl(t.remoteStore,l)})),await s,await B0(t,r),(function(l){const u=de(l);u.Au.forEach(((f,p)=>{Bl(u.remoteStore,p)})),u.Ru.Jr(),u.Au=new Map,u.du=new ut(ce.comparator)})(t),t.gu=!1,await vy(t.remoteStore,!1)}}async function B0(n,e,t){const r=de(n),s=[],a=[];for(const l of e){let u;const f=r.Iu.get(l);if(f&&f.length!==0){u=await jl(r.localStore,kn(f[0]));for(const p of f){const g=r.Tu.get(p),w=await O4(r,g);w.snapshot&&a.push(w.snapshot)}}else{const p=await zS(r.localStore,l);u=await jl(r.localStore,p),await Y_(r,cA(p),l,!1,u.resumeToken)}s.push(u)}return r.Pu.H_(a),s}function cA(n){return Wx(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function j4(n){return(function(t){return de(de(t).persistence).Ts()})(de(n).localStore)}async function U4(n,e,t,r){const s=de(n);if(s.gu)return void Y(so,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await $S(s.localStore,Gx(a[0])),u=yd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Pt.EMPTY_BYTE_STRING);await Qs(s,l,u);break}case"rejected":await Ul(s.localStore,e,!0),$l(s,e,r);break;default:pe(64155,t)}}async function B4(n,e,t){const r=Ip(n);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Y(so,"Adding an already active target "+s);continue}const a=await zS(r.localStore,s),l=await jl(r.localStore,a);await Y_(r,cA(a),l.targetId,!1,l.resumeToken),Ep(r.remoteStore,l)}for(const s of t)r.Iu.has(s)&&await Ul(r.localStore,s,!1).then((()=>{Bl(r.remoteStore,s),$l(r,s)})).catch(eo)}}function Ip(n){const e=de(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=aA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=V4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=R4.bind(null,e),e.Pu.H_=g4.bind(null,e.eventManager),e.Pu.yu=y4.bind(null,e.eventManager),e}function tv(n){const e=de(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=P4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=k4.bind(null,e),e}function z4(n,e,t){const r=de(n);(async function(a,l,u){try{const f=await l.getMetadata();if(await(function(D,S){const O=de(D),L=Lt(S.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",(se=>O.Ii.getBundleMetadata(se,S.id))).then((se=>!!se&&se.createTime.compareTo(L)>=0))})(a.localStore,f))return await l.close(),u._completeWith((function(D){return{taskState:"Success",documentsLoaded:D.totalDocuments,bytesLoaded:D.totalBytes,totalDocuments:D.totalDocuments,totalBytes:D.totalBytes}})(f)),Promise.resolve(new Set);u._updateProgress(nA(f));const p=new v4(f,l.serializer);let g=await l.bu();for(;g;){const T=await p.Ga(g);T&&u._updateProgress(T),g=await l.bu()}const w=await p.ja(a.localStore);return await Qs(a,w.Ha,void 0),await(function(D,S){const O=de(D);return O.persistence.runTransaction("Save bundle","readwrite",(L=>O.Ii.saveBundleMetadata(L,S)))})(a.localStore,f),u._completeWith(w.progress),Promise.resolve(w.Ja)}catch(f){return gs(so,`Loading bundle failed with ${f}`),u._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((s=>{r.sharedClientState.notifyBundleLoaded(s)}))}class Xu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return FS(this.persistence,new MS,e.initialUser,this.serializer)}Cu(e){return new L_(wp.mi,this.serializer)}Du(e){return new KS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xu.provider={build:()=>new Xu};class $4 extends Xu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){we(this.persistence.referenceDelegate instanceof Ff,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new CS(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new L_((r=>Ff.mi(r,t)),this.serializer)}}class uA extends Xu{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await tv(this.xu.syncEngine),await rc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return FS(this.persistence,new MS,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new CS(r,e.asyncQueue,t)}Mu(e,t){const r=new XV(t,this.persistence);return new YV(e.asyncQueue,r)}Cu(e){const t=F_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new M_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,QS(),mf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new KS}}class q4 extends uA{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Cg&&(this.sharedClientState.syncEngine={Co:M4.bind(null,t),vo:U4.bind(null,t),Fo:B4.bind(null,t),Ts:j4.bind(null,t),Do:L4.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await F4(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=QS();if(!Cg.v(t))throw new Q(W.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=F_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Cg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Zu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>U0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=D4.bind(null,this.syncEngine),await vy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new m4})()}createDatastore(e){const t=vd(e.databaseInfo.databaseId),r=(function(a){return new YL(a)})(e.databaseInfo);return(function(a,l,u,f){return new t4(a,l,u,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,u){return new r4(r,s,a,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>U0(this.syncEngine,t,0)),(function(){return D0.v()?new D0:new GL})())}createSyncEngine(e,t){return(function(s,a,l,u,f,p,g){const w=new I4(s,a,l,u,f,p);return g&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=de(t);Y(la,"RemoteStore shutting down."),r.Ea.add(5),await nc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Zu.provider={build:()=>new Zu};function z0(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Tp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ot("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class W4{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new fn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(r);return new _4(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class H4{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Q(W.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,a){const l=de(s),u={documents:a.map((w=>Ju(l.serializer,w)))},f=await l.Ho("BatchGetDocuments",l.serializer.databaseId,ze.emptyPath(),u,a.length),p=new Map;f.forEach((w=>{const T=sL(l.serializer,w);p.set(T.key.toString(),T)}));const g=[];return a.forEach((w=>{const T=p.get(w.toString());we(!!T,55234,{key:w}),g.push(T)})),g})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new tc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const s=ce.fromPath(r);this.mutations.push(new A_(s,this.precondition(s)))})),await(async function(r,s){const a=de(r),l={writes:s.map((u=>Yu(a.serializer,u)))};await a.Go("Commit",a.serializer.databaseId,ze.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw pe(50498,{Gu:e.constructor.name});t=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Q(W.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Te.min())?vt.exists(!1):vt.updateTime(t):vt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Te.min()))throw new Q(W.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vt.updateTime(t)}return vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class G4{constructor(e,t,r,s,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=a,this.zu=r.maxAttempts,this.M_=new z_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new H4(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((s=>{this.Yu(s)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!dd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!oS(t)}return!1}}const Qi="FirestoreClient";class K4{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=nn.UNAUTHENTICATED,this.clientId=h_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{Y(Qi,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(Y(Qi,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ic(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Dg(n,e){n.asyncQueue.verifyOperationInProgress(),Y(Qi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await jS(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function $0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await nv(n);Y(Qi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>O0(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>O0(e.remoteStore,s))),n._onlineComponents=e}async function nv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Y(Qi,"Using user provided OfflineComponentProvider");try{await Dg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;gs("Error using user provided cache. Falling back to memory cache: "+t),await Dg(n,new Xu)}}else Y(Qi,"Using default OfflineComponentProvider"),await Dg(n,new $4(void 0));return n._offlineComponents}async function xp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Y(Qi,"Using user provided OnlineComponentProvider"),await $0(n,n._uninitializedComponentsProvider._online)):(Y(Qi,"Using default OnlineComponentProvider"),await $0(n,new Zu))),n._onlineComponents}function dA(n){return nv(n).then((e=>e.persistence))}function rv(n){return nv(n).then((e=>e.localStore))}function hA(n){return xp(n).then((e=>e.remoteStore))}function sv(n){return xp(n).then((e=>e.syncEngine))}function Q4(n){return xp(n).then((e=>e.datastore))}async function ql(n){const e=await xp(n),t=e.eventManager;return t.onListen=T4.bind(null,e.syncEngine),t.onUnlisten=S4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=x4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=A4.bind(null,e.syncEngine),t}function J4(n){return n.asyncQueue.enqueue((async()=>{const e=await dA(n),t=await hA(n);return e.setNetworkEnabled(!0),(function(s){const a=de(s);return a.Ea.delete(0),wd(a)})(t)}))}function Y4(n){return n.asyncQueue.enqueue((async()=>{const e=await dA(n),t=await hA(n);return e.setNetworkEnabled(!1),(async function(s){const a=de(s);a.Ea.add(0),await nc(a),a.Ra.set("Offline")})(t)}))}function X4(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const u=await(function(p,g){const w=de(p);return w.persistence.runTransaction("read document","readonly",(T=>w.localDocuments.getDocument(T,g)))})(s,a);u.isFoundDocument()?l.resolve(u):u.isNoDocument()?l.resolve(null):l.reject(new Q(W.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const f=ic(u,`Failed to get document '${a} from cache`);l.reject(f)}})(await rv(n),e,t))),t.promise}function fA(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,f,p){const g=new Tp({next:T=>{g.Nu(),l.enqueueAndForget((()=>K_(a,w)));const D=T.docs.has(u);!D&&T.fromCache?p.reject(new Q(W.UNAVAILABLE,"Failed to get document because the client is offline.")):D&&T.fromCache&&f&&f.source==="server"?p.reject(new Q(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),w=new J_(Zl(u.path),g,{includeMetadataChanges:!0,qa:!0});return G_(a,w)})(await ql(n),n.asyncQueue,e,t,r))),r.promise}function Z4(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const u=await jf(s,a,!0),f=new iA(a,u.Qs),p=f.ru(u.documents),g=f.applyChanges(p,!1);l.resolve(g.snapshot)}catch(u){const f=ic(u,`Failed to execute query '${a} against cache`);l.reject(f)}})(await rv(n),e,t))),t.promise}function pA(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,f,p){const g=new Tp({next:T=>{g.Nu(),l.enqueueAndForget((()=>K_(a,w))),T.fromCache&&f.source==="server"?p.reject(new Q(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),w=new J_(u,g,{includeMetadataChanges:!0,qa:!0});return G_(a,w)})(await ql(n),n.asyncQueue,e,t,r))),r.promise}function eM(n,e){const t=new Tp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,a){de(s).Ca.add(a),a.next()})(await ql(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,a){de(s).Ca.delete(a)})(await ql(n),t)))}}function tM(n,e,t,r){const s=(function(l,u){let f;return f=typeof l=="string"?lS().encode(l):l,(function(g,w){return new W4(g,w)})((function(g,w){if(g instanceof Uint8Array)return z0(g,w);if(g instanceof ArrayBuffer)return z0(new Uint8Array(g),w);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),u)})(t,vd(e));n.asyncQueue.enqueueAndForget((async()=>{z4(await sv(n),s,r)}))}function nM(n,e){return n.asyncQueue.enqueue((async()=>(function(r,s){const a=de(r);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,s)))})(await rv(n),e)))}function mA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const q0=new Map;const gA="firestore.googleapis.com",W0=!0;class H0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gA,this.ssl=W0}else this.host=e.host,this.ssl=e.ssl??W0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TL)throw new Q(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mA(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ed{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new H0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new H0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new jV;switch(r.type){case"firstParty":return new $V(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=q0.get(t);r&&(Y("ComponentProvider","Removing Datastore"),q0.delete(t),r.terminate())})(this),Promise.resolve()}}function rM(n,e,t,r={}){n=Xe(n,Ed);const s=Yi(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;s&&(My(`https://${u}`),Fy("Firestore",!0)),a.host!==gA&&a.host!==u&&gs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:u,ssl:s,emulatorOptions:r};if(!Ui(f,l)&&(n._setSettings(f),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=nn.MOCK_USER;else{p=nk(r.mockUserToken,n._app?.options.projectId);const w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new Q(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new nn(w)}n._authCredentials=new UV(new ax(p,g))}}let Cn=class yA{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yA(this.firestore,e,this._query)}},ct=class yu{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yu(this.firestore,e,this._key)}toJSON(){return{type:yu._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ud(t,yu._jsonSchema))return new yu(e,r||null,new ce(ze.fromString(t.referencePath)))}};ct._jsonSchemaVersion="firestore/documentReference/1.0",ct._jsonSchema={type:qt("string",ct._jsonSchemaVersion),referencePath:qt("string")};let ji=class _A extends Cn{constructor(e,t,r){super(e,t,Zl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ct(this.firestore,null,new ce(e))}withConverter(e){return new _A(this.firestore,e,this._path)}};function vA(n,e,...t){if(n=Se(n),f_("collection","path",e),n instanceof Ed){const r=ze.fromString(e,...t);return VI(r),new ji(n,null,r)}{if(!(n instanceof ct||n instanceof ji))throw new Q(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return VI(r),new ji(n.firestore,null,r)}}function sM(n,e){if(n=Xe(n,Ed),f_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Q(W.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Cn(n,null,(function(r){return new Hs(ze.emptyPath(),r)})(e))}function $f(n,e,...t){if(n=Se(n),arguments.length===1&&(e=h_.newId()),f_("doc","path",e),n instanceof Ed){const r=ze.fromString(e,...t);return DI(r),new ct(n,null,new ce(r))}{if(!(n instanceof ct||n instanceof ji))throw new Q(W.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return DI(r),new ct(n.firestore,n instanceof ji?n.converter:null,new ce(r))}}function wA(n,e){return n=Se(n),e=Se(e),(n instanceof ct||n instanceof ji)&&(e instanceof ct||e instanceof ji)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function EA(n,e){return n=Se(n),e=Se(e),n instanceof Cn&&e instanceof Cn&&n.firestore===e.firestore&&pd(n._query,e._query)&&n.converter===e.converter}const G0="AsyncQueue";class K0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z_(this,"async_queue_retry"),this._c=()=>{const r=mf();r&&Y(G0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=mf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=mf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new fn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!to(e))throw e;Y(G0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ot("INTERNAL UNHANDLED ERROR: ",Q0(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=H_.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&pe(47125,{Pc:Q0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Q0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Iy(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class iM{constructor(){this._progressObserver={},this._taskCompletionResolver=new fn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const oM=-1;let Mt=class extends Ed{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new K0,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new K0(e),this._firestoreClient=void 0,await e}}};function Sn(n){if(n._terminated)throw new Q(W.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||IA(n),n._firestoreClient}function IA(n){const e=n._freezeSettings(),t=(function(s,a,l,u){return new bO(s,a,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,mA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new K4(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(n._componentsProvider))}function aM(n,e){gs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return TA(n,Zu.provider,{build:r=>new uA(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function lM(n){gs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();TA(n,Zu.provider,{build:t=>new q4(t,e.cacheSizeBytes)})}function TA(n,e,t){if((n=Xe(n,Mt))._firestoreClient||n._terminated)throw new Q(W.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Q(W.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},IA(n)}function cM(n){if(n._initialized&&!n._terminated)throw new Q(W.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new fn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!hs.v())return Promise.resolve();const s=r+LS;await hs.delete(s)})(F_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function uM(n){return(function(t){const r=new fn;return t.asyncQueue.enqueueAndForget((async()=>C4(await sv(t),r))),r.promise})(Sn(n=Xe(n,Mt)))}function dM(n){return J4(Sn(n=Xe(n,Mt)))}function hM(n){return Y4(Sn(n=Xe(n,Mt)))}function fM(n,e){const t=Sn(n=Xe(n,Mt)),r=new iM;return tM(t,n._databaseId,e,r),r}function pM(n,e){return nM(Sn(n=Xe(n,Mt)),e).then((t=>t?new Cn(n,null,t.query):null))}class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(Pt.fromBase64String(e))}catch(t){throw new Q(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new In(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ud(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:qt("string",In._jsonSchemaVersion),bytes:qt("string")};let Ji=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Q(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let fa=class{constructor(e){this._methodName=e}};class Cr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Q(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Q(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Cr._jsonSchemaVersion}}static fromJSON(e){if(ud(e,Cr._jsonSchema))return new Cr(e.latitude,e.longitude)}}Cr._jsonSchemaVersion="firestore/geoPoint/1.0",Cr._jsonSchema={type:qt("string",Cr._jsonSchemaVersion),latitude:qt("number"),longitude:qt("number")};class ps{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ps._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ud(e,ps._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ps(e.vectorValues);throw new Q(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ps._jsonSchemaVersion="firestore/vectorValue/1.0",ps._jsonSchema={type:qt("string",ps._jsonSchemaVersion),vectorValues:qt("object")};const mM=/^__.*__$/;class gM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ks(e,this.data,this.fieldMask,t,this.fieldTransforms):new ec(e,this.data,t,this.fieldTransforms)}}class xA{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ks(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function SA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe(40011,{Ac:n})}}class Sp{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return qf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(SA(this.Ac)&&mM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yM{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vd(e)}Cc(e,t,r,s=!1){return new Sp({Ac:e,methodName:t,Dc:r,path:_t.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pa(n){const e=n._freezeSettings(),t=vd(n._databaseId);return new yM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ap(n,e,t,r,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);dv("Data must be an object, but it was:",l,r);const u=RA(r,l);let f,p;if(a.merge)f=new zn(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const g=[];for(const w of a.mergeFields){const T=Ty(e,w,t);if(!l.contains(T))throw new Q(W.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);kA(g,T)||g.push(T)}f=new zn(g),p=l.fieldTransforms.filter((w=>f.covers(w.field)))}else f=null,p=l.fieldTransforms;return new gM(new dn(u),f,p)}class Id extends fa{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Id}}function AA(n,e,t){return new Sp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class iv extends fa{_toFieldTransform(e){return new gd(e.path,new Ll)}isEqual(e){return e instanceof iv}}class ov extends fa{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=AA(this,e,!0),r=this.vc.map((a=>ma(a,t))),s=new ra(r);return new gd(e.path,s)}isEqual(e){return e instanceof ov&&Ui(this.vc,e.vc)}}class av extends fa{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=AA(this,e,!0),r=this.vc.map((a=>ma(a,t))),s=new sa(r);return new gd(e.path,s)}isEqual(e){return e instanceof av&&Ui(this.vc,e.vc)}}class lv extends fa{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Ml(e.serializer,Zx(e.serializer,this.Fc));return new gd(e.path,t)}isEqual(e){return e instanceof lv&&this.Fc===e.Fc}}function cv(n,e,t,r){const s=n.Cc(1,e,t);dv("Data must be an object, but it was:",s,r);const a=[],l=dn.empty();no(r,((f,p)=>{const g=hv(e,f,t);p=Se(p);const w=s.yc(g);if(p instanceof Id)a.push(g);else{const T=ma(p,w);T!=null&&(a.push(g),l.set(g,T))}}));const u=new zn(a);return new xA(l,u,s.fieldTransforms)}function uv(n,e,t,r,s,a){const l=n.Cc(1,e,t),u=[Ty(e,r,t)],f=[s];if(a.length%2!=0)throw new Q(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<a.length;T+=2)u.push(Ty(e,a[T])),f.push(a[T+1]);const p=[],g=dn.empty();for(let T=u.length-1;T>=0;--T)if(!kA(p,u[T])){const D=u[T];let S=f[T];S=Se(S);const O=l.yc(D);if(S instanceof Id)p.push(D);else{const L=ma(S,O);L!=null&&(p.push(D),g.set(D,L))}}const w=new zn(p);return new xA(g,w,l.fieldTransforms)}function bA(n,e,t,r=!1){return ma(t,n.Cc(r?4:3,e))}function ma(n,e){if(PA(n=Se(n)))return dv("Unsupported field value:",e,n),RA(n,e);if(n instanceof fa)return(function(r,s){if(!SA(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const u of r){let f=ma(u,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=Se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Zx(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=et.fromDate(r);return{timestampValue:Fl(s.serializer,a)}}if(r instanceof et){const a=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fl(s.serializer,a)}}if(r instanceof Cr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof In)return{bytesValue:dS(s.serializer,r._byteString)};if(r instanceof ct){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:C_(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ps)return(function(l,u){return{mapValue:{fields:{[w_]:{stringValue:E_},[Dl]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw u.Sc("VectorValues must only contain numeric values.");return S_(u.serializer,p)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${lp(r)}`)})(n,e)}function RA(n,e){const t={};return Rx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):no(n,((r,s)=>{const a=ma(s,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function PA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof et||n instanceof Cr||n instanceof In||n instanceof ct||n instanceof fa||n instanceof ps)}function dv(n,e,t){if(!PA(t)||!ux(t)){const r=lp(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Ty(n,e,t){if((e=Se(e))instanceof Ji)return e._internalPath;if(typeof e=="string")return hv(n,e);throw qf("Field path arguments must be of type string or ",n,!1,void 0,t)}const _M=new RegExp("[~\\*/\\[\\]]");function hv(n,e,t){if(e.search(_M)>=0)throw qf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ji(...e.split("."))._internalPath}catch{throw qf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qf(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new Q(W.INVALID_ARGUMENT,u+n+f)}function kA(n,e){return n.some((t=>t.isEqual(e)))}class ed{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(bp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vM extends ed{data(){return super.data()}}function bp(n,e){return typeof e=="string"?hv(n,e):e instanceof Ji?e._internalPath:e._delegate._internalPath}function CA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Q(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fv{}class Td extends fv{}function Pi(n,e,...t){let r=[];e instanceof fv&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof pv)).length,u=a.filter((f=>f instanceof Rp)).length;if(l>1||l>0&&u>0)throw new Q(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Rp extends Td{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Rp(e,t,r)}_apply(e){const t=this._parse(e);return DA(e._query,t),new Cn(e.firestore,e.converter,cy(e._query,t))}_parse(e){const t=pa(e.firestore);return(function(a,l,u,f,p,g,w){let T;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Q(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){Y0(w,g);const S=[];for(const O of w)S.push(J0(f,a,O));T={arrayValue:{values:S}}}else T=J0(f,a,w)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||Y0(w,g),T=bA(u,l,w,g==="in"||g==="not-in");return $e.create(p,g,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wM(n,e,t){const r=e,s=bp("where",n);return Rp._create(s,r,t)}class pv extends fv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pv(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:rt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const u=a.getFlattenedFilters();for(const f of u)DA(l,f),l=cy(l,f)})(e._query,t),new Cn(e.firestore,e.converter,cy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mv extends Td{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mv(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new Q(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qu(a,l)})(e._query,this._field,this._direction);return new Cn(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Hs(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function EM(n,e="asc"){const t=e,r=bp("orderBy",n);return mv._create(r,t)}class Pp extends Td{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Pp(e,t,r)}_apply(e){return new Cn(e.firestore,e.converter,Vf(e._query,this._limit,this._limitType))}}function IM(n){return dx("limit",n),Pp._create("limit",n,"F")}function TM(n){return dx("limitToLast",n),Pp._create("limitToLast",n,"L")}class kp extends Td{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new kp(e,t,r)}_apply(e){const t=NA(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(s,a){return new Hs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,a,s.endAt)})(e._query,t))}}function xM(...n){return kp._create("startAt",n,!0)}function SM(...n){return kp._create("startAfter",n,!1)}class Cp extends Td{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Cp(e,t,r)}_apply(e){const t=NA(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(s,a){return new Hs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,a)})(e._query,t))}}function AM(...n){return Cp._create("endBefore",n,!1)}function bM(...n){return Cp._create("endAt",n,!0)}function NA(n,e,t,r){if(t[0]=Se(t[0]),t[0]instanceof ed)return(function(a,l,u,f,p){if(!f)throw new Q(W.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const g=[];for(const w of El(a))if(w.field.isKeyField())g.push(ta(l,f.key));else{const T=f.data.field(w.field);if(fp(T))throw new Q(W.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const D=w.field.canonicalString();throw new Q(W.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${D}' (used as the orderBy) does not exist.`)}g.push(T)}return new Gi(g,p)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=pa(n.firestore);return(function(l,u,f,p,g,w){const T=l.explicitOrderBy;if(g.length>T.length)throw new Q(W.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const D=[];for(let S=0;S<g.length;S++){const O=g[S];if(T[S].field.isKeyField()){if(typeof O!="string")throw new Q(W.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof O}`);if(!T_(l)&&O.indexOf("/")!==-1)throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${O}' contains a slash.`);const L=l.path.child(ze.fromString(O));if(!ce.isDocumentKey(L))throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${L}' is not because it contains an odd number of segments.`);const se=new ce(L);D.push(ta(u,se))}else{const L=bA(f,p,O);D.push(L)}}return new Gi(D,w)})(n._query,n.firestore._databaseId,s,e,t,r)}}function J0(n,e,t){if(typeof(t=Se(t))=="string"){if(t==="")throw new Q(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!T_(e)&&t.indexOf("/")!==-1)throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ze.fromString(t));if(!ce.isDocumentKey(r))throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ta(n,new ce(r))}if(t instanceof ct)return ta(n,t._key);throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lp(t)}.`)}function Y0(n,e){if(!Array.isArray(n)||n.length===0)throw new Q(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function DA(n,e){const t=(function(s,a){for(const l of s)for(const u of l.getFlattenedFilters())if(a.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Q(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class gv{convertValue(e,t="none"){switch(Wi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return no(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[Dl].arrayValue?.values?.map((r=>yt(r.doubleValue)));return new ps(t)}convertGeoPoint(e){return new Cr(yt(e.latitude),yt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=pp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Hu(e));default:return null}}convertTimestamp(e){const t=zs(e);return new et(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ze.fromString(e);we(IS(r),9688,{name:e});const s=new qi(r.get(1),r.get(3)),a=new ce(r.popFirst(5));return s.isEqual(t)||Ot(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function Np(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class RM extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ct(this.firestore,null,t)}}class qo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let yr=class VA extends ed{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Nu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(bp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=VA._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};yr._jsonSchemaVersion="firestore/documentSnapshot/1.0",yr._jsonSchema={type:qt("string",yr._jsonSchemaVersion),bundleSource:qt("string","DocumentSnapshot"),bundleName:qt("string"),bundle:qt("string")};let Nu=class extends yr{data(e={}){return super.data(e)}},Nr=class OA{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new qo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Nu(this._firestore,this._userDataWriter,r.key,r,new qo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Q(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((u=>{const f=new Nu(s._firestore,s._userDataWriter,u.doc.key,u.doc,new qo(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((u=>a||u.type!==3)).map((u=>{const f=new Nu(s._firestore,s._userDataWriter,u.doc.key,u.doc,new qo(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return u.type!==0&&(p=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),g=l.indexOf(u.doc.key)),{type:PM(u.type),doc:f,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=OA._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=h_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function PM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe(61501,{type:n})}}function LA(n,e){return n instanceof yr&&e instanceof yr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Nr&&e instanceof Nr&&n._firestore===e._firestore&&EA(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function kM(n){n=Xe(n,ct);const e=Xe(n.firestore,Mt);return fA(Sn(e),n._key).then((t=>yv(e,n,t)))}Nr._jsonSchemaVersion="firestore/querySnapshot/1.0",Nr._jsonSchema={type:qt("string",Nr._jsonSchemaVersion),bundleSource:qt("string","QuerySnapshot"),bundleName:qt("string"),bundle:qt("string")};class ga extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ct(this.firestore,null,t)}}function CM(n){n=Xe(n,ct);const e=Xe(n.firestore,Mt),t=Sn(e),r=new ga(e);return X4(t,n._key).then((s=>new yr(e,r,n._key,s,new qo(s!==null&&s.hasLocalMutations,!0),n.converter)))}function NM(n){n=Xe(n,ct);const e=Xe(n.firestore,Mt);return fA(Sn(e),n._key,{source:"server"}).then((t=>yv(e,n,t)))}function DM(n){n=Xe(n,Cn);const e=Xe(n.firestore,Mt),t=Sn(e),r=new ga(e);return CA(n._query),pA(t,n._query).then((s=>new Nr(e,r,n,s)))}function VM(n){n=Xe(n,Cn);const e=Xe(n.firestore,Mt),t=Sn(e),r=new ga(e);return Z4(t,n._query).then((s=>new Nr(e,r,n,s)))}function OM(n){n=Xe(n,Cn);const e=Xe(n.firestore,Mt),t=Sn(e),r=new ga(e);return pA(t,n._query,{source:"server"}).then((s=>new Nr(e,r,n,s)))}function X0(n,e,t){n=Xe(n,ct);const r=Xe(n.firestore,Mt),s=Np(n.converter,e,t);return xd(r,[Ap(pa(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,vt.none())])}function Z0(n,e,t,...r){n=Xe(n,ct);const s=Xe(n.firestore,Mt),a=pa(s);let l;return l=typeof(e=Se(e))=="string"||e instanceof Ji?uv(a,"updateDoc",n._key,e,t,r):cv(a,"updateDoc",n._key,e),xd(s,[l.toMutation(n._key,vt.exists(!0))])}function LM(n){return xd(Xe(n.firestore,Mt),[new tc(n._key,vt.none())])}function MM(n,e){const t=Xe(n.firestore,Mt),r=$f(n),s=Np(n.converter,e);return xd(t,[Ap(pa(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,vt.exists(!1))]).then((()=>r))}function MA(n,...e){n=Se(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Iy(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Iy(e[r])){const f=e[r];e[r]=f.next?.bind(f),e[r+1]=f.error?.bind(f),e[r+2]=f.complete?.bind(f)}let a,l,u;if(n instanceof ct)l=Xe(n.firestore,Mt),u=Zl(n._key.path),a={next:f=>{e[r]&&e[r](yv(l,n,f))},error:e[r+1],complete:e[r+2]};else{const f=Xe(n,Cn);l=Xe(f.firestore,Mt),u=f._query;const p=new ga(l);a={next:g=>{e[r]&&e[r](new Nr(l,p,f,g))},error:e[r+1],complete:e[r+2]},CA(n._query)}return(function(p,g,w,T){const D=new Tp(T),S=new J_(g,D,w);return p.asyncQueue.enqueueAndForget((async()=>G_(await ql(p),S))),()=>{D.Nu(),p.asyncQueue.enqueueAndForget((async()=>K_(await ql(p),S)))}})(Sn(l),u,s,a)}function FM(n,e){return eM(Sn(n=Xe(n,Mt)),Iy(e)?e:{next:e})}function xd(n,e){return(function(r,s){const a=new fn;return r.asyncQueue.enqueueAndForget((async()=>b4(await sv(r),s,a))),a.promise})(Sn(n),e)}function yv(n,e,t){const r=t.docs.get(e._key),s=new ga(n);return new yr(n,s,e._key,r,new qo(t.hasPendingWrites,t.fromCache),e.converter)}const jM={maxAttempts:5};let UM=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=pa(e)}set(e,t,r){this._verifyNotCommitted();const s=Di(e,this._firestore),a=Np(s.converter,t,r),l=Ap(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,r);return this._mutations.push(l.toMutation(s._key,vt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const a=Di(e,this._firestore);let l;return l=typeof(t=Se(t))=="string"||t instanceof Ji?uv(this._dataReader,"WriteBatch.update",a._key,t,r,s):cv(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,vt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Di(e,this._firestore);return this._mutations=this._mutations.concat(new tc(t._key,vt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Q(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Di(n,e){if((n=Se(n)).firestore!==e)throw new Q(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class BM{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=pa(e)}get(e){const t=Di(e,this._firestore),r=new RM(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return pe(24041);const a=s[0];if(a.isFoundDocument())return new ed(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new ed(this._firestore,r,t._key,null,t.converter);throw pe(18433,{doc:a})}))}set(e,t,r){const s=Di(e,this._firestore),a=Np(s.converter,t,r),l=Ap(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,l),this}update(e,t,r,...s){const a=Di(e,this._firestore);let l;return l=typeof(t=Se(t))=="string"||t instanceof Ji?uv(this._dataReader,"Transaction.update",a._key,t,r,s):cv(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Di(e,this._firestore);return this._transaction.delete(t._key),this}}let zM=class extends BM{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Di(e,this._firestore),r=new ga(this._firestore);return super.get(e).then((s=>new yr(this._firestore,r,t._key,s._document,new qo(!1,!1),t.converter)))}};function $M(n,e,t){n=Xe(n,Mt);const r={...jM,...t};return(function(a){if(a.maxAttempts<1)throw new Q(W.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(a,l,u){const f=new fn;return a.asyncQueue.enqueueAndForget((async()=>{const p=await Q4(a);new G4(a.asyncQueue,p,u,l,f).ju()})),f.promise})(Sn(n),(s=>e(new zM(n,s))),r)}function qM(){return new Id("deleteField")}function WM(){return new iv("serverTimestamp")}function HM(...n){return new ov("arrayUnion",n)}function GM(...n){return new av("arrayRemove",n)}function KM(n){return new lv("increment",n)}(function(e,t=!0){(function(s){Xl=s})(Xi),Us(new _r("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),u=new Mt(new BV(r.getProvider("auth-internal")),new qV(l,r.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Q(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qi(p.options.projectId,g)})(l,s),l);return a={useFetchStreams:t,...a},u._setSettings(a),u}),"PUBLIC").setMultipleInstances(!0)),or(PI,kI,e),or(PI,kI,"esm2020")})();const QM="@firebase/firestore-compat",JM="0.4.3";function _v(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Q("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function eT(){if(typeof Uint8Array>"u")throw new Q("unimplemented","Uint8Arrays are not available in this environment.")}function tT(){if(!SO())throw new Q("unimplemented","Blobs are unavailable in Firestore in this environment.")}let FA=class xy{constructor(e){this._delegate=e}static fromBase64String(e){return tT(),new xy(In.fromBase64String(e))}static fromUint8Array(e){return eT(),new xy(In.fromUint8Array(e))}toBase64(){return tT(),this._delegate.toBase64()}toUint8Array(){return eT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Sy(n){return YM(n,["next","error","complete"])}function YM(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class XM{enableIndexedDbPersistence(e,t){return aM(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return lM(e._delegate)}clearIndexedDbPersistence(e){return cM(e._delegate)}}class jA{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof qi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&gs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){rM(this._delegate,e,t,r)}enableNetwork(){return dM(this._delegate)}disableNetwork(){return hM(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,cx("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return uM(this._delegate)}onSnapshotsInSync(e){return FM(this._delegate,e)}get app(){if(!this._appCompat)throw new Q("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Wl(this,vA(this._delegate,e))}catch(t){throw Pn(t,"collection()","Firestore.collection()")}}doc(e){try{return new gr(this,$f(this._delegate,e))}catch(t){throw Pn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Rn(this,sM(this._delegate,e))}catch(t){throw Pn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return $M(this._delegate,t=>e(new UA(this,t)))}batch(){return Sn(this._delegate),new BA(new UM(this._delegate,e=>xd(this._delegate,e)))}loadBundle(e){return fM(this._delegate,e)}namedQuery(e){return pM(this._delegate,e).then(t=>t?new Rn(this,t):null)}}class Dp extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new FA(new In(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return gr.forKey(t,this.firestore,null)}}function ZM(n){MV(n)}class UA{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Dp(e)}get(e){const t=Wo(e);return this._delegate.get(t).then(r=>new td(this._firestore,new yr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=Wo(e);return r?(_v("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Wo(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Wo(e);return this._delegate.delete(t),this}}class BA{constructor(e){this._delegate=e}set(e,t,r){const s=Wo(e);return r?(_v("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Wo(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Wo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ca{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Nu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new nd(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ca.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let a=s.get(t);return a||(a=new ca(e,new Dp(e),t),s.set(t,a)),a}}ca.INSTANCES=new WeakMap;class gr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Dp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Q("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new gr(t,new ct(t._delegate,r,new ce(e)))}static forKey(e,t,r){return new gr(t,new ct(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Wl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Wl(this.firestore,vA(this._delegate,e))}catch(t){throw Pn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Se(e),e instanceof ct?wA(this._delegate,e):!1}set(e,t){t=_v("DocumentReference.set",t);try{return t?X0(this._delegate,e,t):X0(this._delegate,e)}catch(r){throw Pn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Z0(this._delegate,e):Z0(this._delegate,e,t,...r)}catch(s){throw Pn(s,"updateDoc()","DocumentReference.update()")}}delete(){return LM(this._delegate)}onSnapshot(...e){const t=zA(e),r=$A(e,s=>new td(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return MA(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=CM(this._delegate):e?.source==="server"?t=NM(this._delegate):t=kM(this._delegate),t.then(r=>new td(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new gr(this.firestore,e?this._delegate.withConverter(ca.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Pn(n,e,t){return n.message=n.message.replace(e,t),n}function zA(n){for(const e of n)if(typeof e=="object"&&!Sy(e))return e;return{}}function $A(n,e){let t;return Sy(n[0])?t=n[0]:Sy(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class td{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new gr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return LA(this._delegate,e._delegate)}}class nd extends td{data(e){const t=this._delegate.data(e);return this._delegate._converter||FV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Rn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Dp(e)}where(e,t,r){try{return new Rn(this.firestore,Pi(this._delegate,wM(e,t,r)))}catch(s){throw Pn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Rn(this.firestore,Pi(this._delegate,EM(e,t)))}catch(r){throw Pn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Rn(this.firestore,Pi(this._delegate,IM(e)))}catch(t){throw Pn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Rn(this.firestore,Pi(this._delegate,TM(e)))}catch(t){throw Pn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Rn(this.firestore,Pi(this._delegate,xM(...e)))}catch(t){throw Pn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Rn(this.firestore,Pi(this._delegate,SM(...e)))}catch(t){throw Pn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Rn(this.firestore,Pi(this._delegate,AM(...e)))}catch(t){throw Pn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Rn(this.firestore,Pi(this._delegate,bM(...e)))}catch(t){throw Pn(t,"endAt()","Query.endAt()")}}isEqual(e){return EA(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=VM(this._delegate):e?.source==="server"?t=OM(this._delegate):t=DM(this._delegate),t.then(r=>new Ay(this.firestore,new Nr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=zA(e),r=$A(e,s=>new Ay(this.firestore,new Nr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return MA(this._delegate,t,r)}withConverter(e){return new Rn(this.firestore,e?this._delegate.withConverter(ca.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class eF{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new nd(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ay{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Rn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new nd(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new eF(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new nd(this._firestore,r))})}isEqual(e){return LA(this._delegate,e._delegate)}}class Wl extends Rn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new gr(this.firestore,e):null}doc(e){try{return e===void 0?new gr(this.firestore,$f(this._delegate)):new gr(this.firestore,$f(this._delegate,e))}catch(t){throw Pn(t,"doc()","CollectionReference.doc()")}}add(e){return MM(this._delegate,e).then(t=>new gr(this.firestore,t))}isEqual(e){return wA(this._delegate,e._delegate)}withConverter(e){return new Wl(this.firestore,e?this._delegate.withConverter(ca.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Wo(n){return Xe(n,ct)}class vv{constructor(...e){this._delegate=new Ji(...e)}static documentId(){return new vv(_t.keyField().canonicalString())}isEqual(e){return e=Se(e),e instanceof Ji?this._delegate._internalPath.isEqual(e._internalPath):!1}}class Bo{static serverTimestamp(){const e=WM();return e._methodName="FieldValue.serverTimestamp",new Bo(e)}static delete(){const e=qM();return e._methodName="FieldValue.delete",new Bo(e)}static arrayUnion(...e){const t=HM(...e);return t._methodName="FieldValue.arrayUnion",new Bo(t)}static arrayRemove(...e){const t=GM(...e);return t._methodName="FieldValue.arrayRemove",new Bo(t)}static increment(e){const t=KM(e);return t._methodName="FieldValue.increment",new Bo(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const tF={Firestore:jA,GeoPoint:Cr,Timestamp:et,Blob:FA,Transaction:UA,WriteBatch:BA,DocumentReference:gr,DocumentSnapshot:td,Query:Rn,QueryDocumentSnapshot:nd,QuerySnapshot:Ay,CollectionReference:Wl,FieldPath:vv,FieldValue:Bo,setLogLevel:ZM,CACHE_SIZE_UNLIMITED:oM};function nF(n,e){n.INTERNAL.registerComponent(new _r("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps({...tF}))}function rF(n){nF(n,(e,t)=>new jA(e,t,new XM)),n.registerVersion(QM,JM)}rF(hn);const sF="type.googleapis.com/google.protobuf.Int64Value",iF="type.googleapis.com/google.protobuf.UInt64Value";function qA(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Wf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Wf(e));if(typeof n=="function"||typeof n=="object")return qA(n,e=>Wf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Hl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case sF:case iF:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Hl(e)):typeof n=="function"||typeof n=="object"?qA(n,e=>Hl(e)):n}const WA="functions";const nT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qn extends rn{constructor(e,t,r){super(`${WA}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,qn.prototype)}}function oF(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Hf(n,e){let t=oF(n),r=t,s;try{const a=e&&e.error;if(a){const l=a.status;if(typeof l=="string"){if(!nT[l])return new qn("internal","internal");t=nT[l],r=l}const u=a.message;typeof u=="string"&&(r=u),s=a.details,s!==void 0&&(s=Hl(s))}}catch{}return t==="ok"?null:new qn(t,r,s)}class aF{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,mt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||s?.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const rT="us-central1",lF=/^data: (.*?)(?:\n|$)/;function cF(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new qn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}let uF=class{constructor(e,t,r,s,a=rT,l=(...u)=>fetch(...u)){this.app=e,this.fetchImpl=l,this.emulatorOrigin=null,this.contextProvider=new aF(e,t,r,s),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(a);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=rT}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function dF(n,e,t){const r=Yi(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(My(n.emulatorOrigin+"/backends"),Fy("Functions",!0))}function hF(n,e,t){const r=s=>mF(n,e,s,t||{});return r.stream=(s,a)=>gF(n,e,s,a),r}function fF(n,e,t){const r=s=>KA(n,e,s,t||{});return r.stream=(s,a)=>QA(n,e,s,a||{}),r}function HA(n){return n.emulatorOrigin&&Yi(n.emulatorOrigin)?"include":void 0}async function pF(n,e,t,r,s){t["Content-Type"]="application/json";let a;try{a=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:HA(s)})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function GA(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function mF(n,e,t,r){const s=n._url(e);return KA(n,s,t,r)}async function KA(n,e,t,r){t=Wf(t);const s={data:t},a=await GA(n,r),l=r.timeout||7e4,u=cF(l),f=await Promise.race([pF(e,s,a,n.fetchImpl,n),u.promise,n.cancelAllRequests]);if(u.cancel(),!f)throw new qn("cancelled","Firebase Functions instance was deleted.");const p=Hf(f.status,f.json);if(p)throw p;if(!f.json)throw new qn("internal","Response is not valid JSON object.");let g=f.json.data;if(typeof g>"u"&&(g=f.json.result),typeof g>"u")throw new qn("internal","Response is missing data field.");return{data:Hl(g)}}function gF(n,e,t,r){const s=n._url(e);return QA(n,s,t,r||{})}async function QA(n,e,t,r){t=Wf(t);const s={data:t},a=await GA(n,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let l;try{l=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:a,signal:r?.signal,credentials:HA(n)})}catch(T){if(T instanceof Error&&T.name==="AbortError"){const S=new qn("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const D=Hf(0,null);return{data:Promise.reject(D),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(D)}}}}}}let u,f;const p=new Promise((T,D)=>{u=T,f=D});r?.signal?.addEventListener("abort",()=>{const T=new qn("cancelled","Request was cancelled.");f(T)});const g=l.body.getReader(),w=yF(g,u,f,r?.signal);return{stream:{[Symbol.asyncIterator](){const T=w.getReader();return{async next(){const{value:D,done:S}=await T.read();return{value:D,done:S}},async return(){return await T.cancel(),{done:!0,value:void 0}}}}},data:p}}function yF(n,e,t,r){const s=(l,u)=>{const f=l.match(lF);if(!f)return;const p=f[1];try{const g=JSON.parse(p);if("result"in g){e(Hl(g.result));return}if("message"in g){u.enqueue(Hl(g.message));return}if("error"in g){const w=Hf(0,g);u.error(w),t(w);return}}catch(g){if(g instanceof qn){u.error(g),t(g);return}}},a=new TextDecoder;return new ReadableStream({start(l){let u="";return f();async function f(){if(r?.aborted){const p=new qn("cancelled","Request was cancelled");return l.error(p),t(p),Promise.resolve()}try{const{value:p,done:g}=await n.read();if(g){u.trim()&&s(u.trim(),l),l.close();return}if(r?.aborted){const T=new qn("cancelled","Request was cancelled");l.error(T),t(T),await n.cancel();return}u+=a.decode(p,{stream:!0});const w=u.split(`
`);u=w.pop()||"";for(const T of w)T.trim()&&s(T.trim(),l);return f()}catch(p){const g=p instanceof qn?p:Hf(0,null);l.error(g),t(g)}}},cancel(){return n.cancel()}})}const sT="@firebase/functions",iT="0.13.1";const _F="auth-internal",vF="app-check-internal",wF="messaging-internal";function EF(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),a=t.getProvider(_F),l=t.getProvider(wF),u=t.getProvider(vF);return new uF(s,a,l,u,r)};Us(new _r(WA,e,"PUBLIC").setMultipleInstances(!0)),or(sT,iT,n),or(sT,iT,"esm2020")}function oT(n,e,t){dF(Se(n),e,t)}function IF(n,e,t){return hF(Se(n),e,t)}function TF(n,e,t){return fF(Se(n),e,t)}EF();const xF="@firebase/functions-compat",SF="0.4.1";class JA{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return IF(this._delegate,e,t)}httpsCallableFromURL(e,t){return TF(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(t==null)throw new rn("functions","No origin provided to useFunctionsEmulator()");if(t[2]==null)throw new rn("functions","Port missing in origin provided to useFunctionsEmulator()");return oT(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return oT(this._delegate,e,t)}}const AF="us-central1",bF=(n,{instanceIdentifier:e})=>{const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("functions").getImmediate({identifier:e??AF});return new JA(t,r)};function RF(){const n={Functions:JA};hn.INTERNAL.registerComponent(new _r("functions-compat",bF,"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}RF();hn.registerVersion(xF,SF);const PF={apiKey:"AIzaSyDummyKeyForEmulatorOnly",projectId:"schoolbook-290b6"};hn.apps.length||hn.initializeApp(PF);const Vt=hn.firestore(),gl=hn.auth(),Gf=hn.functions(),aT=window.location.hostname;(aT==="localhost"||aT==="127.0.0.1")&&(console.log("Using Firebase Emulators"),Vt.useEmulator("127.0.0.1",8088),gl.useEmulator("http://127.0.0.1:9099",{disableWarnings:!0}),Gf.useEmulator("127.0.0.1",5001));const as=Object.freeze(Object.defineProperty({__proto__:null,auth:gl,db:Vt,firebase:hn,functions:Gf},Symbol.toStringTag,{value:"Module"})),Jo={onAuthStateChanged(n){return gl.onAuthStateChanged(n)},async signUp(n,e){return gl.createUserWithEmailAndPassword(n,e)},async login(n,e){return gl.signInWithEmailAndPassword(n,e)},async logout(){return gl.signOut()},async completeProfile(n){return Gf.httpsCallable("completeProfile")(n)},onProfileSnapshot(n,e){return Vt.collection("users").doc(n).onSnapshot(e)},async getBindingCode(){return Gf.httpsCallable("generateBindingCode")()}};function YA(n,e){return function(){return n.apply(e,arguments)}}const{toString:kF}=Object.prototype,{getPrototypeOf:wv}=Object,{iterator:Vp,toStringTag:XA}=Symbol,Op=(n=>e=>{const t=kF.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Vr=n=>(n=n.toLowerCase(),e=>Op(e)===n),Lp=n=>e=>typeof e===n,{isArray:oc}=Array,Gl=Lp("undefined");function Sd(n){return n!==null&&!Gl(n)&&n.constructor!==null&&!Gl(n.constructor)&&Wn(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const ZA=Vr("ArrayBuffer");function CF(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&ZA(n.buffer),e}const NF=Lp("string"),Wn=Lp("function"),eb=Lp("number"),Ad=n=>n!==null&&typeof n=="object",DF=n=>n===!0||n===!1,gf=n=>{if(Op(n)!=="object")return!1;const e=wv(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(XA in n)&&!(Vp in n)},VF=n=>{if(!Ad(n)||Sd(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},OF=Vr("Date"),LF=Vr("File"),MF=Vr("Blob"),FF=Vr("FileList"),jF=n=>Ad(n)&&Wn(n.pipe),UF=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Wn(n.append)&&((e=Op(n))==="formdata"||e==="object"&&Wn(n.toString)&&n.toString()==="[object FormData]"))},BF=Vr("URLSearchParams"),[zF,$F,qF,WF]=["ReadableStream","Request","Response","Headers"].map(Vr),HF=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bd(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),oc(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{if(Sd(n))return;const a=t?Object.getOwnPropertyNames(n):Object.keys(n),l=a.length;let u;for(r=0;r<l;r++)u=a[r],e.call(null,n[u],u,n)}}function tb(n,e){if(Sd(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Ho=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,nb=n=>!Gl(n)&&n!==Ho;function by(){const{caseless:n,skipUndefined:e}=nb(this)&&this||{},t={},r=(s,a)=>{const l=n&&tb(t,a)||a;gf(t[l])&&gf(s)?t[l]=by(t[l],s):gf(s)?t[l]=by({},s):oc(s)?t[l]=s.slice():(!e||!Gl(s))&&(t[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&bd(arguments[s],r);return t}const GF=(n,e,t,{allOwnKeys:r}={})=>(bd(e,(s,a)=>{t&&Wn(s)?n[a]=YA(s,t):n[a]=s},{allOwnKeys:r}),n),KF=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),QF=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},JF=(n,e,t,r)=>{let s,a,l;const u={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),a=s.length;a-- >0;)l=s[a],(!r||r(l,n,e))&&!u[l]&&(e[l]=n[l],u[l]=!0);n=t!==!1&&wv(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},YF=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},XF=n=>{if(!n)return null;if(oc(n))return n;let e=n.length;if(!eb(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},ZF=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&wv(Uint8Array)),e5=(n,e)=>{const r=(n&&n[Vp]).call(n);let s;for(;(s=r.next())&&!s.done;){const a=s.value;e.call(n,a[0],a[1])}},t5=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},n5=Vr("HTMLFormElement"),r5=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),lT=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),s5=Vr("RegExp"),rb=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};bd(t,(s,a)=>{let l;(l=e(s,a,n))!==!1&&(r[a]=l||s)}),Object.defineProperties(n,r)},i5=n=>{rb(n,(e,t)=>{if(Wn(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Wn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},o5=(n,e)=>{const t={},r=s=>{s.forEach(a=>{t[a]=!0})};return oc(n)?r(n):r(String(n).split(e)),t},a5=()=>{},l5=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function c5(n){return!!(n&&Wn(n.append)&&n[XA]==="FormData"&&n[Vp])}const u5=n=>{const e=new Array(10),t=(r,s)=>{if(Ad(r)){if(e.indexOf(r)>=0)return;if(Sd(r))return r;if(!("toJSON"in r)){e[s]=r;const a=oc(r)?[]:{};return bd(r,(l,u)=>{const f=t(l,s+1);!Gl(f)&&(a[u]=f)}),e[s]=void 0,a}}return r};return t(n,0)},d5=Vr("AsyncFunction"),h5=n=>n&&(Ad(n)||Wn(n))&&Wn(n.then)&&Wn(n.catch),sb=((n,e)=>n?setImmediate:e?((t,r)=>(Ho.addEventListener("message",({source:s,data:a})=>{s===Ho&&a===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Ho.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Wn(Ho.postMessage)),f5=typeof queueMicrotask<"u"?queueMicrotask.bind(Ho):typeof process<"u"&&process.nextTick||sb,p5=n=>n!=null&&Wn(n[Vp]),G={isArray:oc,isArrayBuffer:ZA,isBuffer:Sd,isFormData:UF,isArrayBufferView:CF,isString:NF,isNumber:eb,isBoolean:DF,isObject:Ad,isPlainObject:gf,isEmptyObject:VF,isReadableStream:zF,isRequest:$F,isResponse:qF,isHeaders:WF,isUndefined:Gl,isDate:OF,isFile:LF,isBlob:MF,isRegExp:s5,isFunction:Wn,isStream:jF,isURLSearchParams:BF,isTypedArray:ZF,isFileList:FF,forEach:bd,merge:by,extend:GF,trim:HF,stripBOM:KF,inherits:QF,toFlatObject:JF,kindOf:Op,kindOfTest:Vr,endsWith:YF,toArray:XF,forEachEntry:e5,matchAll:t5,isHTMLForm:n5,hasOwnProperty:lT,hasOwnProp:lT,reduceDescriptors:rb,freezeMethods:i5,toObjectSet:o5,toCamelCase:r5,noop:a5,toFiniteNumber:l5,findKey:tb,global:Ho,isContextDefined:nb,isSpecCompliantForm:c5,toJSONObject:u5,isAsyncFn:d5,isThenable:h5,setImmediate:sb,asap:f5,isIterable:p5};function Le(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}G.inherits(Le,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}});const ib=Le.prototype,ob={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{ob[n]={value:n}});Object.defineProperties(Le,ob);Object.defineProperty(ib,"isAxiosError",{value:!0});Le.from=(n,e,t,r,s,a)=>{const l=Object.create(ib);G.toFlatObject(n,l,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const u=n&&n.message?n.message:"Error",f=e==null&&n?n.code:e;return Le.call(l,u,f,t,r,s),n&&l.cause==null&&Object.defineProperty(l,"cause",{value:n,configurable:!0}),l.name=n&&n.name||"Error",a&&Object.assign(l,a),l};const m5=null;function Ry(n){return G.isPlainObject(n)||G.isArray(n)}function ab(n){return G.endsWith(n,"[]")?n.slice(0,-2):n}function cT(n,e,t){return n?n.concat(e).map(function(s,a){return s=ab(s),!t&&a?"["+s+"]":s}).join(t?".":""):e}function g5(n){return G.isArray(n)&&!n.some(Ry)}const y5=G.toFlatObject(G,{},null,function(e){return/^is[A-Z]/.test(e)});function Mp(n,e,t){if(!G.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=G.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,L){return!G.isUndefined(L[O])});const r=t.metaTokens,s=t.visitor||g,a=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(e);if(!G.isFunction(s))throw new TypeError("visitor must be a function");function p(S){if(S===null)return"";if(G.isDate(S))return S.toISOString();if(G.isBoolean(S))return S.toString();if(!f&&G.isBlob(S))throw new Le("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(S)||G.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function g(S,O,L){let se=S;if(S&&!L&&typeof S=="object"){if(G.endsWith(O,"{}"))O=r?O:O.slice(0,-2),S=JSON.stringify(S);else if(G.isArray(S)&&g5(S)||(G.isFileList(S)||G.endsWith(O,"[]"))&&(se=G.toArray(S)))return O=ab(O),se.forEach(function(Z,ge){!(G.isUndefined(Z)||Z===null)&&e.append(l===!0?cT([O],ge,a):l===null?O:O+"[]",p(Z))}),!1}return Ry(S)?!0:(e.append(cT(L,O,a),p(S)),!1)}const w=[],T=Object.assign(y5,{defaultVisitor:g,convertValue:p,isVisitable:Ry});function D(S,O){if(!G.isUndefined(S)){if(w.indexOf(S)!==-1)throw Error("Circular reference detected in "+O.join("."));w.push(S),G.forEach(S,function(se,oe){(!(G.isUndefined(se)||se===null)&&s.call(e,se,G.isString(oe)?oe.trim():oe,O,T))===!0&&D(se,O?O.concat(oe):[oe])}),w.pop()}}if(!G.isObject(n))throw new TypeError("data must be an object");return D(n),e}function uT(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Ev(n,e){this._pairs=[],n&&Mp(n,this,e)}const lb=Ev.prototype;lb.append=function(e,t){this._pairs.push([e,t])};lb.toString=function(e){const t=e?function(r){return e.call(this,r,uT)}:uT;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function _5(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cb(n,e,t){if(!e)return n;const r=t&&t.encode||_5;G.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let a;if(s?a=s(e,t):a=G.isURLSearchParams(e)?e.toString():new Ev(e,t).toString(r),a){const l=n.indexOf("#");l!==-1&&(n=n.slice(0,l)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class dT{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){G.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ub={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},v5=typeof URLSearchParams<"u"?URLSearchParams:Ev,w5=typeof FormData<"u"?FormData:null,E5=typeof Blob<"u"?Blob:null,I5={isBrowser:!0,classes:{URLSearchParams:v5,FormData:w5,Blob:E5},protocols:["http","https","file","blob","url","data"]},Iv=typeof window<"u"&&typeof document<"u",Py=typeof navigator=="object"&&navigator||void 0,T5=Iv&&(!Py||["ReactNative","NativeScript","NS"].indexOf(Py.product)<0),x5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",S5=Iv&&window.location.href||"http://localhost",A5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Iv,hasStandardBrowserEnv:T5,hasStandardBrowserWebWorkerEnv:x5,navigator:Py,origin:S5},Symbol.toStringTag,{value:"Module"})),Tn={...A5,...I5};function b5(n,e){return Mp(n,new Tn.classes.URLSearchParams,{visitor:function(t,r,s,a){return Tn.isNode&&G.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function R5(n){return G.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function P5(n){const e={},t=Object.keys(n);let r;const s=t.length;let a;for(r=0;r<s;r++)a=t[r],e[a]=n[a];return e}function db(n){function e(t,r,s,a){let l=t[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),f=a>=t.length;return l=!l&&G.isArray(s)?s.length:l,f?(G.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!u):((!s[l]||!G.isObject(s[l]))&&(s[l]=[]),e(t,r,s[l],a)&&G.isArray(s[l])&&(s[l]=P5(s[l])),!u)}if(G.isFormData(n)&&G.isFunction(n.entries)){const t={};return G.forEachEntry(n,(r,s)=>{e(R5(r),s,t,0)}),t}return null}function k5(n,e,t){if(G.isString(n))try{return(e||JSON.parse)(n),G.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Rd={transitional:ub,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=G.isObject(e);if(a&&G.isHTMLForm(e)&&(e=new FormData(e)),G.isFormData(e))return s?JSON.stringify(db(e)):e;if(G.isArrayBuffer(e)||G.isBuffer(e)||G.isStream(e)||G.isFile(e)||G.isBlob(e)||G.isReadableStream(e))return e;if(G.isArrayBufferView(e))return e.buffer;if(G.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return b5(e,this.formSerializer).toString();if((u=G.isFileList(e))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Mp(u?{"files[]":e}:e,f&&new f,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),k5(e)):e}],transformResponse:[function(e){const t=this.transitional||Rd.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(G.isResponse(e)||G.isReadableStream(e))return e;if(e&&G.isString(e)&&(r&&!this.responseType||s)){const l=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?Le.from(u,Le.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Tn.classes.FormData,Blob:Tn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],n=>{Rd.headers[n]={}});const C5=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N5=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(l){s=l.indexOf(":"),t=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!t||e[t]&&C5[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},hT=Symbol("internals");function cu(n){return n&&String(n).trim().toLowerCase()}function yf(n){return n===!1||n==null?n:G.isArray(n)?n.map(yf):String(n)}function D5(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const V5=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Vg(n,e,t,r,s){if(G.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!G.isString(e)){if(G.isString(r))return e.indexOf(r)!==-1;if(G.isRegExp(r))return r.test(e)}}function O5(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function L5(n,e){const t=G.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,a,l){return this[r].call(this,e,s,a,l)},configurable:!0})})}let Hn=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function a(u,f,p){const g=cu(f);if(!g)throw new Error("header name must be a non-empty string");const w=G.findKey(s,g);(!w||s[w]===void 0||p===!0||p===void 0&&s[w]!==!1)&&(s[w||f]=yf(u))}const l=(u,f)=>G.forEach(u,(p,g)=>a(p,g,f));if(G.isPlainObject(e)||e instanceof this.constructor)l(e,t);else if(G.isString(e)&&(e=e.trim())&&!V5(e))l(N5(e),t);else if(G.isObject(e)&&G.isIterable(e)){let u={},f,p;for(const g of e){if(!G.isArray(g))throw TypeError("Object iterator must return a key-value pair");u[p=g[0]]=(f=u[p])?G.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}l(u,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=cu(e),e){const r=G.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return D5(s);if(G.isFunction(t))return t.call(this,s,r);if(G.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=cu(e),e){const r=G.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Vg(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function a(l){if(l=cu(l),l){const u=G.findKey(r,l);u&&(!t||Vg(r,r[u],u,t))&&(delete r[u],s=!0)}}return G.isArray(e)?e.forEach(a):a(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const a=t[r];(!e||Vg(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const t=this,r={};return G.forEach(this,(s,a)=>{const l=G.findKey(r,a);if(l){t[l]=yf(s),delete t[a];return}const u=e?O5(a):String(a).trim();u!==a&&delete t[a],t[u]=yf(s),r[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return G.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&G.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[hT]=this[hT]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=cu(l);r[u]||(L5(s,l),r[u]=!0)}return G.isArray(e)?e.forEach(a):a(e),this}};Hn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.reduceDescriptors(Hn.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});G.freezeMethods(Hn);function Og(n,e){const t=this||Rd,r=e||t,s=Hn.from(r.headers);let a=r.data;return G.forEach(n,function(u){a=u.call(t,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function hb(n){return!!(n&&n.__CANCEL__)}function ac(n,e,t){Le.call(this,n??"canceled",Le.ERR_CANCELED,e,t),this.name="CanceledError"}G.inherits(ac,Le,{__CANCEL__:!0});function fb(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Le("Request failed with status code "+t.status,[Le.ERR_BAD_REQUEST,Le.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function M5(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function F5(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,a=0,l;return e=e!==void 0?e:1e3,function(f){const p=Date.now(),g=r[a];l||(l=p),t[s]=f,r[s]=p;let w=a,T=0;for(;w!==s;)T+=t[w++],w=w%n;if(s=(s+1)%n,s===a&&(a=(a+1)%n),p-l<e)return;const D=g&&p-g;return D?Math.round(T*1e3/D):void 0}}function j5(n,e){let t=0,r=1e3/e,s,a;const l=(p,g=Date.now())=>{t=g,s=null,a&&(clearTimeout(a),a=null),n(...p)};return[(...p)=>{const g=Date.now(),w=g-t;w>=r?l(p,g):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},r-w)))},()=>s&&l(s)]}const Kf=(n,e,t=3)=>{let r=0;const s=F5(50,250);return j5(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,f=l-r,p=s(f),g=l<=u;r=l;const w={loaded:l,total:u,progress:u?l/u:void 0,bytes:f,rate:p||void 0,estimated:p&&u&&g?(u-l)/p:void 0,event:a,lengthComputable:u!=null,[e?"download":"upload"]:!0};n(w)},t)},fT=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},pT=n=>(...e)=>G.asap(()=>n(...e)),U5=Tn.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Tn.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Tn.origin),Tn.navigator&&/(msie|trident)/i.test(Tn.navigator.userAgent)):()=>!0,B5=Tn.hasStandardBrowserEnv?{write(n,e,t,r,s,a,l){if(typeof document>"u")return;const u=[`${n}=${encodeURIComponent(e)}`];G.isNumber(t)&&u.push(`expires=${new Date(t).toUTCString()}`),G.isString(r)&&u.push(`path=${r}`),G.isString(s)&&u.push(`domain=${s}`),a===!0&&u.push("secure"),G.isString(l)&&u.push(`SameSite=${l}`),document.cookie=u.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function z5(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function $5(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function pb(n,e,t){let r=!z5(e);return n&&(r||t==!1)?$5(n,e):e}const mT=n=>n instanceof Hn?{...n}:n;function ua(n,e){e=e||{};const t={};function r(p,g,w,T){return G.isPlainObject(p)&&G.isPlainObject(g)?G.merge.call({caseless:T},p,g):G.isPlainObject(g)?G.merge({},g):G.isArray(g)?g.slice():g}function s(p,g,w,T){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p,w,T)}else return r(p,g,w,T)}function a(p,g){if(!G.isUndefined(g))return r(void 0,g)}function l(p,g){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p)}else return r(void 0,g)}function u(p,g,w){if(w in e)return r(p,g);if(w in n)return r(void 0,p)}const f={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(p,g,w)=>s(mT(p),mT(g),w,!0)};return G.forEach(Object.keys({...n,...e}),function(g){const w=f[g]||s,T=w(n[g],e[g],g);G.isUndefined(T)&&w!==u||(t[g]=T)}),t}const mb=n=>{const e=ua({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:u}=e;if(e.headers=l=Hn.from(l),e.url=cb(pb(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),G.isFormData(t)){if(Tn.hasStandardBrowserEnv||Tn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(G.isFunction(t.getHeaders)){const f=t.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,w])=>{p.includes(g.toLowerCase())&&l.set(g,w)})}}if(Tn.hasStandardBrowserEnv&&(r&&G.isFunction(r)&&(r=r(e)),r||r!==!1&&U5(e.url))){const f=s&&a&&B5.read(a);f&&l.set(s,f)}return e},q5=typeof XMLHttpRequest<"u",W5=q5&&function(n){return new Promise(function(t,r){const s=mb(n);let a=s.data;const l=Hn.from(s.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:p}=s,g,w,T,D,S;function O(){D&&D(),S&&S(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let L=new XMLHttpRequest;L.open(s.method.toUpperCase(),s.url,!0),L.timeout=s.timeout;function se(){if(!L)return;const Z=Hn.from("getAllResponseHeaders"in L&&L.getAllResponseHeaders()),ne={data:!u||u==="text"||u==="json"?L.responseText:L.response,status:L.status,statusText:L.statusText,headers:Z,config:n,request:L};fb(function(A){t(A),O()},function(A){r(A),O()},ne),L=null}"onloadend"in L?L.onloadend=se:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(se)},L.onabort=function(){L&&(r(new Le("Request aborted",Le.ECONNABORTED,n,L)),L=null)},L.onerror=function(ge){const ne=ge&&ge.message?ge.message:"Network Error",ae=new Le(ne,Le.ERR_NETWORK,n,L);ae.event=ge||null,r(ae),L=null},L.ontimeout=function(){let ge=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const ne=s.transitional||ub;s.timeoutErrorMessage&&(ge=s.timeoutErrorMessage),r(new Le(ge,ne.clarifyTimeoutError?Le.ETIMEDOUT:Le.ECONNABORTED,n,L)),L=null},a===void 0&&l.setContentType(null),"setRequestHeader"in L&&G.forEach(l.toJSON(),function(ge,ne){L.setRequestHeader(ne,ge)}),G.isUndefined(s.withCredentials)||(L.withCredentials=!!s.withCredentials),u&&u!=="json"&&(L.responseType=s.responseType),p&&([T,S]=Kf(p,!0),L.addEventListener("progress",T)),f&&L.upload&&([w,D]=Kf(f),L.upload.addEventListener("progress",w),L.upload.addEventListener("loadend",D)),(s.cancelToken||s.signal)&&(g=Z=>{L&&(r(!Z||Z.type?new ac(null,n,L):Z),L.abort(),L=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const oe=M5(s.url);if(oe&&Tn.protocols.indexOf(oe)===-1){r(new Le("Unsupported protocol "+oe+":",Le.ERR_BAD_REQUEST,n));return}L.send(a||null)})},H5=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const a=function(p){if(!s){s=!0,u();const g=p instanceof Error?p:this.reason;r.abort(g instanceof Le?g:new ac(g instanceof Error?g.message:g))}};let l=e&&setTimeout(()=>{l=null,a(new Le(`timeout ${e} of ms exceeded`,Le.ETIMEDOUT))},e);const u=()=>{n&&(l&&clearTimeout(l),l=null,n.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),n=null)};n.forEach(p=>p.addEventListener("abort",a));const{signal:f}=r;return f.unsubscribe=()=>G.asap(u),f}},G5=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},K5=async function*(n,e){for await(const t of Q5(n))yield*G5(t,e)},Q5=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},gT=(n,e,t,r)=>{const s=K5(n,e);let a=0,l,u=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await s.next();if(p){u(),f.close();return}let w=g.byteLength;if(t){let T=a+=w;t(T)}f.enqueue(new Uint8Array(g))}catch(p){throw u(p),p}},cancel(f){return u(f),s.return()}},{highWaterMark:2})},yT=64*1024,{isFunction:Zh}=G,J5=(({Request:n,Response:e})=>({Request:n,Response:e}))(G.global),{ReadableStream:_T,TextEncoder:vT}=G.global,wT=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Y5=n=>{n=G.merge.call({skipUndefined:!0},J5,n);const{fetch:e,Request:t,Response:r}=n,s=e?Zh(e):typeof fetch=="function",a=Zh(t),l=Zh(r);if(!s)return!1;const u=s&&Zh(_T),f=s&&(typeof vT=="function"?(S=>O=>S.encode(O))(new vT):async S=>new Uint8Array(await new t(S).arrayBuffer())),p=a&&u&&wT(()=>{let S=!1;const O=new t(Tn.origin,{body:new _T,method:"POST",get duplex(){return S=!0,"half"}}).headers.has("Content-Type");return S&&!O}),g=l&&u&&wT(()=>G.isReadableStream(new r("").body)),w={stream:g&&(S=>S.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!w[S]&&(w[S]=(O,L)=>{let se=O&&O[S];if(se)return se.call(O);throw new Le(`Response type '${S}' is not supported`,Le.ERR_NOT_SUPPORT,L)})});const T=async S=>{if(S==null)return 0;if(G.isBlob(S))return S.size;if(G.isSpecCompliantForm(S))return(await new t(Tn.origin,{method:"POST",body:S}).arrayBuffer()).byteLength;if(G.isArrayBufferView(S)||G.isArrayBuffer(S))return S.byteLength;if(G.isURLSearchParams(S)&&(S=S+""),G.isString(S))return(await f(S)).byteLength},D=async(S,O)=>{const L=G.toFiniteNumber(S.getContentLength());return L??T(O)};return async S=>{let{url:O,method:L,data:se,signal:oe,cancelToken:Z,timeout:ge,onDownloadProgress:ne,onUploadProgress:ae,responseType:A,headers:b,withCredentials:C="same-origin",fetchOptions:R}=mb(S),N=e||fetch;A=A?(A+"").toLowerCase():"text";let j=H5([oe,Z&&Z.toAbortSignal()],ge),P=null;const Oe=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let it;try{if(ae&&p&&L!=="get"&&L!=="head"&&(it=await D(b,se))!==0){let F=new t(O,{method:"POST",body:se,duplex:"half"}),K;if(G.isFormData(se)&&(K=F.headers.get("content-type"))&&b.setContentType(K),F.body){const[Re,Pe]=fT(it,Kf(pT(ae)));se=gT(F.body,yT,Re,Pe)}}G.isString(C)||(C=C?"include":"omit");const ue=a&&"credentials"in t.prototype,Ne={...R,signal:j,method:L.toUpperCase(),headers:b.normalize().toJSON(),body:se,duplex:"half",credentials:ue?C:void 0};P=a&&new t(O,Ne);let re=await(a?N(P,R):N(O,Ne));const ye=g&&(A==="stream"||A==="response");if(g&&(ne||ye&&Oe)){const F={};["status","statusText","headers"].forEach(Fe=>{F[Fe]=re[Fe]});const K=G.toFiniteNumber(re.headers.get("content-length")),[Re,Pe]=ne&&fT(K,Kf(pT(ne),!0))||[];re=new r(gT(re.body,yT,Re,()=>{Pe&&Pe(),Oe&&Oe()}),F)}A=A||"text";let he=await w[G.findKey(w,A)||"text"](re,S);return!ye&&Oe&&Oe(),await new Promise((F,K)=>{fb(F,K,{data:he,headers:Hn.from(re.headers),status:re.status,statusText:re.statusText,config:S,request:P})})}catch(ue){throw Oe&&Oe(),ue&&ue.name==="TypeError"&&/Load failed|fetch/i.test(ue.message)?Object.assign(new Le("Network Error",Le.ERR_NETWORK,S,P),{cause:ue.cause||ue}):Le.from(ue,ue&&ue.code,S,P)}}},X5=new Map,gb=n=>{let e=n&&n.env||{};const{fetch:t,Request:r,Response:s}=e,a=[r,s,t];let l=a.length,u=l,f,p,g=X5;for(;u--;)f=a[u],p=g.get(f),p===void 0&&g.set(f,p=u?new Map:Y5(e)),g=p;return p};gb();const Tv={http:m5,xhr:W5,fetch:{get:gb}};G.forEach(Tv,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const ET=n=>`- ${n}`,Z5=n=>G.isFunction(n)||n===null||n===!1;function ej(n,e){n=G.isArray(n)?n:[n];const{length:t}=n;let r,s;const a={};for(let l=0;l<t;l++){r=n[l];let u;if(s=r,!Z5(r)&&(s=Tv[(u=String(r)).toLowerCase()],s===void 0))throw new Le(`Unknown adapter '${u}'`);if(s&&(G.isFunction(s)||(s=s.get(e))))break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=t?l.length>1?`since :
`+l.map(ET).join(`
`):" "+ET(l[0]):"as no adapter specified";throw new Le("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const yb={getAdapter:ej,adapters:Tv};function Lg(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new ac(null,n)}function IT(n){return Lg(n),n.headers=Hn.from(n.headers),n.data=Og.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),yb.getAdapter(n.adapter||Rd.adapter,n)(n).then(function(r){return Lg(n),r.data=Og.call(n,n.transformResponse,r),r.headers=Hn.from(r.headers),r},function(r){return hb(r)||(Lg(n),r&&r.response&&(r.response.data=Og.call(n,n.transformResponse,r.response),r.response.headers=Hn.from(r.response.headers))),Promise.reject(r)})}const _b="1.13.2",Fp={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Fp[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const TT={};Fp.transitional=function(e,t,r){function s(a,l){return"[Axios v"+_b+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,u)=>{if(e===!1)throw new Le(s(l," has been removed"+(t?" in "+t:"")),Le.ERR_DEPRECATED);return t&&!TT[l]&&(TT[l]=!0,console.warn(s(l," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,l,u):!0}};Fp.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function tj(n,e,t){if(typeof n!="object")throw new Le("options must be an object",Le.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const a=r[s],l=e[a];if(l){const u=n[a],f=u===void 0||l(u,a,n);if(f!==!0)throw new Le("option "+a+" must be "+f,Le.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Le("Unknown option "+a,Le.ERR_BAD_OPTION)}}const _f={assertOptions:tj,validators:Fp},Zr=_f.validators;let Yo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new dT,response:new dT}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ua(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&_f.assertOptions(r,{silentJSONParsing:Zr.transitional(Zr.boolean),forcedJSONParsing:Zr.transitional(Zr.boolean),clarifyTimeoutError:Zr.transitional(Zr.boolean)},!1),s!=null&&(G.isFunction(s)?t.paramsSerializer={serialize:s}:_f.assertOptions(s,{encode:Zr.function,serialize:Zr.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),_f.assertOptions(t,{baseUrl:Zr.spelling("baseURL"),withXsrfToken:Zr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=a&&G.merge(a.common,a[t.method]);a&&G.forEach(["delete","get","head","post","put","patch","common"],S=>{delete a[S]}),t.headers=Hn.concat(l,a);const u=[];let f=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(t)===!1||(f=f&&O.synchronous,u.unshift(O.fulfilled,O.rejected))});const p=[];this.interceptors.response.forEach(function(O){p.push(O.fulfilled,O.rejected)});let g,w=0,T;if(!f){const S=[IT.bind(this),void 0];for(S.unshift(...u),S.push(...p),T=S.length,g=Promise.resolve(t);w<T;)g=g.then(S[w++],S[w++]);return g}T=u.length;let D=t;for(;w<T;){const S=u[w++],O=u[w++];try{D=S(D)}catch(L){O.call(this,L);break}}try{g=IT.call(this,D)}catch(S){return Promise.reject(S)}for(w=0,T=p.length;w<T;)g=g.then(p[w++],p[w++]);return g}getUri(e){e=ua(this.defaults,e);const t=pb(e.baseURL,e.url,e.allowAbsoluteUrls);return cb(t,e.params,e.paramsSerializer)}};G.forEach(["delete","get","head","options"],function(e){Yo.prototype[e]=function(t,r){return this.request(ua(r||{},{method:e,url:t,data:(r||{}).data}))}});G.forEach(["post","put","patch"],function(e){function t(r){return function(a,l,u){return this.request(ua(u||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Yo.prototype[e]=t(),Yo.prototype[e+"Form"]=t(!0)});let nj=class vb{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(s=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](s);r._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(u=>{r.subscribe(u),a=u}).then(s);return l.cancel=function(){r.unsubscribe(a)},l},e(function(a,l,u){r.reason||(r.reason=new ac(a,l,u),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new vb(function(s){e=s}),cancel:e}}};function rj(n){return function(t){return n.apply(null,t)}}function sj(n){return G.isObject(n)&&n.isAxiosError===!0}const ky={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(ky).forEach(([n,e])=>{ky[e]=n});function wb(n){const e=new Yo(n),t=YA(Yo.prototype.request,e);return G.extend(t,Yo.prototype,e,{allOwnKeys:!0}),G.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return wb(ua(n,s))},t}const Ft=wb(Rd);Ft.Axios=Yo;Ft.CanceledError=ac;Ft.CancelToken=nj;Ft.isCancel=hb;Ft.VERSION=_b;Ft.toFormData=Mp;Ft.AxiosError=Le;Ft.Cancel=Ft.CanceledError;Ft.all=function(e){return Promise.all(e)};Ft.spread=rj;Ft.isAxiosError=sj;Ft.mergeConfig=ua;Ft.AxiosHeaders=Hn;Ft.formToJSON=n=>db(G.isHTMLForm(n)?new FormData(n):n);Ft.getAdapter=yb.getAdapter;Ft.HttpStatusCode=ky;Ft.default=Ft;const{Axios:Nj,AxiosError:Dj,CanceledError:Vj,isCancel:Oj,CancelToken:Lj,VERSION:Mj,all:Fj,Cancel:jj,isAxiosError:Uj,spread:Bj,toFormData:zj,AxiosHeaders:$j,HttpStatusCode:qj,formToJSON:Wj,getAdapter:Hj,mergeConfig:Gj}=Ft,en={onBooksSnapshot(n,e){return Vt.collection("books").orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));n(r)},t=>{console.error("Books snapshot error:",t),e&&e(t)})},getMyBooks(n,e){return Vt.collection("books").where("sellerId","==",n).orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async createBook(n){return Vt.collection("books").add({...n,status:"Available",views:0})},async incrementBookView(n){return Vt.collection("books").doc(n).update({views:hn.firestore.FieldValue.increment(1)})},async deleteBook(n){const{functions:e}=await ns(async()=>{const{functions:r}=await Promise.resolve().then(()=>as);return{functions:r}},void 0);return e.httpsCallable("deleteBook")({bookId:n})},async reserveBook(n,e,t,r){try{return(await Ft.post("http://127.0.0.1:5001/schoolbook-290b6/us-central1/handleBookTransaction",{bookId:n,buyerId:e,agreedPrice:Number(t),meetingTime:r})).data}catch(s){throw s}},async startTransaction(n,e,t){if(!e)return alert("");if(e.uid===n.sellerId)return alert("");try{const r=Vt.collection("transactions"),a=await r.where("bookId","==",n.id).where("buyerId","==",e.uid).get();if(!a.empty)t(a.docs[0].id);else{const l=await r.add({bookId:n.id,bookTitle:n.title,sellerId:n.sellerId,buyerId:e.uid,price:n.price,agreedPrice:n.price,status:"Pending",timestamp:new Date});await this.addNotification({userId:n.sellerId,content:`${n.title}~`,type:"inquiry"}),t(l.id)}}catch(r){console.error(r),alert(": "+r.message)}},async confirmTransactionTime(n){const{functions:e}=await ns(async()=>{const{functions:r}=await Promise.resolve().then(()=>as);return{functions:r}},void 0);return e.httpsCallable("confirmTransactionTime")({transactionId:n})},getUserTransactions(n,e){return Vt.collection("transactions").where("buyerId","==",n).onSnapshot(e)},getSellerTransactions(n,e){return Vt.collection("transactions").where("sellerId","==",n).onSnapshot(e)},async updateTransactionStatus(n,e){const{functions:t}=await ns(async()=>{const{functions:s}=await Promise.resolve().then(()=>as);return{functions:s}},void 0);return t.httpsCallable("updateTransactionStatus")({transactionId:n,newStatus:e})},async requestReschedule(n,e,t){const{functions:r}=await ns(async()=>{const{functions:a}=await Promise.resolve().then(()=>as);return{functions:a}},void 0);return r.httpsCallable("requestReschedule")({transactionId:n,newTime:e,reason:t})},async respondToReschedule(n,e){const{functions:t}=await ns(async()=>{const{functions:s}=await Promise.resolve().then(()=>as);return{functions:s}},void 0);return t.httpsCallable("respondToReschedule")({transactionId:n,response:e})},onWishesSnapshot(n){return Vt.collection("wishes").orderBy("timestamp","desc").onSnapshot(e=>{const t=e.docs.map(r=>({id:r.id,...r.data()}));n(t)})},async addWish({content:n,user:e,avatarId:t,image:r}){return Vt.collection("wishes").add({uid:hn.auth().currentUser?.uid||"anonymous",user:e||"",avatarId:t||"default",content:n,image:r||null,timestamp:new Date})},async deleteWish(n){return Vt.collection("wishes").doc(n).delete()},async addBook(n){return Vt.collection("books").add({...n,status:"Available",timestamp:new Date})},async deleteTransaction(n){return Vt.collection("transactions").doc(n).delete()},async markAsRead(n,e){return Vt.collection("transactions").doc(n).update({unreadBy:hn.firestore.FieldValue.arrayRemove(e)})},subscribeToNotifications(n,e){return Vt.collection("notifications").where("userId","==",n).orderBy("timestamp","desc").limit(20).onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async markNotificationAsRead(n){return Vt.collection("notifications").doc(n).update({isRead:!0})},async addNotification({userId:n,content:e,type:t="system"}){return Vt.collection("notifications").add({userId:n,content:e,type:t,isRead:!1,timestamp:new Date})},recordCheckIn(){localStorage.setItem("lastCheckIn",new Date().toDateString())},hasCheckedInToday(){return localStorage.getItem("lastCheckIn")===new Date().toDateString()}},xT={async sendMessage(n,e,t,r,s=null,a=null){if(!(!r?.trim()&&!s))try{const l=Vt.collection("transactions").doc(n),u=l.collection("messages"),f=await l.get();if(f.exists){const p=f.data(),g=e===p.buyerId?p.sellerId:p.buyerId;await u.add({senderId:e,senderName:t,content:r?.trim()||"",image:s,timestamp:new Date});const w={lastMessage:r?.trim()||(s?"[]":""),lastTimestamp:new Date,unreadBy:hn.firestore.FieldValue.arrayUnion(g)};a&&(w.meetingTime=a.meetingTime||"",w.meetingLocation=a.meetingLocation||"",w.invoiceSentAt=a.invoiceSentAt||new Date,w.status="Invoiced"),await l.update(w)}}catch(l){throw console.error("Error sending message:",l),l}},subscribeToMessages(n,e){return Vt.collection("transactions").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(r=>{const s=r.docs.map(a=>({id:a.id,...a.data()}));e(s)},r=>{console.error("Error subscribing to messages:",r)})}},jp={fontFamily:'"Noto Sans TC", "PMingLiU", sans-serif'},ke={whiteBucks:"#E8E3DF",fossilGray:"#C9C3B6",brushwood:"#9E9081",chocolateBubble:"#A58976",brownWindmill:"#756256",bgLight:"#F9F7F5"},ij=["","","","",""],ST=[{id:"all",name:""},{id:"chi",name:""},{id:"eng",name:""},{id:"math",name:""},{id:"sci",name:""},{id:"soc",name:""},{id:"extra",name:""}],AT=({title:n,avatars:e,onPurchase:t,onEquip:r,currentAvatarId:s,myAvatars:a,coins:l})=>v.jsxs("div",{className:"mb-8",children:[v.jsxs("h4",{className:"font-bold text-[#756256] mb-4 flex items-center gap-2 px-1 text-sm md:text-base",children:[v.jsx("span",{className:"w-1.5 h-5 bg-[#A58976] rounded-full"}),n]}),v.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar",children:e.map(u=>{const f=a.includes(u.id)||u.id==="classic-1",p=s===u.id,g=l>=u.price;return v.jsxs("div",{className:"min-w-[110px] bg-white border rounded-2xl p-3 flex flex-col items-center shadow-sm",style:{borderColor:"#E8E3DF"},children:[v.jsx("div",{className:"w-14 h-14 rounded-full overflow-hidden mb-3 bg-gray-50 border p-1",children:v.jsx("img",{src:Pd(u.src),alt:u.name,className:"w-full h-full object-cover rounded-full"})}),v.jsx("div",{className:"font-bold text-xs text-[#5D4037] mb-3 truncate w-full text-center",children:u.name}),v.jsx("button",{onClick:()=>f?r(u.id):t(u.id,u.price),disabled:!f&&!g,className:`w-full py-1.5 rounded-full text-[10px] font-bold flex items-center justify-center gap-1 transition-colors ${f?p?"bg-gray-100 text-gray-400":"bg-[#756256] text-white hover:bg-[#5D4E44]":"bg-yellow-500 text-white hover:bg-yellow-600"} ${!f&&!g?"opacity-50 cursor-not-allowed":""}`,children:f?p?"":"":v.jsxs(v.Fragment,{children:["NT$ ",u.price]})})]},u.id)})})]}),Vi=[{id:"classic-1",name:"",price:0,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cat&backgroundColor=FFD700"},{id:"pony-gift",name:"",price:0,src:"https://i.postimg.cc/9fW28Bc0/niu.jpg"},{id:"special1",name:"",price:100,src:"https://i.postimg.cc/zyP43KbN/tu-zi.jpg"},{id:"special2",name:"",price:100,src:"https://i.postimg.cc/pd2vGBP9/zhu.jpg"},{id:"special3",name:"",price:100,src:"https://i.postimg.cc/wB6zfk97/gou.jpg"},{id:"special4",name:"",price:100,src:"https://i.postimg.cc/qNvyYNG3/EE1D91FC-D76E-4FBA-A85F-33F8D82EAFEB.jpg"},{id:"special5",name:"",price:100,src:"https://i.postimg.cc/VkjgJMr4/84AD5380-E492-4603-B7C7-4BD68372B94A.jpg"},{id:"classic-2",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=glasses&backgroundColor=4ADE80"},{id:"classic-3",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cool&backgroundColor=A58976"},{id:"classic-4",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=artist&backgroundColor=FFB6C1"},{id:"classic-5",name:"",price:100,src:"https://api.dicebear.com/7.x/bottts/svg?seed=robot&backgroundColor=E0E0E0"}],oj=[],xv=n=>{if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=Math.floor((new Date-e)/1e3);return r<60?"":r<3600?`${Math.floor(r/60)}`:r<86400?`${Math.floor(r/3600)}`:r<2592e3?`${Math.floor(r/86400)}`:e.toLocaleDateString()},Pd=(n,e=150,t=50)=>n,aj=n=>{if(!n)return"";const e=/(\d{1,2})\/(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,t=n.match(e);if(t){const[r,s,a,l,u]=t;return`${s.padStart(2,"0")}/${a.padStart(2,"0")} ${l.padStart(2,"0")}:${u.padStart(2,"0")}`}return n},Sv=({type:n,price:e,originalPrice:t,large:r=!1})=>n==="exchange"?v.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:ke.brushwood},children:[v.jsx(NT,{size:r?20:14}),v.jsx("span",{children:""})]}):n==="gift"||e===0?v.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:ke.chocolateBubble},children:[v.jsx(CT,{size:r?20:14}),v.jsx("span",{children:""})]}):v.jsxs("div",{className:"flex flex-col",children:[v.jsxs("div",{className:`font-bold ${r?"text-3xl":"text-lg"}`,style:{color:ke.brownWindmill},children:["NT$ ",e]}),t&&v.jsxs("span",{className:"text-xs line-through",style:{color:ke.fossilGray},children:[" $",t]})]}),Av=(n,e=800,t=800,r=.6)=>new Promise(s=>{const a=new Image;a.src=n,a.onload=()=>{const l=document.createElement("canvas");let u=a.width,f=a.height;u>f?u>e&&(f*=e/u,u=e):f>t&&(u*=t/f,f=t),l.width=u,l.height=f,l.getContext("2d").drawImage(a,0,0,u,f),s(l.toDataURL("image/jpeg",r))}}),lj=({items:n,onNavigate:e,currentUser:t})=>{const[r,s]=fe.useState(0),a=(n||[]).slice(0,5),[l,u]=fe.useState([]);if(fe.useEffect(()=>{if(a.length===0)return;const p=setInterval(()=>{s(g=>(g+1)%a.length)},4e3);return()=>clearInterval(p)},[a.length]),fe.useEffect(()=>{const p=[];t&&p.push(""),[...n||[]].sort((w,T)=>{const D=w.timestamp?.toDate?w.timestamp.toDate():new Date(w.timestamp||0);return(T.timestamp?.toDate?T.timestamp.toDate():new Date(T.timestamp||0))-D}).slice(0,8).forEach(w=>{const T=xv(w.timestamp),D=w.seller?.nickname||"";p.push(`${T} ${D} ${w.title}`)}),u(p)},[n,t]),a.length===0)return null;const f=a[r];return v.jsxs("div",{className:"h-full",children:[v.jsx("div",{className:"flex items-center justify-between mb-3",children:v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("span",{className:"bg-orange-500 text-white p-1 rounded-full animate-pulse flex-shrink-0",children:v.jsx(uP,{size:16,fill:"currentColor"})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide flex-shrink-0",style:{color:ke.brownWindmill},children:""}),l.length>0&&v.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 ml-2 overflow-hidden flex-1 max-w-[500px]",children:[v.jsx(VT,{size:14,className:"text-red-500 flex-shrink-0",fill:"currentColor"}),v.jsx("div",{className:"flex-1 overflow-hidden relative h-5",children:v.jsxs("div",{className:"whitespace-nowrap absolute animate-marquee font-medium flex items-center h-full",children:[l.map((p,g)=>v.jsx("span",{className:"mr-12 inline-block",children:p},g)),l.map((p,g)=>v.jsx("span",{className:"mr-12 inline-block",children:p},`dup-${g}`))]})})]})]})}),v.jsxs("div",{className:"relative w-full h-48 bg-white rounded-2xl shadow-md overflow-hidden border cursor-pointer group",style:{borderColor:ke.whiteBucks},onClick:()=>e("product",f),children:[v.jsx("div",{className:"absolute inset-0 bg-cover bg-center blur-xl opacity-30 animate-pulse-slow transition-all duration-1000 transform scale-110",style:{backgroundImage:`url(${f.cover||f.imageBase64})`}},f.id+"-bg"),v.jsxs("div",{className:"absolute inset-0 flex items-center p-4 z-10",children:[v.jsx("div",{className:"w-28 h-36 flex-shrink-0 rounded-lg overflow-hidden shadow-lg border border-white transform transition-transform duration-500 hover:scale-105 animate-fade-in-up",children:v.jsx("img",{src:f.cover||f.imageBase64,alt:f.title,className:"w-full h-full object-cover"})},f.id+"-img"),v.jsxs("div",{className:"flex-1 ml-4 flex flex-col justify-center h-full animate-fade-in-right",children:[v.jsxs("div",{className:"flex items-start justify-between mb-1",children:[v.jsx("span",{className:"text-xs font-bold text-orange-500 bg-orange-50 px-2 py-0.5 rounded-md",children:"HOT"}),v.jsxs("span",{className:"text-xs text-gray-400",children:[r+1," / ",a.length]})]}),v.jsx("h3",{className:"font-bold text-lg text-[#5D4037] line-clamp-2 leading-tight mb-2",children:f.title}),v.jsxs("div",{className:"mt-auto",children:[v.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.grade||""}),v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.subject}),v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.conditionLevel})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Sv,{type:f.type,price:f.price,originalPrice:f.originalPrice}),v.jsx("div",{className:"w-8 h-8 rounded-full bg-[#756256] text-white flex items-center justify-center shadow-md transform translate-x-16 group-hover:translate-x-0 transition-all duration-300 opacity-0 group-hover:opacity-100",children:v.jsx(RT,{size:16})})]})]})]},f.id+"-text")]}),v.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-1.5 z-20",children:a.map((p,g)=>v.jsx("div",{className:`h-1 rounded-full overflow-hidden transition-all duration-300 ${g===r?"w-6 bg-gray-200":"w-1.5 bg-gray-300"}`,children:g===r&&v.jsx("div",{className:"h-full bg-[#756256] animate-progress-fill",style:{width:"100%"}})},g))})]}),v.jsx("style",{children:`
        @keyframes progress-fill {
          from { width: 0%; }
          to { width: 100%; }
        }
        .animate-progress-fill {
          animation: progress-fill 4s linear;
        }
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.5s ease-out forwards;
        }
        @keyframes fade-in-right {
          from { opacity: 0; transform: translateX(10px); }
          to { opacity: 1; transform: translateX(0); }
        }
        .animate-fade-in-right {
          animation: fade-in-right 0.5s ease-out forwards;
        }
        @keyframes marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(-50%); } 
        }
        .animate-marquee {
          animation: marquee 30s linear infinite;
        }
      `})]})},cj=({examCountdown:n})=>{const[e,t]=fe.useState(0),r=n?.exams||[],s=r.length>0&&r[e]?r[e]:{title:r.length===0&&n?"...":"",daysLeft:0};return v.jsxs("div",{className:"h-full",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[v.jsx("span",{className:"bg-red-500 text-white p-1 rounded-full",children:v.jsx(XR,{size:16})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:ke.brownWindmill},children:""})]}),v.jsxs("div",{className:"bg-white p-3 rounded-2xl border flex flex-col justify-between h-48 relative overflow-hidden shadow-md",style:{borderColor:ke.whiteBucks},children:[v.jsx("a",{href:"https://calendar.google.com/calendar/embed?src=shsh.ylc.edu.tw_fcpdcjkto9mpulh1gg2eetr4s4%40group.calendar.google.com&ctz=Asia%2FTaipei",target:"_blank",rel:"noopener noreferrer",className:"absolute top-0 right-0 w-12 h-12 bg-red-50 rounded-bl-2xl z-20 flex items-center justify-center text-red-400 hover:text-red-500 hover:bg-red-100 transition-colors cursor-pointer",children:v.jsx(oP,{size:18})}),v.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-center items-center",children:[v.jsxs("div",{className:"relative mb-2",children:[v.jsxs("div",{className:"text-base text-gray-500 font-bold truncate flex items-center justify-center gap-1 cursor-pointer hover:text-gray-700 transition-colors",children:[" ",s.title," ",v.jsx(tP,{size:14})]}),r.length>1&&v.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:e,onChange:a=>t(Number(a.target.value)),children:r.map((a,l)=>v.jsxs("option",{value:l,children:[a.title," (",a.displayDate||`${a.date.substring(4,6)}/${a.date.substring(6,8)}`,")"]},l))}),v.jsx("div",{className:"text-xs text-gray-400 mt-1 text-center",children:s.displayDate||s.date})]}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-7xl font-bold text-[#756256]",children:s.daysLeft}),v.jsx("span",{className:"text-lg text-[#756256]",children:""})]})]})]})]})},uj=({wishes:n,onAddWish:e,onDeleteWish:t,currentUser:r,currentAvatar:s})=>{const[a,l]=fe.useState(!1),[u,f]=fe.useState(""),[p,g]=fe.useState(null),[w,T]=fe.useState(null),[D,S]=fe.useState(null),O=fe.useRef(null),[L,se]=fe.useState(1),oe=5,Z=Math.ceil(n.length/oe),ge=n.slice((L-1)*oe,L*oe),ne=A=>{const b=A.target.files[0];if(b){const C=new FileReader;C.onloadend=async()=>{const R=await Av(C.result,400,400,.5);g(R)},C.readAsDataURL(b)}},ae=()=>{!u.trim()&&!p||(e(u,p),f(""),g(null),l(!1),se(1))};return v.jsxs("div",{className:"mb-8 px-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"bg-yellow-400 text-white p-1 rounded-full",children:v.jsx(DT,{size:16,fill:"currentColor"})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:ke.brownWindmill},children:""})]}),Z>1&&v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[v.jsx("button",{onClick:()=>se(A=>Math.max(1,A-1)),disabled:L===1,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:v.jsx(Ny,{size:18})}),v.jsxs("span",{className:"text-gray-500 font-bold px-1",children:[L," / ",Z]}),v.jsx("button",{onClick:()=>se(A=>Math.min(Z,A+1)),disabled:L===Z,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:v.jsx(kT,{size:18})})]})]}),v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 space-y-3",style:{borderColor:ke.whiteBucks},children:[ge.map(A=>{const b=Vi.find(N=>N.id===A.avatarId)||Vi[0],C=A.uid===r?.uid,R=D===A.id;return v.jsxs("div",{className:"flex gap-3 border-b last:border-0 pb-3 last:pb-0",style:{borderColor:ke.bgLight},children:[v.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden cursor-pointer transition-all duration-300 ${R?"bg-red-500 scale-90":"bg-gray-100"}`,onClick:()=>{C&&(R?(t(A.id),S(null)):S(A.id))},children:R?v.jsx(ls,{size:20,className:"text-white animate-bounce-short"}):v.jsx("img",{src:Pd(b.src,100,60),alt:"avatar",className:"w-full h-full object-cover"})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("span",{className:"text-sm font-bold text-[#756256]",children:A.user}),v.jsx("span",{className:"text-xs font-normal text-gray-400",children:xv(A.timestamp)})]}),v.jsx("p",{className:"text-sm text-[#9E9081]",children:A.content}),A.image&&v.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-gray-100 h-24 inline-block bg-gray-50",children:v.jsx("img",{src:A.image,alt:"wish thumbnail",onClick:()=>T(A.image),className:"h-full w-auto object-contain cursor-zoom-in hover:opacity-90 transition-opacity"})})]})]},A.id)}),v.jsxs("button",{onClick:()=>l(!0),className:"w-full py-2 mt-2 text-xs font-bold text-[#9E9081] border border-dashed hover:bg-[#F9F7F5] rounded-lg transition-colors flex items-center justify-center gap-1",style:{borderColor:ke.fossilGray},children:[v.jsx(SP,{size:14})," "]})]}),w&&v.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 animate-fade-in",onClick:()=>T(null),children:[v.jsx("button",{className:"absolute top-6 right-6 text-white hover:text-gray-300 transition-colors z-10 p-2",onClick:A=>{A.stopPropagation(),T(null)},children:v.jsx(ls,{size:32})}),v.jsx("img",{src:w,alt:"full preview",className:"max-w-full max-h-full object-contain rounded animate-scale-up",onClick:A=>A.stopPropagation()})]}),a&&v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:v.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl overflow-hidden shadow-2xl animate-scale-up flex flex-col max-h-[90vh]",children:[v.jsxs("div",{className:"flex justify-between items-center p-3 border-b",style:{borderColor:ke.whiteBucks},children:[v.jsx("button",{onClick:()=>l(!1),className:"p-1",children:v.jsx(ls,{size:24,className:"text-gray-600"})}),v.jsx("span",{className:"font-bold text-[#756256] text-lg",children:""}),v.jsx("button",{onClick:ae,className:"text-blue-500 font-bold text-sm px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50 disabled:hover:bg-transparent",disabled:!u.trim()&&!p,children:""})]}),v.jsxs("div",{className:"p-4 flex flex-col flex-1 overflow-y-auto",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden border border-gray-100",children:v.jsx("img",{src:s.src,alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("span",{className:"font-bold text-[#5D4037]",children:r.nickname||r.email})]}),v.jsx("textarea",{className:"w-full resize-none outline-none text-[#5D4037] placeholder-gray-400 text-lg leading-relaxed min-h-[100px]",placeholder:"...",value:u,onChange:A=>f(A.target.value),autoFocus:!0}),p&&v.jsxs("div",{className:"relative mt-2 rounded-lg overflow-hidden border border-gray-100 group",children:[v.jsx("img",{src:p,alt:"preview",className:"w-full h-auto"}),v.jsx("button",{onClick:()=>g(null),className:"absolute top-2 right-2 p-1 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors",children:v.jsx(ls,{size:16})})]})]}),v.jsxs("div",{className:"p-3 border-t bg-gray-50 flex gap-4 text-gray-400",children:[v.jsx("input",{type:"file",ref:O,className:"hidden",accept:"image/*",onChange:ne}),v.jsx("button",{onClick:()=>O.current.click(),className:"p-1 hover:text-[#756256] transition-colors",children:v.jsx(PT,{size:20})})]})]})})]})},dj=({onLogin:n})=>{const[e,t]=fe.useState(!1),[r,s]=fe.useState(!1),[a,l]=fe.useState(""),[u,f]=fe.useState(""),[p,g]=fe.useState(""),[w,T]=fe.useState(""),D=async S=>{if(S.preventDefault(),s(!0),e){if(!a.endsWith("@shsh.tw")){alert(" @shsh.tw "),s(!1);return}if(!p||!w){alert(""),s(!1);return}}try{if(e){await Jo.signUp(a,u);try{const O=(p.trim()[0]||"")+"";await Jo.completeProfile({realName:p,studentId:w,nickname:O}),alert("")}catch(O){console.error("Profile completion failed",O),alert("")}alert(""),t(!1)}else await Jo.login(a,u)}catch(O){alert((e?": ":": ")+O.message)}finally{s(!1)}};return v.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",style:{...jp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:v.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center border",style:{borderColor:ke.whiteBucks},children:[v.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:ke.brownWindmill},children:e?"":""}),v.jsx("p",{className:"text-sm mb-6",style:{color:ke.brushwood},children:e?"":""}),v.jsxs("form",{onSubmit:D,className:"space-y-3 mb-4",children:[e&&v.jsxs(v.Fragment,{children:[v.jsx("input",{type:"text",value:p,onChange:S=>g(S.target.value),placeholder:" (+)",className:"w-full p-3 border rounded-xl bg-gray-50",required:!0}),v.jsx("input",{type:"text",value:w,onChange:S=>T(S.target.value),placeholder:"",className:"w-full p-3 border rounded-xl bg-gray-50",required:!0})]}),v.jsx("input",{type:"email",value:a,onChange:S=>l(S.target.value),placeholder:"Email (@shsh.tw)",className:"w-full p-3 border rounded-xl",required:!0}),v.jsx("input",{type:"password",value:u,onChange:S=>f(S.target.value),placeholder:"Password (6)",className:"w-full p-3 border rounded-xl",required:!0}),v.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 rounded-xl border-2 font-bold mb-3 hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:ke.whiteBucks,color:ke.brownWindmill},children:r?"...":e?"":""})]}),v.jsx("button",{onClick:()=>t(!e),className:"text-xs text-gray-400 hover:underline",children:e?"":" ()"})]})})},hj=({product:n,onBack:e,onContact:t,currentUser:r})=>{if(!n)return null;const s=r?.uid&&n.sellerId&&String(r.uid)===String(n.sellerId)||r?.studentId&&n.seller?.studentId&&r.studentId===n.seller.studentId,[a,l]=fe.useState(null);return fe.useEffect(()=>{n?.sellerId&&(async()=>{try{const{db:f}=await ns(async()=>{const{db:g}=await Promise.resolve().then(()=>as);return{db:g}},void 0),p=await f.collection("users").doc(n.sellerId).get();p.exists&&l(p.data())}catch(f){console.error("Failed to fetch seller profile",f)}})()},[n?.sellerId]),fe.useEffect(()=>{window.scrollTo(0,0)},[]),v.jsxs("div",{className:"min-h-screen pb-24 bg-white",style:jp,children:[v.jsxs("nav",{className:"fixed top-0 w-full z-50 flex justify-between items-center px-4 py-3 bg-white/80 backdrop-blur-md border-b",style:{borderColor:ke.whiteBucks},children:[v.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200",children:v.jsx(Ny,{size:20,color:ke.brownWindmill})}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",children:v.jsx(NP,{size:20,color:ke.brownWindmill})}),v.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",children:v.jsx(fP,{size:20,color:ke.brownWindmill})})]})]}),v.jsxs("div",{className:"pt-16 pb-6 md:pt-20 md:pb-12 md:px-8 max-w-6xl mx-auto md:flex md:gap-10 md:items-start",children:[v.jsx("div",{className:"aspect-[4/3] bg-gray-100 relative md:w-1/2 md:aspect-square md:rounded-2xl md:overflow-hidden md:shadow-sm md:sticky md:top-24",children:v.jsx("img",{src:n.cover||n.imageBase64||"https://dummyimage.com/600x400/eee/aaa",alt:n.title,className:"w-full h-full object-contain bg-[#F9F7F5]"})}),v.jsxs("div",{className:"px-5 mt-6 md:w-1/2 md:px-0 md:mt-0",children:[v.jsxs("div",{className:"flex gap-2 mb-2",children:[v.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.grade}),v.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.subject})]}),v.jsx("h1",{className:"text-2xl md:text-3xl font-bold mt-4 mb-2 leading-tight",style:{color:ke.brownWindmill},children:n.title}),v.jsx("div",{className:"flex items-end gap-3 mb-6 pb-6 border-b",style:{borderColor:ke.whiteBucks},children:v.jsx(Sv,{type:n.type,price:n.price,originalPrice:n.originalPrice,large:!0})}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081]",children:""}),v.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-2",children:[v.jsxs("span",{children:[n.views||0," "]}),v.jsx("span",{children:""}),v.jsxs("span",{className:"whitespace-nowrap",children:["",(()=>{const u=n.timestamp?.toDate?n.timestamp.toDate():new Date(n.timestamp||0),f=u.getFullYear(),p=String(u.getMonth()+1).padStart(2,"0"),g=String(u.getDate()).padStart(2,"0"),w=String(u.getHours()).padStart(2,"0"),T=String(u.getMinutes()).padStart(2,"0");return`${f}-${p}-${g} ${w}:${T}`})()]})]})]}),v.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg inline-block border border-gray-100",children:n.conditionLevel})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:n.description||""})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-[#F9F7F5] border border-stone-100",children:[v.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-white shadow-sm",children:v.jsx($P,{size:24,className:"text-gray-500"})}),v.jsxs("div",{children:[v.jsx("div",{className:"font-bold text-[#756256] text-lg",children:a?.nickname||n.seller?.nickname||n.seller?.name}),v.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[v.jsx(MP,{size:12,fill:"#fbbf24",className:"text-yellow-400"}),v.jsx("span",{className:"font-bold text-gray-700",children:n.seller?.score||5})]})]})]})]}),!s&&v.jsx("div",{className:"hidden md:block pt-4",children:v.jsxs("button",{onClick:t,className:"w-full py-4 bg-[#756256] text-white rounded-xl font-bold shadow-lg hover:bg-[#5D4E44] transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2 text-lg",children:[v.jsx(Du,{size:20}),"  / "]})})]})]})]}),!s&&v.jsx("div",{className:"fixed bottom-0 left-0 w-full p-4 bg-white border-t safe-area-bottom flex gap-3 md:hidden z-40",style:{borderColor:ke.whiteBucks},children:v.jsxs("button",{onClick:t,className:"flex-1 py-3 bg-[#756256] text-white rounded-xl font-bold shadow-lg hover:bg-[#5D4E44] transition-colors flex items-center justify-center gap-2",children:[v.jsx(Du,{size:18})," "]})})]})},fj=({onNavigate:n,user:e,currentAvatarId:t,coins:r,wishes:s,onAddWish:a,onDeleteWish:l,books:u,isLoading:f,examCountdown:p,onToggleNotifications:g,hasUnreadNotifications:w})=>{const[T,D]=fe.useState(""),[S,O]=fe.useState("all"),[L,se]=fe.useState("all"),[oe,Z]=fe.useState("all"),[ge,ne]=fe.useState("all"),[ae,A]=fe.useState(1),b=20,C=()=>{se("all"),Z("all"),ne("all"),D(""),O("all"),A(1),window.scrollTo({top:0,behavior:"smooth"})};fe.useEffect(()=>{A(1)},[T,S]);const R=u.filter(ue=>{const Ne=T.toLowerCase(),re=!Ne.trim()||ue.title.toLowerCase().includes(Ne)||ue.author&&ue.author.toLowerCase().includes(Ne);let ye=!0;if(S!=="all")if(S==="extra")ye=ue.subject===""||ue.publisher==="";else if(S==="sci")ye=["","","","",""].includes(ue.subject);else if(S==="soc")ye=["","","",""].includes(ue.subject);else{const he=ST.find(F=>F.id===S)?.name;ye=ue.subject===he}return re&&ye}).sort((ue,Ne)=>{const re=ue.timestamp?.toDate?ue.timestamp.toDate():new Date(ue.timestamp||0);return(Ne.timestamp?.toDate?Ne.timestamp.toDate():new Date(Ne.timestamp||0))-re}),N=Math.ceil(R.length/b),j=R.slice((ae-1)*b,ae*b),P=Vi.find(ue=>ue.id===t)||Vi[0],Oe=fe.useRef(null),it=()=>{if(Oe.current){const Ne=Oe.current.getBoundingClientRect().top+window.pageYOffset+-80;window.scrollTo({top:Ne,behavior:"smooth"})}};return v.jsxs("div",{className:"min-h-screen pb-20",style:{...jp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:[v.jsx("div",{className:"pt-6 pb-12 px-4 rounded-b-[2rem] shadow-lg",style:{background:`linear-gradient(135deg, ${ke.chocolateBubble}, ${ke.brownWindmill})`,color:ke.bgLight},children:v.jsxs("div",{className:"max-w-6xl mx-auto",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-8 h-8 backdrop-blur rounded-sm flex items-center justify-center font-bold font-serif",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:""}),v.jsx("span",{className:"text-xl font-bold tracking-widest",children:""})]}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:C,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:v.jsx(HE,{size:20})}),v.jsxs("button",{onClick:g,className:"relative p-2 hover:bg-white/10 rounded-full transition-colors",children:[v.jsx(Mg,{size:20}),w&&v.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full border border-white"})]}),v.jsxs("button",{onClick:()=>n("profile"),className:"flex items-center gap-2 hover:bg-white/20 pl-1 pr-3 py-1 rounded-full transition-all border border-white/20",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:[v.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center overflow-hidden bg-white/20",children:v.jsx("img",{src:Pd(P.src,100,50),alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("span",{className:"hidden sm:inline text-sm font-medium tracking-wide",children:e.nickname||e.email})]})]})]}),v.jsxs("div",{className:"max-w-3xl mx-auto mt-2",children:[v.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4 tracking-widest text-center",children:""}),v.jsx("div",{className:"bg-[#FDFBF7] rounded-xl shadow-xl overflow-hidden p-2",children:v.jsxs("div",{className:"flex items-center border-b px-2",style:{borderColor:ke.whiteBucks},children:[v.jsx(RP,{className:"text-[#9E9081]",size:20}),v.jsx("input",{type:"text",value:T,onChange:ue=>D(ue.target.value),placeholder:"...",className:"w-full py-3 px-4 bg-transparent text-[#756256] placeholder-[#C9C3B6] outline-none"}),T&&v.jsx("button",{onClick:()=>D(""),className:"text-[#9E9081]",children:v.jsx(ls,{size:16})})]})})]})]})}),v.jsxs("div",{className:"max-w-6xl mx-auto px-4 -mt-6",children:[v.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 no-scrollbar mb-4",children:ST.map(ue=>v.jsx("button",{onClick:()=>O(ue.id),className:`whitespace-nowrap px-5 py-2 rounded-full text-sm tracking-wide shadow-sm transition-all border ${S===ue.id?"bg-[#756256] text-white border-[#756256]":"bg-[#F9F7F5] text-[#756256] border-[#E8E3DF]"}`,children:ue.name},ue.id))}),!T&&S==="all"&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[v.jsx("div",{className:"flex-1 min-w-0",children:v.jsx(lj,{items:u,onNavigate:n,currentUser:e})}),v.jsx("div",{className:"w-full md:w-[320px] flex-shrink-0",children:v.jsx(cj,{examCountdown:p})})]}),v.jsx(uj,{wishes:s,onAddWish:a,onDeleteWish:l,currentUser:e,currentAvatar:P})]}),v.jsxs("div",{className:"pb-8",children:[v.jsx("div",{ref:Oe,className:"flex justify-between items-end mb-4 px-1 border-b pb-2",style:{borderColor:ke.whiteBucks},children:v.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 tracking-wide",style:{color:ke.brownWindmill},children:[v.jsx(JR,{size:20,style:{color:ke.chocolateBubble}}),T||S!=="all"?"":""]})}),f?v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:Array.from({length:10}).map((ue,Ne)=>v.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-sm border border-gray-100 flex flex-col h-full",children:[v.jsx("div",{className:"aspect-square bg-gray-100 animate-pulse"}),v.jsxs("div",{className:"p-3 space-y-2 flex-1",children:[v.jsx("div",{className:"h-4 bg-gray-100 rounded w-3/4 animate-pulse"}),v.jsx("div",{className:"h-3 bg-gray-100 rounded w-1/2 animate-pulse"}),v.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-50 flex justify-between",children:[v.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/3 animate-pulse"}),v.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4 animate-pulse"})]})]})]},Ne))}):j.length>0?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:j.map(ue=>v.jsxs("div",{onClick:()=>n("product",ue),className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all cursor-pointer border flex flex-col h-full group",style:{borderColor:ke.whiteBucks},children:[v.jsxs("div",{className:"relative aspect-square bg-[#F9F7F5] overflow-hidden",children:[v.jsx("img",{src:ue.cover||ue.imageBase64||"https://dummyimage.com/400x400/eee/aaa",alt:ue.title,className:"w-full h-full object-contain group-hover:scale-105 transition-transform duration-500"}),v.jsx("div",{className:"absolute top-0 right-0 px-3 py-1.5 text-xs font-bold shadow-sm rounded-bl-lg z-10",style:{backgroundColor:ue.type==="gift"||ue.price===0?"#E6DBC6":ke.brownWindmill,color:ue.type==="gift"||ue.price===0?"#756256":"#FFFFFF"},children:ue.type==="gift"||ue.price===0?"":""})]}),v.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[v.jsx("h3",{className:"font-bold text-[#756256] text-base leading-tight mb-2 line-clamp-2 min-h-[2.5em]",children:ue.title}),v.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ue.subject}),ue.grade&&ue.grade!==""&&v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ue.grade})]}),v.jsxs("div",{className:"mt-auto flex items-end justify-between border-t pt-2 border-[#E8E3DF]",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsxs("span",{className:"text-[10px] text-gray-400 mb-1",children:["",ue.seller?.nickname||""]}),v.jsx(Sv,{type:ue.type,price:ue.price})]}),v.jsxs("div",{className:"text-[10px] text-gray-400 flex items-center gap-1 scale-90",children:[v.jsx(lP,{size:12,className:"text-gray-400"}),v.jsx("span",{className:"font-bold",children:ue.views||0})]})]})]})]},ue.id))}),N>1&&v.jsxs("div",{className:"mt-8 flex justify-center items-center gap-2",children:[v.jsx("button",{onClick:()=>{A(ue=>Math.max(1,ue-1)),it()},disabled:ae===1,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:v.jsx(Ny,{size:20})}),v.jsx("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar max-w-[200px] sm:max-w-none px-2",children:Array.from({length:N}).map((ue,Ne)=>v.jsx("button",{onClick:()=>{A(Ne+1),it()},className:`w-10 h-10 rounded-lg font-bold flex-shrink-0 transition-all shadow-sm ${ae===Ne+1?"bg-[#756256] text-white":"bg-white text-[#756256] border border-gray-100 hover:bg-gray-50"}`,children:Ne+1},Ne))}),v.jsx("button",{onClick:()=>{A(ue=>Math.min(N,ue+1)),it()},disabled:ae===N,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:v.jsx(kT,{size:20})})]})]}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-20 w-full animate-fade-in text-center col-span-full",children:[v.jsx("p",{className:"text-gray-500 text-lg font-medium mb-6",children:""}),v.jsxs("button",{onClick:C,className:"px-8 py-3 rounded-xl bg-[#756256] text-white font-bold hover:bg-[#5D4E44] transition-all transform hover:-translate-y-1 shadow-md flex items-center gap-2",children:[v.jsx(HE,{size:18})," "]})]})]})]})]})},pj=({onBack:n,onNavigate:e,user:t,onLogout:r,coins:s,myAvatars:a,currentAvatarId:l,onPurchase:u,onEquip:f})=>{const[p,g]=fe.useState("shelf"),w=[],[T,D]=fe.useState(w),[S,O]=fe.useState({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null}),[L,se]=fe.useState(!1),[oe,Z]=fe.useState(null);fe.useEffect(()=>{if(t?.uid){const R=en.getMyBooks(t.uid,N=>{D(N)});return()=>R()}},[t?.uid]);const ge=R=>{const N=R.target.files[0];if(N){const j=new FileReader;j.onloadend=async()=>{const P=await Av(j.result,600,600,.5);O({...S,coverImagePreview:P})},j.readAsDataURL(N)}},ne=async()=>{if(!S.coverImagePreview){alert("");return}if(!S.title){alert("");return}if(S.transactionType==="sell"&&!S.price){alert("");return}if(S.bookType==="textbook"){if(!S.gradeLevel){alert("");return}if(!S.subject){alert("");return}}se(!0);try{const R={title:S.title,author:"",publisher:S.bookType==="textbook"?"":"",subject:S.bookType==="textbook"?S.subject:"",grade:S.bookType==="textbook"?S.gradeLevel:"",price:S.transactionType==="gift"?0:Number(S.price),type:S.transactionType==="gift"?"gift":"sell",conditionLevel:S.conditionLevel,description:S.description,sellerId:t.uid,seller:{nickname:t.nickname||t.email,studentId:t.studentId||"",score:t.creditScore||5},cover:S.coverImagePreview,timestamp:new Date};await en.addBook(R),alert(""),g("shelf"),O({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null})}catch(R){console.error(":",R),alert(": "+R.message)}finally{se(!1)}},ae=(R,N)=>{N.stopPropagation(),Z(R)},A=async()=>{if(!oe)return;const R=oe;try{await en.deleteBook(R),Z(null)}catch(N){console.error("Deletion failed:",N),alert(": "+N.message)}},b=async()=>{try{const N=(await Jo.getBindingCode()).data.code;alert(` 6  LINE 

${N}

( 10 )`)}catch(R){console.error(R),alert(": "+R.message)}},C=Vi.find(R=>R.id===l)||Vi[0];return v.jsxs("div",{className:"min-h-screen pb-20",style:{...jp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:[v.jsx("nav",{className:"backdrop-blur-md shadow-sm border-b sticky top-0 z-50",style:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:ke.whiteBucks},children:v.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:v.jsx(RT,{size:20,className:"rotate-180 text-[#9E9081]"})}),v.jsx("div",{className:"font-bold text-lg tracking-wide",children:""})]}),v.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-red-50 text-red-700 border border-red-200",children:[v.jsx(_P,{size:14})," "]})]})}),v.jsxs("main",{className:"max-w-2xl mx-auto px-4 py-8 space-y-8",children:[v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>g("store"),children:[v.jsx("div",{className:"w-24 h-24 rounded-full border-4 shadow-md overflow-hidden bg-white",style:{borderColor:ke.bgLight},children:v.jsx("img",{src:Pd(C.src,200,70),className:"w-full h-full object-cover",alt:"User"})}),v.jsx("div",{className:"absolute bottom-0 right-0 text-white p-1.5 rounded-full border-2 border-white shadow-sm flex items-center justify-center",style:{backgroundColor:ke.chocolateBubble,width:28,height:28},children:v.jsx(TP,{size:14})})]}),v.jsx("h2",{className:"mt-4 text-xl font-bold tracking-widest",style:{color:ke.brownWindmill},children:t.nickname||t.email}),v.jsx("p",{className:"text-sm text-[#9E9081] mb-2",children:t.email}),v.jsxs("div",{className:"flex items-center gap-1 bg-yellow-100 px-3 py-1 rounded-full text-xs font-bold text-yellow-700",children:[v.jsx(Fg,{size:14,fill:"currentColor"})," ",s," "]}),v.jsxs("button",{onClick:b,className:"mt-3 px-4 py-1.5 bg-[#06C755] text-white text-xs font-bold rounded-full shadow-sm hover:bg-[#05b34c] transition-colors flex items-center gap-1",children:[v.jsx(Du,{size:14}),"  LINE "]})]}),v.jsxs("div",{className:"flex border rounded-lg overflow-hidden bg-white p-1",style:{borderColor:ke.whiteBucks},children:[v.jsx("button",{onClick:()=>g("shelf"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="shelf"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""}),v.jsx("button",{onClick:()=>g("upload"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all bg-[#A58976] text-white shadow-sm ring-1 ring-white/20",children:""}),v.jsx("button",{onClick:()=>g("store"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="store"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""})]}),p==="upload"?v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6 space-y-4 animate-fade-in",style:{borderColor:ke.whiteBucks},children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsx("input",{type:"file",id:"cover-upload",accept:"image/*",onChange:ge,className:"hidden"}),v.jsx("label",{htmlFor:"cover-upload",className:"block text-center p-8 border-2 border-dashed rounded-lg bg-[#F9F7F5] cursor-pointer hover:bg-[#E6DBC6] transition-colors",style:{borderColor:ke.fossilGray},children:S.coverImagePreview?v.jsx("img",{src:S.coverImagePreview,alt:"",className:"max-h-48 mx-auto rounded"}):v.jsxs(v.Fragment,{children:[v.jsx(gP,{className:"mx-auto text-[#9E9081] mb-2",size:32}),v.jsx("span",{className:"text-sm text-[#756256]",children:""})]})})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsx("input",{type:"text",value:S.title,onChange:R=>O({...S,title:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>O({...S,bookType:"textbook"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${S.bookType==="textbook"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),v.jsx("button",{type:"button",onClick:()=>O({...S,bookType:"extracurricular"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${S.bookType==="extracurricular"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),S.bookType==="textbook"&&v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("select",{value:S.gradeLevel,onChange:R=>O({...S,gradeLevel:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("select",{value:S.subject,onChange:R=>O({...S,subject:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>O({...S,transactionType:"sell"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${S.transactionType==="sell"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),v.jsx("button",{type:"button",onClick:()=>O({...S,transactionType:"gift",price:"0"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${S.transactionType==="gift"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:[" (NT$) ",S.transactionType==="sell"&&"*"]}),v.jsx("input",{type:"number",value:S.price,onChange:R=>{const N=R.target.value;Number(N)<0||(Number(N)===0&&N!==""?O({...S,price:0,transactionType:"gift"}):O({...S,price:N}))},className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"100",disabled:S.transactionType==="gift",required:S.transactionType==="sell"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsx("select",{value:S.conditionLevel,onChange:R=>O({...S,conditionLevel:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:ij.map(R=>v.jsx("option",{value:R,children:R},R))})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" ()"}),v.jsx("textarea",{value:S.description,onChange:R=>O({...S,description:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm h-24 resize-none",placeholder:"..."})]}),v.jsx("button",{onClick:ne,disabled:L,className:"w-full py-3 bg-[#756256] text-white rounded-xl font-bold shadow-md hover:bg-[#5D4E44] transition-colors disabled:opacity-50",children:L?"...":""})]}):p==="store"?v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 animate-fade-in",style:{borderColor:ke.whiteBucks},children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2 text-lg",children:[v.jsx(jP,{size:22})," "]}),v.jsxs("div",{className:"flex items-center gap-1 bg-yellow-100 px-3 py-1 rounded-full text-xs font-bold text-yellow-700 shadow-sm border border-yellow-200",children:[v.jsx(Fg,{size:14,fill:"currentColor"})," ",s," "]})]}),v.jsx(AT,{title:"",avatars:Vi.filter(R=>R.id.startsWith("special")||R.id==="pony-gift"),onPurchase:u,onEquip:f,currentAvatarId:l,myAvatars:a,coins:s}),v.jsx(AT,{title:"",avatars:Vi.filter(R=>!["pony-gift"].includes(R.id)&&!R.id.startsWith("special")),onPurchase:u,onEquip:f,currentAvatarId:l,myAvatars:a,coins:s})]}):v.jsx("div",{className:"space-y-4 animate-fade-in",children:T.length===0?v.jsx("div",{className:"text-center py-10 text-gray-400",children:""}):T.map(R=>v.jsxs("div",{onClick:()=>e("product",R),className:"bg-white rounded-xl shadow-sm border p-3 flex gap-4 items-center cursor-pointer hover:shadow-md transition-shadow",style:{borderColor:ke.whiteBucks},children:[v.jsx("div",{className:"w-16 h-20 bg-gray-200 rounded flex-shrink-0 overflow-hidden",children:v.jsx("img",{src:R.cover,className:"w-full h-full object-cover",alt:R.title})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h3",{className:"font-bold text-[#756256] truncate",children:R.title}),v.jsx("div",{className:"text-sm text-[#9E9081] font-medium",children:R.price===0||R.type==="gift"?"":`NT$ ${R.price}`}),v.jsxs("div",{className:"text-xs text-gray-400 mt-1 flex items-center gap-2",children:[v.jsxs("span",{children:[R.views||0," "]}),"  ",v.jsx("span",{children:R.date})]})]}),v.jsx("button",{onClick:N=>ae(R.id,N),className:"p-2 text-red-400 hover:bg-red-50 rounded-full",children:v.jsx(BP,{size:18})})]},R.id))})]}),oe&&v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>Z(null),children:v.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center shadow-xl transform transition-all scale-100",onClick:R=>R.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-4",children:""}),v.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:""}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:()=>Z(null),className:"flex-1 py-2.5 rounded-xl border border-gray-200 font-bold text-gray-500 hover:bg-gray-50 transition-colors",type:"button",children:""}),v.jsx("button",{onClick:A,className:"flex-1 py-2.5 rounded-xl bg-red-500 text-white font-bold hover:bg-red-600 transition-colors shadow-md",type:"button",children:""})]})]})})]})},mj=({transaction:n,currentUser:e,onClose:t,onBackToList:r})=>{const{id:s,sellerId:a,bookTitle:l,price:u}=n,[f,p]=fe.useState([]),[g,w]=fe.useState(""),[T,D]=fe.useState(null),S=fe.useRef(null),O=fe.useRef(null),L=fe.useRef(null);fe.useEffect(()=>{if(!s)return;const ne=xT.subscribeToMessages(s,ae=>{p(ae),en.markAsRead(s,e.uid),setTimeout(()=>S.current?.scrollIntoView({behavior:"smooth"}),100)});return en.markAsRead(s,e.uid),()=>ne&&ne()},[s,e.uid]),fe.useEffect(()=>{O.current&&(O.current.style.height="auto",O.current.style.height=`${Math.min(O.current.scrollHeight,120)}px`)},[g]);const se=ne=>{const ae=ne.target.files[0];if(ae){const A=new FileReader;A.onloadend=async()=>{const b=await Av(A.result,800,800,.7);D(b)},A.readAsDataURL(ae)}},oe=async()=>{if(!(!g.trim()&&!T))try{let ne=null;if(g.includes("")){const ae=g.match(/\*\*[\s\S]*?[:]\s*([^\n\r]*)/),A=g.match(/\*\*[\s\S]*?[:]\s*([^\n\r]*)/);(ae||A)&&(ne={meetingTime:aj(ae?.[1]?.trim()),meetingLocation:A?.[1]?.trim(),invoiceSentAt:new Date})}await xT.sendMessage(s,e.uid,e.name||e.nickname||"",g,T,ne),w(""),D(null)}catch(ne){console.error(ne),alert(": "+ne.message)}},Z=()=>{const ne=`
LINE
----------------
**(ex.1/5 8:20)**
****
****${l}
****NT$ ${u}`;w(ne)},ge=(ne,ae)=>v.jsxs("div",{className:"flex flex-col gap-2",children:[ae&&v.jsx("div",{className:"rounded-lg overflow-hidden bg-gray-100 mb-1",children:v.jsx("img",{src:ae,alt:"chat",className:"max-w-full h-auto object-contain cursor-pointer",onClick:()=>window.open(ae,"_blank")})}),ne&&ne.split(/(\*\*.*?\*\*)/g).map((A,b)=>A.startsWith("**")&&A.endsWith("**")?v.jsx("strong",{children:A.slice(2,-2)},A+b):v.jsx("span",{className:"whitespace-pre-wrap",children:A},A+b))]});return v.jsxs("div",{className:"fixed bottom-4 right-4 w-80 h-[450px] bg-white rounded-t-xl rounded-bl-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[v.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center shadow-md",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:r,className:"hover:bg-white/20 p-1.5 rounded-lg transition-all active:scale-95 group",title:"",children:v.jsx(Du,{size:18,className:"group-hover:animate-pulse"})}),v.jsx("span",{className:"font-bold text-sm truncate max-w-[150px]",children:l||""})]}),v.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1 transition-colors",children:v.jsx(ls,{size:16})})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3 bg-[#F9F7F5]",children:[v.jsx("div",{className:"text-center text-xs text-gray-400 mt-4 mb-4 space-y-2",children:v.jsxs("div",{className:"opacity-80",children:["",v.jsx("br",{}),""]})}),f.map((ne,ae)=>{const A=ne.senderId===e.uid,b=ne.timestamp?.toDate?ne.timestamp.toDate():new Date(ne.timestamp);let C=!1,R="";if(ae===0)C=!0;else{const P=f[ae-1],Oe=P.timestamp?.toDate?P.timestamp.toDate():new Date(P.timestamp);b.toLocaleDateString()!==Oe.toLocaleDateString()&&(C=!0)}C&&(R=`${b.getMonth()+1}/${b.getDate()}`);const j=(P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}):"")(ne.timestamp);return v.jsxs(CR.Fragment,{children:[C&&v.jsx("div",{className:"flex items-center justify-center my-4",children:v.jsx("div",{className:"bg-gray-200/50 text-gray-500 text-[10px] px-3 py-1 rounded-full font-bold",children:R})}),v.jsxs("div",{className:`flex items-end gap-1.5 ${A?"justify-end":"justify-start"}`,children:[A&&v.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:j}),v.jsx("div",{className:`max-w-[85%] rounded-xl px-3 py-2 text-sm shadow-sm break-words ${A?"bg-[#756256] text-white rounded-tr-none":"bg-white text-gray-700 rounded-tl-none"}`,children:ge(ne.content,ne.image)}),!A&&v.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:j})]})]},ne.id)}),v.jsx("div",{ref:S})]}),v.jsxs("div",{className:"px-3 py-1.5 bg-[#F9F7F5] flex items-center justify-start gap-2 border-t border-stone-100",children:[v.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:L,onChange:se}),v.jsx("button",{onClick:()=>L.current?.click(),className:"p-1.5 text-gray-400 hover:text-[#756256] transition-colors rounded-lg hover:bg-white flex-shrink-0 border border-stone-200 bg-white shadow-sm",title:"",children:v.jsx(PT,{size:18})}),e.uid===a&&v.jsx("button",{onClick:Z,className:"text-[10px] w-fit font-bold text-[#756256] border border-[#756256] rounded-md px-3 py-1 transform hover:translate-y-[-1px] transition-all bg-white flex items-center gap-1 shadow-sm active:translate-y-0",children:""})]}),T&&v.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t flex items-center gap-2",children:[v.jsxs("div",{className:"relative w-12 h-12 rounded-md overflow-hidden border border-gray-200",children:[v.jsx("img",{src:T,alt:"preview",className:"w-full h-full object-cover"}),v.jsx("button",{onClick:()=>D(null),className:"absolute top-0 right-0 bg-black/50 text-white rounded-full p-0.5",children:v.jsx(ls,{size:10})})]}),v.jsx("span",{className:"text-[10px] text-gray-500",children:"..."})]}),v.jsxs("div",{className:"p-3 bg-white border-t flex items-end gap-2",children:[v.jsx("textarea",{ref:O,rows:"1",value:g,onChange:ne=>w(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),oe())},placeholder:"...",className:"w-full bg-[#F9F7F5] border-none rounded-2xl px-4 py-2 text-sm focus:ring-1 focus:ring-[#756256] outline-none resize-none transition-all scrollbar-hide py-2"}),v.jsx("button",{onClick:oe,disabled:!g.trim()&&!T,className:"p-2 bg-[#756256] text-white rounded-full hover:bg-[#5D4E44] transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md flex-shrink-0",children:v.jsx(kP,{size:18})})]})]})},gj=({currentUser:n,onSelectChat:e,onClose:t,books:r})=>{const[s,a]=fe.useState([]);fe.useEffect(()=>{if(!n)return;const u=new Map,f=w=>{w.forEach(T=>{u.set(T.id,{id:T.id,...T.data()})}),a(Array.from(u.values()).sort((T,D)=>{const S=T.timestamp?.toDate?T.timestamp.toDate():new Date(T.timestamp);return(D.timestamp?.toDate?D.timestamp.toDate():new Date(D.timestamp))-S}))},p=en.getUserTransactions(n.uid,f),g=en.getSellerTransactions(n.uid,f);return()=>{p(),g()}},[n]);const l=async(u,f)=>{if(u.stopPropagation(),window.confirm(""))try{await en.deleteTransaction(f),a(p=>p.filter(g=>g.id!==f))}catch(p){console.error("Delete chat failed",p)}};return v.jsxs("div",{className:"fixed bottom-24 right-4 w-80 max-h-96 bg-white rounded-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[v.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center",children:[v.jsx("span",{className:"font-bold",children:""}),v.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1",children:v.jsx(ls,{size:16})})]}),v.jsxs("div",{className:"overflow-y-auto p-2 space-y-2 bg-[#F9F7F5] flex-1",children:[s.length===0&&v.jsx("div",{className:"text-center text-gray-400 py-4 text-sm",children:""}),s.map(u=>{const f=r.some(p=>p.id===u.bookId);return v.jsxs("div",{onClick:f?()=>e(u):p=>l(p,u.id),className:`p-3 rounded-lg cursor-pointer transition-colors shadow-sm border border-gray-100 relative ${f?"bg-white hover:bg-gray-50":"bg-gray-100 grayscale hover:bg-gray-200"}`,children:[u.unreadBy?.includes(n.uid)&&v.jsx("div",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white shadow-sm z-10"}),v.jsx("div",{className:"font-bold text-[#756256] text-sm truncate pr-4",children:u.bookTitle}),v.jsx("div",{className:"text-xs text-gray-500 flex justify-between mt-1",children:f?v.jsxs(v.Fragment,{children:[v.jsx("span",{children:u.buyerId===n.uid?"":""}),v.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] ${u.status==="Completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:u.status==="Pending"?"":u.status})]}):v.jsx("span",{className:"text-gray-500 font-bold w-full text-center",children:"()"})})]},u.id)})]})]})},yj=({notifications:n,onClose:e,onMarkAsRead:t})=>v.jsxs("div",{className:"fixed top-16 right-4 sm:right-20 w-80 max-h-[400px] bg-white rounded-2xl shadow-2xl flex flex-col z-[60] animate-slide-up border border-stone-100 overflow-hidden",children:[v.jsxs("div",{className:"bg-white p-4 border-b flex justify-between items-center",children:[v.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2",children:[v.jsx(Mg,{size:18,className:"text-[#A58976]"}),""]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(ls,{size:18})})]}),v.jsx("div",{className:"overflow-y-auto flex-1 bg-[#F9F7F5] p-2 space-y-2",children:n.length===0?v.jsxs("div",{className:"py-12 text-center text-gray-400 text-sm flex flex-col items-center gap-2",children:[v.jsx(Mg,{size:32,className:"opacity-20"}),""]}):n.map(r=>v.jsxs("div",{onClick:()=>!r.isRead&&t(r.id),className:`p-3 rounded-xl transition-all cursor-pointer border relative ${r.isRead?"bg-white/50 border-transparent grayscale-[0.3]":"bg-white border-blue-50 shadow-sm font-medium"}`,children:[!r.isRead&&v.jsx("div",{className:"absolute top-3 left-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),v.jsx("div",{className:"text-xs text-[#756256] mb-1 leading-relaxed pl-2",children:r.content}),v.jsx("div",{className:"text-[10px] text-gray-400 pl-2",children:xv(r.timestamp)})]},r.id))}),n.length>0&&v.jsx("div",{className:"p-3 bg-white border-t text-center",children:v.jsx("button",{className:"text-[10px] font-bold text-[#A58976] hover:underline",children:""})})]}),_j=()=>{const[n,e]=fe.useState("login"),[t,r]=fe.useState(null),[s,a]=fe.useState(null),[l,u]=fe.useState(null),[f,p]=fe.useState(!1),[g,w]=fe.useState(!1),[T,D]=fe.useState([]),S=T.some(xe=>!xe.isRead),[O,L]=fe.useState([]),se=O.some(xe=>xe.unreadBy?.includes(t?.uid));fe.useEffect(()=>{if(!t?.uid)return;const xe=Et=>{const Nn=Et.docs.map(Qt=>({id:Qt.id,...Qt.data()}));L(Qt=>{const jt=new Map(Qt.map(Jt=>[Jt.id,Jt]));return Nn.forEach(Jt=>jt.set(Jt.id,Jt)),Array.from(jt.values())})},Ke=en.getUserTransactions(t.uid,xe),wt=en.getSellerTransactions(t.uid,xe);return()=>{Ke(),wt()}},[t?.uid]);const[oe,Z]=fe.useState([]),[ge,ne]=fe.useState(!0),[ae,A]=fe.useState({exams:[]});fe.useEffect(()=>{(async()=>{try{const{functions:Ke}=await ns(async()=>{const{functions:Nn}=await Promise.resolve().then(()=>as);return{functions:Nn}},void 0),Et=await Ke.httpsCallable("getExamCountdown")();Et.data&&Et.data.exams?A(Et.data):A({exams:[]})}catch(Ke){console.error("Failed to fetch countdown:",Ke),A({exams:[]})}})()},[]);const[b,C]=fe.useState(0),[R,N]=fe.useState(!1),[j,P]=fe.useState(!1),[Oe,it]=fe.useState(oj),[ue,Ne]=fe.useState(["classic-1"]),[re,ye]=fe.useState("classic-1");fe.useEffect(()=>{let xe=null,Ke=null,wt=null,Et=null;const Nn=Jo.onAuthStateChanged(Qt=>{Qt?(r({uid:Qt.uid,email:Qt.email,...Qt,nickname:Qt.email.split("@")[0]}),e("home"),xe=Jo.onProfileSnapshot(Qt.uid,jt=>{if(jt.exists){const Jt=jt.data();r(at=>({...at,...Jt,uid:Qt.uid})),C(Jt.coins||0),Ne(Jt.myAvatars||["classic-1"]),Jt.ponyGiftClaimed||P(!0),(async()=>{try{const{functions:at}=await ns(async()=>{const{functions:io}=await Promise.resolve().then(()=>as);return{functions:io}},void 0),Dn=await at.httpsCallable("dailyCheckIn")();Dn.data.success&&(N(!0),C(Dn.data.newBalance))}catch(at){console.error("Check-in failed",at)}})()}}),Ke=en.onBooksSnapshot(jt=>{Z(jt),ne(!1)},jt=>{console.error("Global books fetch failed:",jt),ne(!1)}),wt=en.onWishesSnapshot(jt=>{it(jt)}),Et=en.subscribeToNotifications(Qt.uid,jt=>{D(jt)})):(r(null),e("login"),D([]),xe&&xe(),Ke&&Ke(),wt&&wt(),Et&&Et())});return()=>{Nn(),xe&&xe(),Ke&&Ke(),wt&&wt(),Et&&Et()}},[]);const he=()=>v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:v.jsxs("div",{className:"bg-white rounded-[2rem] p-8 w-full max-w-sm text-center relative shadow-2xl transform transition-all animate-scale-up",onClick:xe=>xe.stopPropagation(),children:[v.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2",children:v.jsx("div",{className:"bg-gradient-to-br from-yellow-300 to-orange-400 p-4 rounded-full shadow-lg border-4 border-white",children:v.jsx(DT,{size:40,className:"text-white animate-pulse"})})}),v.jsxs("div",{className:"mt-8",children:[v.jsx("h3",{className:"text-2xl font-black text-[#756256] mb-4",children:""}),v.jsxs("p",{className:"text-gray-500 mb-8 leading-relaxed",children:["",v.jsx("br",{})," ",v.jsx("span",{className:"text-orange-500 font-bold",children:""})," "]}),v.jsxs("div",{className:"flex flex-col items-center mb-8",children:[v.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-orange-100 p-1 bg-white shadow-inner mb-3",children:v.jsx("img",{src:Pd("https://i.postimg.cc/9fW28Bc0/niu.jpg",200,70),alt:"Pony Gift",className:"w-full h-full object-cover rounded-full"})}),v.jsx("span",{className:"text-xs font-bold text-gray-400",children:""})]}),v.jsx("button",{onClick:F,className:"w-full py-4 rounded-2xl bg-gradient-to-r from-[#A58976] to-[#756256] text-white font-bold hover:shadow-xl transition-all active:scale-95 text-lg",children:""})]})]})}),F=async()=>{try{const{db:xe,firebase:Ke}=await ns(async()=>{const{db:wt,firebase:Et}=await Promise.resolve().then(()=>as);return{db:wt,firebase:Et}},void 0);await xe.collection("users").doc(t.uid).update({myAvatars:Ke.firestore.FieldValue.arrayUnion("pony-gift"),ponyGiftClaimed:!0}),P(!1),alert(" ")}catch(xe){console.error(xe),alert("")}},K=()=>v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>N(!1),children:v.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center relative shadow-xl transform transition-all scale-100",onClick:xe=>xe.stopPropagation(),children:[v.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2",children:v.jsx("div",{className:"bg-yellow-400 p-3 rounded-full shadow-lg border-4 border-white",children:v.jsx(CT,{size:32,className:"text-white"})})}),v.jsxs("div",{className:"mt-6",children:[v.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-2",children:""}),v.jsx("p",{className:"text-gray-500 mb-6",children:" 5 "}),v.jsxs("div",{className:"flex items-center justify-center gap-2 text-2xl font-bold text-yellow-600 mb-6 bg-yellow-50 py-3 rounded-xl border border-yellow-100",children:[v.jsx(Fg,{size:28,fill:"currentColor"})," +5"]}),v.jsx("button",{onClick:()=>N(!1),className:"w-full py-3 rounded-xl bg-[#A58976] text-white font-bold hover:bg-[#8D735F] transition-colors",children:""})]})]})}),Re=(xe,Ke)=>{xe==="product"&&(a(Ke),Ke&&Ke.id&&en.incrementBookView(Ke.id)),e(xe)},Pe=async()=>{await Jo.logout()},Fe=async(xe,Ke)=>{try{await en.addWish({content:xe,image:Ke,user:t.nickname||t.realName||t.email,avatarId:re})}catch(wt){console.error("Failed to add wish:",wt),alert("")}},je=async xe=>{try{window.confirm("")&&await en.deleteWish(xe)}catch(Ke){console.error("Failed to delete wish:",Ke),alert("")}},Je=async(xe,Ke)=>{if(b<Ke){alert("");return}if(window.confirm(` ${Ke} `))try{const{functions:wt}=await ns(async()=>{const{functions:Nn}=await Promise.resolve().then(()=>as);return{functions:Nn}},void 0);await wt.httpsCallable("purchaseItem")({itemId:xe,price:Ke,type:"avatar"}),alert("")}catch(wt){console.error(wt),alert(": "+wt.message)}},qe=xe=>{ye(xe)};if(!t&&n!=="login")return null;const tt=()=>{switch(n){case"login":return v.jsx(dj,{});case"home":return v.jsx(fj,{onNavigate:Re,user:t,coins:b,wishes:Oe,onAddWish:Fe,onDeleteWish:je,books:oe,isLoading:ge,currentAvatarId:re,unreadCount:0,examCountdown:ae,onToggleNotifications:()=>w(!g),hasUnreadNotifications:S});case"product":return v.jsx(hj,{product:s,currentUser:t,onBack:()=>Re("home"),onContact:async()=>{try{await en.startTransaction(s,t,xe=>{u({id:xe,bookId:s.id,bookTitle:s.title,sellerId:s.sellerId,price:s.price})})}catch(xe){console.error(xe),alert("")}}});case"profile":return v.jsx(pj,{user:t,onBack:()=>Re("home"),onNavigate:Re,onLogout:Pe,coins:b,myAvatars:ue,currentAvatarId:re,onPurchase:Je,onEquip:qe});default:return v.jsx("div",{children:"404"})}};return v.jsxs("div",{className:"min-h-screen flex flex-col bg-[#F9F7F5]",children:[v.jsx("div",{className:"flex-1",children:tt()}),n!=="login"&&v.jsx(vj,{}),R&&v.jsx(K,{}),j&&v.jsx(he,{}),l&&v.jsx(mj,{transaction:l,currentUser:t,onClose:()=>u(null),onBackToList:()=>{u(null),p(!0)}}),g&&v.jsx(yj,{notifications:T,onClose:()=>w(!1),onMarkAsRead:async xe=>{await en.markNotificationAsRead(xe)}}),t&&n!=="login"&&!l&&v.jsxs(v.Fragment,{children:[v.jsxs("button",{onClick:()=>p(!f),className:"fixed bottom-6 right-6 w-14 h-14 bg-[#756256] text-white rounded-full shadow-lg flex items-center justify-center hover:bg-[#5D4E44] transition-all transform hover:scale-105 z-40 border-2 border-white",children:[f?v.jsx(ls,{size:24}):v.jsx(Du,{size:24}),!f&&se&&v.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full border-2 border-white shadow-sm animate-pulse"})]}),f&&v.jsx(gj,{currentUser:t,books:oe,onSelectChat:xe=>{u(xe),p(!1)},onClose:()=>p(!1)})]})]})},vj=()=>v.jsx("footer",{className:"bg-[#756256] text-[#E8E3DF] py-12 px-6 mt-12 border-t border-white/10",children:v.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center gap-2 justify-center md:justify-start",children:[v.jsx(KR,{size:24,className:"text-[#A58976]"}),v.jsx("span",{className:"text-xl font-black tracking-tight text-white",children:"SchoolBook Exchange"})]}),v.jsxs("p",{className:"text-xs opacity-70 leading-relaxed font-medium",children:["",v.jsx("br",{}),""]})]}),v.jsxs("div",{className:"flex flex-col gap-3 justify-center",children:[v.jsx("div",{className:"text-sm font-bold text-white mb-2 underline underline-offset-4 decoration-[#A58976]",children:""}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(VP,{size:14})," "]}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(VT,{size:14})," "]}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(NT,{size:14})," "]})]}),v.jsxs("div",{className:"flex flex-col gap-3 justify-center",children:[v.jsx("div",{className:"text-sm font-bold text-white mb-2 underline underline-offset-4 decoration-[#A58976]",children:""}),v.jsxs("div",{className:"text-xs opacity-80 hover:opacity-100 transition-opacity flex items-center gap-2 justify-center md:justify-start",children:[v.jsx(wP,{size:14})," service@shsh.tw"]}),v.jsx("div",{className:"text-[10px] opacity-50 mt-4 font-mono",children:" 2025 SchoolBook Exchange. All rights reserved."})]})]})});MR.createRoot(document.getElementById("root")).render(v.jsx(fe.StrictMode,{children:v.jsx(_j,{})}));
