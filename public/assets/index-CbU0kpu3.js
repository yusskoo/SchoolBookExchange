(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var ag={exports:{}},Xu={},lg={exports:{}},ze={};var VE;function IR(){if(VE)return ze;VE=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function T(F){return F===null||typeof F!="object"?null:(F=v&&F[v]||F["@@iterator"],typeof F=="function"?F:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,O={};function L(F,K,Ne){this.props=F,this.context=K,this.refs=O,this.updater=Ne||C}L.prototype.isReactComponent={},L.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},L.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function ne(){}ne.prototype=L.prototype;function oe(F,K,Ne){this.props=F,this.context=K,this.refs=O,this.updater=Ne||C}var Z=oe.prototype=new ne;Z.constructor=oe,x(Z,L.prototype),Z.isPureReactComponent=!0;var re=Array.isArray,de=Object.prototype.hasOwnProperty,le={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function b(F,K,Ne){var Ce,Ue={},pe=null,Pe=null;if(K!=null)for(Ce in K.ref!==void 0&&(Pe=K.ref),K.key!==void 0&&(pe=""+K.key),K)de.call(K,Ce)&&!R.hasOwnProperty(Ce)&&(Ue[Ce]=K[Ce]);var xe=arguments.length-2;if(xe===1)Ue.children=Ne;else if(1<xe){for(var Le=Array(xe),lt=0;lt<xe;lt++)Le[lt]=arguments[lt+2];Ue.children=Le}if(F&&F.defaultProps)for(Ce in xe=F.defaultProps,xe)Ue[Ce]===void 0&&(Ue[Ce]=xe[Ce]);return{$$typeof:n,type:F,key:pe,ref:Pe,props:Ue,_owner:le.current}}function A(F,K){return{$$typeof:n,type:F.type,key:K,ref:F.ref,props:F.props,_owner:F._owner}}function N(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function D(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Ne){return K[Ne]})}var j=/\/+/g;function k(F,K){return typeof F=="object"&&F!==null&&F.key!=null?D(""+F.key):K.toString(36)}function Be(F,K,Ne,Ce,Ue){var pe=typeof F;(pe==="undefined"||pe==="boolean")&&(F=null);var Pe=!1;if(F===null)Pe=!0;else switch(pe){case"string":case"number":Pe=!0;break;case"object":switch(F.$$typeof){case n:case e:Pe=!0}}if(Pe)return Pe=F,Ue=Ue(Pe),F=Ce===""?"."+k(Pe,0):Ce,re(Ue)?(Ne="",F!=null&&(Ne=F.replace(j,"$&/")+"/"),Be(Ue,K,Ne,"",function(lt){return lt})):Ue!=null&&(N(Ue)&&(Ue=A(Ue,Ne+(!Ue.key||Pe&&Pe.key===Ue.key?"":(""+Ue.key).replace(j,"$&/")+"/")+F)),K.push(Ue)),1;if(Pe=0,Ce=Ce===""?".":Ce+":",re(F))for(var xe=0;xe<F.length;xe++){pe=F[xe];var Le=Ce+k(pe,xe);Pe+=Be(pe,K,Ne,Le,Ue)}else if(Le=T(F),typeof Le=="function")for(F=Le.call(F),xe=0;!(pe=F.next()).done;)pe=pe.value,Le=Ce+k(pe,xe++),Pe+=Be(pe,K,Ne,Le,Ue);else if(pe==="object")throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Pe}function rt(F,K,Ne){if(F==null)return F;var Ce=[],Ue=0;return Be(F,Ce,"","",function(pe){return K.call(Ne,pe,Ue++)}),Ce}function ce(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(Ne){(F._status===0||F._status===-1)&&(F._status=1,F._result=Ne)},function(Ne){(F._status===0||F._status===-1)&&(F._status=2,F._result=Ne)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var Ve={current:null},se={transition:null},_e={ReactCurrentDispatcher:Ve,ReactCurrentBatchConfig:se,ReactCurrentOwner:le};function fe(){throw Error("act(...) is not supported in production builds of React.")}return ze.Children={map:rt,forEach:function(F,K,Ne){rt(F,function(){K.apply(this,arguments)},Ne)},count:function(F){var K=0;return rt(F,function(){K++}),K},toArray:function(F){return rt(F,function(K){return K})||[]},only:function(F){if(!N(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ze.Component=L,ze.Fragment=t,ze.Profiler=s,ze.PureComponent=oe,ze.StrictMode=r,ze.Suspense=f,ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_e,ze.act=fe,ze.cloneElement=function(F,K,Ne){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Ce=x({},F.props),Ue=F.key,pe=F.ref,Pe=F._owner;if(K!=null){if(K.ref!==void 0&&(pe=K.ref,Pe=le.current),K.key!==void 0&&(Ue=""+K.key),F.type&&F.type.defaultProps)var xe=F.type.defaultProps;for(Le in K)de.call(K,Le)&&!R.hasOwnProperty(Le)&&(Ce[Le]=K[Le]===void 0&&xe!==void 0?xe[Le]:K[Le])}var Le=arguments.length-2;if(Le===1)Ce.children=Ne;else if(1<Le){xe=Array(Le);for(var lt=0;lt<Le;lt++)xe[lt]=arguments[lt+2];Ce.children=xe}return{$$typeof:n,type:F.type,key:Ue,ref:pe,props:Ce,_owner:Pe}},ze.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:a,_context:F},F.Consumer=F},ze.createElement=b,ze.createFactory=function(F){var K=b.bind(null,F);return K.type=F,K},ze.createRef=function(){return{current:null}},ze.forwardRef=function(F){return{$$typeof:d,render:F}},ze.isValidElement=N,ze.lazy=function(F){return{$$typeof:g,_payload:{_status:-1,_result:F},_init:ce}},ze.memo=function(F,K){return{$$typeof:p,type:F,compare:K===void 0?null:K}},ze.startTransition=function(F){var K=se.transition;se.transition={};try{F()}finally{se.transition=K}},ze.unstable_act=fe,ze.useCallback=function(F,K){return Ve.current.useCallback(F,K)},ze.useContext=function(F){return Ve.current.useContext(F)},ze.useDebugValue=function(){},ze.useDeferredValue=function(F){return Ve.current.useDeferredValue(F)},ze.useEffect=function(F,K){return Ve.current.useEffect(F,K)},ze.useId=function(){return Ve.current.useId()},ze.useImperativeHandle=function(F,K,Ne){return Ve.current.useImperativeHandle(F,K,Ne)},ze.useInsertionEffect=function(F,K){return Ve.current.useInsertionEffect(F,K)},ze.useLayoutEffect=function(F,K){return Ve.current.useLayoutEffect(F,K)},ze.useMemo=function(F,K){return Ve.current.useMemo(F,K)},ze.useReducer=function(F,K,Ne){return Ve.current.useReducer(F,K,Ne)},ze.useRef=function(F){return Ve.current.useRef(F)},ze.useState=function(F){return Ve.current.useState(F)},ze.useSyncExternalStore=function(F,K,Ne){return Ve.current.useSyncExternalStore(F,K,Ne)},ze.useTransition=function(){return Ve.current.useTransition()},ze.version="18.3.1",ze}var OE;function Py(){return OE||(OE=1,lg.exports=IR()),lg.exports}var LE;function TR(){if(LE)return Xu;LE=1;var n=Py(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,p){var g,v={},T=null,C=null;p!==void 0&&(T=""+p),f.key!==void 0&&(T=""+f.key),f.ref!==void 0&&(C=f.ref);for(g in f)r.call(f,g)&&!a.hasOwnProperty(g)&&(v[g]=f[g]);if(d&&d.defaultProps)for(g in f=d.defaultProps,f)v[g]===void 0&&(v[g]=f[g]);return{$$typeof:e,type:d,key:T,ref:C,props:v,_owner:s.current}}return Xu.Fragment=t,Xu.jsx=l,Xu.jsxs=l,Xu}var ME;function SR(){return ME||(ME=1,ag.exports=TR()),ag.exports}var E=SR(),ye=Py(),zh={},ug={exports:{}},Nn={},cg={exports:{}},dg={};var FE;function AR(){return FE||(FE=1,(function(n){function e(se,_e){var fe=se.length;se.push(_e);e:for(;0<fe;){var F=fe-1>>>1,K=se[F];if(0<s(K,_e))se[F]=_e,se[fe]=K,fe=F;else break e}}function t(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var _e=se[0],fe=se.pop();if(fe!==_e){se[0]=fe;e:for(var F=0,K=se.length,Ne=K>>>1;F<Ne;){var Ce=2*(F+1)-1,Ue=se[Ce],pe=Ce+1,Pe=se[pe];if(0>s(Ue,fe))pe<K&&0>s(Pe,Ue)?(se[F]=Pe,se[pe]=fe,F=pe):(se[F]=Ue,se[Ce]=fe,F=Ce);else if(pe<K&&0>s(Pe,fe))se[F]=Pe,se[pe]=fe,F=pe;else break e}}return _e}function s(se,_e){var fe=se.sortIndex-_e.sortIndex;return fe!==0?fe:se.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],p=[],g=1,v=null,T=3,C=!1,x=!1,O=!1,L=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(se){for(var _e=t(p);_e!==null;){if(_e.callback===null)r(p);else if(_e.startTime<=se)r(p),_e.sortIndex=_e.expirationTime,e(f,_e);else break;_e=t(p)}}function re(se){if(O=!1,Z(se),!x)if(t(f)!==null)x=!0,ce(de);else{var _e=t(p);_e!==null&&Ve(re,_e.startTime-se)}}function de(se,_e){x=!1,O&&(O=!1,ne(b),b=-1),C=!0;var fe=T;try{for(Z(_e),v=t(f);v!==null&&(!(v.expirationTime>_e)||se&&!D());){var F=v.callback;if(typeof F=="function"){v.callback=null,T=v.priorityLevel;var K=F(v.expirationTime<=_e);_e=n.unstable_now(),typeof K=="function"?v.callback=K:v===t(f)&&r(f),Z(_e)}else r(f);v=t(f)}if(v!==null)var Ne=!0;else{var Ce=t(p);Ce!==null&&Ve(re,Ce.startTime-_e),Ne=!1}return Ne}finally{v=null,T=fe,C=!1}}var le=!1,R=null,b=-1,A=5,N=-1;function D(){return!(n.unstable_now()-N<A)}function j(){if(R!==null){var se=n.unstable_now();N=se;var _e=!0;try{_e=R(!0,se)}finally{_e?k():(le=!1,R=null)}}else le=!1}var k;if(typeof oe=="function")k=function(){oe(j)};else if(typeof MessageChannel<"u"){var Be=new MessageChannel,rt=Be.port2;Be.port1.onmessage=j,k=function(){rt.postMessage(null)}}else k=function(){L(j,0)};function ce(se){R=se,le||(le=!0,k())}function Ve(se,_e){b=L(function(){se(n.unstable_now())},_e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(se){se.callback=null},n.unstable_continueExecution=function(){x||C||(x=!0,ce(de))},n.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<se?Math.floor(1e3/se):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(se){switch(T){case 1:case 2:case 3:var _e=3;break;default:_e=T}var fe=T;T=_e;try{return se()}finally{T=fe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(se,_e){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var fe=T;T=se;try{return _e()}finally{T=fe}},n.unstable_scheduleCallback=function(se,_e,fe){var F=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?F+fe:F):fe=F,se){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=fe+K,se={id:g++,callback:_e,priorityLevel:se,startTime:fe,expirationTime:K,sortIndex:-1},fe>F?(se.sortIndex=fe,e(p,se),t(f)===null&&se===t(p)&&(O?(ne(b),b=-1):O=!0,Ve(re,fe-F))):(se.sortIndex=K,e(f,se),x||C||(x=!0,ce(de))),se},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(se){var _e=T;return function(){var fe=T;T=_e;try{return se.apply(this,arguments)}finally{T=fe}}}})(dg)),dg}var jE;function xR(){return jE||(jE=1,cg.exports=AR()),cg.exports}var UE;function bR(){if(UE)return Nn;UE=1;var n=Py(),e=xR();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},v={};function T(i){return f.call(v,i)?!0:f.call(g,i)?!1:p.test(i)?v[i]=!0:(g[i]=!0,!1)}function C(i,o,u,h){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function x(i,o,u,h){if(o===null||typeof o>"u"||C(i,o,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function O(i,o,u,h,m,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){L[i]=new O(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];L[o]=new O(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){L[i]=new O(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){L[i]=new O(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){L[i]=new O(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){L[i]=new O(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){L[i]=new O(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){L[i]=new O(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){L[i]=new O(i,5,!1,i.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function oe(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(ne,oe);L[o]=new O(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(ne,oe);L[o]=new O(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(ne,oe);L[o]=new O(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){L[i]=new O(i,1,!1,i.toLowerCase(),null,!1,!1)}),L.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){L[i]=new O(i,1,!1,i.toLowerCase(),null,!0,!0)});function Z(i,o,u,h){var m=L.hasOwnProperty(o)?L[o]:null;(m!==null?m.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(x(o,u,m,h)&&(u=null),h||m===null?T(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):m.mustUseProperty?i[m.propertyName]=u===null?m.type===3?!1:"":u:(o=m.attributeName,h=m.attributeNamespace,u===null?i.removeAttribute(o):(m=m.type,u=m===3||m===4&&u===!0?"":""+u,h?i.setAttributeNS(h,o,u):i.setAttribute(o,u))))}var re=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,de=Symbol.for("react.element"),le=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),D=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),Be=Symbol.for("react.suspense_list"),rt=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),Ve=Symbol.for("react.offscreen"),se=Symbol.iterator;function _e(i){return i===null||typeof i!="object"?null:(i=se&&i[se]||i["@@iterator"],typeof i=="function"?i:null)}var fe=Object.assign,F;function K(i){if(F===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+i}var Ne=!1;function Ce(i,o){if(!i||Ne)return"";Ne=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(q){var h=q}Reflect.construct(i,[],o)}else{try{o.call()}catch(q){h=q}i.call(o.prototype)}else{try{throw Error()}catch(q){h=q}i()}}catch(q){if(q&&h&&typeof q.stack=="string"){for(var m=q.stack.split(`
`),y=h.stack.split(`
`),I=m.length-1,P=y.length-1;1<=I&&0<=P&&m[I]!==y[P];)P--;for(;1<=I&&0<=P;I--,P--)if(m[I]!==y[P]){if(I!==1||P!==1)do if(I--,P--,0>P||m[I]!==y[P]){var V=`
`+m[I].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=I&&0<=P);break}}}finally{Ne=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?K(i):""}function Ue(i){switch(i.tag){case 5:return K(i.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return i=Ce(i.type,!1),i;case 11:return i=Ce(i.type.render,!1),i;case 1:return i=Ce(i.type,!0),i;default:return""}}function pe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case R:return"Fragment";case le:return"Portal";case A:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case Be:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case D:return(i.displayName||"Context")+".Consumer";case N:return(i._context.displayName||"Context")+".Provider";case j:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case rt:return o=i.displayName||null,o!==null?o:pe(i.type)||"Memo";case ce:o=i._payload,i=i._init;try{return pe(i(o))}catch{}}return null}function Pe(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(o);case 8:return o===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function xe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Le(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function lt(i){var o=Le(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,y=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return m.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Un(i){i._valueTracker||(i._valueTracker=lt(i))}function $s(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return i&&(h=Le(i)?i.checked?"true":"false":i.value),i=h,i!==u?(o.setValue(i),!0):!1}function xn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ha(i,o){var u=o.checked;return fe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function bd(i,o){var u=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;u=xe(o.value!=null?o.value:u),i._wrapperState={initialChecked:h,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function fa(i,o){o=o.checked,o!=null&&Z(i,"checked",o,!1)}function eo(i,o){fa(i,o);var u=xe(o.value),h=o.type;if(u!=null)h==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ot(i,o.type,u):o.hasOwnProperty("defaultValue")&&Ot(i,o.type,xe(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function iu(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function Ot(i,o,u){(o!=="number"||xn(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var bt=Array.isArray;function pr(i,o,u,h){if(i=i.options,o){o={};for(var m=0;m<u.length;m++)o["$"+u[m]]=!0;for(u=0;u<i.length;u++)m=o.hasOwnProperty("$"+i[u].value),i[u].selected!==m&&(i[u].selected=m),m&&h&&(i[u].defaultSelected=!0)}else{for(u=""+xe(u),o=null,m=0;m<i.length;m++){if(i[m].value===u){i[m].selected=!0,h&&(i[m].defaultSelected=!0);return}o!==null||i[m].disabled||(o=i[m])}o!==null&&(o.selected=!0)}}function ou(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return fe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function au(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(t(92));if(bt(u)){if(1<u.length)throw Error(t(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:xe(u)}}function Rd(i,o){var u=xe(o.value),h=xe(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),h!=null&&(i.defaultValue=""+h)}function qs(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function lu(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pa(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?lu(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ws,Pd=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,h,m){MSApp.execUnsafeLocalFunction(function(){return i(o,u,h,m)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Ws=Ws||document.createElement("div"),Ws.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ws.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function to(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var Hs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kd=["Webkit","ms","Moz","O"];Object.keys(Hs).forEach(function(i){kd.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Hs[o]=Hs[i]})});function Gs(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||Hs.hasOwnProperty(i)&&Hs[i]?(""+o).trim():o+"px"}function ma(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var h=u.indexOf("--")===0,m=Gs(u,o[u],h);u==="float"&&(u="cssFloat"),h?i.setProperty(u,m):i[u]=m}}var uu=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mr(i,o){if(o){if(uu[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function ga(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ks=null;function ya(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ds=null,hs=null,It=null;function cu(i){if(i=Mu(i)){if(typeof ds!="function")throw Error(t(280));var o=i.stateNode;o&&(o=rh(o),ds(i.stateNode,i.type,o))}}function Qs(i){hs?It?It.push(i):It=[i]:hs=i}function Js(){if(hs){var i=hs,o=It;if(It=hs=null,cu(i),o)for(i=0;i<o.length;i++)cu(o[i])}}function Cd(i,o){return i(o)}function Nd(){}var kr=!1;function Dd(i,o,u){if(kr)return i(o,u);kr=!0;try{return Cd(i,o,u)}finally{kr=!1,(hs!==null||It!==null)&&(Nd(),Js())}}function no(i,o){var u=i.stateNode;if(u===null)return null;var h=rh(u);if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(t(231,o,typeof u));return u}var Ys=!1;if(d)try{var Xs={};Object.defineProperty(Xs,"passive",{get:function(){Ys=!0}}),window.addEventListener("test",Xs,Xs),window.removeEventListener("test",Xs,Xs)}catch{Ys=!1}function Vd(i,o,u,h,m,y,I,P,V){var q=Array.prototype.slice.call(arguments,3);try{o.apply(u,q)}catch(X){this.onError(X)}}var fs=!1,Cr=null,_a=!1,nr=null,Od={onError:function(i){fs=!0,Cr=i}};function Ld(i,o,u,h,m,y,I,P,V){fs=!1,Cr=null,Vd.apply(Od,arguments)}function du(i,o,u,h,m,y,I,P,V){if(Ld.apply(this,arguments),fs){if(fs){var q=Cr;fs=!1,Cr=null}else throw Error(t(198));_a||(_a=!0,nr=q)}}function gr(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function hu(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Md(i){if(gr(i)!==i)throw Error(t(188))}function Fd(i){var o=i.alternate;if(!o){if(o=gr(i),o===null)throw Error(t(188));return o!==i?null:i}for(var u=i,h=o;;){var m=u.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){u=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===u)return Md(m),i;if(y===h)return Md(m),o;y=y.sibling}throw Error(t(188))}if(u.return!==h.return)u=m,h=y;else{for(var I=!1,P=m.child;P;){if(P===u){I=!0,u=m,h=y;break}if(P===h){I=!0,h=m,u=y;break}P=P.sibling}if(!I){for(P=y.child;P;){if(P===u){I=!0,u=y,h=m;break}if(P===h){I=!0,h=y,u=m;break}P=P.sibling}if(!I)throw Error(t(189))}}if(u.alternate!==h)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?i:o}function jd(i){return i=Fd(i),i!==null?ro(i):null}function ro(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=ro(i);if(o!==null)return o;i=i.sibling}return null}var fu=e.unstable_scheduleCallback,va=e.unstable_cancelCallback,so=e.unstable_shouldYield,ps=e.unstable_requestPaint,ut=e.unstable_now,Fp=e.unstable_getCurrentPriorityLevel,wa=e.unstable_ImmediatePriority,pu=e.unstable_UserBlockingPriority,io=e.unstable_NormalPriority,mu=e.unstable_LowPriority,Ea=e.unstable_IdlePriority,oo=null,Bn=null;function Ud(i){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(oo,i,void 0,(i.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:ao,Nr=Math.log,rr=Math.LN2;function ao(i){return i>>>=0,i===0?32:31-(Nr(i)/rr|0)|0}var Dr=64,Zs=4194304;function Xe(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ms(i,o){var u=i.pendingLanes;if(u===0)return 0;var h=0,m=i.suspendedLanes,y=i.pingedLanes,I=u&268435455;if(I!==0){var P=I&~m;P!==0?h=Xe(P):(y&=I,y!==0&&(h=Xe(y)))}else I=u&~m,I!==0?h=Xe(I):y!==0&&(h=Xe(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&m)===0&&(m=h&-h,y=o&-o,m>=y||m===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=u&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)u=31-zn(o),m=1<<u,h|=i[u],o&=~m;return h}function lo(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uo(i,o){for(var u=i.suspendedLanes,h=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-zn(y),P=1<<I,V=m[I];V===-1?((P&u)===0||(P&h)!==0)&&(m[I]=lo(P,o)):V<=o&&(i.expiredLanes|=P),y&=~P}}function gu(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function yu(){var i=Dr;return Dr<<=1,(Dr&4194240)===0&&(Dr=64),i}function _u(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function co(i,o,u){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-zn(o),i[o]=u}function jp(i,o){var u=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<u;){var m=31-zn(u),y=1<<m;o[m]=0,h[m]=-1,i[m]=-1,u&=~y}}function vu(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var h=31-zn(u),m=1<<h;m&o|i[h]&o&&(i[h]|=o),u&=~m}}var He=0;function Vr(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var wu,Ia,Eu,Iu,Tu,Or=!1,Ta=[],Lr=null,Mr=null,Zt=null,ho=new Map,gs=new Map,$n=[],Bd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ei(i,o){switch(i){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":Zt=null;break;case"pointerover":case"pointerout":ho.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":gs.delete(o.pointerId)}}function yr(i,o,u,h,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},o!==null&&(o=Mu(o),o!==null&&Ia(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),i)}function zd(i,o,u,h,m){switch(o){case"focusin":return Lr=yr(Lr,i,o,u,h,m),!0;case"dragenter":return Mr=yr(Mr,i,o,u,h,m),!0;case"mouseover":return Zt=yr(Zt,i,o,u,h,m),!0;case"pointerover":var y=m.pointerId;return ho.set(y,yr(ho.get(y)||null,i,o,u,h,m)),!0;case"gotpointercapture":return y=m.pointerId,gs.set(y,yr(gs.get(y)||null,i,o,u,h,m)),!0}return!1}function Sa(i){var o=go(i.target);if(o!==null){var u=gr(o);if(u!==null){if(o=u.tag,o===13){if(o=hu(u),o!==null){i.blockedOn=o,Tu(i.priority,function(){Eu(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function st(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=Aa(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);Ks=h,u.target.dispatchEvent(h),Ks=null}else return o=Mu(u),o!==null&&Ia(o),i.blockedOn=u,!1;o.shift()}return!0}function $d(i,o,u){st(i)&&u.delete(o)}function Up(){Or=!1,Lr!==null&&st(Lr)&&(Lr=null),Mr!==null&&st(Mr)&&(Mr=null),Zt!==null&&st(Zt)&&(Zt=null),ho.forEach($d),gs.forEach($d)}function ti(i,o){i.blockedOn===o&&(i.blockedOn=null,Or||(Or=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Up)))}function ni(i){function o(m){return ti(m,i)}if(0<Ta.length){ti(Ta[0],i);for(var u=1;u<Ta.length;u++){var h=Ta[u];h.blockedOn===i&&(h.blockedOn=null)}}for(Lr!==null&&ti(Lr,i),Mr!==null&&ti(Mr,i),Zt!==null&&ti(Zt,i),ho.forEach(o),gs.forEach(o),u=0;u<$n.length;u++)h=$n[u],h.blockedOn===i&&(h.blockedOn=null);for(;0<$n.length&&(u=$n[0],u.blockedOn===null);)Sa(u),u.blockedOn===null&&$n.shift()}var ys=re.ReactCurrentBatchConfig,_s=!0;function Fr(i,o,u,h){var m=He,y=ys.transition;ys.transition=null;try{He=1,Su(i,o,u,h)}finally{He=m,ys.transition=y}}function qd(i,o,u,h){var m=He,y=ys.transition;ys.transition=null;try{He=4,Su(i,o,u,h)}finally{He=m,ys.transition=y}}function Su(i,o,u,h){if(_s){var m=Aa(i,o,u,h);if(m===null)Yp(i,o,h,jr,u),ei(i,h);else if(zd(m,i,o,u,h))h.stopPropagation();else if(ei(i,h),o&4&&-1<Bd.indexOf(i)){for(;m!==null;){var y=Mu(m);if(y!==null&&wu(y),y=Aa(i,o,u,h),y===null&&Yp(i,o,h,jr,u),y===m)break;m=y}m!==null&&h.stopPropagation()}else Yp(i,o,h,null,u)}}var jr=null;function Aa(i,o,u,h){if(jr=null,i=ya(h),i=go(i),i!==null)if(o=gr(i),o===null)i=null;else if(u=o.tag,u===13){if(i=hu(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return jr=i,null}function xa(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fp()){case wa:return 1;case pu:return 4;case io:case mu:return 16;case Ea:return 536870912;default:return 16}default:return 16}}var qn=null,ba=null,vs=null;function Wd(){if(vs)return vs;var i,o=ba,u=o.length,h,m="value"in qn?qn.value:qn.textContent,y=m.length;for(i=0;i<u&&o[i]===m[i];i++);var I=u-i;for(h=1;h<=I&&o[u-h]===m[y-h];h++);return vs=m.slice(i,1<h?1-h:void 0)}function fo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Ur(){return!0}function Au(){return!1}function ln(i){function o(u,h,m,y,I){this._reactName=u,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var P in i)i.hasOwnProperty(P)&&(u=i[P],this[P]=u?u(y):y[P]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ur:Au,this.isPropagationStopped=Au,this}return fe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),o}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},po=ln(Br),ri=fe({},Br,{view:0,detail:0}),Ra=ln(ri),Pa,ka,Wn,mo=fe({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Me,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Wn&&(Wn&&i.type==="mousemove"?(Pa=i.screenX-Wn.screenX,ka=i.screenY-Wn.screenY):ka=Pa=0,Wn=i),Pa)},movementY:function(i){return"movementY"in i?i.movementY:ka}}),xu=ln(mo),Hd=fe({},mo,{dataTransfer:0}),Gd=ln(Hd),Ca=fe({},ri,{relatedTarget:0}),en=ln(Ca),Kd=fe({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),Qd=ln(Kd),si=fe({},Br,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),c=ln(si),_=fe({},Br,{data:0}),w=ln(_),S={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ae(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=H[i])?!!o[i]:!1}function Me(){return ae}var Rt=fe({},ri,{key:function(i){if(i.key){var o=S[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=fo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?z[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Me,charCode:function(i){return i.type==="keypress"?fo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?fo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),et=ln(Rt),Lt=fe({},mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hn=ln(Lt),ws=fe({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Me}),zr=ln(ws),$r=fe({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Na=ln($r),bu=fe({},mo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),gb=ln(bu),yb=[9,13,27,32],Bp=d&&"CompositionEvent"in window,Ru=null;d&&"documentMode"in document&&(Ru=document.documentMode);var _b=d&&"TextEvent"in window&&!Ru,xv=d&&(!Bp||Ru&&8<Ru&&11>=Ru),bv=" ",Rv=!1;function Pv(i,o){switch(i){case"keyup":return yb.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kv(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Da=!1;function vb(i,o){switch(i){case"compositionend":return kv(o);case"keypress":return o.which!==32?null:(Rv=!0,bv);case"textInput":return i=o.data,i===bv&&Rv?null:i;default:return null}}function wb(i,o){if(Da)return i==="compositionend"||!Bp&&Pv(i,o)?(i=Wd(),vs=ba=qn=null,Da=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return xv&&o.locale!=="ko"?null:o.data;default:return null}}var Eb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cv(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Eb[i.type]:o==="textarea"}function Nv(i,o,u,h){Qs(h),o=eh(o,"onChange"),0<o.length&&(u=new po("onChange","change",null,u,h),i.push({event:u,listeners:o}))}var Pu=null,ku=null;function Ib(i){Jv(i,0)}function Jd(i){var o=Fa(i);if($s(o))return i}function Tb(i,o){if(i==="change")return o}var Dv=!1;if(d){var zp;if(d){var $p="oninput"in document;if(!$p){var Vv=document.createElement("div");Vv.setAttribute("oninput","return;"),$p=typeof Vv.oninput=="function"}zp=$p}else zp=!1;Dv=zp&&(!document.documentMode||9<document.documentMode)}function Ov(){Pu&&(Pu.detachEvent("onpropertychange",Lv),ku=Pu=null)}function Lv(i){if(i.propertyName==="value"&&Jd(ku)){var o=[];Nv(o,ku,i,ya(i)),Dd(Ib,o)}}function Sb(i,o,u){i==="focusin"?(Ov(),Pu=o,ku=u,Pu.attachEvent("onpropertychange",Lv)):i==="focusout"&&Ov()}function Ab(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Jd(ku)}function xb(i,o){if(i==="click")return Jd(o)}function bb(i,o){if(i==="input"||i==="change")return Jd(o)}function Rb(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var _r=typeof Object.is=="function"?Object.is:Rb;function Cu(i,o){if(_r(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var m=u[h];if(!f.call(o,m)||!_r(i[m],o[m]))return!1}return!0}function Mv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Fv(i,o){var u=Mv(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=o&&h>=o)return{node:u,offset:o-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Mv(u)}}function jv(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?jv(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Uv(){for(var i=window,o=xn();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=xn(i.document)}return o}function qp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Pb(i){var o=Uv(),u=i.focusedElem,h=i.selectionRange;if(o!==u&&u&&u.ownerDocument&&jv(u.ownerDocument.documentElement,u)){if(h!==null&&qp(u)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(i,u.value.length);else if(i=(o=u.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var m=u.textContent.length,y=Math.min(h.start,m);h=h.end===void 0?y:Math.min(h.end,m),!i.extend&&y>h&&(m=h,h=y,y=m),m=Fv(u,y);var I=Fv(u,h);m&&I&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=u;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)i=o[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var kb=d&&"documentMode"in document&&11>=document.documentMode,Va=null,Wp=null,Nu=null,Hp=!1;function Bv(i,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Hp||Va==null||Va!==xn(h)||(h=Va,"selectionStart"in h&&qp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Nu&&Cu(Nu,h)||(Nu=h,h=eh(Wp,"onSelect"),0<h.length&&(o=new po("onSelect","select",null,o,u),i.push({event:o,listeners:h}),o.target=Va)))}function Yd(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Oa={animationend:Yd("Animation","AnimationEnd"),animationiteration:Yd("Animation","AnimationIteration"),animationstart:Yd("Animation","AnimationStart"),transitionend:Yd("Transition","TransitionEnd")},Gp={},zv={};d&&(zv=document.createElement("div").style,"AnimationEvent"in window||(delete Oa.animationend.animation,delete Oa.animationiteration.animation,delete Oa.animationstart.animation),"TransitionEvent"in window||delete Oa.transitionend.transition);function Xd(i){if(Gp[i])return Gp[i];if(!Oa[i])return i;var o=Oa[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in zv)return Gp[i]=o[u];return i}var $v=Xd("animationend"),qv=Xd("animationiteration"),Wv=Xd("animationstart"),Hv=Xd("transitionend"),Gv=new Map,Kv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ii(i,o){Gv.set(i,o),a(o,[i])}for(var Kp=0;Kp<Kv.length;Kp++){var Qp=Kv[Kp],Cb=Qp.toLowerCase(),Nb=Qp[0].toUpperCase()+Qp.slice(1);ii(Cb,"on"+Nb)}ii($v,"onAnimationEnd"),ii(qv,"onAnimationIteration"),ii(Wv,"onAnimationStart"),ii("dblclick","onDoubleClick"),ii("focusin","onFocus"),ii("focusout","onBlur"),ii(Hv,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Db=new Set("cancel close invalid load scroll toggle".split(" ").concat(Du));function Qv(i,o,u){var h=i.type||"unknown-event";i.currentTarget=u,du(h,o,void 0,i),i.currentTarget=null}function Jv(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],m=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var P=h[I],V=P.instance,q=P.currentTarget;if(P=P.listener,V!==y&&m.isPropagationStopped())break e;Qv(m,P,q),y=V}else for(I=0;I<h.length;I++){if(P=h[I],V=P.instance,q=P.currentTarget,P=P.listener,V!==y&&m.isPropagationStopped())break e;Qv(m,P,q),y=V}}}if(_a)throw i=nr,_a=!1,nr=null,i}function ct(i,o){var u=o[rm];u===void 0&&(u=o[rm]=new Set);var h=i+"__bubble";u.has(h)||(Yv(o,i,2,!1),u.add(h))}function Jp(i,o,u){var h=0;o&&(h|=4),Yv(u,i,h,o)}var Zd="_reactListening"+Math.random().toString(36).slice(2);function Vu(i){if(!i[Zd]){i[Zd]=!0,r.forEach(function(u){u!=="selectionchange"&&(Db.has(u)||Jp(u,!1,i),Jp(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Zd]||(o[Zd]=!0,Jp("selectionchange",!1,o))}}function Yv(i,o,u,h){switch(xa(o)){case 1:var m=Fr;break;case 4:m=qd;break;default:m=Su}u=m.bind(null,o,u,i),m=void 0,!Ys||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),h?m!==void 0?i.addEventListener(o,u,{capture:!0,passive:m}):i.addEventListener(o,u,!0):m!==void 0?i.addEventListener(o,u,{passive:m}):i.addEventListener(o,u,!1)}function Yp(i,o,u,h,m){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var P=h.stateNode.containerInfo;if(P===m||P.nodeType===8&&P.parentNode===m)break;if(I===4)for(I=h.return;I!==null;){var V=I.tag;if((V===3||V===4)&&(V=I.stateNode.containerInfo,V===m||V.nodeType===8&&V.parentNode===m))return;I=I.return}for(;P!==null;){if(I=go(P),I===null)return;if(V=I.tag,V===5||V===6){h=y=I;continue e}P=P.parentNode}}h=h.return}Dd(function(){var q=y,X=ya(u),te=[];e:{var J=Gv.get(i);if(J!==void 0){var ge=po,we=i;switch(i){case"keypress":if(fo(u)===0)break e;case"keydown":case"keyup":ge=et;break;case"focusin":we="focus",ge=en;break;case"focusout":we="blur",ge=en;break;case"beforeblur":case"afterblur":ge=en;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Gd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=zr;break;case $v:case qv:case Wv:ge=Qd;break;case Hv:ge=Na;break;case"scroll":ge=Ra;break;case"wheel":ge=gb;break;case"copy":case"cut":case"paste":ge=c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=Hn}var Ie=(o&4)!==0,Pt=!Ie&&i==="scroll",B=Ie?J!==null?J+"Capture":null:J;Ie=[];for(var M=q,$;M!==null;){$=M;var ie=$.stateNode;if($.tag===5&&ie!==null&&($=ie,B!==null&&(ie=no(M,B),ie!=null&&Ie.push(Ou(M,ie,$)))),Pt)break;M=M.return}0<Ie.length&&(J=new ge(J,we,null,u,X),te.push({event:J,listeners:Ie}))}}if((o&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",ge=i==="mouseout"||i==="pointerout",J&&u!==Ks&&(we=u.relatedTarget||u.fromElement)&&(go(we)||we[Es]))break e;if((ge||J)&&(J=X.window===X?X:(J=X.ownerDocument)?J.defaultView||J.parentWindow:window,ge?(we=u.relatedTarget||u.toElement,ge=q,we=we?go(we):null,we!==null&&(Pt=gr(we),we!==Pt||we.tag!==5&&we.tag!==6)&&(we=null)):(ge=null,we=q),ge!==we)){if(Ie=xu,ie="onMouseLeave",B="onMouseEnter",M="mouse",(i==="pointerout"||i==="pointerover")&&(Ie=Hn,ie="onPointerLeave",B="onPointerEnter",M="pointer"),Pt=ge==null?J:Fa(ge),$=we==null?J:Fa(we),J=new Ie(ie,M+"leave",ge,u,X),J.target=Pt,J.relatedTarget=$,ie=null,go(X)===q&&(Ie=new Ie(B,M+"enter",we,u,X),Ie.target=$,Ie.relatedTarget=Pt,ie=Ie),Pt=ie,ge&&we)t:{for(Ie=ge,B=we,M=0,$=Ie;$;$=La($))M++;for($=0,ie=B;ie;ie=La(ie))$++;for(;0<M-$;)Ie=La(Ie),M--;for(;0<$-M;)B=La(B),$--;for(;M--;){if(Ie===B||B!==null&&Ie===B.alternate)break t;Ie=La(Ie),B=La(B)}Ie=null}else Ie=null;ge!==null&&Xv(te,J,ge,Ie,!1),we!==null&&Pt!==null&&Xv(te,Pt,we,Ie,!0)}}e:{if(J=q?Fa(q):window,ge=J.nodeName&&J.nodeName.toLowerCase(),ge==="select"||ge==="input"&&J.type==="file")var Te=Tb;else if(Cv(J))if(Dv)Te=bb;else{Te=Ab;var be=Sb}else(ge=J.nodeName)&&ge.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(Te=xb);if(Te&&(Te=Te(i,q))){Nv(te,Te,u,X);break e}be&&be(i,J,q),i==="focusout"&&(be=J._wrapperState)&&be.controlled&&J.type==="number"&&Ot(J,"number",J.value)}switch(be=q?Fa(q):window,i){case"focusin":(Cv(be)||be.contentEditable==="true")&&(Va=be,Wp=q,Nu=null);break;case"focusout":Nu=Wp=Va=null;break;case"mousedown":Hp=!0;break;case"contextmenu":case"mouseup":case"dragend":Hp=!1,Bv(te,u,X);break;case"selectionchange":if(kb)break;case"keydown":case"keyup":Bv(te,u,X)}var Re;if(Bp)e:{switch(i){case"compositionstart":var De="onCompositionStart";break e;case"compositionend":De="onCompositionEnd";break e;case"compositionupdate":De="onCompositionUpdate";break e}De=void 0}else Da?Pv(i,u)&&(De="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(De="onCompositionStart");De&&(xv&&u.locale!=="ko"&&(Da||De!=="onCompositionStart"?De==="onCompositionEnd"&&Da&&(Re=Wd()):(qn=X,ba="value"in qn?qn.value:qn.textContent,Da=!0)),be=eh(q,De),0<be.length&&(De=new w(De,i,null,u,X),te.push({event:De,listeners:be}),Re?De.data=Re:(Re=kv(u),Re!==null&&(De.data=Re)))),(Re=_b?vb(i,u):wb(i,u))&&(q=eh(q,"onBeforeInput"),0<q.length&&(X=new w("onBeforeInput","beforeinput",null,u,X),te.push({event:X,listeners:q}),X.data=Re))}Jv(te,o)})}function Ou(i,o,u){return{instance:i,listener:o,currentTarget:u}}function eh(i,o){for(var u=o+"Capture",h=[];i!==null;){var m=i,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=no(i,u),y!=null&&h.unshift(Ou(i,y,m)),y=no(i,o),y!=null&&h.push(Ou(i,y,m))),i=i.return}return h}function La(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Xv(i,o,u,h,m){for(var y=o._reactName,I=[];u!==null&&u!==h;){var P=u,V=P.alternate,q=P.stateNode;if(V!==null&&V===h)break;P.tag===5&&q!==null&&(P=q,m?(V=no(u,y),V!=null&&I.unshift(Ou(u,V,P))):m||(V=no(u,y),V!=null&&I.push(Ou(u,V,P)))),u=u.return}I.length!==0&&i.push({event:o,listeners:I})}var Vb=/\r\n?/g,Ob=/\u0000|\uFFFD/g;function Zv(i){return(typeof i=="string"?i:""+i).replace(Vb,`
`).replace(Ob,"")}function th(i,o,u){if(o=Zv(o),Zv(i)!==o&&u)throw Error(t(425))}function nh(){}var Xp=null,Zp=null;function em(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var tm=typeof setTimeout=="function"?setTimeout:void 0,Lb=typeof clearTimeout=="function"?clearTimeout:void 0,ew=typeof Promise=="function"?Promise:void 0,Mb=typeof queueMicrotask=="function"?queueMicrotask:typeof ew<"u"?function(i){return ew.resolve(null).then(i).catch(Fb)}:tm;function Fb(i){setTimeout(function(){throw i})}function nm(i,o){var u=o,h=0;do{var m=u.nextSibling;if(i.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(h===0){i.removeChild(m),ni(o);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=m}while(u);ni(o)}function oi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function tw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Ma=Math.random().toString(36).slice(2),qr="__reactFiber$"+Ma,Lu="__reactProps$"+Ma,Es="__reactContainer$"+Ma,rm="__reactEvents$"+Ma,jb="__reactListeners$"+Ma,Ub="__reactHandles$"+Ma;function go(i){var o=i[qr];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Es]||u[qr]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=tw(i);i!==null;){if(u=i[qr])return u;i=tw(i)}return o}i=u,u=i.parentNode}return null}function Mu(i){return i=i[qr]||i[Es],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Fa(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function rh(i){return i[Lu]||null}var sm=[],ja=-1;function ai(i){return{current:i}}function dt(i){0>ja||(i.current=sm[ja],sm[ja]=null,ja--)}function it(i,o){ja++,sm[ja]=i.current,i.current=o}var li={},un=ai(li),bn=ai(!1),yo=li;function Ua(i,o){var u=i.type.contextTypes;if(!u)return li;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in u)m[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=m),m}function Rn(i){return i=i.childContextTypes,i!=null}function sh(){dt(bn),dt(un)}function nw(i,o,u){if(un.current!==li)throw Error(t(168));it(un,o),it(bn,u)}function rw(i,o,u){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var m in h)if(!(m in o))throw Error(t(108,Pe(i)||"Unknown",m));return fe({},u,h)}function ih(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||li,yo=un.current,it(un,i),it(bn,bn.current),!0}function sw(i,o,u){var h=i.stateNode;if(!h)throw Error(t(169));u?(i=rw(i,o,yo),h.__reactInternalMemoizedMergedChildContext=i,dt(bn),dt(un),it(un,i)):dt(bn),it(bn,u)}var Is=null,oh=!1,im=!1;function iw(i){Is===null?Is=[i]:Is.push(i)}function Bb(i){oh=!0,iw(i)}function ui(){if(!im&&Is!==null){im=!0;var i=0,o=He;try{var u=Is;for(He=1;i<u.length;i++){var h=u[i];do h=h(!0);while(h!==null)}Is=null,oh=!1}catch(m){throw Is!==null&&(Is=Is.slice(i+1)),fu(wa,ui),m}finally{He=o,im=!1}}return null}var Ba=[],za=0,ah=null,lh=0,sr=[],ir=0,_o=null,Ts=1,Ss="";function vo(i,o){Ba[za++]=lh,Ba[za++]=ah,ah=i,lh=o}function ow(i,o,u){sr[ir++]=Ts,sr[ir++]=Ss,sr[ir++]=_o,_o=i;var h=Ts;i=Ss;var m=32-zn(h)-1;h&=~(1<<m),u+=1;var y=32-zn(o)+m;if(30<y){var I=m-m%5;y=(h&(1<<I)-1).toString(32),h>>=I,m-=I,Ts=1<<32-zn(o)+m|u<<m|h,Ss=y+i}else Ts=1<<y|u<<m|h,Ss=i}function om(i){i.return!==null&&(vo(i,1),ow(i,1,0))}function am(i){for(;i===ah;)ah=Ba[--za],Ba[za]=null,lh=Ba[--za],Ba[za]=null;for(;i===_o;)_o=sr[--ir],sr[ir]=null,Ss=sr[--ir],sr[ir]=null,Ts=sr[--ir],sr[ir]=null}var Gn=null,Kn=null,pt=!1,vr=null;function aw(i,o){var u=ur(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=i,o=i.deletions,o===null?(i.deletions=[u],i.flags|=16):o.push(u)}function lw(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Gn=i,Kn=oi(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Gn=i,Kn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=_o!==null?{id:Ts,overflow:Ss}:null,i.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=ur(18,null,null,0),u.stateNode=o,u.return=i,i.child=u,Gn=i,Kn=null,!0):!1;default:return!1}}function lm(i){return(i.mode&1)!==0&&(i.flags&128)===0}function um(i){if(pt){var o=Kn;if(o){var u=o;if(!lw(i,o)){if(lm(i))throw Error(t(418));o=oi(u.nextSibling);var h=Gn;o&&lw(i,o)?aw(h,u):(i.flags=i.flags&-4097|2,pt=!1,Gn=i)}}else{if(lm(i))throw Error(t(418));i.flags=i.flags&-4097|2,pt=!1,Gn=i}}}function uw(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Gn=i}function uh(i){if(i!==Gn)return!1;if(!pt)return uw(i),pt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!em(i.type,i.memoizedProps)),o&&(o=Kn)){if(lm(i))throw cw(),Error(t(418));for(;o;)aw(i,o),o=oi(o.nextSibling)}if(uw(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){Kn=oi(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}Kn=null}}else Kn=Gn?oi(i.stateNode.nextSibling):null;return!0}function cw(){for(var i=Kn;i;)i=oi(i.nextSibling)}function $a(){Kn=Gn=null,pt=!1}function cm(i){vr===null?vr=[i]:vr.push(i)}var zb=re.ReactCurrentBatchConfig;function Fu(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var h=u.stateNode}if(!h)throw Error(t(147,i));var m=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var P=m.refs;I===null?delete P[y]:P[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,i))}return i}function ch(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function dw(i){var o=i._init;return o(i._payload)}function hw(i){function o(B,M){if(i){var $=B.deletions;$===null?(B.deletions=[M],B.flags|=16):$.push(M)}}function u(B,M){if(!i)return null;for(;M!==null;)o(B,M),M=M.sibling;return null}function h(B,M){for(B=new Map;M!==null;)M.key!==null?B.set(M.key,M):B.set(M.index,M),M=M.sibling;return B}function m(B,M){return B=yi(B,M),B.index=0,B.sibling=null,B}function y(B,M,$){return B.index=$,i?($=B.alternate,$!==null?($=$.index,$<M?(B.flags|=2,M):$):(B.flags|=2,M)):(B.flags|=1048576,M)}function I(B){return i&&B.alternate===null&&(B.flags|=2),B}function P(B,M,$,ie){return M===null||M.tag!==6?(M=tg($,B.mode,ie),M.return=B,M):(M=m(M,$),M.return=B,M)}function V(B,M,$,ie){var Te=$.type;return Te===R?X(B,M,$.props.children,ie,$.key):M!==null&&(M.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ce&&dw(Te)===M.type)?(ie=m(M,$.props),ie.ref=Fu(B,M,$),ie.return=B,ie):(ie=Vh($.type,$.key,$.props,null,B.mode,ie),ie.ref=Fu(B,M,$),ie.return=B,ie)}function q(B,M,$,ie){return M===null||M.tag!==4||M.stateNode.containerInfo!==$.containerInfo||M.stateNode.implementation!==$.implementation?(M=ng($,B.mode,ie),M.return=B,M):(M=m(M,$.children||[]),M.return=B,M)}function X(B,M,$,ie,Te){return M===null||M.tag!==7?(M=bo($,B.mode,ie,Te),M.return=B,M):(M=m(M,$),M.return=B,M)}function te(B,M,$){if(typeof M=="string"&&M!==""||typeof M=="number")return M=tg(""+M,B.mode,$),M.return=B,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case de:return $=Vh(M.type,M.key,M.props,null,B.mode,$),$.ref=Fu(B,null,M),$.return=B,$;case le:return M=ng(M,B.mode,$),M.return=B,M;case ce:var ie=M._init;return te(B,ie(M._payload),$)}if(bt(M)||_e(M))return M=bo(M,B.mode,$,null),M.return=B,M;ch(B,M)}return null}function J(B,M,$,ie){var Te=M!==null?M.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return Te!==null?null:P(B,M,""+$,ie);if(typeof $=="object"&&$!==null){switch($.$$typeof){case de:return $.key===Te?V(B,M,$,ie):null;case le:return $.key===Te?q(B,M,$,ie):null;case ce:return Te=$._init,J(B,M,Te($._payload),ie)}if(bt($)||_e($))return Te!==null?null:X(B,M,$,ie,null);ch(B,$)}return null}function ge(B,M,$,ie,Te){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return B=B.get($)||null,P(M,B,""+ie,Te);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case de:return B=B.get(ie.key===null?$:ie.key)||null,V(M,B,ie,Te);case le:return B=B.get(ie.key===null?$:ie.key)||null,q(M,B,ie,Te);case ce:var be=ie._init;return ge(B,M,$,be(ie._payload),Te)}if(bt(ie)||_e(ie))return B=B.get($)||null,X(M,B,ie,Te,null);ch(M,ie)}return null}function we(B,M,$,ie){for(var Te=null,be=null,Re=M,De=M=0,Gt=null;Re!==null&&De<$.length;De++){Re.index>De?(Gt=Re,Re=null):Gt=Re.sibling;var Qe=J(B,Re,$[De],ie);if(Qe===null){Re===null&&(Re=Gt);break}i&&Re&&Qe.alternate===null&&o(B,Re),M=y(Qe,M,De),be===null?Te=Qe:be.sibling=Qe,be=Qe,Re=Gt}if(De===$.length)return u(B,Re),pt&&vo(B,De),Te;if(Re===null){for(;De<$.length;De++)Re=te(B,$[De],ie),Re!==null&&(M=y(Re,M,De),be===null?Te=Re:be.sibling=Re,be=Re);return pt&&vo(B,De),Te}for(Re=h(B,Re);De<$.length;De++)Gt=ge(Re,B,De,$[De],ie),Gt!==null&&(i&&Gt.alternate!==null&&Re.delete(Gt.key===null?De:Gt.key),M=y(Gt,M,De),be===null?Te=Gt:be.sibling=Gt,be=Gt);return i&&Re.forEach(function(_i){return o(B,_i)}),pt&&vo(B,De),Te}function Ie(B,M,$,ie){var Te=_e($);if(typeof Te!="function")throw Error(t(150));if($=Te.call($),$==null)throw Error(t(151));for(var be=Te=null,Re=M,De=M=0,Gt=null,Qe=$.next();Re!==null&&!Qe.done;De++,Qe=$.next()){Re.index>De?(Gt=Re,Re=null):Gt=Re.sibling;var _i=J(B,Re,Qe.value,ie);if(_i===null){Re===null&&(Re=Gt);break}i&&Re&&_i.alternate===null&&o(B,Re),M=y(_i,M,De),be===null?Te=_i:be.sibling=_i,be=_i,Re=Gt}if(Qe.done)return u(B,Re),pt&&vo(B,De),Te;if(Re===null){for(;!Qe.done;De++,Qe=$.next())Qe=te(B,Qe.value,ie),Qe!==null&&(M=y(Qe,M,De),be===null?Te=Qe:be.sibling=Qe,be=Qe);return pt&&vo(B,De),Te}for(Re=h(B,Re);!Qe.done;De++,Qe=$.next())Qe=ge(Re,B,De,Qe.value,ie),Qe!==null&&(i&&Qe.alternate!==null&&Re.delete(Qe.key===null?De:Qe.key),M=y(Qe,M,De),be===null?Te=Qe:be.sibling=Qe,be=Qe);return i&&Re.forEach(function(ER){return o(B,ER)}),pt&&vo(B,De),Te}function Pt(B,M,$,ie){if(typeof $=="object"&&$!==null&&$.type===R&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case de:e:{for(var Te=$.key,be=M;be!==null;){if(be.key===Te){if(Te=$.type,Te===R){if(be.tag===7){u(B,be.sibling),M=m(be,$.props.children),M.return=B,B=M;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ce&&dw(Te)===be.type){u(B,be.sibling),M=m(be,$.props),M.ref=Fu(B,be,$),M.return=B,B=M;break e}u(B,be);break}else o(B,be);be=be.sibling}$.type===R?(M=bo($.props.children,B.mode,ie,$.key),M.return=B,B=M):(ie=Vh($.type,$.key,$.props,null,B.mode,ie),ie.ref=Fu(B,M,$),ie.return=B,B=ie)}return I(B);case le:e:{for(be=$.key;M!==null;){if(M.key===be)if(M.tag===4&&M.stateNode.containerInfo===$.containerInfo&&M.stateNode.implementation===$.implementation){u(B,M.sibling),M=m(M,$.children||[]),M.return=B,B=M;break e}else{u(B,M);break}else o(B,M);M=M.sibling}M=ng($,B.mode,ie),M.return=B,B=M}return I(B);case ce:return be=$._init,Pt(B,M,be($._payload),ie)}if(bt($))return we(B,M,$,ie);if(_e($))return Ie(B,M,$,ie);ch(B,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,M!==null&&M.tag===6?(u(B,M.sibling),M=m(M,$),M.return=B,B=M):(u(B,M),M=tg($,B.mode,ie),M.return=B,B=M),I(B)):u(B,M)}return Pt}var qa=hw(!0),fw=hw(!1),dh=ai(null),hh=null,Wa=null,dm=null;function hm(){dm=Wa=hh=null}function fm(i){var o=dh.current;dt(dh),i._currentValue=o}function pm(i,o,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===u)break;i=i.return}}function Ha(i,o){hh=i,dm=Wa=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Pn=!0),i.firstContext=null)}function or(i){var o=i._currentValue;if(dm!==i)if(i={context:i,memoizedValue:o,next:null},Wa===null){if(hh===null)throw Error(t(308));Wa=i,hh.dependencies={lanes:0,firstContext:i}}else Wa=Wa.next=i;return o}var wo=null;function mm(i){wo===null?wo=[i]:wo.push(i)}function pw(i,o,u,h){var m=o.interleaved;return m===null?(u.next=u,mm(o)):(u.next=m.next,m.next=u),o.interleaved=u,As(i,h)}function As(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}var ci=!1;function gm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mw(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function xs(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function di(i,o,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ke&2)!==0){var m=h.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),h.pending=o,As(i,u)}return m=h.interleaved,m===null?(o.next=o,mm(h)):(o.next=m.next,m.next=o),h.interleaved=o,As(i,u)}function fh(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,vu(i,u)}}function gw(i,o){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var m=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var I={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};y===null?m=y=I:y=y.next=I,u=u.next}while(u!==null);y===null?m=y=o:y=y.next=o}else m=y=o;u={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function ph(i,o,u,h){var m=i.updateQueue;ci=!1;var y=m.firstBaseUpdate,I=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var V=P,q=V.next;V.next=null,I===null?y=q:I.next=q,I=V;var X=i.alternate;X!==null&&(X=X.updateQueue,P=X.lastBaseUpdate,P!==I&&(P===null?X.firstBaseUpdate=q:P.next=q,X.lastBaseUpdate=V))}if(y!==null){var te=m.baseState;I=0,X=q=V=null,P=y;do{var J=P.lane,ge=P.eventTime;if((h&J)===J){X!==null&&(X=X.next={eventTime:ge,lane:0,tag:P.tag,payload:P.payload,callback:P.callback,next:null});e:{var we=i,Ie=P;switch(J=o,ge=u,Ie.tag){case 1:if(we=Ie.payload,typeof we=="function"){te=we.call(ge,te,J);break e}te=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Ie.payload,J=typeof we=="function"?we.call(ge,te,J):we,J==null)break e;te=fe({},te,J);break e;case 2:ci=!0}}P.callback!==null&&P.lane!==0&&(i.flags|=64,J=m.effects,J===null?m.effects=[P]:J.push(P))}else ge={eventTime:ge,lane:J,tag:P.tag,payload:P.payload,callback:P.callback,next:null},X===null?(q=X=ge,V=te):X=X.next=ge,I|=J;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;J=P,P=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);if(X===null&&(V=te),m.baseState=V,m.firstBaseUpdate=q,m.lastBaseUpdate=X,o=m.shared.interleaved,o!==null){m=o;do I|=m.lane,m=m.next;while(m!==o)}else y===null&&(m.shared.lanes=0);To|=I,i.lanes=I,i.memoizedState=te}}function yw(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],m=h.callback;if(m!==null){if(h.callback=null,h=u,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var ju={},Wr=ai(ju),Uu=ai(ju),Bu=ai(ju);function Eo(i){if(i===ju)throw Error(t(174));return i}function ym(i,o){switch(it(Bu,o),it(Uu,i),it(Wr,ju),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:pa(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=pa(o,i)}dt(Wr),it(Wr,o)}function Ga(){dt(Wr),dt(Uu),dt(Bu)}function _w(i){Eo(Bu.current);var o=Eo(Wr.current),u=pa(o,i.type);o!==u&&(it(Uu,i),it(Wr,u))}function _m(i){Uu.current===i&&(dt(Wr),dt(Uu))}var _t=ai(0);function mh(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vm=[];function wm(){for(var i=0;i<vm.length;i++)vm[i]._workInProgressVersionPrimary=null;vm.length=0}var gh=re.ReactCurrentDispatcher,Em=re.ReactCurrentBatchConfig,Io=0,vt=null,Bt=null,Wt=null,yh=!1,zu=!1,$u=0,$b=0;function cn(){throw Error(t(321))}function Im(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!_r(i[u],o[u]))return!1;return!0}function Tm(i,o,u,h,m,y){if(Io=y,vt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,gh.current=i===null||i.memoizedState===null?Gb:Kb,i=u(h,m),zu){y=0;do{if(zu=!1,$u=0,25<=y)throw Error(t(301));y+=1,Wt=Bt=null,o.updateQueue=null,gh.current=Qb,i=u(h,m)}while(zu)}if(gh.current=wh,o=Bt!==null&&Bt.next!==null,Io=0,Wt=Bt=vt=null,yh=!1,o)throw Error(t(300));return i}function Sm(){var i=$u!==0;return $u=0,i}function Hr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?vt.memoizedState=Wt=i:Wt=Wt.next=i,Wt}function ar(){if(Bt===null){var i=vt.alternate;i=i!==null?i.memoizedState:null}else i=Bt.next;var o=Wt===null?vt.memoizedState:Wt.next;if(o!==null)Wt=o,Bt=i;else{if(i===null)throw Error(t(310));Bt=i,i={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Wt===null?vt.memoizedState=Wt=i:Wt=Wt.next=i}return Wt}function qu(i,o){return typeof o=="function"?o(i):o}function Am(i){var o=ar(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=Bt,m=h.baseQueue,y=u.pending;if(y!==null){if(m!==null){var I=m.next;m.next=y.next,y.next=I}h.baseQueue=m=y,u.pending=null}if(m!==null){y=m.next,h=h.baseState;var P=I=null,V=null,q=y;do{var X=q.lane;if((Io&X)===X)V!==null&&(V=V.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),h=q.hasEagerState?q.eagerState:i(h,q.action);else{var te={lane:X,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};V===null?(P=V=te,I=h):V=V.next=te,vt.lanes|=X,To|=X}q=q.next}while(q!==null&&q!==y);V===null?I=h:V.next=P,_r(h,o.memoizedState)||(Pn=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=V,u.lastRenderedState=h}if(i=u.interleaved,i!==null){m=i;do y=m.lane,vt.lanes|=y,To|=y,m=m.next;while(m!==i)}else m===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function xm(i){var o=ar(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=u.dispatch,m=u.pending,y=o.memoizedState;if(m!==null){u.pending=null;var I=m=m.next;do y=i(y,I.action),I=I.next;while(I!==m);_r(y,o.memoizedState)||(Pn=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,h]}function vw(){}function ww(i,o){var u=vt,h=ar(),m=o(),y=!_r(h.memoizedState,m);if(y&&(h.memoizedState=m,Pn=!0),h=h.queue,bm(Tw.bind(null,u,h,i),[i]),h.getSnapshot!==o||y||Wt!==null&&Wt.memoizedState.tag&1){if(u.flags|=2048,Wu(9,Iw.bind(null,u,h,m,o),void 0,null),Ht===null)throw Error(t(349));(Io&30)!==0||Ew(u,o,m)}return m}function Ew(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=vt.updateQueue,o===null?(o={lastEffect:null,stores:null},vt.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function Iw(i,o,u,h){o.value=u,o.getSnapshot=h,Sw(o)&&Aw(i)}function Tw(i,o,u){return u(function(){Sw(o)&&Aw(i)})}function Sw(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!_r(i,u)}catch{return!0}}function Aw(i){var o=As(i,1);o!==null&&Tr(o,i,1,-1)}function xw(i){var o=Hr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qu,lastRenderedState:i},o.queue=i,i=i.dispatch=Hb.bind(null,vt,i),[o.memoizedState,i]}function Wu(i,o,u,h){return i={tag:i,create:o,destroy:u,deps:h,next:null},o=vt.updateQueue,o===null?(o={lastEffect:null,stores:null},vt.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,o.lastEffect=i)),i}function bw(){return ar().memoizedState}function _h(i,o,u,h){var m=Hr();vt.flags|=i,m.memoizedState=Wu(1|o,u,void 0,h===void 0?null:h)}function vh(i,o,u,h){var m=ar();h=h===void 0?null:h;var y=void 0;if(Bt!==null){var I=Bt.memoizedState;if(y=I.destroy,h!==null&&Im(h,I.deps)){m.memoizedState=Wu(o,u,y,h);return}}vt.flags|=i,m.memoizedState=Wu(1|o,u,y,h)}function Rw(i,o){return _h(8390656,8,i,o)}function bm(i,o){return vh(2048,8,i,o)}function Pw(i,o){return vh(4,2,i,o)}function kw(i,o){return vh(4,4,i,o)}function Cw(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Nw(i,o,u){return u=u!=null?u.concat([i]):null,vh(4,4,Cw.bind(null,o,i),u)}function Rm(){}function Dw(i,o){var u=ar();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Im(o,h[1])?h[0]:(u.memoizedState=[i,o],i)}function Vw(i,o){var u=ar();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Im(o,h[1])?h[0]:(i=i(),u.memoizedState=[i,o],i)}function Ow(i,o,u){return(Io&21)===0?(i.baseState&&(i.baseState=!1,Pn=!0),i.memoizedState=u):(_r(u,o)||(u=yu(),vt.lanes|=u,To|=u,i.baseState=!0),o)}function qb(i,o){var u=He;He=u!==0&&4>u?u:4,i(!0);var h=Em.transition;Em.transition={};try{i(!1),o()}finally{He=u,Em.transition=h}}function Lw(){return ar().memoizedState}function Wb(i,o,u){var h=mi(i);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},Mw(i))Fw(o,u);else if(u=pw(i,o,u,h),u!==null){var m=En();Tr(u,i,h,m),jw(u,o,h)}}function Hb(i,o,u){var h=mi(i),m={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(Mw(i))Fw(o,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,P=y(I,u);if(m.hasEagerState=!0,m.eagerState=P,_r(P,I)){var V=o.interleaved;V===null?(m.next=m,mm(o)):(m.next=V.next,V.next=m),o.interleaved=m;return}}catch{}u=pw(i,o,m,h),u!==null&&(m=En(),Tr(u,i,h,m),jw(u,o,h))}}function Mw(i){var o=i.alternate;return i===vt||o!==null&&o===vt}function Fw(i,o){zu=yh=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function jw(i,o,u){if((u&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,vu(i,u)}}var wh={readContext:or,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},Gb={readContext:or,useCallback:function(i,o){return Hr().memoizedState=[i,o===void 0?null:o],i},useContext:or,useEffect:Rw,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,_h(4194308,4,Cw.bind(null,o,i),u)},useLayoutEffect:function(i,o){return _h(4194308,4,i,o)},useInsertionEffect:function(i,o){return _h(4,2,i,o)},useMemo:function(i,o){var u=Hr();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var h=Hr();return o=u!==void 0?u(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=Wb.bind(null,vt,i),[h.memoizedState,i]},useRef:function(i){var o=Hr();return i={current:i},o.memoizedState=i},useState:xw,useDebugValue:Rm,useDeferredValue:function(i){return Hr().memoizedState=i},useTransition:function(){var i=xw(!1),o=i[0];return i=qb.bind(null,i[1]),Hr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,u){var h=vt,m=Hr();if(pt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=o(),Ht===null)throw Error(t(349));(Io&30)!==0||Ew(h,o,u)}m.memoizedState=u;var y={value:u,getSnapshot:o};return m.queue=y,Rw(Tw.bind(null,h,y,i),[i]),h.flags|=2048,Wu(9,Iw.bind(null,h,y,u,o),void 0,null),u},useId:function(){var i=Hr(),o=Ht.identifierPrefix;if(pt){var u=Ss,h=Ts;u=(h&~(1<<32-zn(h)-1)).toString(32)+u,o=":"+o+"R"+u,u=$u++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=$b++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Kb={readContext:or,useCallback:Dw,useContext:or,useEffect:bm,useImperativeHandle:Nw,useInsertionEffect:Pw,useLayoutEffect:kw,useMemo:Vw,useReducer:Am,useRef:bw,useState:function(){return Am(qu)},useDebugValue:Rm,useDeferredValue:function(i){var o=ar();return Ow(o,Bt.memoizedState,i)},useTransition:function(){var i=Am(qu)[0],o=ar().memoizedState;return[i,o]},useMutableSource:vw,useSyncExternalStore:ww,useId:Lw,unstable_isNewReconciler:!1},Qb={readContext:or,useCallback:Dw,useContext:or,useEffect:bm,useImperativeHandle:Nw,useInsertionEffect:Pw,useLayoutEffect:kw,useMemo:Vw,useReducer:xm,useRef:bw,useState:function(){return xm(qu)},useDebugValue:Rm,useDeferredValue:function(i){var o=ar();return Bt===null?o.memoizedState=i:Ow(o,Bt.memoizedState,i)},useTransition:function(){var i=xm(qu)[0],o=ar().memoizedState;return[i,o]},useMutableSource:vw,useSyncExternalStore:ww,useId:Lw,unstable_isNewReconciler:!1};function wr(i,o){if(i&&i.defaultProps){o=fe({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}function Pm(i,o,u,h){o=i.memoizedState,u=u(h,o),u=u==null?o:fe({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Eh={isMounted:function(i){return(i=i._reactInternals)?gr(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var h=En(),m=mi(i),y=xs(h,m);y.payload=o,u!=null&&(y.callback=u),o=di(i,y,m),o!==null&&(Tr(o,i,m,h),fh(o,i,m))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var h=En(),m=mi(i),y=xs(h,m);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=di(i,y,m),o!==null&&(Tr(o,i,m,h),fh(o,i,m))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=En(),h=mi(i),m=xs(u,h);m.tag=2,o!=null&&(m.callback=o),o=di(i,m,h),o!==null&&(Tr(o,i,h,u),fh(o,i,h))}};function Uw(i,o,u,h,m,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Cu(u,h)||!Cu(m,y):!0}function Bw(i,o,u){var h=!1,m=li,y=o.contextType;return typeof y=="object"&&y!==null?y=or(y):(m=Rn(o)?yo:un.current,h=o.contextTypes,y=(h=h!=null)?Ua(i,m):li),o=new o(u,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Eh,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=y),o}function zw(i,o,u,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==i&&Eh.enqueueReplaceState(o,o.state,null)}function km(i,o,u,h){var m=i.stateNode;m.props=u,m.state=i.memoizedState,m.refs={},gm(i);var y=o.contextType;typeof y=="object"&&y!==null?m.context=or(y):(y=Rn(o)?yo:un.current,m.context=Ua(i,y)),m.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(Pm(i,o,y,u),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&Eh.enqueueReplaceState(m,m.state,null),ph(i,u,m,h),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function Ka(i,o){try{var u="",h=o;do u+=Ue(h),h=h.return;while(h);var m=u}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:m,digest:null}}function Cm(i,o,u){return{value:i,source:null,stack:u??null,digest:o??null}}function Nm(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var Jb=typeof WeakMap=="function"?WeakMap:Map;function $w(i,o,u){u=xs(-1,u),u.tag=3,u.payload={element:null};var h=o.value;return u.callback=function(){Rh||(Rh=!0,Gm=h),Nm(i,o)},u}function qw(i,o,u){u=xs(-1,u),u.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var m=o.value;u.payload=function(){return h(m)},u.callback=function(){Nm(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(u.callback=function(){Nm(i,o),typeof h!="function"&&(fi===null?fi=new Set([this]):fi.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),u}function Ww(i,o,u){var h=i.pingCache;if(h===null){h=i.pingCache=new Jb;var m=new Set;h.set(o,m)}else m=h.get(o),m===void 0&&(m=new Set,h.set(o,m));m.has(u)||(m.add(u),i=cR.bind(null,i,o,u),o.then(i,i))}function Hw(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Gw(i,o,u,h,m){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=xs(-1,1),o.tag=2,di(u,o,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var Yb=re.ReactCurrentOwner,Pn=!1;function wn(i,o,u,h){o.child=i===null?fw(o,null,u,h):qa(o,i.child,u,h)}function Kw(i,o,u,h,m){u=u.render;var y=o.ref;return Ha(o,m),h=Tm(i,o,u,h,y,m),u=Sm(),i!==null&&!Pn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,bs(i,o,m)):(pt&&u&&om(o),o.flags|=1,wn(i,o,h,m),o.child)}function Qw(i,o,u,h,m){if(i===null){var y=u.type;return typeof y=="function"&&!eg(y)&&y.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=y,Jw(i,o,y,h,m)):(i=Vh(u.type,null,h,o,o.mode,m),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&m)===0){var I=y.memoizedProps;if(u=u.compare,u=u!==null?u:Cu,u(I,h)&&i.ref===o.ref)return bs(i,o,m)}return o.flags|=1,i=yi(y,h),i.ref=o.ref,i.return=o,o.child=i}function Jw(i,o,u,h,m){if(i!==null){var y=i.memoizedProps;if(Cu(y,h)&&i.ref===o.ref)if(Pn=!1,o.pendingProps=h=y,(i.lanes&m)!==0)(i.flags&131072)!==0&&(Pn=!0);else return o.lanes=i.lanes,bs(i,o,m)}return Dm(i,o,u,h,m)}function Yw(i,o,u){var h=o.pendingProps,m=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(Ja,Qn),Qn|=u;else{if((u&1073741824)===0)return i=y!==null?y.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,it(Ja,Qn),Qn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:u,it(Ja,Qn),Qn|=h}else y!==null?(h=y.baseLanes|u,o.memoizedState=null):h=u,it(Ja,Qn),Qn|=h;return wn(i,o,m,u),o.child}function Xw(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function Dm(i,o,u,h,m){var y=Rn(u)?yo:un.current;return y=Ua(o,y),Ha(o,m),u=Tm(i,o,u,h,y,m),h=Sm(),i!==null&&!Pn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,bs(i,o,m)):(pt&&h&&om(o),o.flags|=1,wn(i,o,u,m),o.child)}function Zw(i,o,u,h,m){if(Rn(u)){var y=!0;ih(o)}else y=!1;if(Ha(o,m),o.stateNode===null)Th(i,o),Bw(o,u,h),km(o,u,h,m),h=!0;else if(i===null){var I=o.stateNode,P=o.memoizedProps;I.props=P;var V=I.context,q=u.contextType;typeof q=="object"&&q!==null?q=or(q):(q=Rn(u)?yo:un.current,q=Ua(o,q));var X=u.getDerivedStateFromProps,te=typeof X=="function"||typeof I.getSnapshotBeforeUpdate=="function";te||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(P!==h||V!==q)&&zw(o,I,h,q),ci=!1;var J=o.memoizedState;I.state=J,ph(o,h,I,m),V=o.memoizedState,P!==h||J!==V||bn.current||ci?(typeof X=="function"&&(Pm(o,u,X,h),V=o.memoizedState),(P=ci||Uw(o,u,P,h,J,V,q))?(te||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=V),I.props=h,I.state=V,I.context=q,h=P):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,mw(i,o),P=o.memoizedProps,q=o.type===o.elementType?P:wr(o.type,P),I.props=q,te=o.pendingProps,J=I.context,V=u.contextType,typeof V=="object"&&V!==null?V=or(V):(V=Rn(u)?yo:un.current,V=Ua(o,V));var ge=u.getDerivedStateFromProps;(X=typeof ge=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(P!==te||J!==V)&&zw(o,I,h,V),ci=!1,J=o.memoizedState,I.state=J,ph(o,h,I,m);var we=o.memoizedState;P!==te||J!==we||bn.current||ci?(typeof ge=="function"&&(Pm(o,u,ge,h),we=o.memoizedState),(q=ci||Uw(o,u,q,h,J,we,V)||!1)?(X||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,we,V),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,we,V)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||P===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||P===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=we),I.props=h,I.state=we,I.context=V,h=q):(typeof I.componentDidUpdate!="function"||P===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||P===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),h=!1)}return Vm(i,o,u,h,y,m)}function Vm(i,o,u,h,m,y){Xw(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return m&&sw(o,u,!1),bs(i,o,y);h=o.stateNode,Yb.current=o;var P=I&&typeof u.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=qa(o,i.child,null,y),o.child=qa(o,null,P,y)):wn(i,o,P,y),o.memoizedState=h.state,m&&sw(o,u,!0),o.child}function eE(i){var o=i.stateNode;o.pendingContext?nw(i,o.pendingContext,o.pendingContext!==o.context):o.context&&nw(i,o.context,!1),ym(i,o.containerInfo)}function tE(i,o,u,h,m){return $a(),cm(m),o.flags|=256,wn(i,o,u,h),o.child}var Om={dehydrated:null,treeContext:null,retryLane:0};function Lm(i){return{baseLanes:i,cachePool:null,transitions:null}}function nE(i,o,u){var h=o.pendingProps,m=_t.current,y=!1,I=(o.flags&128)!==0,P;if((P=I)||(P=i!==null&&i.memoizedState===null?!1:(m&2)!==0),P?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),it(_t,m&1),i===null)return um(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=Oh(I,h,0,null),i=bo(i,h,u,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=Lm(u),o.memoizedState=Om,i):Mm(o,I));if(m=i.memoizedState,m!==null&&(P=m.dehydrated,P!==null))return Xb(i,o,I,h,P,m,u);if(y){y=h.fallback,I=o.mode,m=i.child,P=m.sibling;var V={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==m?(h=o.child,h.childLanes=0,h.pendingProps=V,o.deletions=null):(h=yi(m,V),h.subtreeFlags=m.subtreeFlags&14680064),P!==null?y=yi(P,y):(y=bo(y,I,u,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?Lm(u):{baseLanes:I.baseLanes|u,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~u,o.memoizedState=Om,h}return y=i.child,i=y.sibling,h=yi(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=u),h.return=o,h.sibling=null,i!==null&&(u=o.deletions,u===null?(o.deletions=[i],o.flags|=16):u.push(i)),o.child=h,o.memoizedState=null,h}function Mm(i,o){return o=Oh({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Ih(i,o,u,h){return h!==null&&cm(h),qa(o,i.child,null,u),i=Mm(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Xb(i,o,u,h,m,y,I){if(u)return o.flags&256?(o.flags&=-257,h=Cm(Error(t(422))),Ih(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,m=o.mode,h=Oh({mode:"visible",children:h.children},m,0,null),y=bo(y,m,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&qa(o,i.child,null,I),o.child.memoizedState=Lm(I),o.memoizedState=Om,y);if((o.mode&1)===0)return Ih(i,o,I,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var P=h.dgst;return h=P,y=Error(t(419)),h=Cm(y,h,void 0),Ih(i,o,I,h)}if(P=(I&i.childLanes)!==0,Pn||P){if(h=Ht,h!==null){switch(I&-I){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(h.suspendedLanes|I))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,As(i,m),Tr(h,i,m,-1))}return Zm(),h=Cm(Error(t(421))),Ih(i,o,I,h)}return m.data==="$?"?(o.flags|=128,o.child=i.child,o=dR.bind(null,i),m._reactRetry=o,null):(i=y.treeContext,Kn=oi(m.nextSibling),Gn=o,pt=!0,vr=null,i!==null&&(sr[ir++]=Ts,sr[ir++]=Ss,sr[ir++]=_o,Ts=i.id,Ss=i.overflow,_o=o),o=Mm(o,h.children),o.flags|=4096,o)}function rE(i,o,u){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),pm(i.return,o,u)}function Fm(i,o,u,h,m){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:m}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=u,y.tailMode=m)}function sE(i,o,u){var h=o.pendingProps,m=h.revealOrder,y=h.tail;if(wn(i,o,h.children,u),h=_t.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&rE(i,u,o);else if(i.tag===19)rE(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(it(_t,h),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(u=o.child,m=null;u!==null;)i=u.alternate,i!==null&&mh(i)===null&&(m=u),u=u.sibling;u=m,u===null?(m=o.child,o.child=null):(m=u.sibling,u.sibling=null),Fm(o,!1,m,u,y);break;case"backwards":for(u=null,m=o.child,o.child=null;m!==null;){if(i=m.alternate,i!==null&&mh(i)===null){o.child=m;break}i=m.sibling,m.sibling=u,u=m,m=i}Fm(o,!0,u,null,y);break;case"together":Fm(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Th(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function bs(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),To|=o.lanes,(u&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,u=yi(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=yi(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function Zb(i,o,u){switch(o.tag){case 3:eE(o),$a();break;case 5:_w(o);break;case 1:Rn(o.type)&&ih(o);break;case 4:ym(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,m=o.memoizedProps.value;it(dh,h._currentValue),h._currentValue=m;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(it(_t,_t.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?nE(i,o,u):(it(_t,_t.current&1),i=bs(i,o,u),i!==null?i.sibling:null);it(_t,_t.current&1);break;case 19:if(h=(u&o.childLanes)!==0,(i.flags&128)!==0){if(h)return sE(i,o,u);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),it(_t,_t.current),h)break;return null;case 22:case 23:return o.lanes=0,Yw(i,o,u)}return bs(i,o,u)}var iE,jm,oE,aE;iE=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},jm=function(){},oE=function(i,o,u,h){var m=i.memoizedProps;if(m!==h){i=o.stateNode,Eo(Wr.current);var y=null;switch(u){case"input":m=ha(i,m),h=ha(i,h),y=[];break;case"select":m=fe({},m,{value:void 0}),h=fe({},h,{value:void 0}),y=[];break;case"textarea":m=ou(i,m),h=ou(i,h),y=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=nh)}mr(u,h);var I;u=null;for(q in m)if(!h.hasOwnProperty(q)&&m.hasOwnProperty(q)&&m[q]!=null)if(q==="style"){var P=m[q];for(I in P)P.hasOwnProperty(I)&&(u||(u={}),u[I]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(s.hasOwnProperty(q)?y||(y=[]):(y=y||[]).push(q,null));for(q in h){var V=h[q];if(P=m?.[q],h.hasOwnProperty(q)&&V!==P&&(V!=null||P!=null))if(q==="style")if(P){for(I in P)!P.hasOwnProperty(I)||V&&V.hasOwnProperty(I)||(u||(u={}),u[I]="");for(I in V)V.hasOwnProperty(I)&&P[I]!==V[I]&&(u||(u={}),u[I]=V[I])}else u||(y||(y=[]),y.push(q,u)),u=V;else q==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,P=P?P.__html:void 0,V!=null&&P!==V&&(y=y||[]).push(q,V)):q==="children"?typeof V!="string"&&typeof V!="number"||(y=y||[]).push(q,""+V):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(s.hasOwnProperty(q)?(V!=null&&q==="onScroll"&&ct("scroll",i),y||P===V||(y=[])):(y=y||[]).push(q,V))}u&&(y=y||[]).push("style",u);var q=y;(o.updateQueue=q)&&(o.flags|=4)}},aE=function(i,o,u,h){u!==h&&(o.flags|=4)};function Hu(i,o){if(!pt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function dn(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(o)for(var m=i.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=h,i.childLanes=u,o}function eR(i,o,u){var h=o.pendingProps;switch(am(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(o),null;case 1:return Rn(o.type)&&sh(),dn(o),null;case 3:return h=o.stateNode,Ga(),dt(bn),dt(un),wm(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(uh(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,vr!==null&&(Jm(vr),vr=null))),jm(i,o),dn(o),null;case 5:_m(o);var m=Eo(Bu.current);if(u=o.type,i!==null&&o.stateNode!=null)oE(i,o,u,h,m),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return dn(o),null}if(i=Eo(Wr.current),uh(o)){h=o.stateNode,u=o.type;var y=o.memoizedProps;switch(h[qr]=o,h[Lu]=y,i=(o.mode&1)!==0,u){case"dialog":ct("cancel",h),ct("close",h);break;case"iframe":case"object":case"embed":ct("load",h);break;case"video":case"audio":for(m=0;m<Du.length;m++)ct(Du[m],h);break;case"source":ct("error",h);break;case"img":case"image":case"link":ct("error",h),ct("load",h);break;case"details":ct("toggle",h);break;case"input":bd(h,y),ct("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},ct("invalid",h);break;case"textarea":au(h,y),ct("invalid",h)}mr(u,y),m=null;for(var I in y)if(y.hasOwnProperty(I)){var P=y[I];I==="children"?typeof P=="string"?h.textContent!==P&&(y.suppressHydrationWarning!==!0&&th(h.textContent,P,i),m=["children",P]):typeof P=="number"&&h.textContent!==""+P&&(y.suppressHydrationWarning!==!0&&th(h.textContent,P,i),m=["children",""+P]):s.hasOwnProperty(I)&&P!=null&&I==="onScroll"&&ct("scroll",h)}switch(u){case"input":Un(h),iu(h,y,!0);break;case"textarea":Un(h),qs(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=nh)}h=m,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=lu(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(u,{is:h.is}):(i=I.createElement(u),u==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,u),i[qr]=o,i[Lu]=h,iE(i,o,!1,!1),o.stateNode=i;e:{switch(I=ga(u,h),u){case"dialog":ct("cancel",i),ct("close",i),m=h;break;case"iframe":case"object":case"embed":ct("load",i),m=h;break;case"video":case"audio":for(m=0;m<Du.length;m++)ct(Du[m],i);m=h;break;case"source":ct("error",i),m=h;break;case"img":case"image":case"link":ct("error",i),ct("load",i),m=h;break;case"details":ct("toggle",i),m=h;break;case"input":bd(i,h),m=ha(i,h),ct("invalid",i);break;case"option":m=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},m=fe({},h,{value:void 0}),ct("invalid",i);break;case"textarea":au(i,h),m=ou(i,h),ct("invalid",i);break;default:m=h}mr(u,m),P=m;for(y in P)if(P.hasOwnProperty(y)){var V=P[y];y==="style"?ma(i,V):y==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&Pd(i,V)):y==="children"?typeof V=="string"?(u!=="textarea"||V!=="")&&to(i,V):typeof V=="number"&&to(i,""+V):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?V!=null&&y==="onScroll"&&ct("scroll",i):V!=null&&Z(i,y,V,I))}switch(u){case"input":Un(i),iu(i,h,!1);break;case"textarea":Un(i),qs(i);break;case"option":h.value!=null&&i.setAttribute("value",""+xe(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?pr(i,!!h.multiple,y,!1):h.defaultValue!=null&&pr(i,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=nh)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return dn(o),null;case 6:if(i&&o.stateNode!=null)aE(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(u=Eo(Bu.current),Eo(Wr.current),uh(o)){if(h=o.stateNode,u=o.memoizedProps,h[qr]=o,(y=h.nodeValue!==u)&&(i=Gn,i!==null))switch(i.tag){case 3:th(h.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&th(h.nodeValue,u,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[qr]=o,o.stateNode=h}return dn(o),null;case 13:if(dt(_t),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(pt&&Kn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)cw(),$a(),o.flags|=98560,y=!1;else if(y=uh(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[qr]=o}else $a(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;dn(o),y=!1}else vr!==null&&(Jm(vr),vr=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(_t.current&1)!==0?zt===0&&(zt=3):Zm())),o.updateQueue!==null&&(o.flags|=4),dn(o),null);case 4:return Ga(),jm(i,o),i===null&&Vu(o.stateNode.containerInfo),dn(o),null;case 10:return fm(o.type._context),dn(o),null;case 17:return Rn(o.type)&&sh(),dn(o),null;case 19:if(dt(_t),y=o.memoizedState,y===null)return dn(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Hu(y,!1);else{if(zt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=mh(i),I!==null){for(o.flags|=128,Hu(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=u,u=o.child;u!==null;)y=u,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return it(_t,_t.current&1|2),o.child}i=i.sibling}y.tail!==null&&ut()>Ya&&(o.flags|=128,h=!0,Hu(y,!1),o.lanes=4194304)}else{if(!h)if(i=mh(I),i!==null){if(o.flags|=128,h=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Hu(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!pt)return dn(o),null}else 2*ut()-y.renderingStartTime>Ya&&u!==1073741824&&(o.flags|=128,h=!0,Hu(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(u=y.last,u!==null?u.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=ut(),o.sibling=null,u=_t.current,it(_t,h?u&1|2:u&1),o):(dn(o),null);case 22:case 23:return Xm(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(Qn&1073741824)!==0&&(dn(o),o.subtreeFlags&6&&(o.flags|=8192)):dn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function tR(i,o){switch(am(o),o.tag){case 1:return Rn(o.type)&&sh(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Ga(),dt(bn),dt(un),wm(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return _m(o),null;case 13:if(dt(_t),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));$a()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return dt(_t),null;case 4:return Ga(),null;case 10:return fm(o.type._context),null;case 22:case 23:return Xm(),null;case 24:return null;default:return null}}var Sh=!1,hn=!1,nR=typeof WeakSet=="function"?WeakSet:Set,ve=null;function Qa(i,o){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){Tt(i,o,h)}else u.current=null}function Um(i,o,u){try{u()}catch(h){Tt(i,o,h)}}var lE=!1;function rR(i,o){if(Xp=_s,i=Uv(),qp(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var I=0,P=-1,V=-1,q=0,X=0,te=i,J=null;t:for(;;){for(var ge;te!==u||m!==0&&te.nodeType!==3||(P=I+m),te!==y||h!==0&&te.nodeType!==3||(V=I+h),te.nodeType===3&&(I+=te.nodeValue.length),(ge=te.firstChild)!==null;)J=te,te=ge;for(;;){if(te===i)break t;if(J===u&&++q===m&&(P=I),J===y&&++X===h&&(V=I),(ge=te.nextSibling)!==null)break;te=J,J=te.parentNode}te=ge}u=P===-1||V===-1?null:{start:P,end:V}}else u=null}u=u||{start:0,end:0}}else u=null;for(Zp={focusedElem:i,selectionRange:u},_s=!1,ve=o;ve!==null;)if(o=ve,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,ve=i;else for(;ve!==null;){o=ve;try{var we=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(we!==null){var Ie=we.memoizedProps,Pt=we.memoizedState,B=o.stateNode,M=B.getSnapshotBeforeUpdate(o.elementType===o.type?Ie:wr(o.type,Ie),Pt);B.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var $=o.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){Tt(o,o.return,ie)}if(i=o.sibling,i!==null){i.return=o.return,ve=i;break}ve=o.return}return we=lE,lE=!1,we}function Gu(i,o,u){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&i)===i){var y=m.destroy;m.destroy=void 0,y!==void 0&&Um(o,u,y)}m=m.next}while(m!==h)}}function Ah(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&i)===i){var h=u.create;u.destroy=h()}u=u.next}while(u!==o)}}function Bm(i){var o=i.ref;if(o!==null){var u=i.stateNode;i.tag,i=u,typeof o=="function"?o(i):o.current=i}}function uE(i){var o=i.alternate;o!==null&&(i.alternate=null,uE(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[qr],delete o[Lu],delete o[rm],delete o[jb],delete o[Ub])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function cE(i){return i.tag===5||i.tag===3||i.tag===4}function dE(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||cE(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function zm(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=nh));else if(h!==4&&(i=i.child,i!==null))for(zm(i,o,u),i=i.sibling;i!==null;)zm(i,o,u),i=i.sibling}function $m(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for($m(i,o,u),i=i.sibling;i!==null;)$m(i,o,u),i=i.sibling}var tn=null,Er=!1;function hi(i,o,u){for(u=u.child;u!==null;)hE(i,o,u),u=u.sibling}function hE(i,o,u){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(oo,u)}catch{}switch(u.tag){case 5:hn||Qa(u,o);case 6:var h=tn,m=Er;tn=null,hi(i,o,u),tn=h,Er=m,tn!==null&&(Er?(i=tn,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):tn.removeChild(u.stateNode));break;case 18:tn!==null&&(Er?(i=tn,u=u.stateNode,i.nodeType===8?nm(i.parentNode,u):i.nodeType===1&&nm(i,u),ni(i)):nm(tn,u.stateNode));break;case 4:h=tn,m=Er,tn=u.stateNode.containerInfo,Er=!0,hi(i,o,u),tn=h,Er=m;break;case 0:case 11:case 14:case 15:if(!hn&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var y=m,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&Um(u,o,I),m=m.next}while(m!==h)}hi(i,o,u);break;case 1:if(!hn&&(Qa(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(P){Tt(u,o,P)}hi(i,o,u);break;case 21:hi(i,o,u);break;case 22:u.mode&1?(hn=(h=hn)||u.memoizedState!==null,hi(i,o,u),hn=h):hi(i,o,u);break;default:hi(i,o,u)}}function fE(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new nR),o.forEach(function(h){var m=hR.bind(null,i,h);u.has(h)||(u.add(h),h.then(m,m))})}}function Ir(i,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var m=u[h];try{var y=i,I=o,P=I;e:for(;P!==null;){switch(P.tag){case 5:tn=P.stateNode,Er=!1;break e;case 3:tn=P.stateNode.containerInfo,Er=!0;break e;case 4:tn=P.stateNode.containerInfo,Er=!0;break e}P=P.return}if(tn===null)throw Error(t(160));hE(y,I,m),tn=null,Er=!1;var V=m.alternate;V!==null&&(V.return=null),m.return=null}catch(q){Tt(m,o,q)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)pE(o,i),o=o.sibling}function pE(i,o){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Ir(o,i),Gr(i),h&4){try{Gu(3,i,i.return),Ah(3,i)}catch(Ie){Tt(i,i.return,Ie)}try{Gu(5,i,i.return)}catch(Ie){Tt(i,i.return,Ie)}}break;case 1:Ir(o,i),Gr(i),h&512&&u!==null&&Qa(u,u.return);break;case 5:if(Ir(o,i),Gr(i),h&512&&u!==null&&Qa(u,u.return),i.flags&32){var m=i.stateNode;try{to(m,"")}catch(Ie){Tt(i,i.return,Ie)}}if(h&4&&(m=i.stateNode,m!=null)){var y=i.memoizedProps,I=u!==null?u.memoizedProps:y,P=i.type,V=i.updateQueue;if(i.updateQueue=null,V!==null)try{P==="input"&&y.type==="radio"&&y.name!=null&&fa(m,y),ga(P,I);var q=ga(P,y);for(I=0;I<V.length;I+=2){var X=V[I],te=V[I+1];X==="style"?ma(m,te):X==="dangerouslySetInnerHTML"?Pd(m,te):X==="children"?to(m,te):Z(m,X,te,q)}switch(P){case"input":eo(m,y);break;case"textarea":Rd(m,y);break;case"select":var J=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var ge=y.value;ge!=null?pr(m,!!y.multiple,ge,!1):J!==!!y.multiple&&(y.defaultValue!=null?pr(m,!!y.multiple,y.defaultValue,!0):pr(m,!!y.multiple,y.multiple?[]:"",!1))}m[Lu]=y}catch(Ie){Tt(i,i.return,Ie)}}break;case 6:if(Ir(o,i),Gr(i),h&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,y=i.memoizedProps;try{m.nodeValue=y}catch(Ie){Tt(i,i.return,Ie)}}break;case 3:if(Ir(o,i),Gr(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{ni(o.containerInfo)}catch(Ie){Tt(i,i.return,Ie)}break;case 4:Ir(o,i),Gr(i);break;case 13:Ir(o,i),Gr(i),m=i.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(Hm=ut())),h&4&&fE(i);break;case 22:if(X=u!==null&&u.memoizedState!==null,i.mode&1?(hn=(q=hn)||X,Ir(o,i),hn=q):Ir(o,i),Gr(i),h&8192){if(q=i.memoizedState!==null,(i.stateNode.isHidden=q)&&!X&&(i.mode&1)!==0)for(ve=i,X=i.child;X!==null;){for(te=ve=X;ve!==null;){switch(J=ve,ge=J.child,J.tag){case 0:case 11:case 14:case 15:Gu(4,J,J.return);break;case 1:Qa(J,J.return);var we=J.stateNode;if(typeof we.componentWillUnmount=="function"){h=J,u=J.return;try{o=h,we.props=o.memoizedProps,we.state=o.memoizedState,we.componentWillUnmount()}catch(Ie){Tt(h,u,Ie)}}break;case 5:Qa(J,J.return);break;case 22:if(J.memoizedState!==null){yE(te);continue}}ge!==null?(ge.return=J,ve=ge):yE(te)}X=X.sibling}e:for(X=null,te=i;;){if(te.tag===5){if(X===null){X=te;try{m=te.stateNode,q?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(P=te.stateNode,V=te.memoizedProps.style,I=V!=null&&V.hasOwnProperty("display")?V.display:null,P.style.display=Gs("display",I))}catch(Ie){Tt(i,i.return,Ie)}}}else if(te.tag===6){if(X===null)try{te.stateNode.nodeValue=q?"":te.memoizedProps}catch(Ie){Tt(i,i.return,Ie)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;X===te&&(X=null),te=te.return}X===te&&(X=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:Ir(o,i),Gr(i),h&4&&fE(i);break;case 21:break;default:Ir(o,i),Gr(i)}}function Gr(i){var o=i.flags;if(o&2){try{e:{for(var u=i.return;u!==null;){if(cE(u)){var h=u;break e}u=u.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(to(m,""),h.flags&=-33);var y=dE(i);$m(i,y,m);break;case 3:case 4:var I=h.stateNode.containerInfo,P=dE(i);zm(i,P,I);break;default:throw Error(t(161))}}catch(V){Tt(i,i.return,V)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function sR(i,o,u){ve=i,mE(i)}function mE(i,o,u){for(var h=(i.mode&1)!==0;ve!==null;){var m=ve,y=m.child;if(m.tag===22&&h){var I=m.memoizedState!==null||Sh;if(!I){var P=m.alternate,V=P!==null&&P.memoizedState!==null||hn;P=Sh;var q=hn;if(Sh=I,(hn=V)&&!q)for(ve=m;ve!==null;)I=ve,V=I.child,I.tag===22&&I.memoizedState!==null?_E(m):V!==null?(V.return=I,ve=V):_E(m);for(;y!==null;)ve=y,mE(y),y=y.sibling;ve=m,Sh=P,hn=q}gE(i)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,ve=y):gE(i)}}function gE(i){for(;ve!==null;){var o=ve;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:hn||Ah(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!hn)if(u===null)h.componentDidMount();else{var m=o.elementType===o.type?u.memoizedProps:wr(o.type,u.memoizedProps);h.componentDidUpdate(m,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&yw(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}yw(o,I,u)}break;case 5:var P=o.stateNode;if(u===null&&o.flags&4){u=P;var V=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&u.focus();break;case"img":V.src&&(u.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var q=o.alternate;if(q!==null){var X=q.memoizedState;if(X!==null){var te=X.dehydrated;te!==null&&ni(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}hn||o.flags&512&&Bm(o)}catch(J){Tt(o,o.return,J)}}if(o===i){ve=null;break}if(u=o.sibling,u!==null){u.return=o.return,ve=u;break}ve=o.return}}function yE(i){for(;ve!==null;){var o=ve;if(o===i){ve=null;break}var u=o.sibling;if(u!==null){u.return=o.return,ve=u;break}ve=o.return}}function _E(i){for(;ve!==null;){var o=ve;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{Ah(4,o)}catch(V){Tt(o,u,V)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var m=o.return;try{h.componentDidMount()}catch(V){Tt(o,m,V)}}var y=o.return;try{Bm(o)}catch(V){Tt(o,y,V)}break;case 5:var I=o.return;try{Bm(o)}catch(V){Tt(o,I,V)}}}catch(V){Tt(o,o.return,V)}if(o===i){ve=null;break}var P=o.sibling;if(P!==null){P.return=o.return,ve=P;break}ve=o.return}}var iR=Math.ceil,xh=re.ReactCurrentDispatcher,qm=re.ReactCurrentOwner,lr=re.ReactCurrentBatchConfig,Ke=0,Ht=null,Mt=null,nn=0,Qn=0,Ja=ai(0),zt=0,Ku=null,To=0,bh=0,Wm=0,Qu=null,kn=null,Hm=0,Ya=1/0,Rs=null,Rh=!1,Gm=null,fi=null,Ph=!1,pi=null,kh=0,Ju=0,Km=null,Ch=-1,Nh=0;function En(){return(Ke&6)!==0?ut():Ch!==-1?Ch:Ch=ut()}function mi(i){return(i.mode&1)===0?1:(Ke&2)!==0&&nn!==0?nn&-nn:zb.transition!==null?(Nh===0&&(Nh=yu()),Nh):(i=He,i!==0||(i=window.event,i=i===void 0?16:xa(i.type)),i)}function Tr(i,o,u,h){if(50<Ju)throw Ju=0,Km=null,Error(t(185));co(i,u,h),((Ke&2)===0||i!==Ht)&&(i===Ht&&((Ke&2)===0&&(bh|=u),zt===4&&gi(i,nn)),Cn(i,h),u===1&&Ke===0&&(o.mode&1)===0&&(Ya=ut()+500,oh&&ui()))}function Cn(i,o){var u=i.callbackNode;uo(i,o);var h=ms(i,i===Ht?nn:0);if(h===0)u!==null&&va(u),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(u!=null&&va(u),o===1)i.tag===0?Bb(wE.bind(null,i)):iw(wE.bind(null,i)),Mb(function(){(Ke&6)===0&&ui()}),u=null;else{switch(Vr(h)){case 1:u=wa;break;case 4:u=pu;break;case 16:u=io;break;case 536870912:u=Ea;break;default:u=io}u=RE(u,vE.bind(null,i))}i.callbackPriority=o,i.callbackNode=u}}function vE(i,o){if(Ch=-1,Nh=0,(Ke&6)!==0)throw Error(t(327));var u=i.callbackNode;if(Xa()&&i.callbackNode!==u)return null;var h=ms(i,i===Ht?nn:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=Dh(i,h);else{o=h;var m=Ke;Ke|=2;var y=IE();(Ht!==i||nn!==o)&&(Rs=null,Ya=ut()+500,Ao(i,o));do try{lR();break}catch(P){EE(i,P)}while(!0);hm(),xh.current=y,Ke=m,Mt!==null?o=0:(Ht=null,nn=0,o=zt)}if(o!==0){if(o===2&&(m=gu(i),m!==0&&(h=m,o=Qm(i,m))),o===1)throw u=Ku,Ao(i,0),gi(i,h),Cn(i,ut()),u;if(o===6)gi(i,h);else{if(m=i.current.alternate,(h&30)===0&&!oR(m)&&(o=Dh(i,h),o===2&&(y=gu(i),y!==0&&(h=y,o=Qm(i,y))),o===1))throw u=Ku,Ao(i,0),gi(i,h),Cn(i,ut()),u;switch(i.finishedWork=m,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:xo(i,kn,Rs);break;case 3:if(gi(i,h),(h&130023424)===h&&(o=Hm+500-ut(),10<o)){if(ms(i,0)!==0)break;if(m=i.suspendedLanes,(m&h)!==h){En(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=tm(xo.bind(null,i,kn,Rs),o);break}xo(i,kn,Rs);break;case 4:if(gi(i,h),(h&4194240)===h)break;for(o=i.eventTimes,m=-1;0<h;){var I=31-zn(h);y=1<<I,I=o[I],I>m&&(m=I),h&=~y}if(h=m,h=ut()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*iR(h/1960))-h,10<h){i.timeoutHandle=tm(xo.bind(null,i,kn,Rs),h);break}xo(i,kn,Rs);break;case 5:xo(i,kn,Rs);break;default:throw Error(t(329))}}}return Cn(i,ut()),i.callbackNode===u?vE.bind(null,i):null}function Qm(i,o){var u=Qu;return i.current.memoizedState.isDehydrated&&(Ao(i,o).flags|=256),i=Dh(i,o),i!==2&&(o=kn,kn=u,o!==null&&Jm(o)),i}function Jm(i){kn===null?kn=i:kn.push.apply(kn,i)}function oR(i){for(var o=i;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var m=u[h],y=m.getSnapshot;m=m.value;try{if(!_r(y(),m))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function gi(i,o){for(o&=~Wm,o&=~bh,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-zn(o),h=1<<u;i[u]=-1,o&=~h}}function wE(i){if((Ke&6)!==0)throw Error(t(327));Xa();var o=ms(i,0);if((o&1)===0)return Cn(i,ut()),null;var u=Dh(i,o);if(i.tag!==0&&u===2){var h=gu(i);h!==0&&(o=h,u=Qm(i,h))}if(u===1)throw u=Ku,Ao(i,0),gi(i,o),Cn(i,ut()),u;if(u===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,xo(i,kn,Rs),Cn(i,ut()),null}function Ym(i,o){var u=Ke;Ke|=1;try{return i(o)}finally{Ke=u,Ke===0&&(Ya=ut()+500,oh&&ui())}}function So(i){pi!==null&&pi.tag===0&&(Ke&6)===0&&Xa();var o=Ke;Ke|=1;var u=lr.transition,h=He;try{if(lr.transition=null,He=1,i)return i()}finally{He=h,lr.transition=u,Ke=o,(Ke&6)===0&&ui()}}function Xm(){Qn=Ja.current,dt(Ja)}function Ao(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,Lb(u)),Mt!==null)for(u=Mt.return;u!==null;){var h=u;switch(am(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&sh();break;case 3:Ga(),dt(bn),dt(un),wm();break;case 5:_m(h);break;case 4:Ga();break;case 13:dt(_t);break;case 19:dt(_t);break;case 10:fm(h.type._context);break;case 22:case 23:Xm()}u=u.return}if(Ht=i,Mt=i=yi(i.current,null),nn=Qn=o,zt=0,Ku=null,Wm=bh=To=0,kn=Qu=null,wo!==null){for(o=0;o<wo.length;o++)if(u=wo[o],h=u.interleaved,h!==null){u.interleaved=null;var m=h.next,y=u.pending;if(y!==null){var I=y.next;y.next=m,h.next=I}u.pending=h}wo=null}return i}function EE(i,o){do{var u=Mt;try{if(hm(),gh.current=wh,yh){for(var h=vt.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}yh=!1}if(Io=0,Wt=Bt=vt=null,zu=!1,$u=0,qm.current=null,u===null||u.return===null){zt=1,Ku=o,Mt=null;break}e:{var y=i,I=u.return,P=u,V=o;if(o=nn,P.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var q=V,X=P,te=X.tag;if((X.mode&1)===0&&(te===0||te===11||te===15)){var J=X.alternate;J?(X.updateQueue=J.updateQueue,X.memoizedState=J.memoizedState,X.lanes=J.lanes):(X.updateQueue=null,X.memoizedState=null)}var ge=Hw(I);if(ge!==null){ge.flags&=-257,Gw(ge,I,P,y,o),ge.mode&1&&Ww(y,q,o),o=ge,V=q;var we=o.updateQueue;if(we===null){var Ie=new Set;Ie.add(V),o.updateQueue=Ie}else we.add(V);break e}else{if((o&1)===0){Ww(y,q,o),Zm();break e}V=Error(t(426))}}else if(pt&&P.mode&1){var Pt=Hw(I);if(Pt!==null){(Pt.flags&65536)===0&&(Pt.flags|=256),Gw(Pt,I,P,y,o),cm(Ka(V,P));break e}}y=V=Ka(V,P),zt!==4&&(zt=2),Qu===null?Qu=[y]:Qu.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var B=$w(y,V,o);gw(y,B);break e;case 1:P=V;var M=y.type,$=y.stateNode;if((y.flags&128)===0&&(typeof M.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(fi===null||!fi.has($)))){y.flags|=65536,o&=-o,y.lanes|=o;var ie=qw(y,P,o);gw(y,ie);break e}}y=y.return}while(y!==null)}SE(u)}catch(Te){o=Te,Mt===u&&u!==null&&(Mt=u=u.return);continue}break}while(!0)}function IE(){var i=xh.current;return xh.current=wh,i===null?wh:i}function Zm(){(zt===0||zt===3||zt===2)&&(zt=4),Ht===null||(To&268435455)===0&&(bh&268435455)===0||gi(Ht,nn)}function Dh(i,o){var u=Ke;Ke|=2;var h=IE();(Ht!==i||nn!==o)&&(Rs=null,Ao(i,o));do try{aR();break}catch(m){EE(i,m)}while(!0);if(hm(),Ke=u,xh.current=h,Mt!==null)throw Error(t(261));return Ht=null,nn=0,zt}function aR(){for(;Mt!==null;)TE(Mt)}function lR(){for(;Mt!==null&&!so();)TE(Mt)}function TE(i){var o=bE(i.alternate,i,Qn);i.memoizedProps=i.pendingProps,o===null?SE(i):Mt=o,qm.current=null}function SE(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&32768)===0){if(u=eR(u,o,Qn),u!==null){Mt=u;return}}else{if(u=tR(u,o),u!==null){u.flags&=32767,Mt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{zt=6,Mt=null;return}}if(o=o.sibling,o!==null){Mt=o;return}Mt=o=i}while(o!==null);zt===0&&(zt=5)}function xo(i,o,u){var h=He,m=lr.transition;try{lr.transition=null,He=1,uR(i,o,u,h)}finally{lr.transition=m,He=h}return null}function uR(i,o,u,h){do Xa();while(pi!==null);if((Ke&6)!==0)throw Error(t(327));u=i.finishedWork;var m=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=u.lanes|u.childLanes;if(jp(i,y),i===Ht&&(Mt=Ht=null,nn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Ph||(Ph=!0,RE(io,function(){return Xa(),null})),y=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||y){y=lr.transition,lr.transition=null;var I=He;He=1;var P=Ke;Ke|=4,qm.current=null,rR(i,u),pE(u,i),Pb(Zp),_s=!!Xp,Zp=Xp=null,i.current=u,sR(u),ps(),Ke=P,He=I,lr.transition=y}else i.current=u;if(Ph&&(Ph=!1,pi=i,kh=m),y=i.pendingLanes,y===0&&(fi=null),Ud(u.stateNode),Cn(i,ut()),o!==null)for(h=i.onRecoverableError,u=0;u<o.length;u++)m=o[u],h(m.value,{componentStack:m.stack,digest:m.digest});if(Rh)throw Rh=!1,i=Gm,Gm=null,i;return(kh&1)!==0&&i.tag!==0&&Xa(),y=i.pendingLanes,(y&1)!==0?i===Km?Ju++:(Ju=0,Km=i):Ju=0,ui(),null}function Xa(){if(pi!==null){var i=Vr(kh),o=lr.transition,u=He;try{if(lr.transition=null,He=16>i?16:i,pi===null)var h=!1;else{if(i=pi,pi=null,kh=0,(Ke&6)!==0)throw Error(t(331));var m=Ke;for(Ke|=4,ve=i.current;ve!==null;){var y=ve,I=y.child;if((ve.flags&16)!==0){var P=y.deletions;if(P!==null){for(var V=0;V<P.length;V++){var q=P[V];for(ve=q;ve!==null;){var X=ve;switch(X.tag){case 0:case 11:case 15:Gu(8,X,y)}var te=X.child;if(te!==null)te.return=X,ve=te;else for(;ve!==null;){X=ve;var J=X.sibling,ge=X.return;if(uE(X),X===q){ve=null;break}if(J!==null){J.return=ge,ve=J;break}ve=ge}}}var we=y.alternate;if(we!==null){var Ie=we.child;if(Ie!==null){we.child=null;do{var Pt=Ie.sibling;Ie.sibling=null,Ie=Pt}while(Ie!==null)}}ve=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,ve=I;else e:for(;ve!==null;){if(y=ve,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Gu(9,y,y.return)}var B=y.sibling;if(B!==null){B.return=y.return,ve=B;break e}ve=y.return}}var M=i.current;for(ve=M;ve!==null;){I=ve;var $=I.child;if((I.subtreeFlags&2064)!==0&&$!==null)$.return=I,ve=$;else e:for(I=M;ve!==null;){if(P=ve,(P.flags&2048)!==0)try{switch(P.tag){case 0:case 11:case 15:Ah(9,P)}}catch(Te){Tt(P,P.return,Te)}if(P===I){ve=null;break e}var ie=P.sibling;if(ie!==null){ie.return=P.return,ve=ie;break e}ve=P.return}}if(Ke=m,ui(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(oo,i)}catch{}h=!0}return h}finally{He=u,lr.transition=o}}return!1}function AE(i,o,u){o=Ka(u,o),o=$w(i,o,1),i=di(i,o,1),o=En(),i!==null&&(co(i,1,o),Cn(i,o))}function Tt(i,o,u){if(i.tag===3)AE(i,i,u);else for(;o!==null;){if(o.tag===3){AE(o,i,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(fi===null||!fi.has(h))){i=Ka(u,i),i=qw(o,i,1),o=di(o,i,1),i=En(),o!==null&&(co(o,1,i),Cn(o,i));break}}o=o.return}}function cR(i,o,u){var h=i.pingCache;h!==null&&h.delete(o),o=En(),i.pingedLanes|=i.suspendedLanes&u,Ht===i&&(nn&u)===u&&(zt===4||zt===3&&(nn&130023424)===nn&&500>ut()-Hm?Ao(i,0):Wm|=u),Cn(i,o)}function xE(i,o){o===0&&((i.mode&1)===0?o=1:(o=Zs,Zs<<=1,(Zs&130023424)===0&&(Zs=4194304)));var u=En();i=As(i,o),i!==null&&(co(i,o,u),Cn(i,u))}function dR(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),xE(i,u)}function hR(i,o){var u=0;switch(i.tag){case 13:var h=i.stateNode,m=i.memoizedState;m!==null&&(u=m.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),xE(i,u)}var bE;bE=function(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps||bn.current)Pn=!0;else{if((i.lanes&u)===0&&(o.flags&128)===0)return Pn=!1,Zb(i,o,u);Pn=(i.flags&131072)!==0}else Pn=!1,pt&&(o.flags&1048576)!==0&&ow(o,lh,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;Th(i,o),i=o.pendingProps;var m=Ua(o,un.current);Ha(o,u),m=Tm(null,o,h,i,m,u);var y=Sm();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Rn(h)?(y=!0,ih(o)):y=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,gm(o),m.updater=Eh,o.stateNode=m,m._reactInternals=o,km(o,h,i,u),o=Vm(null,o,h,!0,y,u)):(o.tag=0,pt&&y&&om(o),wn(null,o,m,u),o=o.child),o;case 16:h=o.elementType;e:{switch(Th(i,o),i=o.pendingProps,m=h._init,h=m(h._payload),o.type=h,m=o.tag=pR(h),i=wr(h,i),m){case 0:o=Dm(null,o,h,i,u);break e;case 1:o=Zw(null,o,h,i,u);break e;case 11:o=Kw(null,o,h,i,u);break e;case 14:o=Qw(null,o,h,wr(h.type,i),u);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:wr(h,m),Dm(i,o,h,m,u);case 1:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:wr(h,m),Zw(i,o,h,m,u);case 3:e:{if(eE(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,m=y.element,mw(i,o),ph(o,h,null,u);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){m=Ka(Error(t(423)),o),o=tE(i,o,h,u,m);break e}else if(h!==m){m=Ka(Error(t(424)),o),o=tE(i,o,h,u,m);break e}else for(Kn=oi(o.stateNode.containerInfo.firstChild),Gn=o,pt=!0,vr=null,u=fw(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if($a(),h===m){o=bs(i,o,u);break e}wn(i,o,h,u)}o=o.child}return o;case 5:return _w(o),i===null&&um(o),h=o.type,m=o.pendingProps,y=i!==null?i.memoizedProps:null,I=m.children,em(h,m)?I=null:y!==null&&em(h,y)&&(o.flags|=32),Xw(i,o),wn(i,o,I,u),o.child;case 6:return i===null&&um(o),null;case 13:return nE(i,o,u);case 4:return ym(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=qa(o,null,h,u):wn(i,o,h,u),o.child;case 11:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:wr(h,m),Kw(i,o,h,m,u);case 7:return wn(i,o,o.pendingProps,u),o.child;case 8:return wn(i,o,o.pendingProps.children,u),o.child;case 12:return wn(i,o,o.pendingProps.children,u),o.child;case 10:e:{if(h=o.type._context,m=o.pendingProps,y=o.memoizedProps,I=m.value,it(dh,h._currentValue),h._currentValue=I,y!==null)if(_r(y.value,I)){if(y.children===m.children&&!bn.current){o=bs(i,o,u);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var P=y.dependencies;if(P!==null){I=y.child;for(var V=P.firstContext;V!==null;){if(V.context===h){if(y.tag===1){V=xs(-1,u&-u),V.tag=2;var q=y.updateQueue;if(q!==null){q=q.shared;var X=q.pending;X===null?V.next=V:(V.next=X.next,X.next=V),q.pending=V}}y.lanes|=u,V=y.alternate,V!==null&&(V.lanes|=u),pm(y.return,u,o),P.lanes|=u;break}V=V.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=u,P=I.alternate,P!==null&&(P.lanes|=u),pm(I,u,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}wn(i,o,m.children,u),o=o.child}return o;case 9:return m=o.type,h=o.pendingProps.children,Ha(o,u),m=or(m),h=h(m),o.flags|=1,wn(i,o,h,u),o.child;case 14:return h=o.type,m=wr(h,o.pendingProps),m=wr(h.type,m),Qw(i,o,h,m,u);case 15:return Jw(i,o,o.type,o.pendingProps,u);case 17:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:wr(h,m),Th(i,o),o.tag=1,Rn(h)?(i=!0,ih(o)):i=!1,Ha(o,u),Bw(o,h,m),km(o,h,m,u),Vm(null,o,h,!0,i,u);case 19:return sE(i,o,u);case 22:return Yw(i,o,u)}throw Error(t(156,o.tag))};function RE(i,o){return fu(i,o)}function fR(i,o,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(i,o,u,h){return new fR(i,o,u,h)}function eg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function pR(i){if(typeof i=="function")return eg(i)?1:0;if(i!=null){if(i=i.$$typeof,i===j)return 11;if(i===rt)return 14}return 2}function yi(i,o){var u=i.alternate;return u===null?(u=ur(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function Vh(i,o,u,h,m,y){var I=2;if(h=i,typeof i=="function")eg(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case R:return bo(u.children,m,y,o);case b:I=8,m|=8;break;case A:return i=ur(12,u,o,m|2),i.elementType=A,i.lanes=y,i;case k:return i=ur(13,u,o,m),i.elementType=k,i.lanes=y,i;case Be:return i=ur(19,u,o,m),i.elementType=Be,i.lanes=y,i;case Ve:return Oh(u,m,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:I=10;break e;case D:I=9;break e;case j:I=11;break e;case rt:I=14;break e;case ce:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=ur(I,u,o,m),o.elementType=i,o.type=h,o.lanes=y,o}function bo(i,o,u,h){return i=ur(7,i,h,o),i.lanes=u,i}function Oh(i,o,u,h){return i=ur(22,i,h,o),i.elementType=Ve,i.lanes=u,i.stateNode={isHidden:!1},i}function tg(i,o,u){return i=ur(6,i,null,o),i.lanes=u,i}function ng(i,o,u){return o=ur(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function mR(i,o,u,h,m){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_u(0),this.expirationTimes=_u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_u(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function rg(i,o,u,h,m,y,I,P,V){return i=new mR(i,o,u,P,V),o===1?(o=1,y===!0&&(o|=8)):o=0,y=ur(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},gm(y),i}function gR(i,o,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:le,key:h==null?null:""+h,children:i,containerInfo:o,implementation:u}}function PE(i){if(!i)return li;i=i._reactInternals;e:{if(gr(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Rn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var u=i.type;if(Rn(u))return rw(i,u,o)}return o}function kE(i,o,u,h,m,y,I,P,V){return i=rg(u,h,!0,i,m,y,I,P,V),i.context=PE(null),u=i.current,h=En(),m=mi(u),y=xs(h,m),y.callback=o??null,di(u,y,m),i.current.lanes=m,co(i,m,h),Cn(i,h),i}function Lh(i,o,u,h){var m=o.current,y=En(),I=mi(m);return u=PE(u),o.context===null?o.context=u:o.pendingContext=u,o=xs(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=di(m,o,I),i!==null&&(Tr(i,m,I,y),fh(i,m,I)),I}function Mh(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function CE(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function sg(i,o){CE(i,o),(i=i.alternate)&&CE(i,o)}function yR(){return null}var NE=typeof reportError=="function"?reportError:function(i){console.error(i)};function ig(i){this._internalRoot=i}Fh.prototype.render=ig.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Lh(i,o,null,null)},Fh.prototype.unmount=ig.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;So(function(){Lh(null,i,null,null)}),o[Es]=null}};function Fh(i){this._internalRoot=i}Fh.prototype.unstable_scheduleHydration=function(i){if(i){var o=Iu();i={blockedOn:null,target:i,priority:o};for(var u=0;u<$n.length&&o!==0&&o<$n[u].priority;u++);$n.splice(u,0,i),u===0&&Sa(i)}};function og(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function jh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function DE(){}function _R(i,o,u,h,m){if(m){if(typeof h=="function"){var y=h;h=function(){var q=Mh(I);y.call(q)}}var I=kE(o,h,i,0,null,!1,!1,"",DE);return i._reactRootContainer=I,i[Es]=I.current,Vu(i.nodeType===8?i.parentNode:i),So(),I}for(;m=i.lastChild;)i.removeChild(m);if(typeof h=="function"){var P=h;h=function(){var q=Mh(V);P.call(q)}}var V=rg(i,0,!1,null,null,!1,!1,"",DE);return i._reactRootContainer=V,i[Es]=V.current,Vu(i.nodeType===8?i.parentNode:i),So(function(){Lh(o,V,u,h)}),V}function Uh(i,o,u,h,m){var y=u._reactRootContainer;if(y){var I=y;if(typeof m=="function"){var P=m;m=function(){var V=Mh(I);P.call(V)}}Lh(o,I,i,m)}else I=_R(u,o,i,m,h);return Mh(I)}wu=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var u=Xe(o.pendingLanes);u!==0&&(vu(o,u|1),Cn(o,ut()),(Ke&6)===0&&(Ya=ut()+500,ui()))}break;case 13:So(function(){var h=As(i,1);if(h!==null){var m=En();Tr(h,i,1,m)}}),sg(i,1)}},Ia=function(i){if(i.tag===13){var o=As(i,134217728);if(o!==null){var u=En();Tr(o,i,134217728,u)}sg(i,134217728)}},Eu=function(i){if(i.tag===13){var o=mi(i),u=As(i,o);if(u!==null){var h=En();Tr(u,i,o,h)}sg(i,o)}},Iu=function(){return He},Tu=function(i,o){var u=He;try{return He=i,o()}finally{He=u}},ds=function(i,o,u){switch(o){case"input":if(eo(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==i&&h.form===i.form){var m=rh(h);if(!m)throw Error(t(90));$s(h),eo(h,m)}}}break;case"textarea":Rd(i,u);break;case"select":o=u.value,o!=null&&pr(i,!!u.multiple,o,!1)}},Cd=Ym,Nd=So;var vR={usingClientEntryPoint:!1,Events:[Mu,Fa,rh,Qs,Js,Ym]},Yu={findFiberByHostInstance:go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wR={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:re.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=jd(i),i===null?null:i.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||yR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bh.isDisabled&&Bh.supportsFiber)try{oo=Bh.inject(wR),Bn=Bh}catch{}}return Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vR,Nn.createPortal=function(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!og(o))throw Error(t(200));return gR(i,o,null,u)},Nn.createRoot=function(i,o){if(!og(i))throw Error(t(299));var u=!1,h="",m=NE;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=rg(i,1,!1,null,null,u,!1,h,m),i[Es]=o.current,Vu(i.nodeType===8?i.parentNode:i),new ig(o)},Nn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=jd(o),i=i===null?null:i.stateNode,i},Nn.flushSync=function(i){return So(i)},Nn.hydrate=function(i,o,u){if(!jh(o))throw Error(t(200));return Uh(null,i,o,!0,u)},Nn.hydrateRoot=function(i,o,u){if(!og(i))throw Error(t(405));var h=u!=null&&u.hydratedSources||null,m=!1,y="",I=NE;if(u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),o=kE(o,null,i,1,u??null,m,!1,y,I),i[Es]=o.current,Vu(i),h)for(i=0;i<h.length;i++)u=h[i],m=u._getVersion,m=m(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,m]:o.mutableSourceEagerHydrationData.push(u,m);return new Fh(o)},Nn.render=function(i,o,u){if(!jh(o))throw Error(t(200));return Uh(null,i,o,!1,u)},Nn.unmountComponentAtNode=function(i){if(!jh(i))throw Error(t(40));return i._reactRootContainer?(So(function(){Uh(null,null,i,!1,function(){i._reactRootContainer=null,i[Es]=null})}),!0):!1},Nn.unstable_batchedUpdates=Ym,Nn.unstable_renderSubtreeIntoContainer=function(i,o,u,h){if(!jh(u))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Uh(i,o,u,!1,h)},Nn.version="18.3.1-next-f1338f8080-20240426",Nn}var BE;function RR(){if(BE)return ug.exports;BE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ug.exports=bR(),ug.exports}var zE;function PR(){if(zE)return zh;zE=1;var n=RR();return zh.createRoot=n.createRoot,zh.hydrateRoot=n.hydrateRoot,zh}var kR=PR();const CR="modulepreload",NR=function(n){return"/"+n},$E={},Si=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(v=>Promise.resolve(v).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var l=p;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");s=p(t.map(g=>{if(g=NR(g),g in $E)return;$E[g]=!0;const v=g.endsWith(".css"),T=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${T}`))return;const C=document.createElement("link");if(C.rel=v?"stylesheet":CR,v||(C.as="script"),C.crossOrigin="",C.href=g,f&&C.setAttribute("nonce",f),document.head.appendChild(C),v)return new Promise((x,O)=>{C.addEventListener("load",x),C.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return s.then(d=>{for(const f of d||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})};const DR=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VR=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),qE=n=>{const e=VR(n);return e.charAt(0).toUpperCase()+e.slice(1)},A0=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),OR=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var LR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const MR=ye.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:l,...d},f)=>ye.createElement("svg",{ref:f,...LR,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:A0("lucide",s),...!a&&!OR(d)&&{"aria-hidden":"true"},...d},[...l.map(([p,g])=>ye.createElement(p,g)),...Array.isArray(a)?a:[a]]));const Ye=(n,e)=>{const t=ye.forwardRef(({className:r,...s},a)=>ye.createElement(MR,{ref:a,iconNode:e,className:A0(`lucide-${DR(qE(n))}`,`lucide-${n}`,r),...s}));return t.displayName=qE(n),t};const FR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],x0=Ye("arrow-right",FR);const jR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Og=Ye("bell",jR);const UR=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],BR=Ye("book",UR);const zR=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],$R=Ye("calendar",zR);const qR=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],b0=Ye("camera",qR);const WR=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],HR=Ye("chevron-down",WR);const GR=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ky=Ye("chevron-left",GR);const KR=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],R0=Ye("chevron-right",KR);const QR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],JR=Ye("circle-check-big",QR);const YR=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Lg=Ye("coins",YR);const XR=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ZR=Ye("external-link",XR);const eP=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tP=Ye("eye",eP);const nP=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],rP=Ye("flame",nP);const sP=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],P0=Ye("gift",sP);const iP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],oP=Ye("heart",iP);const aP=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],WE=Ye("house",aP);const lP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],uP=Ye("image",lP);const cP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],dP=Ye("log-out",cP);const hP=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],yf=Ye("message-circle",hP);const fP=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],pP=Ye("palette",fP);const mP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],gP=Ye("plus",mP);const yP=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],_P=Ye("repeat",yP);const vP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wP=Ye("search",vP);const EP=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],IP=Ye("send",EP);const TP=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],SP=Ye("share-2",TP);const AP=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],xP=Ye("sparkles",AP);const bP=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],RP=Ye("star",bP);const PP=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],kP=Ye("store",PP);const CP=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],NP=Ye("trash-2",CP);const DP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],VP=Ye("user",DP);const OP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ts=Ye("x",OP);const LP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],MP=Ye("zap",LP),FP=()=>{};var HE={};const k0=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},C0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,g=a>>2,v=(a&3)<<4|d>>4;let T=(d&15)<<2|p>>6,C=p&63;f||(C=64,l||(T=64)),r.push(t[g],t[v],t[T],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(k0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||p==null||v==null)throw new UP;const T=a<<2|d>>4;if(r.push(T),p!==64){const C=d<<4&240|p>>2;if(r.push(C),v!==64){const x=p<<6&192|v;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class UP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const BP=function(n){const e=k0(n);return C0.encodeByteArray(e,!0)},_f=function(n){return BP(n).replace(/\./g,"")},Cy=function(n){try{return C0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vf(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!zP(t)||(n[t]=vf(n[t],e[t]));return n}function zP(n){return n!=="__proto__"}function Ny(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const $P=()=>Ny().__FIREBASE_DEFAULTS__,qP=()=>{if(typeof process>"u"||typeof HE>"u")return;const n=HE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},WP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Cy(n[1]);return e&&JSON.parse(e)},Dy=()=>{try{return FP()||$P()||qP()||WP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Vy=()=>Dy()?.config,HP=n=>Dy()?.[`_${n}`];class GP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Hi(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Oy(n){return(await fetch(n,{credentials:"include"})).ok}function KP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_f(JSON.stringify(t)),_f(JSON.stringify(l)),""].join(".")}const yc={};function QP(){const n={prod:[],emulator:[]};for(const e of Object.keys(yc))yc[e]?n.emulator.push(e):n.prod.push(e);return n}function JP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let GE=!1;function Ly(n,e){if(typeof window>"u"||typeof document>"u"||!Hi(window.location.host)||yc[n]===e||yc[n]||GE)return;yc[n]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",a=QP().prod.length>0;function l(){const T=document.getElementById(r);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,C){T.setAttribute("width","24"),T.setAttribute("id",C),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{GE=!0,l()},T}function g(T,C){T.setAttribute("id",C),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function v(){const T=JP(r),C=t("text"),x=document.getElementById(C)||document.createElement("span"),O=t("learnmore"),L=document.getElementById(O)||document.createElement("a"),ne=t("preprendIcon"),oe=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Z=T.element;d(Z),g(L,O);const re=p();f(oe,ne),Z.append(oe,x,L,re),document.body.appendChild(Z)}a?(x.innerText="Preview backend disconnected.",oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function YP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wt())}function Gf(){const n=Dy()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XP(){return typeof window<"u"||N0()}function N0(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ZP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D0(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function My(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function V0(){const n=wt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function O0(){return!Gf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L0(){return!Gf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Nc(){try{return typeof indexedDB=="object"}catch{return!1}}function ek(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const tk="FirebaseError";class Yt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=tk,Object.setPrototypeOf(this,Yt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oa.prototype.create)}}class oa{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?nk(a,r):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new Yt(s,d,r)}}function nk(n,e){return n.replace(rk,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const rk=/\{\$([^}]+)}/g;function KE(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function sk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Oi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(QE(a)&&QE(l)){if(!Oi(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function QE(n){return n!==null&&typeof n=="object"}function Wl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function dl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function uc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function M0(n,e){const t=new ik(n,e);return t.subscribe.bind(t)}class ik{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ok(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=hg),s.error===void 0&&(s.error=hg),s.complete===void 0&&(s.complete=hg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ok(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function hg(){}function Ae(n){return n&&n._delegate?n._delegate:n}class hr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Po="[DEFAULT]";class ak{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new GP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uk(e))try{this.getOrInitializeService({instanceIdentifier:Po})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Po){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Po){return this.instances.has(e)}getOptions(e=Po){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:lk(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Po){return this.component?this.component.multipleInstances?e:Po:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lk(n){return n===Po?void 0:n}function uk(n){return n.instantiationMode==="EAGER"}class F0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ak(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Fy=[];var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const j0={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},ck=$e.INFO,dk={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},hk=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=dk[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kf{constructor(e){this.name=e,this._logLevel=ck,this._logHandler=hk,this._userLogHandler=null,Fy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?j0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}function fk(n){Fy.forEach(e=>{e.setLogLevel(n)})}function pk(n,e){for(const t of Fy){let r=null;e&&e.level&&(r=j0[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,a,...l)=>{const d=l.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");a>=(r??s.logLevel)&&n({level:$e[a].toLowerCase(),message:d,args:l,type:s.name})}}}const mk=(n,e)=>e.some(t=>n instanceof t);let JE,YE;function gk(){return JE||(JE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yk(){return YE||(YE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const U0=new WeakMap,Mg=new WeakMap,B0=new WeakMap,fg=new WeakMap,jy=new WeakMap;function _k(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(ki(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&U0.set(t,n)}).catch(()=>{}),jy.set(e,n),e}function vk(n){if(Mg.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Mg.set(n,e)}let Fg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Mg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||B0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ki(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wk(n){Fg=n(Fg)}function Ek(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(pg(this),e,...t);return B0.set(r,e.sort?e.sort():[e]),ki(r)}:yk().includes(n)?function(...e){return n.apply(pg(this),e),ki(U0.get(this))}:function(...e){return ki(n.apply(pg(this),e))}}function Ik(n){return typeof n=="function"?Ek(n):(n instanceof IDBTransaction&&vk(n),mk(n,gk())?new Proxy(n,Fg):n)}function ki(n){if(n instanceof IDBRequest)return _k(n);if(fg.has(n))return fg.get(n);const e=Ik(n);return e!==n&&(fg.set(n,e),jy.set(e,n)),e}const pg=n=>jy.get(n);function Tk(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=ki(l);return r&&l.addEventListener("upgradeneeded",f=>{r(ki(l.result),f.oldVersion,f.newVersion,ki(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const Sk=["get","getKey","getAll","getAllKeys","count"],Ak=["put","add","delete","clear"],mg=new Map;function XE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(mg.get(e))return mg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Ak.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Sk.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&f.done]))[0]};return mg.set(e,a),a}wk(n=>({...n,get:(e,t,r)=>XE(e,t)||n.get(e,t,r),has:(e,t)=>!!XE(e,t)||n.has(e,t)}));class xk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(bk(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function bk(n){return n.getComponent()?.type==="VERSION"}const wf="@firebase/app",jg="0.14.6";const Ns=new Kf("@firebase/app"),Rk="@firebase/app-compat",Pk="@firebase/analytics-compat",kk="@firebase/analytics",Ck="@firebase/app-check-compat",Nk="@firebase/app-check",Dk="@firebase/auth",Vk="@firebase/auth-compat",Ok="@firebase/database",Lk="@firebase/data-connect",Mk="@firebase/database-compat",Fk="@firebase/functions",jk="@firebase/functions-compat",Uk="@firebase/installations",Bk="@firebase/installations-compat",zk="@firebase/messaging",$k="@firebase/messaging-compat",qk="@firebase/performance",Wk="@firebase/performance-compat",Hk="@firebase/remote-config",Gk="@firebase/remote-config-compat",Kk="@firebase/storage",Qk="@firebase/storage-compat",Jk="@firebase/firestore",Yk="@firebase/ai",Xk="@firebase/firestore-compat",Zk="firebase",eC="12.6.0";const Li="[DEFAULT]",tC={[wf]:"fire-core",[Rk]:"fire-core-compat",[kk]:"fire-analytics",[Pk]:"fire-analytics-compat",[Nk]:"fire-app-check",[Ck]:"fire-app-check-compat",[Dk]:"fire-auth",[Vk]:"fire-auth-compat",[Ok]:"fire-rtdb",[Lk]:"fire-data-connect",[Mk]:"fire-rtdb-compat",[Fk]:"fire-fn",[jk]:"fire-fn-compat",[Uk]:"fire-iid",[Bk]:"fire-iid-compat",[zk]:"fire-fcm",[$k]:"fire-fcm-compat",[qk]:"fire-perf",[Wk]:"fire-perf-compat",[Hk]:"fire-rc",[Gk]:"fire-rc-compat",[Kk]:"fire-gcs",[Qk]:"fire-gcs-compat",[Jk]:"fire-fst",[Xk]:"fire-fst-compat",[Yk]:"fire-vertex","fire-js":"fire-js",[Zk]:"fire-js-all"};const Mi=new Map,wl=new Map,El=new Map;function Dc(n,e){try{n.container.addComponent(e)}catch(t){Ns.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function z0(n,e){n.container.addOrOverwriteComponent(e)}function Ds(n){const e=n.name;if(El.has(e))return Ns.debug(`There were multiple attempts to register component ${e}.`),!1;El.set(e,n);for(const t of Mi.values())Dc(t,n);for(const t of wl.values())Dc(t,n);return!0}function $0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nC(n,e,t=Li){$0(n,e).clearInstance(t)}function Uy(n){return n.options!==void 0}function q0(n){return Uy(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function ft(n){return n==null?!1:n.settings!==void 0}function rC(){El.clear()}const sC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zn=new oa("app","Firebase",sC);let W0=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zn.create("app-deleted",{appName:this._name})}};function ZE(n,e){const t=Cy(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,a=new Date().getTime();s-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class iC extends W0{constructor(e,t,r,s){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:r,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,s);else{const d=e;super(d.options,l,s)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&ZE(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&ZE(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,er(wf,jg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){zy(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Zn.create("server-app-deleted")}}const Gi=eC;function By(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Li,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Zn.create("bad-app-name",{appName:String(s)});if(t||(t=Vy()),!t)throw Zn.create("no-options");const a=Mi.get(s);if(a){if(Oi(t,a.options)&&Oi(r,a.config))return a;throw Zn.create("duplicate-app",{appName:s})}const l=new F0(s);for(const f of El.values())l.addComponent(f);const d=new W0(t,r,l);return Mi.set(s,d),d}function oC(n,e={}){if(XP()&&!N0())throw Zn.create("invalid-server-app-environment");let t,r=e||{};if(n&&(Uy(n)?t=n.options:q0(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=Vy()),!t)throw Zn.create("no-options");const s={...r,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const a=g=>[...g].reduce((v,T)=>Math.imul(31,v)+T.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Zn.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(s)),d=wl.get(l);if(d)return d.incRefCount(r.releaseOnDeref),d;const f=new F0(l);for(const g of El.values())f.addComponent(g);const p=new iC(t,r,l,f);return wl.set(l,p),p}function aC(n=Li){const e=Mi.get(n);if(!e&&n===Li&&Vy())return By();if(!e)throw Zn.create("no-app",{appName:n});return e}function lC(){return Array.from(Mi.values())}async function zy(n){let e=!1;const t=n.name;Mi.has(t)?(e=!0,Mi.delete(t)):wl.has(t)&&n.decRefCount()<=0&&(wl.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function er(n,e,t){let r=tC[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ns.warn(l.join(" "));return}Ds(new hr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function H0(n,e){if(n!==null&&typeof n!="function")throw Zn.create("invalid-log-argument");pk(n,e)}function G0(n){fk(n)}const uC="firebase-heartbeat-database",cC=1,Vc="firebase-heartbeat-store";let gg=null;function K0(){return gg||(gg=Tk(uC,cC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zn.create("idb-open",{originalErrorMessage:n.message})})),gg}async function dC(n){try{const t=(await K0()).transaction(Vc),r=await t.objectStore(Vc).get(Q0(n));return await t.done,r}catch(e){if(e instanceof Yt)Ns.warn(e.message);else{const t=Zn.create("idb-get",{originalErrorMessage:e?.message});Ns.warn(t.message)}}}async function eI(n,e){try{const r=(await K0()).transaction(Vc,"readwrite");await r.objectStore(Vc).put(e,Q0(n)),await r.done}catch(t){if(t instanceof Yt)Ns.warn(t.message);else{const r=Zn.create("idb-set",{originalErrorMessage:t?.message});Ns.warn(r.message)}}}function Q0(n){return`${n.name}!${n.options.appId}`}const hC=1024,fC=30;class pC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=tI();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>fC){const s=yC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ns.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=tI(),{heartbeatsToSend:t,unsentEntries:r}=mC(this._heartbeatsCache.heartbeats),s=_f(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Ns.warn(e),""}}}function tI(){return new Date().toISOString().substring(0,10)}function mC(n,e=hC){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),nI(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),nI(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class gC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nc()?ek().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await dC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return eI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function nI(n){return _f(JSON.stringify({version:2,heartbeats:n})).length}function yC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function _C(n){Ds(new hr("platform-logger",e=>new xk(e),"PRIVATE")),Ds(new hr("heartbeat",e=>new pC(e),"PRIVATE")),er(wf,jg,n),er(wf,jg,"esm2020"),er("fire-js","")}_C("");const vC=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Yt,SDK_VERSION:Gi,_DEFAULT_ENTRY_NAME:Li,_addComponent:Dc,_addOrOverwriteComponent:z0,_apps:Mi,_clearComponents:rC,_components:El,_getProvider:$0,_isFirebaseApp:Uy,_isFirebaseServerApp:ft,_isFirebaseServerAppSettings:q0,_registerComponent:Ds,_removeServiceInstance:nC,_serverApps:wl,deleteApp:zy,getApp:aC,getApps:lC,initializeApp:By,initializeServerApp:oC,onLog:H0,registerVersion:er,setLogLevel:G0},Symbol.toStringTag,{value:"Module"}));class wC{constructor(e,t){this._delegate=e,this.firebase=t,Dc(e,new hr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),zy(this._delegate)))}_getService(e,t=Li){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Li){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Dc(this._delegate,e)}_addOrOverwriteComponent(e){z0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const EC={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},rI=new oa("app-compat","Firebase",EC);function IC(n){const e={},t={__esModule:!0,initializeApp:a,app:s,registerVersion:er,setLogLevel:G0,onLog:H0,apps:null,SDK_VERSION:Gi,INTERNAL:{registerComponent:d,removeApp:r,useAsService:f,modularAPIs:vC}};t.default=t,Object.defineProperty(t,"apps",{get:l});function r(p){delete e[p]}function s(p){if(p=p||Li,!KE(e,p))throw rI.create("no-app",{appName:p});return e[p]}s.App=n;function a(p,g={}){const v=By(p,g);if(KE(e,v.name))return e[v.name];const T=new n(v,t);return e[v.name]=T,T}function l(){return Object.keys(e).map(p=>e[p])}function d(p){const g=p.name,v=g.replace("-compat","");if(Ds(p)&&p.type==="PUBLIC"){const T=(C=s())=>{if(typeof C[v]!="function")throw rI.create("invalid-app-argument",{appName:g});return C[v]()};p.serviceProps!==void 0&&vf(T,p.serviceProps),t[v]=T,n.prototype[v]=function(...C){return this._getService.bind(this,g).apply(this,p.multipleInstances?C:[])}}return p.type==="PUBLIC"?t[v]:null}function f(p,g){return g==="serverAuth"?null:g}return t}function J0(){const n=IC(wC);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:J0,extendNamespace:e,createSubscribe:M0,ErrorFactory:oa,deepExtend:vf};function e(t){vf(n,t)}return n}const TC=J0();const sI=new Kf("@firebase/app-compat"),SC="@firebase/app-compat",AC="0.5.6";function xC(n){er(SC,AC,n)}try{const n=Ny();if(n.firebase!==void 0){sI.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&sI.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const yn=TC;xC();var bC="firebase",RC="12.7.0";yn.registerVersion(bC,RC,"app-compat");const Zu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Za={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function PC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function Y0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kC=PC,CC=Y0,X0=new oa("auth","Firebase",Y0());const Ef=new Kf("@firebase/auth");function NC(n,...e){Ef.logLevel<=$e.WARN&&Ef.warn(`Auth (${Gi}): ${n}`,...e)}function Xh(n,...e){Ef.logLevel<=$e.ERROR&&Ef.error(`Auth (${Gi}): ${n}`,...e)}function an(n,...e){throw qy(n,...e)}function $t(n,...e){return qy(n,...e)}function $y(n,e,t){const r={...CC(),[e]:t};return new oa("auth","Firebase",r).create(e,{appName:n.name})}function Xt(n){return $y(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hl(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&an(n,"argument-error"),$y(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return X0.create(n,...e)}function ee(n,e,...t){if(!n)throw qy(e,...t)}function ns(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Xh(e),new Error(e)}function Rr(n,e){n||ns(e)}function Oc(){return typeof self<"u"&&self.location?.href||""}function Wy(){return iI()==="http:"||iI()==="https:"}function iI(){return typeof self<"u"&&self.location?.protocol||null}function DC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Wy()||D0()||"connection"in navigator)?navigator.onLine:!0}function VC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class td{constructor(e,t){this.shortDelay=e,this.longDelay=t,Rr(t>e,"Short delay should be less than long delay!"),this.isMobile=YP()||My()}get(){return DC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Hy(n,e){Rr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Z0{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const LC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MC=new td(3e4,6e4);function At(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function xt(n,e,t,r,s={}){return eS(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=Wl({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return ZP()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Hi(n.emulatorConfig.host)&&(p.credentials="include"),Z0.fetch()(await tS(n,n.config.apiHost,t,d),p)})}async function eS(n,e,t){n._canInitEmulator=!1;const r={...OC,...e};try{const s=new jC(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw cc(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw cc(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw cc(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw cc(n,"user-disabled",l);const g=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw $y(n,g,p);an(n,g)}}catch(s){if(s instanceof Yt)throw s;an(n,"network-request-failed",{message:String(s)})}}async function Ms(n,e,t,r,s={}){const a=await xt(n,e,t,r,s);return"mfaPendingCredential"in a&&an(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function tS(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?Hy(n.config,s):`${n.config.apiScheme}://${s}`;return LC.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function FC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($t(this.auth,"network-request-failed")),MC.get())})}}function cc(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=$t(n,e,r);return s.customData._tokenResponse=t,s}function oI(n){return n!==void 0&&n.getResponse!==void 0}function aI(n){return n!==void 0&&n.enterprise!==void 0}class nS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return FC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function UC(n){return(await xt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function rS(n,e){return xt(n,"GET","/v2/recaptchaConfig",At(n,e))}async function BC(n,e){return xt(n,"POST","/v1/accounts:delete",e)}async function zC(n,e){return xt(n,"POST","/v1/accounts:update",e)}async function If(n,e){return xt(n,"POST","/v1/accounts:lookup",e)}function _c(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $C(n,e=!1){const t=Ae(n),r=await t.getIdToken(e),s=Qf(r);ee(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a?.sign_in_provider;return{claims:s,token:r,authTime:_c(yg(s.auth_time)),issuedAtTime:_c(yg(s.iat)),expirationTime:_c(yg(s.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function yg(n){return Number(n)*1e3}function Qf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Xh("JWT malformed, contained fewer than 3 sections"),null;try{const s=Cy(t);return s?JSON.parse(s):(Xh("Failed to decode base64 JWT payload"),null)}catch(s){return Xh("Caught error parsing JWT payload as JSON",s?.toString()),null}}function lI(n){const e=Qf(n);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Yt&&qC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function qC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class WC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ug{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_c(this.lastLoginAt),this.creationTime=_c(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Lc(n){const e=n.auth,t=await n.getIdToken(),r=await Vs(n,If(e,{idToken:t}));ee(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const a=s.providerUserInfo?.length?sS(s.providerUserInfo):[],l=GC(n.providerData,a),d=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!l?.length,p=d?f:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Ug(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function HC(n){const e=Ae(n);await Lc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GC(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function sS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function KC(n,e){const t=await eS(n,{},async()=>{const r=Wl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await tS(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:r};return n.emulatorConfig&&Hi(n.emulatorConfig.host)&&(f.credentials="include"),Z0.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function QC(n,e){return xt(n,"POST","/v2/accounts:revokeToken",At(n,e))}class fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):lI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const t=lI(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await KC(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new fl;return r&&(ee(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(ee(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fl,this.toJSON())}_performRefresh(){return ns("not implemented")}}function vi(n,e){ee(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ar{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new WC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ug(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Vs(this,this.stsTokenManager.getToken(this.auth,e));return ee(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $C(this,e)}reload(){return HC(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Lc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ft(this.auth.app))return Promise.reject(Xt(this.auth));const e=await this.getIdToken();return await Vs(this,BC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:v,emailVerified:T,isAnonymous:C,providerData:x,stsTokenManager:O}=t;ee(v&&O,e,"internal-error");const L=fl.fromJSON(this.name,O);ee(typeof v=="string",e,"internal-error"),vi(r,e.name),vi(s,e.name),ee(typeof T=="boolean",e,"internal-error"),ee(typeof C=="boolean",e,"internal-error"),vi(a,e.name),vi(l,e.name),vi(d,e.name),vi(f,e.name),vi(p,e.name),vi(g,e.name);const ne=new Ar({uid:v,auth:e,email:s,emailVerified:T,displayName:r,isAnonymous:C,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:L,createdAt:p,lastLoginAt:g});return x&&Array.isArray(x)&&(ne.providerData=x.map(oe=>({...oe}))),f&&(ne._redirectEventId=f),ne}static async _fromIdTokenResponse(e,t,r=!1){const s=new fl;s.updateFromServerResponse(t);const a=new Ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Lc(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ee(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?sS(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!a?.length,d=new fl;d.updateFromIdToken(r);const f=new Ar({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ug(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(f,p),f}}const uI=new Map;function Xn(n){Rr(n instanceof Function,"Expected a class definition");let e=uI.get(n);return e?(Rr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uI.set(n,e),e)}class iS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}iS.type="NONE";const Il=iS;function zo(n,e,t){return`firebase:${n}:${e}:${t}`}class pl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=zo(this.userKey,s.apiKey,a),this.fullPersistenceKey=zo("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await If(this.auth,{idToken:e}).catch(()=>{});return t?Ar._fromGetAccountInfoResponse(this.auth,t,e):null}return Ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new pl(Xn(Il),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||Xn(Il);const l=zo(r,e.config.apiKey,e.name);let d=null;for(const p of t)try{const g=await p._get(l);if(g){let v;if(typeof g=="string"){const T=await If(e,{idToken:g}).catch(()=>{});if(!T)break;v=await Ar._fromGetAccountInfoResponse(e,T,g)}else v=Ar._fromJSON(e,g);p!==a&&(d=v),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new pl(a,e,r):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new pl(a,e,r))}}function cI(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cS(e))return"Blackberry";if(dS(e))return"Webos";if(aS(e))return"Safari";if((e.includes("chrome/")||lS(e))&&!e.includes("edge/"))return"Chrome";if(nd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function oS(n=wt()){return/firefox\//i.test(n)}function aS(n=wt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lS(n=wt()){return/crios\//i.test(n)}function uS(n=wt()){return/iemobile/i.test(n)}function nd(n=wt()){return/android/i.test(n)}function cS(n=wt()){return/blackberry/i.test(n)}function dS(n=wt()){return/webos/i.test(n)}function rd(n=wt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function JC(n=wt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function YC(n=wt()){return rd(n)&&!!window.navigator?.standalone}function XC(){return V0()&&document.documentMode===10}function hS(n=wt()){return rd(n)||nd(n)||dS(n)||cS(n)||/windows phone/i.test(n)||uS(n)}function fS(n,e=[]){let t;switch(n){case"Browser":t=cI(wt());break;case"Worker":t=`${cI(wt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Gi}/${r}`}class ZC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function eN(n,e={}){return xt(n,"GET","/v2/passwordPolicy",At(n,e))}const tN=6;class nN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class rN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dI(this),this.idTokenSubscription=new dI(this),this.beforeStateQueue=new ZC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=X0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xn(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await pl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await If(this,{idToken:e}),r=await Ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ft(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=r?._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===l)&&d?.user&&(r=d.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Lc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ft(this.app))return Promise.reject(Xt(this));const t=e?Ae(e):null;return t&&ee(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ft(this.app)?Promise.reject(Xt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ft(this.app)?Promise.reject(Xt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Xn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eN(this),t=new nN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new oa("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await QC(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Xn(e)||this._popupRedirectResolver;ee(t,this,"argument-error"),this.redirectPersistenceManager=await pl.create(this,[Xn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ft(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&NC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Et(n){return Ae(n)}class dI{constructor(e){this.auth=e,this.observer=null,this.addObserver=M0(t=>this.observer=t)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sN(n){sd=n}function Gy(n){return sd.loadJS(n)}function iN(){return sd.recaptchaV2Script}function oN(){return sd.recaptchaEnterpriseScript}function aN(){return sd.gapiScript}function pS(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const lN=500,uN=6e4,$h=1e12;class cN{constructor(e){this.auth=e,this.counter=$h,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new fN(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||$h;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||$h;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||$h;return this._widgets.get(t)?.execute(),""}}class dN{constructor(){this.enterprise=new hN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class hN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class fN{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ee(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=pN(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},uN)},lN))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function pN(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const mN="recaptcha-enterprise",vc="NO_RECAPTCHA";class mS{constructor(e){this.type=mN,this.auth=Et(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{rS(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new nS(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,l(p.siteKey)}}).catch(f=>{d(f)})})}function s(a,l,d){const f=window.grecaptcha;aI(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{l(p)}).catch(()=>{l(vc)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dN().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{r(this.auth).then(d=>{if(!t&&aI(window.grecaptcha))s(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=oN();f.length!==0&&(f+=d),Gy(f).then(()=>{s(d,a,l)}).catch(p=>{l(p)})}}).catch(d=>{l(d)})})}}async function ec(n,e,t,r=!1,s=!1){const a=new mS(n);let l;if(s)l=vc;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Ci(n,e,t,r,s){if(s==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await ec(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await ec(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)});else if(s==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const a=await ec(n,e,t);return r(n,a).catch(async l=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const d=await ec(n,e,t,!1,!0);return r(n,d)}return Promise.reject(l)})}else{const a=await ec(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(s+" provider is not supported.")}async function gN(n){const e=Et(n),t=await rS(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new nS(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new mS(e).verify()}function yN(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Xn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function _N(n,e,t){const r=Et(n);ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!t?.disableWarnings,a=gS(e),{host:l,port:d}=vN(e),f=d===null?"":`:${d}`,p={url:`${a}//${l}${f}/`},g=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ee(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ee(Oi(p,r.config.emulator)&&Oi(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,Hi(l)?(Oy(`${a}//${l}${f}`),Ly("Auth",!0)):s||wN()}function gS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function vN(n){const e=gS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:hI(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:hI(l)}}}function hI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Gl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ns("not implemented")}_getIdTokenResponse(e){return ns("not implemented")}_linkToIdToken(e,t){return ns("not implemented")}_getReauthenticationResolver(e){return ns("not implemented")}}async function yS(n,e){return xt(n,"POST","/v1/accounts:resetPassword",At(n,e))}async function EN(n,e){return xt(n,"POST","/v1/accounts:update",e)}async function IN(n,e){return xt(n,"POST","/v1/accounts:signUp",e)}async function TN(n,e){return xt(n,"POST","/v1/accounts:update",At(n,e))}async function SN(n,e){return Ms(n,"POST","/v1/accounts:signInWithPassword",At(n,e))}async function Jf(n,e){return xt(n,"POST","/v1/accounts:sendOobCode",At(n,e))}async function AN(n,e){return Jf(n,e)}async function xN(n,e){return Jf(n,e)}async function bN(n,e){return Jf(n,e)}async function RN(n,e){return Jf(n,e)}async function PN(n,e){return Ms(n,"POST","/v1/accounts:signInWithEmailLink",At(n,e))}async function kN(n,e){return Ms(n,"POST","/v1/accounts:signInWithEmailLink",At(n,e))}class Mc extends Gl{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Mc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Mc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ci(e,t,"signInWithPassword",SN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return PN(e,{email:this._email,oobCode:this._password});default:an(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ci(e,r,"signUpPassword",IN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return kN(e,{idToken:t,email:this._email,oobCode:this._password});default:an(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Cs(n,e){return Ms(n,"POST","/v1/accounts:signInWithIdp",At(n,e))}const CN="http://localhost";class ls extends Gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ls(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):an("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...a}=t;if(!r||!s)return null;const l=new ls(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Cs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Cs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Cs(e,t)}buildRequest(){const e={requestUri:CN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wl(t)}return e}}async function fI(n,e){return xt(n,"POST","/v1/accounts:sendVerificationCode",At(n,e))}async function NN(n,e){return Ms(n,"POST","/v1/accounts:signInWithPhoneNumber",At(n,e))}async function DN(n,e){const t=await Ms(n,"POST","/v1/accounts:signInWithPhoneNumber",At(n,e));if(t.temporaryProof)throw cc(n,"account-exists-with-different-credential",t);return t}const VN={USER_NOT_FOUND:"user-not-found"};async function ON(n,e){const t={...e,operation:"REAUTH"};return Ms(n,"POST","/v1/accounts:signInWithPhoneNumber",At(n,t),VN)}class $o extends Gl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new $o({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new $o({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return NN(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return DN(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return ON(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a}=e;return!r&&!t&&!s&&!a?null:new $o({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a})}}function LN(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function MN(n){const e=dl(uc(n)).link,t=e?dl(uc(e)).deep_link_id:null,r=dl(uc(n)).deep_link_id;return(r?dl(uc(r)).link:null)||r||t||e||n}class Yf{constructor(e){const t=dl(uc(e)),r=t.apiKey??null,s=t.oobCode??null,a=LN(t.mode??null);ee(r&&s&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=MN(e);try{return new Yf(t)}catch{return null}}}class Ki{constructor(){this.providerId=Ki.PROVIDER_ID}static credential(e,t){return Mc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Yf.parseLink(t);return ee(r,"argument-error"),Mc._fromEmailAndCode(e,r.code,r.tenantId)}}Ki.PROVIDER_ID="password";Ki.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ki.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Fs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Kl extends Fs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ml extends Kl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ee("providerId"in t&&"signInMethod"in t,"argument-error"),ls._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return ee(e.idToken||e.accessToken,"argument-error"),ls._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return ml.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ml.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:a,nonce:l,providerId:d}=e;if(!r&&!s&&!t&&!a||!d)return null;try{return new ml(d)._credential({idToken:t,accessToken:r,nonce:l,pendingToken:a})}catch{return null}}}class Yr extends Kl{constructor(){super("facebook.com")}static credential(e){return ls._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yr.credential(e.oauthAccessToken)}catch{return null}}}Yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yr.PROVIDER_ID="facebook.com";class Xr extends Kl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ls._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Xr.credential(t,r)}catch{return null}}}Xr.GOOGLE_SIGN_IN_METHOD="google.com";Xr.PROVIDER_ID="google.com";class Zr extends Kl{constructor(){super("github.com")}static credential(e){return ls._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.GITHUB_SIGN_IN_METHOD="github.com";Zr.PROVIDER_ID="github.com";const FN="http://localhost";class Tl extends Gl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Cs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Cs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Cs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:a}=t;return!r||!s||!a||r!==s?null:new Tl(r,a)}static _create(e,t){return new Tl(e,t)}buildRequest(){return{requestUri:FN,returnSecureToken:!0,pendingToken:this.pendingToken}}}const jN="saml.";class Tf extends Fs{constructor(e){ee(e.startsWith(jN),"argument-error"),super(e)}static credentialFromResult(e){return Tf.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Tf.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Tl.fromJSON(e);return ee(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Tl._create(r,t)}catch{return null}}}class es extends Kl{constructor(){super("twitter.com")}static credential(e,t){return ls._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return es.credential(t,r)}catch{return null}}}es.TWITTER_SIGN_IN_METHOD="twitter.com";es.PROVIDER_ID="twitter.com";async function _S(n,e){return Ms(n,"POST","/v1/accounts:signUp",At(n,e))}class fr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await Ar._fromIdTokenResponse(e,r,s),l=pI(r);return new fr({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=pI(r);return new fr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function pI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function UN(n){if(ft(n.app))return Promise.reject(Xt(n));const e=Et(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new fr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await _S(e,{returnSecureToken:!0}),r=await fr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Sf extends Yt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Sf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Sf(e,t,r,s)}}function vS(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Sf._fromErrorAndOperation(n,a,e,r):a})}function wS(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function BN(n,e){const t=Ae(n);await Xf(!0,t,e);const{providerUserInfo:r}=await zC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=wS(r||[]);return t.providerData=t.providerData.filter(a=>s.has(a.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Ky(n,e,t=!1){const r=await Vs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fr._forOperation(n,"link",r)}async function Xf(n,e,t){await Lc(e);const r=wS(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ee(r.has(t)===n,e.auth,s)}async function ES(n,e,t=!1){const{auth:r}=n;if(ft(r.app))return Promise.reject(Xt(r));const s="reauthenticate";try{const a=await Vs(n,vS(r,s,e,n),t);ee(a.idToken,r,"internal-error");const l=Qf(a.idToken);ee(l,r,"internal-error");const{sub:d}=l;return ee(n.uid===d,r,"user-mismatch"),fr._forOperation(n,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&an(r,"user-mismatch"),a}}async function IS(n,e,t=!1){if(ft(n.app))return Promise.reject(Xt(n));const r="signIn",s=await vS(n,r,e),a=await fr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}async function Zf(n,e){return IS(Et(n),e)}async function TS(n,e){const t=Ae(n);return await Xf(!1,t,e.providerId),Ky(t,e)}async function SS(n,e){return ES(Ae(n),e)}async function zN(n,e){return Ms(n,"POST","/v1/accounts:signInWithCustomToken",At(n,e))}async function $N(n,e){if(ft(n.app))return Promise.reject(Xt(n));const t=Et(n),r=await zN(t,{token:e,returnSecureToken:!0}),s=await fr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}class id{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Qy._fromServerResponse(e,t):"totpInfo"in t?Jy._fromServerResponse(e,t):an(e,"internal-error")}}class Qy extends id{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Qy(t)}}class Jy extends id{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Jy(t)}}function ep(n,e,t){ee(t.url?.length>0,n,"invalid-continue-uri"),ee(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),ee(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ee(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ee(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Yy(n){const e=Et(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function qN(n,e,t){const r=Et(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&ep(r,s,t),await Ci(r,s,"getOobCode",xN,"EMAIL_PASSWORD_PROVIDER")}async function WN(n,e,t){await yS(Ae(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yy(n),r})}async function HN(n,e){await TN(Ae(n),{oobCode:e})}async function AS(n,e){const t=Ae(n),r=await yS(t,{oobCode:e}),s=r.requestType;switch(ee(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ee(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ee(r.mfaInfo,t,"internal-error");default:ee(r.email,t,"internal-error")}let a=null;return r.mfaInfo&&(a=id._fromServerResponse(Et(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:a},operation:s}}async function GN(n,e){const{data:t}=await AS(Ae(n),e);return t.email}async function KN(n,e,t){if(ft(n.app))return Promise.reject(Xt(n));const r=Et(n),l=await Ci(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_S,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&Yy(n),f}),d=await fr._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(d.user),d}function QN(n,e,t){return ft(n.app)?Promise.reject(Xt(n)):Zf(Ae(n),Ki.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yy(n),r})}async function JN(n,e,t){const r=Et(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,d){ee(d.handleCodeInApp,r,"argument-error"),d&&ep(r,l,d)}a(s,t),await Ci(r,s,"getOobCode",bN,"EMAIL_PASSWORD_PROVIDER")}function YN(n,e){return Yf.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function XN(n,e,t){if(ft(n.app))return Promise.reject(Xt(n));const r=Ae(n),s=Ki.credentialWithLink(e,t||Oc());return ee(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Zf(r,s)}async function ZN(n,e){return xt(n,"POST","/v1/accounts:createAuthUri",At(n,e))}async function e2(n,e){const t=Wy()?Oc():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await ZN(Ae(n),r);return s||[]}async function t2(n,e){const t=Ae(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&ep(t.auth,s,e);const{email:a}=await AN(t.auth,s);a!==n.email&&await n.reload()}async function n2(n,e,t){const r=Ae(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&ep(r.auth,a,t);const{email:l}=await RN(r.auth,a);l!==n.email&&await n.reload()}async function r2(n,e){return xt(n,"POST","/v1/accounts:update",e)}async function s2(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ae(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await Vs(r,r2(r.auth,a));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const d=r.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function i2(n,e){const t=Ae(n);return ft(t.auth.app)?Promise.reject(Xt(t.auth)):xS(t,e,null)}function o2(n,e){return xS(Ae(n),null,e)}async function xS(n,e,t){const{auth:r}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await Vs(n,EN(r,a));await n._updateTokensIfNecessary(l,!0)}function a2(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const s=Qf(n.idToken)?.firebase?.sign_in_provider;if(s){const a=s!=="anonymous"&&s!=="custom"?s:null;return new gl(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new l2(r,t);case"github.com":return new u2(r,t);case"google.com":return new c2(r,t);case"twitter.com":return new d2(r,t,n.screenName||null);case"custom":case"anonymous":return new gl(r,null);default:return new gl(r,e,t)}}class gl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class bS extends gl{constructor(e,t,r,s){super(e,t,r),this.username=s}}class l2 extends gl{constructor(e,t){super(e,"facebook.com",t)}}class u2 extends bS{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class c2 extends gl{constructor(e,t){super(e,"google.com",t)}}class d2 extends bS{constructor(e,t,r){super(e,"twitter.com",t,r)}}function h2(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:a2(t)}class Mo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Mo("enroll",e,t)}static _fromMfaPendingCredential(e){return new Mo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return Mo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return Mo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Xy{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Et(e),s=t.customData._serverResponse,a=(s.mfaInfo||[]).map(d=>id._fromServerResponse(r,d));ee(s.mfaPendingCredential,r,"internal-error");const l=Mo._fromMfaPendingCredential(s.mfaPendingCredential);return new Xy(l,a,async d=>{const f=await d._process(r,l);delete s.mfaInfo,delete s.mfaPendingCredential;const p={...s,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const g=await fr._fromIdTokenResponse(r,t.operationType,p);return await r._updateCurrentUser(g.user),g;case"reauthenticate":return ee(t.user,r,"internal-error"),fr._forOperation(t.user,t.operationType,p);default:an(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function f2(n,e){const t=Ae(n),r=e;return ee(e.customData.operationType,t,"argument-error"),ee(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),Xy._fromError(t,r)}function mI(n,e){return xt(n,"POST","/v2/accounts/mfaEnrollment:start",At(n,e))}function p2(n,e){return xt(n,"POST","/v2/accounts/mfaEnrollment:finalize",At(n,e))}function m2(n,e){return xt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",At(n,e))}class Zy{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>id._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Zy(e)}async getSession(){return Mo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),a=await Vs(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Vs(this.user,m2(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const _g=new WeakMap;function g2(n){const e=Ae(n);return _g.has(e)||_g.set(e,Zy._fromUser(e)),_g.get(e)}const Af="__sak";class RS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Af,"1"),this.storage.removeItem(Af),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const y2=1e3,_2=10;class PS extends RS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);XC()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_2):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},y2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}PS.type="LOCAL";const e_=PS;class kS extends RS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kS.type="SESSION";const Go=kS;function v2(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new tp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,a)),f=await v2(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tp.receivers=[];function od(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class w2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const p=od("",20);s.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(v){const T=v;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(T.data.response);break;default:clearTimeout(g),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function jt(){return window}function E2(n){jt().location.href=n}function t_(){return typeof jt().WorkerGlobalScope<"u"&&typeof jt().importScripts=="function"}async function I2(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function T2(){return navigator?.serviceWorker?.controller||null}function S2(){return t_()?self:null}const CS="firebaseLocalStorageDb",A2=1,xf="firebaseLocalStorage",NS="fbase_key";class ad{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function np(n,e){return n.transaction([xf],e?"readwrite":"readonly").objectStore(xf)}function x2(){const n=indexedDB.deleteDatabase(CS);return new ad(n).toPromise()}function Bg(){const n=indexedDB.open(CS,A2);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(xf,{keyPath:NS})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(xf)?e(r):(r.close(),await x2(),e(await Bg()))})})}async function gI(n,e,t){const r=np(n,!0).put({[NS]:e,value:t});return new ad(r).toPromise()}async function b2(n,e){const t=np(n,!1).get(e),r=await new ad(t).toPromise();return r===void 0?null:r.value}function yI(n,e){const t=np(n,!0).delete(e);return new ad(t).toPromise()}const R2=800,P2=3;class DS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>P2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return t_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tp._getInstance(S2()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await I2(),!this.activeServiceWorker)return;this.sender=new w2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||T2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bg();return await gI(e,Af,"1"),await yI(e,Af),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>gI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>b2(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>yI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=np(s,!1).getAll();return new ad(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),R2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}DS.type="LOCAL";const Fc=DS;function _I(n,e){return xt(n,"POST","/v2/accounts/mfaSignIn:start",At(n,e))}function k2(n,e){return xt(n,"POST","/v2/accounts/mfaSignIn:finalize",At(n,e))}const vg=pS("rcb"),C2=new td(3e4,6e4);class N2{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!jt().grecaptcha?.render}load(e,t=""){return ee(D2(t),e,"argument-error"),this.shouldResolveImmediately(t)&&oI(jt().grecaptcha)?Promise.resolve(jt().grecaptcha):new Promise((r,s)=>{const a=jt().setTimeout(()=>{s($t(e,"network-request-failed"))},C2.get());jt()[vg]=()=>{jt().clearTimeout(a),delete jt()[vg];const d=jt().grecaptcha;if(!d||!oI(d)){s($t(e,"internal-error"));return}const f=d.render;d.render=(p,g)=>{const v=f(p,g);return this.counter++,v},this.hostLanguage=t,r(d)};const l=`${iN()}?${Wl({onload:vg,render:"explicit",hl:t})}`;Gy(l).catch(()=>{clearTimeout(a),s($t(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!jt().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function D2(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class V2{async load(e){return new cN(e)}clearedOneInstance(){}}const wc="recaptcha",O2={theme:"light",type:"image"};let L2=class{constructor(e,t,r={...O2}){this.parameters=r,this.type=wc,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Et(e),this.isInvisible=this.parameters.size==="invisible",ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ee(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new V2:new N2,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),s(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ee(!this.parameters.sitekey,this.auth,"argument-error"),ee(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=jt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ee(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ee(Wy()&&!t_(),this.auth,"internal-error"),await M2(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await UC(this.auth);ee(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ee(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function M2(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class n_{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=$o._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function F2(n,e,t){if(ft(n.app))return Promise.reject(Xt(n));const r=Et(n),s=await rp(r,e,Ae(t));return new n_(s,a=>Zf(r,a))}async function j2(n,e,t){const r=Ae(n);await Xf(!1,r,"phone");const s=await rp(r.auth,e,Ae(t));return new n_(s,a=>TS(r,a))}async function U2(n,e,t){const r=Ae(n);if(ft(r.auth.app))return Promise.reject(Xt(r.auth));const s=await rp(r.auth,e,Ae(t));return new n_(s,a=>SS(r,a))}async function rp(n,e,t){if(!n._getRecaptchaConfig())try{await gN(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const s=r.session;if("phoneNumber"in r){ee(s.type==="enroll",n,"internal-error");const a={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Ci(n,a,"mfaSmsEnrollment",async(p,g)=>{if(g.phoneEnrollmentInfo.captchaResponse===vc){ee(t?.type===wc,p,"argument-error");const v=await wg(p,g,t);return mI(p,v)}return mI(p,g)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{ee(s.type==="signin",n,"internal-error");const a=r.multiFactorHint?.uid||r.multiFactorUid;ee(a,n,"missing-multi-factor-info");const l={mfaPendingCredential:s.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Ci(n,l,"mfaSmsSignIn",async(g,v)=>{if(v.phoneSignInInfo.captchaResponse===vc){ee(t?.type===wc,g,"argument-error");const T=await wg(g,v,t);return _I(g,T)}return _I(g,v)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Ci(n,s,"sendVerificationCode",async(f,p)=>{if(p.captchaResponse===vc){ee(t?.type===wc,f,"argument-error");const g=await wg(f,p,t);return fI(f,g)}return fI(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function B2(n,e){const t=Ae(n);if(ft(t.auth.app))return Promise.reject(Xt(t.auth));await Ky(t,e)}async function wg(n,e,t){ee(t.type===wc,n,"argument-error");const r=await t.verify();ee(typeof r=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const a=s.phoneEnrollmentInfo.phoneNumber,l=s.phoneEnrollmentInfo.captchaResponse,d=s.phoneEnrollmentInfo.clientType,f=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r,captchaResponse:l,clientType:d,recaptchaVersion:f}}),s}else if("phoneSignInInfo"in s){const a=s.phoneSignInInfo.captchaResponse,l=s.phoneSignInInfo.clientType,d=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:a,clientType:l,recaptchaVersion:d}}),s}else return Object.assign(s,{recaptchaToken:r}),s}let Ko=class Zh{constructor(e){this.providerId=Zh.PROVIDER_ID,this.auth=Et(e)}verifyPhoneNumber(e,t){return rp(this.auth,e,Ae(t))}static credential(e,t){return $o._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Zh.credentialFromTaggedObject(t)}static credentialFromError(e){return Zh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?$o._fromTokenResponse(t,r):null}};Ko.PROVIDER_ID="phone";Ko.PHONE_SIGN_IN_METHOD="phone";function aa(n,e){return e?Xn(e):(ee(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class r_ extends Gl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Cs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Cs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function z2(n){return IS(n.auth,new r_(n),n.bypassAuthState)}function $2(n){const{auth:e,user:t}=n;return ee(t,e,"internal-error"),ES(t,new r_(n),n.bypassAuthState)}async function q2(n){const{auth:e,user:t}=n;return ee(t,e,"internal-error"),Ky(t,new r_(n),n.bypassAuthState)}class VS{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return z2;case"linkViaPopup":case"linkViaRedirect":return q2;case"reauthViaPopup":case"reauthViaRedirect":return $2;default:an(this.auth,"internal-error")}}resolve(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const W2=new td(2e3,1e4);async function H2(n,e,t){if(ft(n.app))return Promise.reject($t(n,"operation-not-supported-in-this-environment"));const r=Et(n);Hl(n,e,Fs);const s=aa(r,t);return new Ps(r,"signInViaPopup",e,s).executeNotNull()}async function G2(n,e,t){const r=Ae(n);if(ft(r.auth.app))return Promise.reject($t(r.auth,"operation-not-supported-in-this-environment"));Hl(r.auth,e,Fs);const s=aa(r.auth,t);return new Ps(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function K2(n,e,t){const r=Ae(n);Hl(r.auth,e,Fs);const s=aa(r.auth,t);return new Ps(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Ps extends VS{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Ps.currentPopupAction&&Ps.currentPopupAction.cancel(),Ps.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){Rr(this.filter.length===1,"Popup operations only handle one event");const e=od();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($t(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ps.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($t(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,W2.get())};e()}}Ps.currentPopupAction=null;const Q2="pendingRedirect",Ec=new Map;class J2 extends VS{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ec.get(this.auth._key());if(!e){try{const r=await Y2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ec.set(this.auth._key(),e)}return this.bypassAuthState||Ec.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Y2(n,e){const t=LS(e),r=OS(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function s_(n,e){return OS(n)._set(LS(e),"true")}function X2(){Ec.clear()}function i_(n,e){Ec.set(n._key(),e)}function OS(n){return Xn(n._redirectPersistence)}function LS(n){return zo(Q2,n.config.apiKey,n.name)}function Z2(n,e,t){return eD(n,e,t)}async function eD(n,e,t){if(ft(n.app))return Promise.reject(Xt(n));const r=Et(n);Hl(n,e,Fs),await r._initializationPromise;const s=aa(r,t);return await s_(s,r),s._openRedirect(r,e,"signInViaRedirect")}function tD(n,e,t){return nD(n,e,t)}async function nD(n,e,t){const r=Ae(n);if(Hl(r.auth,e,Fs),ft(r.auth.app))return Promise.reject(Xt(r.auth));await r.auth._initializationPromise;const s=aa(r.auth,t);await s_(s,r.auth);const a=await MS(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",a)}function rD(n,e,t){return sD(n,e,t)}async function sD(n,e,t){const r=Ae(n);Hl(r.auth,e,Fs),await r.auth._initializationPromise;const s=aa(r.auth,t);await Xf(!1,r,e.providerId),await s_(s,r.auth);const a=await MS(r);return s._openRedirect(r.auth,e,"linkViaRedirect",a)}async function iD(n,e){return await Et(n)._initializationPromise,sp(n,e,!1)}async function sp(n,e,t=!1){if(ft(n.app))return Promise.reject(Xt(n));const r=Et(n),s=aa(r,e),l=await new J2(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}async function MS(n){const e=od(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const oD=600*1e3;class FS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!jS(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError($t(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=oD&&this.cachedEventUids.clear(),this.cachedEventUids.has(vI(e))}saveEventToCache(e){this.cachedEventUids.add(vI(e)),this.lastProcessedEventTime=Date.now()}}function vI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function jS({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function aD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jS(n);default:return!1}}async function US(n,e={}){return xt(n,"GET","/v1/projects",e)}const lD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uD=/^https?/;async function cD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await US(n);for(const t of e)try{if(dD(t))return}catch{}an(n,"unauthorized-domain")}function dD(n){const e=Oc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!uD.test(t))return!1;if(lD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const hD=new td(3e4,6e4);function wI(){const n=jt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function fD(n){return new Promise((e,t)=>{function r(){wI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wI(),t($t(n,"network-request-failed"))},timeout:hD.get()})}if(jt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(jt().gapi?.load)r();else{const s=pS("iframefcb");return jt()[s]=()=>{gapi.load?r():t($t(n,"network-request-failed"))},Gy(`${aN()}?onload=${s}`).catch(a=>t(a))}}).catch(e=>{throw ef=null,e})}let ef=null;function pD(n){return ef=ef||fD(n),ef}const mD=new td(5e3,15e3),gD="__/auth/iframe",yD="emulator/auth/iframe",_D={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wD(n){const e=n.config;ee(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Hy(e,yD):`https://${n.config.authDomain}/${gD}`,r={apiKey:e.apiKey,appName:n.name,v:Gi},s=vD.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Wl(r).slice(1)}`}async function ED(n){const e=await pD(n),t=jt().gapi;return ee(t,n,"internal-error"),e.open({where:document.body,url:wD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_D,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=$t(n,"network-request-failed"),d=jt().setTimeout(()=>{a(l)},mD.get());function f(){jt().clearTimeout(d),s(r)}r.ping(f).then(f,()=>{a(l)})}))}const ID={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},TD=500,SD=600,AD="_blank",xD="http://localhost";class EI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bD(n,e,t,r=TD,s=SD){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f={...ID,width:r.toString(),height:s.toString(),top:a,left:l},p=wt().toLowerCase();t&&(d=lS(p)?AD:t),oS(p)&&(e=e||xD,f.scrollbars="yes");const g=Object.entries(f).reduce((T,[C,x])=>`${T}${C}=${x},`,"");if(YC(p)&&d!=="_self")return RD(e||"",d),new EI(null);const v=window.open(e||"",d,g);ee(v,n,"popup-blocked");try{v.focus()}catch{}return new EI(v)}function RD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const PD="__/auth/handler",kD="emulator/auth/handler",CD=encodeURIComponent("fac");async function zg(n,e,t,r,s,a){ee(n.config.authDomain,n,"auth-domain-config-required"),ee(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Gi,eventId:s};if(e instanceof Fs){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",sk(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,v]of Object.entries(a||{}))l[g]=v}if(e instanceof Kl){const g=e.getScopes().filter(v=>v!=="");g.length>0&&(l.scopes=g.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const f=await n._getAppCheckToken(),p=f?`#${CD}=${encodeURIComponent(f)}`:"";return`${ND(n)}?${Wl(d).slice(1)}${p}`}function ND({config:n}){return n.emulator?Hy(n,kD):`https://${n.authDomain}/${PD}`}const Eg="webStorageSupport";class DD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Go,this._completeRedirectFn=sp,this._overrideRedirectResult=i_}async _openPopup(e,t,r,s){Rr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await zg(e,t,r,Oc(),s);return bD(e,a,od())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await zg(e,t,r,Oc(),s);return E2(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(Rr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await ED(e),r=new FS(e);return t.register("authEvent",s=>(ee(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Eg,{type:Eg},s=>{const a=s?.[0]?.[Eg];a!==void 0&&t(!!a),an(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hS()||aS()||rd()}}const VD=DD;class OD{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ns("unexpected MultiFactorSessionType")}}}class o_ extends OD{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new o_(e)}_finalizeEnroll(e,t,r){return p2(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return k2(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class BS{constructor(){}static assertion(e){return o_._fromCredential(e)}}BS.FACTOR_ID="phone";var II="@firebase/auth",TI="1.12.0";class LD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function MD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FD(n){Ds(new hr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;ee(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fS(n)},p=new rN(r,s,a,f);return yN(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ds(new hr("auth-internal",e=>{const t=Et(e.getProvider("auth").getImmediate());return(r=>new LD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),er(II,TI,MD(n)),er(II,TI,"esm2020")}const jD=300;HP("authIdTokenMaxAge");function UD(){return document.getElementsByTagName("head")?.[0]??document}sN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=$t("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",UD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FD("Browser");function Qo(){return window}const BD=2e3;async function zD(n,e,t){const{BuildInfo:r}=Qo();Rr(e.sessionId,"AuthEvent did not contain a session ID");const s=await GD(e.sessionId),a={};return rd()?a.ibi=r.packageName:nd()?a.apn=r.packageName:an(n,"operation-not-supported-in-this-environment"),r.displayName&&(a.appDisplayName=r.displayName),a.sessionId=s,zg(n,t,e.type,void 0,e.eventId??void 0,a)}async function $D(n){const{BuildInfo:e}=Qo(),t={};rd()?t.iosBundleId=e.packageName:nd()?t.androidPackageName=e.packageName:an(n,"operation-not-supported-in-this-environment"),await US(n,t)}function qD(n){const{cordova:e}=Qo();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,JC()?"_blank":"_system","location=yes"),t(s)})})}async function WD(n,e,t){const{cordova:r}=Qo();let s=()=>{};try{await new Promise((a,l)=>{let d=null;function f(){a();const v=r.plugins.browsertab?.close;typeof v=="function"&&v(),typeof t?.close=="function"&&t.close()}function p(){d||(d=window.setTimeout(()=>{l($t(n,"redirect-cancelled-by-user"))},BD))}function g(){document?.visibilityState==="visible"&&p()}e.addPassiveListener(f),document.addEventListener("resume",p,!1),nd()&&document.addEventListener("visibilitychange",g,!1),s=()=>{e.removePassiveListener(f),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",g,!1),d&&window.clearTimeout(d)}})}finally{s()}}function HD(n){const e=Qo();ee(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ee(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ee(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function GD(n){const e=KD(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function KD(n){if(Rr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const QD=20;class JD extends FS{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function YD(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:eV(),postBody:null,tenantId:n.tenantId,error:$t(n,"no-auth-event")}}function XD(n,e){return $g()._set(qg(n),e)}async function SI(n){const e=await $g()._get(qg(n));return e&&await $g()._remove(qg(n)),e}function ZD(n,e){const t=nV(e);if(t.includes("/__/auth/callback")){const r=tf(t),a=(r.firebaseError?tV(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],l=a?$t(a):null;return l?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function eV(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<QD;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function $g(){return Xn(e_)}function qg(n){return zo("authEvent",n.config.apiKey,n.name)}function tV(n){try{return JSON.parse(n)}catch{return null}}function nV(n){const e=tf(n),t=e.link?decodeURIComponent(e.link):void 0,r=tf(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return tf(s).link||s||r||t||n}function tf(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return dl(t.join("?"))}const rV=500;class sV{constructor(){this._redirectPersistence=Go,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=sp,this._overrideRedirectResult=i_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new JD(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){an(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,s){HD(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),X2(),await this._originValidation(e);const l=YD(e,r,s);await XD(e,l);const d=await zD(e,l,t),f=await qD(d);return WD(e,a,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$D(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:s,BuildInfo:a}=Qo(),l=setTimeout(async()=>{await SI(e),t.onEvent(AI())},rV),d=async g=>{clearTimeout(l);const v=await SI(e);let T=null;v&&g?.url&&(T=ZD(v,g.url)),t.onEvent(T||AI())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,d);const f=s,p=`${a.packageName.toLowerCase()}://`;Qo().handleOpenURL=async g=>{if(g.toLowerCase().startsWith(p)&&d({url:g}),typeof f=="function")try{f(g)}catch(v){console.error(v)}}}}const iV=sV;function AI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:$t("no-auth-event")}}function oV(n,e){Et(n)._logFramework(e)}var aV="@firebase/auth-compat",lV="0.6.2";const uV=1e3;function Ic(){return self?.location?.protocol||null}function cV(){return Ic()==="http:"||Ic()==="https:"}function zS(n=wt()){return!!((Ic()==="file:"||Ic()==="ionic:"||Ic()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function dV(){return My()||Gf()}function hV(){return V0()&&document?.documentMode===11}function fV(n=wt()){return/Edge\/\d+/.test(n)}function pV(n=wt()){return hV()||fV(n)}function $S(){try{const n=self.localStorage,e=od();if(n)return n.setItem(e,"1"),n.removeItem(e),pV()?Nc():!0}catch{return a_()&&Nc()}return!1}function a_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Ig(){return(cV()||D0()||zS())&&!dV()&&$S()&&!a_()}function qS(){return zS()&&typeof document<"u"}async function mV(){return qS()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},uV);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function gV(){return typeof window<"u"?window:null}const Yn={LOCAL:"local",NONE:"none",SESSION:"session"},tc=ee,WS="persistence";function yV(n,e){if(tc(Object.values(Yn).includes(e),n,"invalid-persistence-type"),My()){tc(e!==Yn.SESSION,n,"unsupported-persistence-type");return}if(Gf()){tc(e===Yn.NONE,n,"unsupported-persistence-type");return}if(a_()){tc(e===Yn.NONE||e===Yn.LOCAL&&Nc(),n,"unsupported-persistence-type");return}tc(e===Yn.NONE||$S(),n,"unsupported-persistence-type")}async function Wg(n){await n._initializationPromise;const e=HS(),t=zo(WS,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function _V(n,e){const t=HS();if(!t)return[];const r=zo(WS,n,e);switch(t.getItem(r)){case Yn.NONE:return[Il];case Yn.LOCAL:return[Fc,Go];case Yn.SESSION:return[Go];default:return[]}}function HS(){try{return gV()?.sessionStorage||null}catch{return null}}const vV=ee;class bi{constructor(){this.browserResolver=Xn(VD),this.cordovaResolver=Xn(iV),this.underlyingResolver=null,this._redirectPersistence=Go,this._completeRedirectFn=sp,this._overrideRedirectResult=i_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,s)}async _openRedirect(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return qS()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return vV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await mV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function GS(n){return n.unwrap()}function wV(n){return n.wrapped()}function EV(n){return KS(n)}function IV(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new TV(n,f2(n,e))}else if(t){const r=KS(e),s=e;r&&(s.credential=r,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function KS(n){const{_tokenResponse:e}=n instanceof Yt?n.customData:n;if(!e)return null;if(!(n instanceof Yt)&&"temporaryProof"in e&&"phoneNumber"in e)return Ko.credentialFromResult(n);const t=e.providerId;if(!t||t===Zu.PASSWORD)return null;let r;switch(t){case Zu.GOOGLE:r=Xr;break;case Zu.FACEBOOK:r=Yr;break;case Zu.GITHUB:r=Zr;break;case Zu.TWITTER:r=es;break;default:const{oauthIdToken:s,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:d,nonce:f}=e;return!a&&!l&&!s&&!d?null:d?t.startsWith("saml.")?Tl._create(t,d):ls._fromParams({providerId:t,signInMethod:t,pendingToken:d,idToken:s,accessToken:a}):new ml(t).credential({idToken:s,accessToken:a,rawNonce:f})}return n instanceof Yt?r.credentialFromError(n):r.credentialFromResult(n)}function Dn(n,e){return e.catch(t=>{throw t instanceof Yt&&IV(n,t),t}).then(t=>{const r=t.operationType,s=t.user;return{operationType:r,credential:EV(t),additionalUserInfo:h2(t),user:ip.getOrCreate(s)}})}async function Hg(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Dn(n,t.confirm(r))}}class TV{constructor(e,t){this.resolver=t,this.auth=wV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Dn(GS(this.auth),this.resolver.resolveSignIn(e))}}let ip=class dc{constructor(e){this._delegate=e,this.multiFactor=g2(e)}static getOrCreate(e){return dc.USER_MAP.has(e)||dc.USER_MAP.set(e,new dc(e)),dc.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Dn(this.auth,TS(this._delegate,e))}async linkWithPhoneNumber(e,t){return Hg(this.auth,j2(this._delegate,e,t))}async linkWithPopup(e){return Dn(this.auth,K2(this._delegate,e,bi))}async linkWithRedirect(e){return await Wg(Et(this.auth)),rD(this._delegate,e,bi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Dn(this.auth,SS(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Hg(this.auth,U2(this._delegate,e,t))}reauthenticateWithPopup(e){return Dn(this.auth,G2(this._delegate,e,bi))}async reauthenticateWithRedirect(e){return await Wg(Et(this.auth)),tD(this._delegate,e,bi)}sendEmailVerification(e){return t2(this._delegate,e)}async unlink(e){return await BN(this._delegate,e),this}updateEmail(e){return i2(this._delegate,e)}updatePassword(e){return o2(this._delegate,e)}updatePhoneNumber(e){return B2(this._delegate,e)}updateProfile(e){return s2(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return n2(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};ip.USER_MAP=new WeakMap;const nc=ee;class Gg{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;nc(r,"invalid-api-key",{appName:e.name}),nc(r,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?bi:void 0;this._delegate=t.initialize({options:{persistence:SV(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(kC),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ip.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){_N(this._delegate,e,t)}applyActionCode(e){return HN(this._delegate,e)}checkActionCode(e){return AS(this._delegate,e)}confirmPasswordReset(e,t){return WN(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Dn(this._delegate,KN(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return e2(this._delegate,e)}isSignInWithEmailLink(e){return YN(this._delegate,e)}async getRedirectResult(){nc(Ig(),this._delegate,"operation-not-supported-in-this-environment");const e=await iD(this._delegate,bi);return e?Dn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){oV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:s,error:a,complete:l}=xI(e,t,r);return this._delegate.onAuthStateChanged(s,a,l)}onIdTokenChanged(e,t,r){const{next:s,error:a,complete:l}=xI(e,t,r);return this._delegate.onIdTokenChanged(s,a,l)}sendSignInLinkToEmail(e,t){return JN(this._delegate,e,t)}sendPasswordResetEmail(e,t){return qN(this._delegate,e,t||void 0)}async setPersistence(e){yV(this._delegate,e);let t;switch(e){case Yn.SESSION:t=Go;break;case Yn.LOCAL:t=await Xn(Fc)._isAvailable()?Fc:e_;break;case Yn.NONE:t=Il;break;default:return an("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Dn(this._delegate,UN(this._delegate))}signInWithCredential(e){return Dn(this._delegate,Zf(this._delegate,e))}signInWithCustomToken(e){return Dn(this._delegate,$N(this._delegate,e))}signInWithEmailAndPassword(e,t){return Dn(this._delegate,QN(this._delegate,e,t))}signInWithEmailLink(e,t){return Dn(this._delegate,XN(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Hg(this._delegate,F2(this._delegate,e,t))}async signInWithPopup(e){return nc(Ig(),this._delegate,"operation-not-supported-in-this-environment"),Dn(this._delegate,H2(this._delegate,e,bi))}async signInWithRedirect(e){return nc(Ig(),this._delegate,"operation-not-supported-in-this-environment"),await Wg(this._delegate),Z2(this._delegate,e,bi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return GN(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Gg.Persistence=Yn;function xI(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const s=r;return{next:l=>s(l&&ip.getOrCreate(l)),error:e,complete:t}}function SV(n,e){const t=_V(n,e);if(typeof self<"u"&&!t.includes(Fc)&&t.push(Fc),typeof window<"u")for(const r of[e_,Go])t.includes(r)||t.push(r);return t.includes(Il)||t.push(Il),t}class l_{static credential(e,t){return Ko.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ko(GS(yn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}l_.PHONE_SIGN_IN_METHOD=Ko.PHONE_SIGN_IN_METHOD;l_.PROVIDER_ID=Ko.PROVIDER_ID;const AV=ee;class xV{constructor(e,t,r=yn.app()){AV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new L2(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const bV="auth-compat";function RV(n){n.INTERNAL.registerComponent(new hr(bV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Gg(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Za.EMAIL_SIGNIN,PASSWORD_RESET:Za.PASSWORD_RESET,RECOVER_EMAIL:Za.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Za.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Za.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Za.VERIFY_EMAIL}},EmailAuthProvider:Ki,FacebookAuthProvider:Yr,GithubAuthProvider:Zr,GoogleAuthProvider:Xr,OAuthProvider:ml,SAMLAuthProvider:Tf,PhoneAuthProvider:l_,PhoneMultiFactorGenerator:BS,RecaptchaVerifier:xV,TwitterAuthProvider:es,Auth:Gg,AuthCredential:Gl,Error:Yt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(aV,lV)}RV(yn);var bI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ni,QS;(function(){var n;function e(R,b){function A(){}A.prototype=b.prototype,R.F=b.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(N,D,j){for(var k=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)k[Be-2]=arguments[Be];return b.prototype[D].apply(N,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,b,A){A||(A=0);const N=Array(16);if(typeof b=="string")for(var D=0;D<16;++D)N[D]=b.charCodeAt(A++)|b.charCodeAt(A++)<<8|b.charCodeAt(A++)<<16|b.charCodeAt(A++)<<24;else for(D=0;D<16;++D)N[D]=b[A++]|b[A++]<<8|b[A++]<<16|b[A++]<<24;b=R.g[0],A=R.g[1],D=R.g[2];let j=R.g[3],k;k=b+(j^A&(D^j))+N[0]+3614090360&4294967295,b=A+(k<<7&4294967295|k>>>25),k=j+(D^b&(A^D))+N[1]+3905402710&4294967295,j=b+(k<<12&4294967295|k>>>20),k=D+(A^j&(b^A))+N[2]+606105819&4294967295,D=j+(k<<17&4294967295|k>>>15),k=A+(b^D&(j^b))+N[3]+3250441966&4294967295,A=D+(k<<22&4294967295|k>>>10),k=b+(j^A&(D^j))+N[4]+4118548399&4294967295,b=A+(k<<7&4294967295|k>>>25),k=j+(D^b&(A^D))+N[5]+1200080426&4294967295,j=b+(k<<12&4294967295|k>>>20),k=D+(A^j&(b^A))+N[6]+2821735955&4294967295,D=j+(k<<17&4294967295|k>>>15),k=A+(b^D&(j^b))+N[7]+4249261313&4294967295,A=D+(k<<22&4294967295|k>>>10),k=b+(j^A&(D^j))+N[8]+1770035416&4294967295,b=A+(k<<7&4294967295|k>>>25),k=j+(D^b&(A^D))+N[9]+2336552879&4294967295,j=b+(k<<12&4294967295|k>>>20),k=D+(A^j&(b^A))+N[10]+4294925233&4294967295,D=j+(k<<17&4294967295|k>>>15),k=A+(b^D&(j^b))+N[11]+2304563134&4294967295,A=D+(k<<22&4294967295|k>>>10),k=b+(j^A&(D^j))+N[12]+1804603682&4294967295,b=A+(k<<7&4294967295|k>>>25),k=j+(D^b&(A^D))+N[13]+4254626195&4294967295,j=b+(k<<12&4294967295|k>>>20),k=D+(A^j&(b^A))+N[14]+2792965006&4294967295,D=j+(k<<17&4294967295|k>>>15),k=A+(b^D&(j^b))+N[15]+1236535329&4294967295,A=D+(k<<22&4294967295|k>>>10),k=b+(D^j&(A^D))+N[1]+4129170786&4294967295,b=A+(k<<5&4294967295|k>>>27),k=j+(A^D&(b^A))+N[6]+3225465664&4294967295,j=b+(k<<9&4294967295|k>>>23),k=D+(b^A&(j^b))+N[11]+643717713&4294967295,D=j+(k<<14&4294967295|k>>>18),k=A+(j^b&(D^j))+N[0]+3921069994&4294967295,A=D+(k<<20&4294967295|k>>>12),k=b+(D^j&(A^D))+N[5]+3593408605&4294967295,b=A+(k<<5&4294967295|k>>>27),k=j+(A^D&(b^A))+N[10]+38016083&4294967295,j=b+(k<<9&4294967295|k>>>23),k=D+(b^A&(j^b))+N[15]+3634488961&4294967295,D=j+(k<<14&4294967295|k>>>18),k=A+(j^b&(D^j))+N[4]+3889429448&4294967295,A=D+(k<<20&4294967295|k>>>12),k=b+(D^j&(A^D))+N[9]+568446438&4294967295,b=A+(k<<5&4294967295|k>>>27),k=j+(A^D&(b^A))+N[14]+3275163606&4294967295,j=b+(k<<9&4294967295|k>>>23),k=D+(b^A&(j^b))+N[3]+4107603335&4294967295,D=j+(k<<14&4294967295|k>>>18),k=A+(j^b&(D^j))+N[8]+1163531501&4294967295,A=D+(k<<20&4294967295|k>>>12),k=b+(D^j&(A^D))+N[13]+2850285829&4294967295,b=A+(k<<5&4294967295|k>>>27),k=j+(A^D&(b^A))+N[2]+4243563512&4294967295,j=b+(k<<9&4294967295|k>>>23),k=D+(b^A&(j^b))+N[7]+1735328473&4294967295,D=j+(k<<14&4294967295|k>>>18),k=A+(j^b&(D^j))+N[12]+2368359562&4294967295,A=D+(k<<20&4294967295|k>>>12),k=b+(A^D^j)+N[5]+4294588738&4294967295,b=A+(k<<4&4294967295|k>>>28),k=j+(b^A^D)+N[8]+2272392833&4294967295,j=b+(k<<11&4294967295|k>>>21),k=D+(j^b^A)+N[11]+1839030562&4294967295,D=j+(k<<16&4294967295|k>>>16),k=A+(D^j^b)+N[14]+4259657740&4294967295,A=D+(k<<23&4294967295|k>>>9),k=b+(A^D^j)+N[1]+2763975236&4294967295,b=A+(k<<4&4294967295|k>>>28),k=j+(b^A^D)+N[4]+1272893353&4294967295,j=b+(k<<11&4294967295|k>>>21),k=D+(j^b^A)+N[7]+4139469664&4294967295,D=j+(k<<16&4294967295|k>>>16),k=A+(D^j^b)+N[10]+3200236656&4294967295,A=D+(k<<23&4294967295|k>>>9),k=b+(A^D^j)+N[13]+681279174&4294967295,b=A+(k<<4&4294967295|k>>>28),k=j+(b^A^D)+N[0]+3936430074&4294967295,j=b+(k<<11&4294967295|k>>>21),k=D+(j^b^A)+N[3]+3572445317&4294967295,D=j+(k<<16&4294967295|k>>>16),k=A+(D^j^b)+N[6]+76029189&4294967295,A=D+(k<<23&4294967295|k>>>9),k=b+(A^D^j)+N[9]+3654602809&4294967295,b=A+(k<<4&4294967295|k>>>28),k=j+(b^A^D)+N[12]+3873151461&4294967295,j=b+(k<<11&4294967295|k>>>21),k=D+(j^b^A)+N[15]+530742520&4294967295,D=j+(k<<16&4294967295|k>>>16),k=A+(D^j^b)+N[2]+3299628645&4294967295,A=D+(k<<23&4294967295|k>>>9),k=b+(D^(A|~j))+N[0]+4096336452&4294967295,b=A+(k<<6&4294967295|k>>>26),k=j+(A^(b|~D))+N[7]+1126891415&4294967295,j=b+(k<<10&4294967295|k>>>22),k=D+(b^(j|~A))+N[14]+2878612391&4294967295,D=j+(k<<15&4294967295|k>>>17),k=A+(j^(D|~b))+N[5]+4237533241&4294967295,A=D+(k<<21&4294967295|k>>>11),k=b+(D^(A|~j))+N[12]+1700485571&4294967295,b=A+(k<<6&4294967295|k>>>26),k=j+(A^(b|~D))+N[3]+2399980690&4294967295,j=b+(k<<10&4294967295|k>>>22),k=D+(b^(j|~A))+N[10]+4293915773&4294967295,D=j+(k<<15&4294967295|k>>>17),k=A+(j^(D|~b))+N[1]+2240044497&4294967295,A=D+(k<<21&4294967295|k>>>11),k=b+(D^(A|~j))+N[8]+1873313359&4294967295,b=A+(k<<6&4294967295|k>>>26),k=j+(A^(b|~D))+N[15]+4264355552&4294967295,j=b+(k<<10&4294967295|k>>>22),k=D+(b^(j|~A))+N[6]+2734768916&4294967295,D=j+(k<<15&4294967295|k>>>17),k=A+(j^(D|~b))+N[13]+1309151649&4294967295,A=D+(k<<21&4294967295|k>>>11),k=b+(D^(A|~j))+N[4]+4149444226&4294967295,b=A+(k<<6&4294967295|k>>>26),k=j+(A^(b|~D))+N[11]+3174756917&4294967295,j=b+(k<<10&4294967295|k>>>22),k=D+(b^(j|~A))+N[2]+718787259&4294967295,D=j+(k<<15&4294967295|k>>>17),k=A+(j^(D|~b))+N[9]+3951481745&4294967295,R.g[0]=R.g[0]+b&4294967295,R.g[1]=R.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+j&4294967295}r.prototype.v=function(R,b){b===void 0&&(b=R.length);const A=b-this.blockSize,N=this.C;let D=this.h,j=0;for(;j<b;){if(D==0)for(;j<=A;)s(this,R,j),j+=this.blockSize;if(typeof R=="string"){for(;j<b;)if(N[D++]=R.charCodeAt(j++),D==this.blockSize){s(this,N),D=0;break}}else for(;j<b;)if(N[D++]=R[j++],D==this.blockSize){s(this,N),D=0;break}}this.h=D,this.o+=b},r.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var b=1;b<R.length-8;++b)R[b]=0;b=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=b&255,b/=256;for(this.v(R),R=Array(16),b=0,A=0;A<4;++A)for(let N=0;N<32;N+=8)R[b++]=this.g[A]>>>N&255;return R};function a(R,b){var A=d;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=b(R)}function l(R,b){this.h=b;const A=[];let N=!0;for(let D=R.length-1;D>=0;D--){const j=R[D]|0;N&&j==b||(A[D]=j,N=!1)}this.g=A}var d={};function f(R){return-128<=R&&R<128?a(R,function(b){return new l([b|0],b<0?-1:0)}):new l([R|0],R<0?-1:0)}function p(R){if(isNaN(R)||!isFinite(R))return v;if(R<0)return L(p(-R));const b=[];let A=1;for(let N=0;R>=A;N++)b[N]=R/A|0,A*=4294967296;return new l(b,0)}function g(R,b){if(R.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(R.charAt(0)=="-")return L(g(R.substring(1),b));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=p(Math.pow(b,8));let N=v;for(let j=0;j<R.length;j+=8){var D=Math.min(8,R.length-j);const k=parseInt(R.substring(j,j+D),b);D<8?(D=p(Math.pow(b,D)),N=N.j(D).add(p(k))):(N=N.j(A),N=N.add(p(k)))}return N}var v=f(0),T=f(1),C=f(16777216);n=l.prototype,n.m=function(){if(O(this))return-L(this).m();let R=0,b=1;for(let A=0;A<this.g.length;A++){const N=this.i(A);R+=(N>=0?N:4294967296+N)*b,b*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(x(this))return"0";if(O(this))return"-"+L(this).toString(R);const b=p(Math.pow(R,6));var A=this;let N="";for(;;){const D=re(A,b).g;A=ne(A,D.j(b));let j=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,x(A))return j+N;for(;j.length<6;)j="0"+j;N=j+N}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function x(R){if(R.h!=0)return!1;for(let b=0;b<R.g.length;b++)if(R.g[b]!=0)return!1;return!0}function O(R){return R.h==-1}n.l=function(R){return R=ne(this,R),O(R)?-1:x(R)?0:1};function L(R){const b=R.g.length,A=[];for(let N=0;N<b;N++)A[N]=~R.g[N];return new l(A,~R.h).add(T)}n.abs=function(){return O(this)?L(this):this},n.add=function(R){const b=Math.max(this.g.length,R.g.length),A=[];let N=0;for(let D=0;D<=b;D++){let j=N+(this.i(D)&65535)+(R.i(D)&65535),k=(j>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);N=k>>>16,j&=65535,k&=65535,A[D]=k<<16|j}return new l(A,A[A.length-1]&-2147483648?-1:0)};function ne(R,b){return R.add(L(b))}n.j=function(R){if(x(this)||x(R))return v;if(O(this))return O(R)?L(this).j(L(R)):L(L(this).j(R));if(O(R))return L(this.j(L(R)));if(this.l(C)<0&&R.l(C)<0)return p(this.m()*R.m());const b=this.g.length+R.g.length,A=[];for(var N=0;N<2*b;N++)A[N]=0;for(N=0;N<this.g.length;N++)for(let D=0;D<R.g.length;D++){const j=this.i(N)>>>16,k=this.i(N)&65535,Be=R.i(D)>>>16,rt=R.i(D)&65535;A[2*N+2*D]+=k*rt,oe(A,2*N+2*D),A[2*N+2*D+1]+=j*rt,oe(A,2*N+2*D+1),A[2*N+2*D+1]+=k*Be,oe(A,2*N+2*D+1),A[2*N+2*D+2]+=j*Be,oe(A,2*N+2*D+2)}for(R=0;R<b;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=b;R<2*b;R++)A[R]=0;return new l(A,0)};function oe(R,b){for(;(R[b]&65535)!=R[b];)R[b+1]+=R[b]>>>16,R[b]&=65535,b++}function Z(R,b){this.g=R,this.h=b}function re(R,b){if(x(b))throw Error("division by zero");if(x(R))return new Z(v,v);if(O(R))return b=re(L(R),b),new Z(L(b.g),L(b.h));if(O(b))return b=re(R,L(b)),new Z(L(b.g),b.h);if(R.g.length>30){if(O(R)||O(b))throw Error("slowDivide_ only works with positive integers.");for(var A=T,N=b;N.l(R)<=0;)A=de(A),N=de(N);var D=le(A,1),j=le(N,1);for(N=le(N,2),A=le(A,2);!x(N);){var k=j.add(N);k.l(R)<=0&&(D=D.add(A),j=k),N=le(N,1),A=le(A,1)}return b=ne(R,D.j(b)),new Z(D,b)}for(D=v;R.l(b)>=0;){for(A=Math.max(1,Math.floor(R.m()/b.m())),N=Math.ceil(Math.log(A)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),j=p(A),k=j.j(b);O(k)||k.l(R)>0;)A-=N,j=p(A),k=j.j(b);x(j)&&(j=T),D=D.add(j),R=ne(R,k)}return new Z(D,R)}n.B=function(R){return re(this,R).h},n.and=function(R){const b=Math.max(this.g.length,R.g.length),A=[];for(let N=0;N<b;N++)A[N]=this.i(N)&R.i(N);return new l(A,this.h&R.h)},n.or=function(R){const b=Math.max(this.g.length,R.g.length),A=[];for(let N=0;N<b;N++)A[N]=this.i(N)|R.i(N);return new l(A,this.h|R.h)},n.xor=function(R){const b=Math.max(this.g.length,R.g.length),A=[];for(let N=0;N<b;N++)A[N]=this.i(N)^R.i(N);return new l(A,this.h^R.h)};function de(R){const b=R.g.length+1,A=[];for(let N=0;N<b;N++)A[N]=R.i(N)<<1|R.i(N-1)>>>31;return new l(A,R.h)}function le(R,b){const A=b>>5;b%=32;const N=R.g.length-A,D=[];for(let j=0;j<N;j++)D[j]=b>0?R.i(j+A)>>>b|R.i(j+A+1)<<32-b:R.i(j+A);return new l(D,R.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,QS=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=g,Ni=l}).apply(typeof bI<"u"?bI:typeof self<"u"?self:typeof window<"u"?window:{});var qh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var JS,hc,YS,nf,Kg,XS,ZS,e1;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof qh=="object"&&qh];for(var _=0;_<c.length;++_){var w=c[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function s(c,_){if(_)e:{var w=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var z=c[S];if(!(z in w))break e;w=w[z]}c=c[c.length-1],S=w[c],_=_(S),_!=S&&_!=null&&e(w,c,{configurable:!0,writable:!0,value:_})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(_){var w=[],S;for(S in _)Object.prototype.hasOwnProperty.call(_,S)&&w.push([S,_[S]]);return w}});var a=a||{},l=this||self;function d(c){var _=typeof c;return _=="object"&&c!=null||_=="function"}function f(c,_,w){return c.call.apply(c.bind,arguments)}function p(c,_,w){return p=f,p.apply(null,arguments)}function g(c,_){var w=Array.prototype.slice.call(arguments,1);return function(){var S=w.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function v(c,_){function w(){}w.prototype=_.prototype,c.Z=_.prototype,c.prototype=new w,c.prototype.constructor=c,c.Ob=function(S,z,H){for(var ae=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)ae[Me-2]=arguments[Me];return _.prototype[z].apply(S,ae)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function C(c){const _=c.length;if(_>0){const w=Array(_);for(let S=0;S<_;S++)w[S]=c[S];return w}return[]}function x(c,_){for(let S=1;S<arguments.length;S++){const z=arguments[S];var w=typeof z;if(w=w!="object"?w:z?Array.isArray(z)?"array":w:"null",w=="array"||w=="object"&&typeof z.length=="number"){w=c.length||0;const H=z.length||0;c.length=w+H;for(let ae=0;ae<H;ae++)c[w+ae]=z[ae]}else c.push(z)}}class O{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function L(c){l.setTimeout(()=>{throw c},0)}function ne(){var c=R;let _=null;return c.g&&(_=c.g,c.g=c.g.next,c.g||(c.h=null),_.next=null),_}class oe{constructor(){this.h=this.g=null}add(_,w){const S=Z.get();S.set(_,w),this.h?this.h.next=S:this.g=S,this.h=S}}var Z=new O(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let de,le=!1,R=new oe,b=()=>{const c=Promise.resolve(void 0);de=()=>{c.then(A)}};function A(){for(var c;c=ne();){try{c.h.call(c.g)}catch(w){L(w)}var _=Z;_.j(c),_.h<100&&(_.h++,c.next=_.g,_.g=c)}le=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(c,_){this.type=c,this.g=this.target=_,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,_=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const w=()=>{};l.addEventListener("test",w,_),l.removeEventListener("test",w,_)}catch{}return c})();function k(c){return/^[\s\xa0]*$/.test(c)}function Be(c,_){D.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,_)}v(Be,D),Be.prototype.init=function(c,_){const w=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=_,_=c.relatedTarget,_||(w=="mouseover"?_=c.fromElement:w=="mouseout"&&(_=c.toElement)),this.relatedTarget=_,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Be.Z.h.call(this)},Be.prototype.h=function(){Be.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var rt="closure_listenable_"+(Math.random()*1e6|0),ce=0;function Ve(c,_,w,S,z){this.listener=c,this.proxy=null,this.src=_,this.type=w,this.capture=!!S,this.ha=z,this.key=++ce,this.da=this.fa=!1}function se(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function _e(c,_,w){for(const S in c)_.call(w,c[S],S,c)}function fe(c,_){for(const w in c)_.call(void 0,c[w],w,c)}function F(c){const _={};for(const w in c)_[w]=c[w];return _}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ne(c,_){let w,S;for(let z=1;z<arguments.length;z++){S=arguments[z];for(w in S)c[w]=S[w];for(let H=0;H<K.length;H++)w=K[H],Object.prototype.hasOwnProperty.call(S,w)&&(c[w]=S[w])}}function Ce(c){this.src=c,this.g={},this.h=0}Ce.prototype.add=function(c,_,w,S,z){const H=c.toString();c=this.g[H],c||(c=this.g[H]=[],this.h++);const ae=pe(c,_,S,z);return ae>-1?(_=c[ae],w||(_.fa=!1)):(_=new Ve(_,this.src,H,!!S,z),_.fa=w,c.push(_)),_};function Ue(c,_){const w=_.type;if(w in c.g){var S=c.g[w],z=Array.prototype.indexOf.call(S,_,void 0),H;(H=z>=0)&&Array.prototype.splice.call(S,z,1),H&&(se(_),c.g[w].length==0&&(delete c.g[w],c.h--))}}function pe(c,_,w,S){for(let z=0;z<c.length;++z){const H=c[z];if(!H.da&&H.listener==_&&H.capture==!!w&&H.ha==S)return z}return-1}var Pe="closure_lm_"+(Math.random()*1e6|0),xe={};function Le(c,_,w,S,z){if(Array.isArray(_)){for(let H=0;H<_.length;H++)Le(c,_[H],w,S,z);return null}return w=iu(w),c&&c[rt]?c.J(_,w,d(S)?!!S.capture:!1,z):lt(c,_,w,!1,S,z)}function lt(c,_,w,S,z,H){if(!_)throw Error("Invalid event type");const ae=d(z)?!!z.capture:!!z;let Me=fa(c);if(Me||(c[Pe]=Me=new Ce(c)),w=Me.add(_,w,S,ae,H),w.proxy)return w;if(S=Un(),w.proxy=S,S.src=c,S.listener=w,c.addEventListener)j||(z=ae),z===void 0&&(z=!1),c.addEventListener(_.toString(),S,z);else if(c.attachEvent)c.attachEvent(ha(_.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Un(){function c(w){return _.call(c.src,c.listener,w)}const _=bd;return c}function $s(c,_,w,S,z){if(Array.isArray(_))for(var H=0;H<_.length;H++)$s(c,_[H],w,S,z);else S=d(S)?!!S.capture:!!S,w=iu(w),c&&c[rt]?(c=c.i,H=String(_).toString(),H in c.g&&(_=c.g[H],w=pe(_,w,S,z),w>-1&&(se(_[w]),Array.prototype.splice.call(_,w,1),_.length==0&&(delete c.g[H],c.h--)))):c&&(c=fa(c))&&(_=c.g[_.toString()],c=-1,_&&(c=pe(_,w,S,z)),(w=c>-1?_[c]:null)&&xn(w))}function xn(c){if(typeof c!="number"&&c&&!c.da){var _=c.src;if(_&&_[rt])Ue(_.i,c);else{var w=c.type,S=c.proxy;_.removeEventListener?_.removeEventListener(w,S,c.capture):_.detachEvent?_.detachEvent(ha(w),S):_.addListener&&_.removeListener&&_.removeListener(S),(w=fa(_))?(Ue(w,c),w.h==0&&(w.src=null,_[Pe]=null)):se(c)}}}function ha(c){return c in xe?xe[c]:xe[c]="on"+c}function bd(c,_){if(c.da)c=!0;else{_=new Be(_,this);const w=c.listener,S=c.ha||c.src;c.fa&&xn(c),c=w.call(S,_)}return c}function fa(c){return c=c[Pe],c instanceof Ce?c:null}var eo="__closure_events_fn_"+(Math.random()*1e9>>>0);function iu(c){return typeof c=="function"?c:(c[eo]||(c[eo]=function(_){return c.handleEvent(_)}),c[eo])}function Ot(){N.call(this),this.i=new Ce(this),this.M=this,this.G=null}v(Ot,N),Ot.prototype[rt]=!0,Ot.prototype.removeEventListener=function(c,_,w,S){$s(this,c,_,w,S)};function bt(c,_){var w,S=c.G;if(S)for(w=[];S;S=S.G)w.push(S);if(c=c.M,S=_.type||_,typeof _=="string")_=new D(_,c);else if(_ instanceof D)_.target=_.target||c;else{var z=_;_=new D(S,c),Ne(_,z)}z=!0;let H,ae;if(w)for(ae=w.length-1;ae>=0;ae--)H=_.g=w[ae],z=pr(H,S,!0,_)&&z;if(H=_.g=c,z=pr(H,S,!0,_)&&z,z=pr(H,S,!1,_)&&z,w)for(ae=0;ae<w.length;ae++)H=_.g=w[ae],z=pr(H,S,!1,_)&&z}Ot.prototype.N=function(){if(Ot.Z.N.call(this),this.i){var c=this.i;for(const _ in c.g){const w=c.g[_];for(let S=0;S<w.length;S++)se(w[S]);delete c.g[_],c.h--}}this.G=null},Ot.prototype.J=function(c,_,w,S){return this.i.add(String(c),_,!1,w,S)},Ot.prototype.K=function(c,_,w,S){return this.i.add(String(c),_,!0,w,S)};function pr(c,_,w,S){if(_=c.i.g[String(_)],!_)return!0;_=_.concat();let z=!0;for(let H=0;H<_.length;++H){const ae=_[H];if(ae&&!ae.da&&ae.capture==w){const Me=ae.listener,Rt=ae.ha||ae.src;ae.fa&&Ue(c.i,ae),z=Me.call(Rt,S)!==!1&&z}}return z&&!S.defaultPrevented}function ou(c,_){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:l.setTimeout(c,_||0)}function au(c){c.g=ou(()=>{c.g=null,c.i&&(c.i=!1,au(c))},c.l);const _=c.h;c.h=null,c.m.apply(null,_)}class Rd extends N{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:au(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qs(c){N.call(this),this.h=c,this.g={}}v(qs,N);var lu=[];function pa(c){_e(c.g,function(_,w){this.g.hasOwnProperty(w)&&xn(_)},c),c.g={}}qs.prototype.N=function(){qs.Z.N.call(this),pa(this)},qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ws=l.JSON.stringify,Pd=l.JSON.parse,to=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function Hs(){}function kd(){}var Gs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ma(){D.call(this,"d")}v(ma,D);function uu(){D.call(this,"c")}v(uu,D);var mr={},ga=null;function Ks(){return ga=ga||new Ot}mr.Ia="serverreachability";function ya(c){D.call(this,mr.Ia,c)}v(ya,D);function ds(c){const _=Ks();bt(_,new ya(_))}mr.STAT_EVENT="statevent";function hs(c,_){D.call(this,mr.STAT_EVENT,c),this.stat=_}v(hs,D);function It(c){const _=Ks();bt(_,new hs(_,c))}mr.Ja="timingevent";function cu(c,_){D.call(this,mr.Ja,c),this.size=_}v(cu,D);function Qs(c,_){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},_)}function Js(){this.g=!0}Js.prototype.ua=function(){this.g=!1};function Cd(c,_,w,S,z,H){c.info(function(){if(c.g)if(H){var ae="",Me=H.split("&");for(let et=0;et<Me.length;et++){var Rt=Me[et].split("=");if(Rt.length>1){const Lt=Rt[0];Rt=Rt[1];const Hn=Lt.split("_");ae=Hn.length>=2&&Hn[1]=="type"?ae+(Lt+"="+Rt+"&"):ae+(Lt+"=redacted&")}}}else ae=null;else ae=H;return"XMLHTTP REQ ("+S+") [attempt "+z+"]: "+_+`
`+w+`
`+ae})}function Nd(c,_,w,S,z,H,ae){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+z+"]: "+_+`
`+w+`
`+H+" "+ae})}function kr(c,_,w,S){c.info(function(){return"XMLHTTP TEXT ("+_+"): "+no(c,w)+(S?" "+S:"")})}function Dd(c,_){c.info(function(){return"TIMEOUT: "+_})}Js.prototype.info=function(){};function no(c,_){if(!c.g)return _;if(!_)return null;try{const H=JSON.parse(_);if(H){for(c=0;c<H.length;c++)if(Array.isArray(H[c])){var w=H[c];if(!(w.length<2)){var S=w[1];if(Array.isArray(S)&&!(S.length<1)){var z=S[0];if(z!="noop"&&z!="stop"&&z!="close")for(let ae=1;ae<S.length;ae++)S[ae]=""}}}}return Ws(H)}catch{return _}}var Ys={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Xs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Vd;function fs(){}v(fs,Hs),fs.prototype.g=function(){return new XMLHttpRequest},Vd=new fs;function Cr(c){return encodeURIComponent(String(c))}function _a(c){var _=1;c=c.split(":");const w=[];for(;_>0&&c.length;)w.push(c.shift()),_--;return c.length&&w.push(c.join(":")),w}function nr(c,_,w,S){this.j=c,this.i=_,this.l=w,this.S=S||1,this.V=new qs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Od}function Od(){this.i=null,this.g="",this.h=!1}var Ld={},du={};function gr(c,_,w){c.M=1,c.A=ms(rr(_)),c.u=w,c.R=!0,hu(c,null)}function hu(c,_){c.F=Date.now(),ro(c),c.B=rr(c.A);var w=c.B,S=c.S;Array.isArray(S)||(S=[String(S)]),Iu(w.i,"t",S),c.C=0,w=c.j.L,c.h=new Od,c.g=Hd(c.j,w?_:null,!c.u),c.P>0&&(c.O=new Rd(p(c.Y,c,c.g),c.P)),_=c.V,w=c.g,S=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(lu[0]=z.toString()),z=lu);for(let H=0;H<z.length;H++){const ae=Le(w,z[H],S||_.handleEvent,!1,_.h||_);if(!ae)break;_.g[ae.key]=ae}_=c.J?F(c.J):{},c.u?(c.v||(c.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,_)):(c.v="GET",c.g.ea(c.B,c.v,null,_)),ds(),Cd(c.i,c.v,c.B,c.l,c.S,c.u)}nr.prototype.ba=function(c){c=c.target;const _=this.O;_&&Fr(c)==3?_.j():this.Y(c)},nr.prototype.Y=function(c){try{if(c==this.g)e:{const Me=Fr(this.g),Rt=this.g.ya(),et=this.g.ca();if(!(Me<3)&&(Me!=3||this.g&&(this.h.h||this.g.la()||qd(this.g)))){this.K||Me!=4||Rt==7||(Rt==8||et<=0?ds(3):ds(2)),va(this);var _=this.g.ca();this.X=_;var w=Md(this);if(this.o=_==200,Nd(this.i,this.v,this.B,this.l,this.S,Me,_),this.o){if(this.U&&!this.L){t:{if(this.g){var S,z=this.g;if((S=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(S)){var H=S;break t}}H=null}if(c=H)kr(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ut(this,c);else{this.o=!1,this.m=3,It(12),ps(this),so(this);break e}}if(this.R){c=!0;let Lt;for(;!this.K&&this.C<w.length;)if(Lt=jd(this,w),Lt==du){Me==4&&(this.m=4,It(14),c=!1),kr(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==Ld){this.m=4,It(15),kr(this.i,this.l,w,"[Invalid Chunk]"),c=!1;break}else kr(this.i,this.l,Lt,null),ut(this,Lt);if(Fd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Me!=4||w.length!=0||this.h.h||(this.m=1,It(16),c=!1),this.o=this.o&&c,!c)kr(this.i,this.l,w,"[Invalid Chunked Response]"),ps(this),so(this);else if(w.length>0&&!this.W){this.W=!0;var ae=this.j;ae.g==this&&ae.aa&&!ae.P&&(ae.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),po(ae),ae.P=!0,It(11))}}else kr(this.i,this.l,w,null),ut(this,w);Me==4&&ps(this),this.o&&!this.K&&(Me==4?Pa(this.j,this):(this.o=!1,ro(this)))}else Su(this.g),_==400&&w.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),ps(this),so(this)}}}catch{}};function Md(c){if(!Fd(c))return c.g.la();const _=qd(c.g);if(_==="")return"";let w="";const S=_.length,z=Fr(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return ps(c),so(c),"";c.h.i=new l.TextDecoder}for(let H=0;H<S;H++)c.h.h=!0,w+=c.h.i.decode(_[H],{stream:!(z&&H==S-1)});return _.length=0,c.h.g+=w,c.C=0,c.h.g}function Fd(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function jd(c,_){var w=c.C,S=_.indexOf(`
`,w);return S==-1?du:(w=Number(_.substring(w,S)),isNaN(w)?Ld:(S+=1,S+w>_.length?du:(_=_.slice(S,S+w),c.C=S+w,_)))}nr.prototype.cancel=function(){this.K=!0,ps(this)};function ro(c){c.T=Date.now()+c.H,fu(c,c.H)}function fu(c,_){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Qs(p(c.aa,c),_)}function va(c){c.D&&(l.clearTimeout(c.D),c.D=null)}nr.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Dd(this.i,this.B),this.M!=2&&(ds(),It(17)),ps(this),this.m=2,so(this)):fu(this,this.T-c)};function so(c){c.j.I==0||c.K||Pa(c.j,c)}function ps(c){va(c);var _=c.O;_&&typeof _.dispose=="function"&&_.dispose(),c.O=null,pa(c.V),c.g&&(_=c.g,c.g=null,_.abort(),_.dispose())}function ut(c,_){try{var w=c.j;if(w.I!=0&&(w.g==c||mu(w.h,c))){if(!c.L&&mu(w.h,c)&&w.I==3){try{var S=w.Ba.g.parse(_)}catch{S=null}if(Array.isArray(S)&&S.length==3){var z=S;if(z[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<c.F)Ra(w),qn(w);else break e;Br(w),It(18)}}else w.xa=z[1],0<w.xa-w.K&&z[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Qs(p(w.Va,w),6e3));io(w.h)<=1&&w.ta&&(w.ta=void 0)}else Wn(w,11)}else if((c.L||w.g==c)&&Ra(w),!k(_))for(z=w.Ba.g.parse(_),_=0;_<z.length;_++){let et=z[_];const Lt=et[0];if(!(Lt<=w.K))if(w.K=Lt,et=et[1],w.I==2)if(et[0]=="c"){w.M=et[1],w.ba=et[2];const Hn=et[3];Hn!=null&&(w.ka=Hn,w.j.info("VER="+w.ka));const ws=et[4];ws!=null&&(w.za=ws,w.j.info("SVER="+w.za));const zr=et[5];zr!=null&&typeof zr=="number"&&zr>0&&(S=1.5*zr,w.O=S,w.j.info("backChannelRequestTimeoutMs_="+S)),S=w;const $r=c.g;if($r){const Na=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Na){var H=S.h;H.g||Na.indexOf("spdy")==-1&&Na.indexOf("quic")==-1&&Na.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Ea(H,H.h),H.h=null))}if(S.G){const bu=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;bu&&(S.wa=bu,Xe(S.J,S.G,bu))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-c.F,w.j.info("Handshake RTT: "+w.T+"ms")),S=w;var ae=c;if(S.na=xu(S,S.L?S.ba:null,S.W),ae.L){oo(S.h,ae);var Me=ae,Rt=S.O;Rt&&(Me.H=Rt),Me.D&&(va(Me),ro(Me)),S.g=ae}else ln(S);w.i.length>0&&vs(w)}else et[0]!="stop"&&et[0]!="close"||Wn(w,7);else w.I==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?Wn(w,7):xa(w):et[0]!="noop"&&w.l&&w.l.qa(et),w.A=0)}}ds(4)}catch{}}var Fp=class{constructor(c,_){this.g=c,this.map=_}};function wa(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function pu(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function io(c){return c.h?1:c.g?c.g.size:0}function mu(c,_){return c.h?c.h==_:c.g?c.g.has(_):!1}function Ea(c,_){c.g?c.g.add(_):c.h=_}function oo(c,_){c.h&&c.h==_?c.h=null:c.g&&c.g.has(_)&&c.g.delete(_)}wa.prototype.cancel=function(){if(this.i=Bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Bn(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let _=c.i;for(const w of c.g.values())_=_.concat(w.G);return _}return C(c.i)}var Ud=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zn(c,_){if(c){c=c.split("&");for(let w=0;w<c.length;w++){const S=c[w].indexOf("=");let z,H=null;S>=0?(z=c[w].substring(0,S),H=c[w].substring(S+1)):z=c[w],_(z,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Nr(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;c instanceof Nr?(this.l=c.l,ao(this,c.j),this.o=c.o,this.g=c.g,Dr(this,c.u),this.h=c.h,Zs(this,Tu(c.i)),this.m=c.m):c&&(_=String(c).match(Ud))?(this.l=!1,ao(this,_[1]||"",!0),this.o=lo(_[2]||""),this.g=lo(_[3]||"",!0),Dr(this,_[4]),this.h=lo(_[5]||"",!0),Zs(this,_[6]||"",!0),this.m=lo(_[7]||"")):(this.l=!1,this.i=new He(null,this.l))}Nr.prototype.toString=function(){const c=[];var _=this.j;_&&c.push(uo(_,yu,!0),":");var w=this.g;return(w||_=="file")&&(c.push("//"),(_=this.o)&&c.push(uo(_,yu,!0),"@"),c.push(Cr(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&c.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&c.push("/"),c.push(uo(w,w.charAt(0)=="/"?co:_u,!0))),(w=this.i.toString())&&c.push("?",w),(w=this.m)&&c.push("#",uo(w,vu)),c.join("")},Nr.prototype.resolve=function(c){const _=rr(this);let w=!!c.j;w?ao(_,c.j):w=!!c.o,w?_.o=c.o:w=!!c.g,w?_.g=c.g:w=c.u!=null;var S=c.h;if(w)Dr(_,c.u);else if(w=!!c.h){if(S.charAt(0)!="/")if(this.g&&!this.h)S="/"+S;else{var z=_.h.lastIndexOf("/");z!=-1&&(S=_.h.slice(0,z+1)+S)}if(z=S,z==".."||z==".")S="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){S=z.lastIndexOf("/",0)==0,z=z.split("/");const H=[];for(let ae=0;ae<z.length;){const Me=z[ae++];Me=="."?S&&ae==z.length&&H.push(""):Me==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),S&&ae==z.length&&H.push("")):(H.push(Me),S=!0)}S=H.join("/")}else S=z}return w?_.h=S:w=c.i.toString()!=="",w?Zs(_,Tu(c.i)):w=!!c.m,w&&(_.m=c.m),_};function rr(c){return new Nr(c)}function ao(c,_,w){c.j=w?lo(_,!0):_,c.j&&(c.j=c.j.replace(/:$/,""))}function Dr(c,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);c.u=_}else c.u=null}function Zs(c,_,w){_ instanceof He?(c.i=_,Ta(c.i,c.l)):(w||(_=uo(_,jp)),c.i=new He(_,c.l))}function Xe(c,_,w){c.i.set(_,w)}function ms(c){return Xe(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function lo(c,_){return c?_?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function uo(c,_,w){return typeof c=="string"?(c=encodeURI(c).replace(_,gu),w&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function gu(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var yu=/[#\/\?@]/g,_u=/[#\?:]/g,co=/[#\?]/g,jp=/[#\?@]/g,vu=/#/g;function He(c,_){this.h=this.g=null,this.i=c||null,this.j=!!_}function Vr(c){c.g||(c.g=new Map,c.h=0,c.i&&zn(c.i,function(_,w){c.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}n=He.prototype,n.add=function(c,_){Vr(this),this.i=null,c=Or(this,c);let w=this.g.get(c);return w||this.g.set(c,w=[]),w.push(_),this.h+=1,this};function wu(c,_){Vr(c),_=Or(c,_),c.g.has(_)&&(c.i=null,c.h-=c.g.get(_).length,c.g.delete(_))}function Ia(c,_){return Vr(c),_=Or(c,_),c.g.has(_)}n.forEach=function(c,_){Vr(this),this.g.forEach(function(w,S){w.forEach(function(z){c.call(_,z,S,this)},this)},this)};function Eu(c,_){Vr(c);let w=[];if(typeof _=="string")Ia(c,_)&&(w=w.concat(c.g.get(Or(c,_))));else for(c=Array.from(c.g.values()),_=0;_<c.length;_++)w=w.concat(c[_]);return w}n.set=function(c,_){return Vr(this),this.i=null,c=Or(this,c),Ia(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[_]),this.h+=1,this},n.get=function(c,_){return c?(c=Eu(this,c),c.length>0?String(c[0]):_):_};function Iu(c,_,w){wu(c,_),w.length>0&&(c.i=null,c.g.set(Or(c,_),C(w)),c.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],_=Array.from(this.g.keys());for(let S=0;S<_.length;S++){var w=_[S];const z=Cr(w);w=Eu(this,w);for(let H=0;H<w.length;H++){let ae=z;w[H]!==""&&(ae+="="+Cr(w[H])),c.push(ae)}}return this.i=c.join("&")};function Tu(c){const _=new He;return _.i=c.i,c.g&&(_.g=new Map(c.g),_.h=c.h),_}function Or(c,_){return _=String(_),c.j&&(_=_.toLowerCase()),_}function Ta(c,_){_&&!c.j&&(Vr(c),c.i=null,c.g.forEach(function(w,S){const z=S.toLowerCase();S!=z&&(wu(this,S),Iu(this,z,w))},c)),c.j=_}function Lr(c,_){const w=new Js;if(l.Image){const S=new Image;S.onload=g(Zt,w,"TestLoadImage: loaded",!0,_,S),S.onerror=g(Zt,w,"TestLoadImage: error",!1,_,S),S.onabort=g(Zt,w,"TestLoadImage: abort",!1,_,S),S.ontimeout=g(Zt,w,"TestLoadImage: timeout",!1,_,S),l.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else _(!1)}function Mr(c,_){const w=new Js,S=new AbortController,z=setTimeout(()=>{S.abort(),Zt(w,"TestPingServer: timeout",!1,_)},1e4);fetch(c,{signal:S.signal}).then(H=>{clearTimeout(z),H.ok?Zt(w,"TestPingServer: ok",!0,_):Zt(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(z),Zt(w,"TestPingServer: error",!1,_)})}function Zt(c,_,w,S,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),S(w)}catch{}}function ho(){this.g=new to}function gs(c){this.i=c.Sb||null,this.h=c.ab||!1}v(gs,Hs),gs.prototype.g=function(){return new $n(this.i,this.h)};function $n(c,_){Ot.call(this),this.H=c,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v($n,Ot),n=$n.prototype,n.open=function(c,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=_,this.readyState=1,yr(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(_.body=c),(this.H||l).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ei(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,yr(this)),this.g&&(this.readyState=3,yr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Bd(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Bd(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var _=c.value?c.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!c.done}))&&(this.response=this.responseText+=_)}c.done?ei(this):yr(this),this.readyState==3&&Bd(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,ei(this))},n.Na=function(c){this.g&&(this.response=c,ei(this))},n.ga=function(){this.g&&ei(this)};function ei(c){c.readyState=4,c.l=null,c.j=null,c.B=null,yr(c)}n.setRequestHeader=function(c,_){this.A.append(c,_)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,c.push(w[0]+": "+w[1]),w=_.next();return c.join(`\r
`)};function yr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty($n.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function zd(c){let _="";return _e(c,function(w,S){_+=S,_+=":",_+=w,_+=`\r
`}),_}function Sa(c,_,w){e:{for(S in w){var S=!1;break e}S=!0}S||(w=zd(w),typeof c=="string"?w!=null&&Cr(w):Xe(c,_,w))}function st(c){Ot.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(st,Ot);var $d=/^https?$/i,Up=["POST","PUT"];n=st.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,_,w,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);_=_?_.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Vd.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(_,String(c),!0),this.B=!1}catch(H){ti(this,H);return}if(c=w||"",w=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var z in S)w.set(z,S[z]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const H of S.keys())w.set(H,S.get(H));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(w.keys()).find(H=>H.toLowerCase()=="content-type"),z=l.FormData&&c instanceof l.FormData,!(Array.prototype.indexOf.call(Up,_,void 0)>=0)||S||z||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,ae]of w)this.g.setRequestHeader(H,ae);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(H){ti(this,H)}};function ti(c,_){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=_,c.o=5,ni(c),_s(c)}function ni(c){c.A||(c.A=!0,bt(c,"complete"),bt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,bt(this,"complete"),bt(this,"abort"),_s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_s(this,!0)),st.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ys(this):this.Xa())},n.Xa=function(){ys(this)};function ys(c){if(c.h&&typeof a<"u"){if(c.v&&Fr(c)==4)setTimeout(c.Ca.bind(c),0);else if(bt(c,"readystatechange"),Fr(c)==4){c.h=!1;try{const H=c.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var S;if(S=H===0){let ae=String(c.D).match(Ud)[1]||null;!ae&&l.self&&l.self.location&&(ae=l.self.location.protocol.slice(0,-1)),S=!$d.test(ae?ae.toLowerCase():"")}w=S}if(w)bt(c,"complete"),bt(c,"success");else{c.o=6;try{var z=Fr(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",ni(c)}}finally{_s(c)}}}}function _s(c,_){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const w=c.g;c.g=null,_||bt(c,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Fr(c){return c.g?c.g.readyState:0}n.ca=function(){try{return Fr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var _=this.g.responseText;return c&&_.indexOf(c)==0&&(_=_.substring(c.length)),Pd(_)}};function qd(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Su(c){const _={};c=(c.g&&Fr(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(k(c[S]))continue;var w=_a(c[S]);const z=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const H=_[z]||[];_[z]=H,H.push(w)}fe(_,function(S){return S.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function jr(c,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[c]||_}function Aa(c){this.za=0,this.i=[],this.j=new Js,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jr("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jr("baseRetryDelayMs",5e3,c),this.Za=jr("retryDelaySeedMs",1e4,c),this.Ta=jr("forwardChannelMaxRetries",2,c),this.va=jr("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new wa(c&&c.concurrentRequestLimit),this.Ba=new ho,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Aa.prototype,n.ka=8,n.I=1,n.connect=function(c,_,w,S){It(0),this.W=c,this.H=_||{},w&&S!==void 0&&(this.H.OSID=w,this.H.OAID=S),this.F=this.X,this.J=xu(this,null,this.W),vs(this)};function xa(c){if(ba(c),c.I==3){var _=c.V++,w=rr(c.J);if(Xe(w,"SID",c.M),Xe(w,"RID",_),Xe(w,"TYPE","terminate"),Ur(c,w),_=new nr(c,c.j,_),_.M=2,_.A=ms(rr(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(_.A.toString(),"")}catch{}!w&&l.Image&&(new Image().src=_.A,w=!0),w||(_.g=Hd(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ro(_)}mo(c)}function qn(c){c.g&&(po(c),c.g.cancel(),c.g=null)}function ba(c){qn(c),c.v&&(l.clearTimeout(c.v),c.v=null),Ra(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&l.clearTimeout(c.m),c.m=null)}function vs(c){if(!pu(c.h)&&!c.m){c.m=!0;var _=c.Ea;de||b(),le||(de(),le=!0),R.add(_,c),c.D=0}}function Wd(c,_){return io(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=_.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Qs(p(c.Ea,c,_),ka(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new nr(this,this.j,c);let H=this.o;if(this.U&&(H?(H=F(H),Ne(H,this.U)):H=this.U),this.u!==null||this.R||(z.J=H,H=null),this.S)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var S=this.i[w];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(_+=S,_>4096){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=Au(this,z,_),w=rr(this.J),Xe(w,"RID",c),Xe(w,"CVER",22),this.G&&Xe(w,"X-HTTP-Session-Id",this.G),Ur(this,w),H&&(this.R?_="headers="+Cr(zd(H))+"&"+_:this.u&&Sa(w,this.u,H)),Ea(this.h,z),this.Ra&&Xe(w,"TYPE","init"),this.S?(Xe(w,"$req",_),Xe(w,"SID","null"),z.U=!0,gr(z,w,null)):gr(z,w,_),this.I=2}}else this.I==3&&(c?fo(this,c):this.i.length==0||pu(this.h)||fo(this))};function fo(c,_){var w;_?w=_.l:w=c.V++;const S=rr(c.J);Xe(S,"SID",c.M),Xe(S,"RID",w),Xe(S,"AID",c.K),Ur(c,S),c.u&&c.o&&Sa(S,c.u,c.o),w=new nr(c,c.j,w,c.D+1),c.u===null&&(w.J=c.o),_&&(c.i=_.G.concat(c.i)),_=Au(c,w,1e3),w.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Ea(c.h,w),gr(w,S,_)}function Ur(c,_){c.H&&_e(c.H,function(w,S){Xe(_,S,w)}),c.l&&_e({},function(w,S){Xe(_,S,w)})}function Au(c,_,w){w=Math.min(c.i.length,w);const S=c.l?p(c.l.Ka,c.l,c):null;e:{var z=c.i;let Me=-1;for(;;){const Rt=["count="+w];Me==-1?w>0?(Me=z[0].g,Rt.push("ofs="+Me)):Me=0:Rt.push("ofs="+Me);let et=!0;for(let Lt=0;Lt<w;Lt++){var H=z[Lt].g;const Hn=z[Lt].map;if(H-=Me,H<0)Me=Math.max(0,z[Lt].g-100),et=!1;else try{H="req"+H+"_"||"";try{var ae=Hn instanceof Map?Hn:Object.entries(Hn);for(const[ws,zr]of ae){let $r=zr;d(zr)&&($r=Ws(zr)),Rt.push(H+ws+"="+encodeURIComponent($r))}}catch(ws){throw Rt.push(H+"type="+encodeURIComponent("_badmap")),ws}}catch{S&&S(Hn)}}if(et){ae=Rt.join("&");break e}}ae=void 0}return c=c.i.splice(0,w),_.G=c,ae}function ln(c){if(!c.g&&!c.v){c.Y=1;var _=c.Da;de||b(),le||(de(),le=!0),R.add(_,c),c.A=0}}function Br(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Qs(p(c.Da,c),ka(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,ri(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Qs(p(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),qn(this),ri(this))};function po(c){c.B!=null&&(l.clearTimeout(c.B),c.B=null)}function ri(c){c.g=new nr(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var _=rr(c.na);Xe(_,"RID","rpc"),Xe(_,"SID",c.M),Xe(_,"AID",c.K),Xe(_,"CI",c.F?"0":"1"),!c.F&&c.ia&&Xe(_,"TO",c.ia),Xe(_,"TYPE","xmlhttp"),Ur(c,_),c.u&&c.o&&Sa(_,c.u,c.o),c.O&&(c.g.H=c.O);var w=c.g;c=c.ba,w.M=1,w.A=ms(rr(_)),w.u=null,w.R=!0,hu(w,c)}n.Va=function(){this.C!=null&&(this.C=null,qn(this),Br(this),It(19))};function Ra(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function Pa(c,_){var w=null;if(c.g==_){Ra(c),po(c),c.g=null;var S=2}else if(mu(c.h,_))w=_.G,oo(c.h,_),S=1;else return;if(c.I!=0){if(_.o)if(S==1){w=_.u?_.u.length:0,_=Date.now()-_.F;var z=c.D;S=Ks(),bt(S,new cu(S,w)),vs(c)}else ln(c);else if(z=_.m,z==3||z==0&&_.X>0||!(S==1&&Wd(c,_)||S==2&&Br(c)))switch(w&&w.length>0&&(_=c.h,_.i=_.i.concat(w)),z){case 1:Wn(c,5);break;case 4:Wn(c,10);break;case 3:Wn(c,6);break;default:Wn(c,2)}}}function ka(c,_){let w=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(w*=2),w*_}function Wn(c,_){if(c.j.info("Error code "+_),_==2){var w=p(c.bb,c),S=c.Ua;const z=!S;S=new Nr(S||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ao(S,"https"),ms(S),z?Lr(S.toString(),w):Mr(S.toString(),w)}else It(2);c.I=0,c.l&&c.l.pa(_),mo(c),ba(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function mo(c){if(c.I=0,c.ja=[],c.l){const _=Bn(c.h);(_.length!=0||c.i.length!=0)&&(x(c.ja,_),x(c.ja,c.i),c.h.i.length=0,C(c.i),c.i.length=0),c.l.oa()}}function xu(c,_,w){var S=w instanceof Nr?rr(w):new Nr(w);if(S.g!="")_&&(S.g=_+"."+S.g),Dr(S,S.u);else{var z=l.location;S=z.protocol,_=_?_+"."+z.hostname:z.hostname,z=+z.port;const H=new Nr(null);S&&ao(H,S),_&&(H.g=_),z&&Dr(H,z),w&&(H.h=w),S=H}return w=c.G,_=c.wa,w&&_&&Xe(S,w,_),Xe(S,"VER",c.ka),Ur(c,S),S}function Hd(c,_,w){if(_&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=c.Aa&&!c.ma?new st(new gs({ab:w})):new st(c.ma),_.Fa(c.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gd(){}n=Gd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ca(){}Ca.prototype.g=function(c,_){return new en(c,_)};function en(c,_){Ot.call(this),this.g=new Aa(_),this.l=c,this.h=_&&_.messageUrlParams||null,c=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(c?c["X-WebChannel-Content-Type"]=_.messageContentType:c={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(c?c["X-WebChannel-Client-Profile"]=_.sa:c={"X-WebChannel-Client-Profile":_.sa}),this.g.U=c,(c=_&&_.Qb)&&!k(c)&&(this.g.u=c),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!k(_)&&(this.g.G=_,c=this.h,c!==null&&_ in c&&(c=this.h,_ in c&&delete c[_])),this.j=new si(this)}v(en,Ot),en.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){xa(this.g)},en.prototype.o=function(c){var _=this.g;if(typeof c=="string"){var w={};w.__data__=c,c=w}else this.v&&(w={},w.__data__=Ws(c),c=w);_.i.push(new Fp(_.Ya++,c)),_.I==3&&vs(_)},en.prototype.N=function(){this.g.l=null,delete this.j,xa(this.g),delete this.g,en.Z.N.call(this)};function Kd(c){ma.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var _=c.__sm__;if(_){e:{for(const w in _){c=w;break e}c=void 0}(this.i=c)&&(c=this.i,_=_!==null&&c in _?_[c]:void 0),this.data=_}else this.data=c}v(Kd,ma);function Qd(){uu.call(this),this.status=1}v(Qd,uu);function si(c){this.g=c}v(si,Gd),si.prototype.ra=function(){bt(this.g,"a")},si.prototype.qa=function(c){bt(this.g,new Kd(c))},si.prototype.pa=function(c){bt(this.g,new Qd)},si.prototype.oa=function(){bt(this.g,"b")},Ca.prototype.createWebChannel=Ca.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,e1=function(){return new Ca},ZS=function(){return Ks()},XS=mr,Kg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ys.NO_ERROR=0,Ys.TIMEOUT=8,Ys.HTTP_ERROR=6,nf=Ys,Xs.COMPLETE="complete",YS=Xs,kd.EventType=Gs,Gs.OPEN="a",Gs.CLOSE="b",Gs.ERROR="c",Gs.MESSAGE="d",Ot.prototype.listen=Ot.prototype.J,hc=kd,st.prototype.listenOnce=st.prototype.K,st.prototype.getLastError=st.prototype.Ha,st.prototype.getLastErrorCode=st.prototype.ya,st.prototype.getStatus=st.prototype.ca,st.prototype.getResponseJson=st.prototype.La,st.prototype.getResponseText=st.prototype.la,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Fa,JS=st}).apply(typeof qh<"u"?qh:typeof self<"u"?self:typeof window<"u"?window:{});const RI="@firebase/firestore",PI="4.9.3";class Jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jt.UNAUTHENTICATED=new Jt(null),Jt.GOOGLE_CREDENTIALS=new Jt("google-credentials-uid"),Jt.FIRST_PARTY=new Jt("first-party-uid"),Jt.MOCK_USER=new Jt("mock-user");let Ql="12.7.0";const Fi=new Kf("@firebase/firestore");function ol(){return Fi.logLevel}function PV(n){Fi.setLogLevel(n)}function Y(n,...e){if(Fi.logLevel<=$e.DEBUG){const t=e.map(u_);Fi.debug(`Firestore (${Ql}): ${n}`,...t)}}function Ct(n,...e){if(Fi.logLevel<=$e.ERROR){const t=e.map(u_);Fi.error(`Firestore (${Ql}): ${n}`,...t)}}function us(n,...e){if(Fi.logLevel<=$e.WARN){const t=e.map(u_);Fi.warn(`Firestore (${Ql}): ${n}`,...t)}}function u_(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function me(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,t1(n,r,t)}function t1(n,e,t){let r=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ct(r),new Error(r)}function Ee(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||t1(e,s,r)}function kV(n,e){n||me(57014,e)}function he(n,e){return n}const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends Yt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class on{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class n1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class CV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Jt.UNAUTHENTICATED)))}shutdown(){}}class NV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class DV{constructor(e){this.t=e,this.currentUser=Jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ee(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new on;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new on,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new on)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ee(typeof r.accessToken=="string",31837,{l:r}),new n1(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string",2055,{h:e}),new Jt(e)}}class VV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Jt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class OV{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new VV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Jt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class kI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ft(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ee(this.o===void 0,3512);const r=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new kI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new kI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function MV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class c_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=MV(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function Oe(n,e){return n<e?-1:n>e?1:0}function Qg(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),a=e.charAt(r);if(s!==a)return Tg(s)===Tg(a)?Oe(s,a):Tg(s)?1:-1}return Oe(n.length,e.length)}const FV=55296,jV=57343;function Tg(n){const e=n.charCodeAt(0);return e>=FV&&e<=jV}function Sl(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function r1(n){return n+"\0"}const CI="__name__";class Qr{constructor(e,t,r){t===void 0?t=0:t>e.length&&me(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&me(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Qr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=Qr.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Oe(e.length,t.length)}static compareSegments(e,t){const r=Qr.isNumericId(e),s=Qr.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Qr.extractNumericId(e).compare(Qr.extractNumericId(t)):Qg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ni.fromString(e.substring(4,e.length-2))}}class qe extends Qr{construct(e,t,r){return new qe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new qe(t)}static emptyPath(){return new qe([])}}const UV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Qr{construct(e,t,r){return new gt(e,t,r)}static isValidIdentifier(e){return UV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CI}static keyField(){return new gt([CI])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new Q(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new Q(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Q(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(r+=d,s++):(a(),s++)}if(a(),l)throw new Q(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(t)}static emptyPath(){return new gt([])}}class ue{constructor(e){this.path=e}static fromPath(e){return new ue(qe.fromString(e))}static fromName(e){return new ue(qe.fromString(e).popFirst(5))}static empty(){return new ue(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new qe(e.slice()))}}function d_(n,e,t){if(!t)throw new Q(W.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function s1(n,e,t,r){if(e===!0&&r===!0)throw new Q(W.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NI(n){if(!ue.isDocumentKey(n))throw new Q(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function DI(n){if(ue.isDocumentKey(n))throw new Q(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function i1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function op(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":me(12329,{type:typeof n})}function Je(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Q(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=op(n);throw new Q(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function o1(n,e){if(e<=0)throw new Q(W.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ut(n,e){const t={typeString:n};return e&&(t.value=e),t}function ld(n,e){if(!i1(n))throw new Q(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Q(W.INVALID_ARGUMENT,t);return!0}const VI=-62135596800,OI=1e6;class Ze{static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*OI);return new Ze(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Q(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Q(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<VI)throw new Q(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OI}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ze._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ld(e,Ze._jsonSchema))return new Ze(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-VI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ze._jsonSchemaVersion="firestore/timestamp/1.0",Ze._jsonSchema={type:Ut("string",Ze._jsonSchemaVersion),seconds:Ut("number"),nanoseconds:Ut("number")};class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new Ze(0,0))}static max(){return new Se(new Ze(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Al=-1;class bf{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Jg(n){return n.fields.find((e=>e.kind===2))}function ko(n){return n.fields.filter((e=>e.kind!==2))}bf.UNKNOWN_ID=-1;class rf{constructor(e,t){this.fieldPath=e,this.kind=t}}class jc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jc(0,tr.min())}}function a1(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Se.fromTimestamp(r===1e9?new Ze(t+1,0):new Ze(t,r));return new tr(s,ue.empty(),e)}function l1(n){return new tr(n.readTime,n.key,Al)}class tr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new tr(Se.min(),ue.empty(),Al)}static max(){return new tr(Se.max(),ue.empty(),Al)}}function h_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ue.comparator(n.documentKey,e.documentKey),t!==0?t:Oe(n.largestBatchId,e.largestBatchId))}const u1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class c1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Qi(n){if(n.code!==W.FAILED_PRECONDITION||n.message!==u1)throw n;Y("LocalStore","Unexpectedly lost primary lease")}class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):U.reject(t)}static resolve(e){return new U(((t,r)=>{t(e)}))}static reject(e){return new U(((t,r)=>{r(e)}))}static waitFor(e){return new U(((t,r)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=U.resolve(!1);for(const r of e)t=t.next((s=>s?U.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new U(((r,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((g=>{l[p]=g,++d,d===a&&r(l)}),(g=>s(g)))}}))}static doWhile(e,t){return new U(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}const Jn="SimpleDb";class ap{static open(e,t,r,s){try{return new ap(t,e.transaction(s,r))}catch(a){throw new Tc(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new on,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Tc(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=f_(r.target.error);this.S.reject(new Tc(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Y(Jn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zV(t)}}class is{static delete(e){return Y(Jn,"Removing database:",e),No(Ny().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Nc())return!1;if(is.F())return!0;const e=wt(),t=is.M(e),r=0<t&&t<10,s=d1(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,is.M(wt())===12.2&&Ct("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Y(Jn,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new Tc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new Q(W.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new Q(W.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new Tc(e,l))},s.onupgradeneeded=a=>{Y(Jn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{Y(Jn,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=ap.open(this.db,e,a?"readonly":"readwrite",r),f=s(d).next((p=>(d.C(),p))).catch((p=>(d.abort(p),U.reject(p)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&l<3;if(Y(Jn,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function d1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class BV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return No(this.U.delete())}}class Tc extends Q{constructor(e,t){super(W.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ji(n){return n.name==="IndexedDbTransactionError"}class zV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Y(Jn,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Y(Jn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),No(r)}add(e){return Y(Jn,"ADD",this.store.name,e,e),No(this.store.add(e))}get(e){return No(this.store.get(e)).next((t=>(t===void 0&&(t=null),Y(Jn,"GET",this.store.name,e,t),t)))}delete(e){return Y(Jn,"DELETE",this.store.name,e),No(this.store.delete(e))}count(){return Y(Jn,"COUNT",this.store.name),No(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new U(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.H(a,((d,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new U(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){Y(Jn,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const s=this.cursor(r);return this.H(s,((a,l,d)=>d.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}te(e){const t=this.cursor({});return new U(((r,s)=>{t.onerror=a=>{const l=f_(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}H(e,t){const r=[];return new U(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new BV(d),p=t(d.primaryKey,d.value,f);if(p instanceof U){const g=p.catch((v=>(f.done(),U.reject(v))));r.push(g)}f.isDone?s():f.G===null?d.continue():d.continue(f.G)}})).next((()=>U.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function No(n){return new U(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=f_(r.target.error);t(s)}}))}let LI=!1;function f_(n){const e=is.M(wt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LI||(LI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Sc="IndexBackfiller";class $V{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Y(Sc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Y(Sc,`Documents written: ${t}`)}catch(t){Ji(t)?Y(Sc,"Ignoring IndexedDB error during index backfill: ",t):await Qi(t)}await this.re(6e4)}))}}class qV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let s=t,a=!0;return U.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return Y(Sc,`Processing collection: ${l}`),this.oe(e,l,s).next((d=>{s-=d,r.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((d=>(Y(Sc,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=l1(a);h_(l,r)>0&&(r=l)})),new tr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Vn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Vn.ce=-1;const Di=-1;function ud(n){return n==null}function Uc(n){return n===0&&1/n==-1/0}function h1(n){return typeof n=="number"&&Number.isInteger(n)&&!Uc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Rf="";function _n(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=MI(e)),e=WV(n.get(t),e);return MI(e)}function WV(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Rf:t+="";break;default:t+=a}}return t}function MI(n){return n+Rf+""}function rs(n){const e=n.length;if(Ee(e>=2,64408,{path:n}),e===2)return Ee(n.charAt(0)===Rf&&n.charAt(1)==="",56145,{path:n}),qe.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Rf,a);switch((l<0||l>t)&&me(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:me(61167,{path:n})}a=l+2}return new qe(r)}const Co="remoteDocuments",cd="owner",el="owner",Bc="mutationQueues",HV="userId",Sr="mutations",FI="batchId",Fo="userMutationsIndex",jI=["userId","batchId"];function sf(n,e){return[n,_n(e)]}function f1(n,e,t){return[n,_n(e),t]}const GV={},xl="documentMutations",Pf="remoteDocumentsV14",KV=["prefixPath","collectionGroup","readTime","documentId"],of="documentKeyIndex",QV=["prefixPath","collectionGroup","documentId"],p1="collectionGroupIndex",JV=["collectionGroup","readTime","prefixPath","documentId"],zc="remoteDocumentGlobal",Yg="remoteDocumentGlobalKey",bl="targets",m1="queryTargetsIndex",YV=["canonicalId","targetId"],Rl="targetDocuments",XV=["targetId","path"],p_="documentTargetsIndex",ZV=["path","targetId"],kf="targetGlobalKey",qo="targetGlobal",$c="collectionParents",eO=["collectionId","parent"],Pl="clientMetadata",tO="clientId",lp="bundles",nO="bundleId",up="namedQueries",rO="name",m_="indexConfiguration",sO="indexId",Xg="collectionGroupIndex",iO="collectionGroup",Ac="indexState",oO=["indexId","uid"],g1="sequenceNumberIndex",aO=["uid","sequenceNumber"],xc="indexEntries",lO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],y1="documentKeyIndex",uO=["indexId","uid","orderedDocumentKey"],cp="documentOverlays",cO=["userId","collectionPath","documentId"],Zg="collectionPathOverlayIndex",dO=["userId","collectionPath","largestBatchId"],_1="collectionGroupOverlayIndex",hO=["userId","collectionGroup","largestBatchId"],g_="globals",fO="name",v1=[Bc,Sr,xl,Co,bl,cd,qo,Rl,Pl,zc,$c,lp,up],pO=[...v1,cp],w1=[Bc,Sr,xl,Pf,bl,cd,qo,Rl,Pl,zc,$c,lp,up,cp],E1=w1,y_=[...E1,m_,Ac,xc],mO=y_,I1=[...y_,g_],gO=I1;class ey extends c1{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function qt(n,e){const t=he(n);return is.O(t.le,e)}function UI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function T1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class at{constructor(e,t){this.comparator=e,this.root=t||rn.EMPTY}insert(e,t){return new at(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wh(this.root,e,this.comparator,!0)}}class Wh{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rn{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??rn.RED,this.left=s??rn.EMPTY,this.right=a??rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new rn(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return rn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw me(27949);return e+(this.isRed()?0:1)}}rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw me(57766)}get value(){throw me(16141)}get color(){throw me(16727)}get left(){throw me(29726)}get right(){throw me(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class nt{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new BI(this.data.getIterator())}getIteratorFrom(e){return new BI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof nt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new nt(this.comparator);return t.data=e,t}}class BI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function tl(n){return n.hasNext()?n.getNext():void 0}class On{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new On([])}unionWith(e){let t=new nt(gt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new On(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class S1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function yO(){return typeof atob<"u"}class St{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new S1("Invalid base64 string: "+a):a}})(e);return new St(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new St(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}St.EMPTY_BYTE_STRING=new St("");const _O=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(n){if(Ee(!!n,39018),typeof n=="string"){let e=0;const t=_O.exec(n);if(Ee(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(n.seconds),nanos:mt(n.nanos)}}function mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ls(n){return typeof n=="string"?St.fromBase64String(n):St.fromUint8Array(n)}const A1="server_timestamp",x1="__type__",b1="__previous_value__",R1="__local_write_time__";function dp(n){return(n?.mapValue?.fields||{})[x1]?.stringValue===A1}function hp(n){const e=n.mapValue.fields[b1];return dp(e)?hp(e):e}function qc(n){const e=Os(n.mapValue.fields[R1].timestampValue);return new Ze(e.seconds,e.nanos)}class vO{constructor(e,t,r,s,a,l,d,f,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=g}}const ty="(default)";class ji{constructor(e,t){this.projectId=e,this.database=t||ty}static empty(){return new ji("","")}get isDefaultDatabase(){return this.database===ty}isEqual(e){return e instanceof ji&&e.projectId===this.projectId&&e.database===this.database}}const __="__type__",P1="__max__",Ri={mapValue:{fields:{__type__:{stringValue:P1}}}},v_="__vector__",kl="value",af={nullValue:"NULL_VALUE"};function Ui(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dp(n)?4:k1(n)?9007199254740991:fp(n)?10:11:me(28295,{value:n})}function cs(n,e){if(n===e)return!0;const t=Ui(n);if(t!==Ui(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return qc(n).isEqual(qc(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=Os(s.timestampValue),d=Os(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return Ls(s.bytesValue).isEqual(Ls(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return mt(s.geoPointValue.latitude)===mt(a.geoPointValue.latitude)&&mt(s.geoPointValue.longitude)===mt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return mt(s.integerValue)===mt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=mt(s.doubleValue),d=mt(a.doubleValue);return l===d?Uc(l)===Uc(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return Sl(n.arrayValue.values||[],e.arrayValue.values||[],cs);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(UI(l)!==UI(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!cs(l[f],d[f])))return!1;return!0})(n,e);default:return me(52216,{left:n})}}function Wc(n,e){return(n.values||[]).find((t=>cs(t,e)))!==void 0}function Bi(n,e){if(n===e)return 0;const t=Ui(n),r=Ui(e);if(t!==r)return Oe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oe(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=mt(a.integerValue||a.doubleValue),f=mt(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return zI(n.timestampValue,e.timestampValue);case 4:return zI(qc(n),qc(e));case 5:return Qg(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=Ls(a),f=Ls(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let p=0;p<d.length&&p<f.length;p++){const g=Oe(d[p],f[p]);if(g!==0)return g}return Oe(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=Oe(mt(a.latitude),mt(l.latitude));return d!==0?d:Oe(mt(a.longitude),mt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return $I(n.arrayValue,e.arrayValue);case 10:return(function(a,l){const d=a.fields||{},f=l.fields||{},p=d[kl]?.arrayValue,g=f[kl]?.arrayValue,v=Oe(p?.values?.length||0,g?.values?.length||0);return v!==0?v:$I(p,g)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Ri.mapValue&&l===Ri.mapValue)return 0;if(a===Ri.mapValue)return 1;if(l===Ri.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=l.fields||{},g=Object.keys(p);f.sort(),g.sort();for(let v=0;v<f.length&&v<g.length;++v){const T=Qg(f[v],g[v]);if(T!==0)return T;const C=Bi(d[f[v]],p[g[v]]);if(C!==0)return C}return Oe(f.length,g.length)})(n.mapValue,e.mapValue);default:throw me(23264,{he:t})}}function zI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Oe(n,e);const t=Os(n),r=Os(e),s=Oe(t.seconds,r.seconds);return s!==0?s:Oe(t.nanos,r.nanos)}function $I(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=Bi(t[s],r[s]);if(a)return a}return Oe(t.length,r.length)}function Cl(n){return ny(n)}function ny(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Os(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ls(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ue.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=ny(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${ny(t.fields[l])}`;return s+"}"})(n.mapValue):me(61005,{value:n})}function lf(n){switch(Ui(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hp(n);return e?16+lf(e):16;case 5:return 2*n.stringValue.length;case 6:return Ls(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+lf(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Yi(r.fields,((a,l)=>{s+=a.length+lf(l)})),s})(n.mapValue);default:throw me(13486,{value:n})}}function Jo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ry(n){return!!n&&"integerValue"in n}function Hc(n){return!!n&&"arrayValue"in n}function qI(n){return!!n&&"nullValue"in n}function WI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function uf(n){return!!n&&"mapValue"in n}function fp(n){return(n?.mapValue?.fields||{})[__]?.stringValue===v_}function bc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Yi(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=bc(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bc(n.arrayValue.values[t]);return e}return{...n}}function k1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===P1}const C1={mapValue:{fields:{[__]:{stringValue:v_},[kl]:{arrayValue:{}}}}};function wO(n){return"nullValue"in n?af:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Jo(ji.empty(),ue.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fp(n)?C1:{mapValue:{}}:me(35942,{value:n})}function EO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Jo(ji.empty(),ue.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?C1:"mapValue"in n?fp(n)?{mapValue:{}}:Ri:me(61959,{value:n})}function HI(n,e){const t=Bi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function GI(n,e){const t=Bi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class sn{constructor(e){this.value=e}static empty(){return new sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!uf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bc(t)}setAll(e){let t=gt.emptyPath(),r={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=d.popLast()}l?r[d.lastSegment()]=bc(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());uf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];uf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Yi(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new sn(bc(this.value))}}function N1(n){const e=[];return Yi(n.fields,((t,r)=>{const s=new gt([t]);if(uf(r)){const a=N1(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new On(e)}class ht{constructor(e,t,r,s,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new ht(e,0,Se.min(),Se.min(),Se.min(),sn.empty(),0)}static newFoundDocument(e,t,r,s){return new ht(e,1,t,Se.min(),r,s,0)}static newNoDocument(e,t){return new ht(e,2,t,Se.min(),Se.min(),sn.empty(),0)}static newUnknownDocument(e,t){return new ht(e,3,t,Se.min(),Se.min(),sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zi{constructor(e,t){this.position=e,this.inclusive=t}}function KI(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=ue.comparator(ue.fromName(l.referenceValue),t.key):r=Bi(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function QI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!cs(n.position[t],e.position[t]))return!1;return!0}class Gc{constructor(e,t="asc"){this.field=e,this.dir=t}}function IO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class D1{}class We extends D1{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new TO(e,t,r):t==="array-contains"?new xO(e,r):t==="in"?new j1(e,r):t==="not-in"?new bO(e,r):t==="array-contains-any"?new RO(e,r):new We(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new SO(e,r):new AO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Bi(t,this.value)):t!==null&&Ui(this.value)===Ui(t)&&this.matchesComparison(Bi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tt extends D1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new tt(e,t)}matches(e){return Nl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nl(n){return n.op==="and"}function sy(n){return n.op==="or"}function w_(n){return V1(n)&&Nl(n)}function V1(n){for(const e of n.filters)if(e instanceof tt)return!1;return!0}function iy(n){if(n instanceof We)return n.field.canonicalString()+n.op.toString()+Cl(n.value);if(w_(n))return n.filters.map((e=>iy(e))).join(",");{const e=n.filters.map((t=>iy(t))).join(",");return`${n.op}(${e})`}}function O1(n,e){return n instanceof We?(function(r,s){return s instanceof We&&r.op===s.op&&r.field.isEqual(s.field)&&cs(r.value,s.value)})(n,e):n instanceof tt?(function(r,s){return s instanceof tt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,d)=>a&&O1(l,s.filters[d])),!0):!1})(n,e):void me(19439)}function L1(n,e){const t=n.filters.concat(e);return tt.create(t,n.op)}function M1(n){return n instanceof We?(function(t){return`${t.field.canonicalString()} ${t.op} ${Cl(t.value)}`})(n):n instanceof tt?(function(t){return t.op.toString()+" {"+t.getFilters().map(M1).join(" ,")+"}"})(n):"Filter"}class TO extends We{constructor(e,t,r){super(e,t,r),this.key=ue.fromName(r.referenceValue)}matches(e){const t=ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class SO extends We{constructor(e,t){super(e,"in",t),this.keys=F1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class AO extends We{constructor(e,t){super(e,"not-in",t),this.keys=F1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function F1(n,e){return(e.arrayValue?.values||[]).map((t=>ue.fromName(t.referenceValue)))}class xO extends We{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hc(t)&&Wc(t.arrayValue,this.value)}}class j1 extends We{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wc(this.value.arrayValue,t)}}class bO extends We{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wc(this.value.arrayValue,t)}}class RO extends We{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Wc(this.value.arrayValue,r)))}}class PO{constructor(e,t=null,r=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Te=null}}function oy(n,e=null,t=[],r=[],s=null,a=null,l=null){return new PO(n,e,t,r,s,a,l)}function Yo(n){const e=he(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>iy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),ud(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Cl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Cl(r))).join(",")),e.Te=t}return e.Te}function dd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!IO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!O1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!QI(n.startAt,e.startAt)&&QI(n.endAt,e.endAt)}function Cf(n){return ue.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Nf(n,e){return n.filters.filter((t=>t instanceof We&&t.field.isEqual(e)))}function JI(n,e,t){let r=af,s=!0;for(const a of Nf(n,e)){let l=af,d=!0;switch(a.op){case"<":case"<=":l=wO(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=af}HI({value:r,inclusive:s},{value:l,inclusive:d})<0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];HI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function YI(n,e,t){let r=Ri,s=!0;for(const a of Nf(n,e)){let l=Ri,d=!0;switch(a.op){case">=":case">":l=EO(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Ri}GI({value:r,inclusive:s},{value:l,inclusive:d})>0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];GI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}class js{constructor(e,t=null,r=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function U1(n,e,t,r,s,a,l,d){return new js(n,e,t,r,s,a,l,d)}function Jl(n){return new js(n)}function XI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function E_(n){return n.collectionGroup!==null}function yl(n){const e=he(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new nt(gt.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Gc(a,r))})),t.has(gt.keyField().canonicalString())||e.Ie.push(new Gc(gt.keyField(),r))}return e.Ie}function Sn(n){const e=he(n);return e.Ee||(e.Ee=kO(e,yl(n))),e.Ee}function kO(n,e){if(n.limitType==="F")return oy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Gc(s.field,a)}));const t=n.endAt?new zi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zi(n.startAt.position,n.startAt.inclusive):null;return oy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ay(n,e){const t=n.filters.concat([e]);return new js(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Df(n,e,t){return new js(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hd(n,e){return dd(Sn(n),Sn(e))&&n.limitType===e.limitType}function B1(n){return`${Yo(Sn(n))}|lt:${n.limitType}`}function al(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>M1(s))).join(", ")}]`),ud(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Cl(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Cl(s))).join(",")),`Target(${r})`})(Sn(n))}; limitType=${n.limitType})`}function fd(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ue.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of yl(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,d,f){const p=KI(l,d,f);return l.inclusive?p<=0:p<0})(r.startAt,yl(r),s)||r.endAt&&!(function(l,d,f){const p=KI(l,d,f);return l.inclusive?p>=0:p>0})(r.endAt,yl(r),s))})(n,e)}function z1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $1(n){return(e,t)=>{let r=!1;for(const s of yl(n)){const a=CO(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function CO(n,e,t){const r=n.field.isKeyField()?ue.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),p=d.data.field(a);return f!==null&&p!==null?Bi(f,p):me(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return me(19790,{direction:n.dir})}}class Us{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Yi(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return T1(this.inner)}size(){return this.innerSize}}const NO=new at(ue.comparator);function Ln(){return NO}const q1=new at(ue.comparator);function fc(...n){let e=q1;for(const t of n)e=e.insert(t.key,t);return e}function W1(n){let e=q1;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ss(){return Rc()}function H1(){return Rc()}function Rc(){return new Us((n=>n.toString()),((n,e)=>n.isEqual(e)))}const DO=new at(ue.comparator),VO=new nt(ue.comparator);function je(...n){let e=VO;for(const t of n)e=e.add(t);return e}const OO=new nt(Oe);function I_(){return OO}function T_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uc(e)?"-0":e}}function G1(n){return{integerValue:""+n}}function K1(n,e){return h1(e)?G1(e):T_(n,e)}class pp{constructor(){this._=void 0}}function LO(n,e,t){return n instanceof Dl?(function(s,a){const l={fields:{[x1]:{stringValue:A1},[R1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&dp(a)&&(a=hp(a)),a&&(l.fields[b1]=a),{mapValue:l}})(t,e):n instanceof Xo?J1(n,e):n instanceof Zo?Y1(n,e):(function(s,a){const l=Q1(s,a),d=ZI(l)+ZI(s.Ae);return ry(l)&&ry(s.Ae)?G1(d):T_(s.serializer,d)})(n,e)}function MO(n,e,t){return n instanceof Xo?J1(n,e):n instanceof Zo?Y1(n,e):t}function Q1(n,e){return n instanceof Vl?(function(r){return ry(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Dl extends pp{}class Xo extends pp{constructor(e){super(),this.elements=e}}function J1(n,e){const t=X1(e);for(const r of n.elements)t.some((s=>cs(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Zo extends pp{constructor(e){super(),this.elements=e}}function Y1(n,e){let t=X1(e);for(const r of n.elements)t=t.filter((s=>!cs(s,r)));return{arrayValue:{values:t}}}class Vl extends pp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ZI(n){return mt(n.integerValue||n.doubleValue)}function X1(n){return Hc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class pd{constructor(e,t){this.field=e,this.transform=t}}function FO(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Xo&&s instanceof Xo||r instanceof Zo&&s instanceof Zo?Sl(r.elements,s.elements,cs):r instanceof Vl&&s instanceof Vl?cs(r.Ae,s.Ae):r instanceof Dl&&s instanceof Dl})(n.transform,e.transform)}class jO{constructor(e,t){this.version=e,this.transformResults=t}}class yt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yt}static exists(e){return new yt(void 0,e)}static updateTime(e){return new yt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class mp{}function Z1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xl(n.key,yt.none()):new Yl(n.key,n.data,yt.none());{const t=n.data,r=sn.empty();let s=new nt(gt.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new Bs(n.key,r,new On(s.toArray()),yt.none())}}function UO(n,e,t){n instanceof Yl?(function(s,a,l){const d=s.value.clone(),f=tT(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Bs?(function(s,a,l){if(!cf(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=tT(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(eA(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Pc(n,e,t,r){return n instanceof Yl?(function(a,l,d,f){if(!cf(a.precondition,l))return d;const p=a.value.clone(),g=nT(a.fieldTransforms,f,l);return p.setAll(g),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof Bs?(function(a,l,d,f){if(!cf(a.precondition,l))return d;const p=nT(a.fieldTransforms,f,l),g=l.data;return g.setAll(eA(a)),g.setAll(p),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(a,l,d){return cf(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function BO(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=Q1(r.transform,s||null);a!=null&&(t===null&&(t=sn.empty()),t.set(r.field,a))}return t||null}function eT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Sl(r,s,((a,l)=>FO(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Yl extends mp{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Bs extends mp{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function eA(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function tT(n,e,t){const r=new Map;Ee(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);r.set(a.field,MO(l,d,t[s]))}return r}function nT(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,LO(a,l,e))}return r}class Xl extends mp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class S_ extends mp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class A_{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&UO(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Pc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Pc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=H1();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=Z1(l,d);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Se.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),je())}isEqual(e){return this.batchId===e.batchId&&Sl(this.mutations,e.mutations,((t,r)=>eT(t,r)))&&Sl(this.baseMutations,e.baseMutations,((t,r)=>eT(t,r)))}}class x_{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return DO})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new x_(e,t,r,s)}}class b_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class zO{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ft,Ge;function tA(n){switch(n){case W.OK:return me(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return me(15467,{code:n})}}function nA(n){if(n===void 0)return Ct("GRPC error has no .code"),W.UNKNOWN;switch(n){case Ft.OK:return W.OK;case Ft.CANCELLED:return W.CANCELLED;case Ft.UNKNOWN:return W.UNKNOWN;case Ft.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case Ft.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case Ft.INTERNAL:return W.INTERNAL;case Ft.UNAVAILABLE:return W.UNAVAILABLE;case Ft.UNAUTHENTICATED:return W.UNAUTHENTICATED;case Ft.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case Ft.NOT_FOUND:return W.NOT_FOUND;case Ft.ALREADY_EXISTS:return W.ALREADY_EXISTS;case Ft.PERMISSION_DENIED:return W.PERMISSION_DENIED;case Ft.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case Ft.ABORTED:return W.ABORTED;case Ft.OUT_OF_RANGE:return W.OUT_OF_RANGE;case Ft.UNIMPLEMENTED:return W.UNIMPLEMENTED;case Ft.DATA_LOSS:return W.DATA_LOSS;default:return me(39323,{code:n})}}(Ge=Ft||(Ft={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";function rA(){return new TextEncoder}const $O=new Ni([4294967295,4294967295],0);function rT(n){const e=rA().encode(n),t=new QS;return t.update(e),new Uint8Array(t.digest())}function sT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ni([t,r],0),new Ni([s,a],0)]}class R_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new pc(`Invalid padding: ${t}`);if(r<0)throw new pc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new pc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ni.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Ni.fromNumber(r)));return s.compare($O)===1&&(s=new Ni([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=rT(e),[r,s]=sT(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);if(!this.we(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new R_(a,s,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=rT(e),[r,s]=sT(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class md{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,gd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new md(Se.min(),s,new at(Oe),Ln(),je())}}class gd{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new gd(r,t,je(),je(),je())}}class df{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class sA{constructor(e,t){this.targetId=e,this.Ce=t}}class iA{constructor(e,t,r=St.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class iT{constructor(){this.ve=0,this.Fe=oT(),this.Me=St.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=je(),t=je(),r=je();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:me(38017,{changeType:a})}})),new gd(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=oT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ee(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class qO{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ln(),this.Je=Hh(),this.He=Hh(),this.Ye=new at(Oe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(Cf(a))if(r===0){const l=new ue(a.path);this.et(t,l,ht.newNoDocument(l,Se.min()))}else Ee(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const d=this.ut(e),f=d?this.ct(d,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=Ls(r).toUint8Array()}catch(f){if(f instanceof S1)return us("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new R_(l,s,a)}catch(f){return us(f instanceof pc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const d=this.ot(l);if(d){if(a.current&&Cf(d.target)){const f=new ue(d.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,ht.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let r=je();this.He.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new md(e,t,this.Ye,this.je,r);return this.je=Ln(),this.Je=Hh(),this.He=Hh(),this.Ye=new at(Oe),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new iT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new nt(Oe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new nt(Oe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Y("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new iT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Hh(){return new at(ue.comparator)}function oT(){return new at(ue.comparator)}const WO={asc:"ASCENDING",desc:"DESCENDING"},HO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GO={and:"AND",or:"OR"};class KO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ly(n,e){return n.useProto3Json||ud(e)?e:{value:e}}function Ol(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QO(n,e){return Ol(n,e.toTimestamp())}function Nt(n){return Ee(!!n,49232),Se.fromTimestamp((function(t){const r=Os(t);return new Ze(r.seconds,r.nanos)})(n))}function P_(n,e){return uy(n,e).canonicalString()}function uy(n,e){const t=(function(s){return new qe(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function aA(n){const e=qe.fromString(n);return Ee(yA(e),10190,{key:e.toString()}),e}function Kc(n,e){return P_(n.databaseId,e.path)}function os(n,e){const t=aA(e);if(t.get(1)!==n.databaseId.projectId)throw new Q(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Q(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ue(cA(t))}function lA(n,e){return P_(n.databaseId,e)}function uA(n){const e=aA(n);return e.length===4?qe.emptyPath():cA(e)}function cy(n){return new qe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function cA(n){return Ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function aT(n,e,t){return{name:Kc(n,e),fields:t.value.mapValue.fields}}function dA(n,e,t){const r=os(n,e.name),s=Nt(e.updateTime),a=e.createTime?Nt(e.createTime):Se.min(),l=new sn({mapValue:{fields:e.fields}}),d=ht.newFoundDocument(r,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function JO(n,e){return"found"in e?(function(r,s){Ee(!!s.found,43571),s.found.name,s.found.updateTime;const a=os(r,s.found.name),l=Nt(s.found.updateTime),d=s.found.createTime?Nt(s.found.createTime):Se.min(),f=new sn({mapValue:{fields:s.found.fields}});return ht.newFoundDocument(a,l,d,f)})(n,e):"missing"in e?(function(r,s){Ee(!!s.missing,3894),Ee(!!s.readTime,22933);const a=os(r,s.missing),l=Nt(s.readTime);return ht.newNoDocument(a,l)})(n,e):me(7234,{result:e})}function YO(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:me(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,g){return p.useProto3Json?(Ee(g===void 0||typeof g=="string",58123),St.fromBase64String(g||"")):(Ee(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),St.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const g=p.code===void 0?W.UNKNOWN:nA(p.code);return new Q(g,p.message||"")})(l);t=new iA(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=os(n,r.document.name),a=Nt(r.document.updateTime),l=r.document.createTime?Nt(r.document.createTime):Se.min(),d=new sn({mapValue:{fields:r.document.fields}}),f=ht.newFoundDocument(s,a,l,d),p=r.targetIds||[],g=r.removedTargetIds||[];t=new df(p,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=os(n,r.document),a=r.readTime?Nt(r.readTime):Se.min(),l=ht.newNoDocument(s,a),d=r.removedTargetIds||[];t=new df([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=os(n,r.document),a=r.removedTargetIds||[];t=new df([],a,s,null)}else{if(!("filter"in e))return me(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new zO(s,a),d=r.targetId;t=new sA(d,l)}}return t}function Qc(n,e){let t;if(e instanceof Yl)t={update:aT(n,e.key,e.value)};else if(e instanceof Xl)t={delete:Kc(n,e.key)};else if(e instanceof Bs)t={update:aT(n,e.key,e.data),updateMask:rL(e.fieldMask)};else{if(!(e instanceof S_))return me(16599,{Vt:e.type});t={verify:Kc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof Dl)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Xo)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Zo)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Vl)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw me(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:QO(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me(27497)})(n,e.precondition)),t}function dy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?yt.updateTime(Nt(a.updateTime)):a.exists!==void 0?yt.exists(a.exists):yt.none()})(e.currentDocument):yt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)Ee(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Dl;else if("appendMissingElements"in d){const g=d.appendMissingElements.values||[];f=new Xo(g)}else if("removeAllFromArray"in d){const g=d.removeAllFromArray.values||[];f=new Zo(g)}else"increment"in d?f=new Vl(l,d.increment):me(16584,{proto:d});const p=gt.fromServerFormat(d.fieldPath);return new pd(p,f)})(n,s))):[];if(e.update){e.update.name;const s=os(n,e.update.name),a=new sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new On(p.map((g=>gt.fromServerFormat(g))))})(e.updateMask);return new Bs(s,a,l,t,r)}return new Yl(s,a,t,r)}if(e.delete){const s=os(n,e.delete);return new Xl(s,t)}if(e.verify){const s=os(n,e.verify);return new S_(s,t)}return me(1463,{proto:e})}function XO(n,e){return n&&n.length>0?(Ee(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Nt(s.updateTime):Nt(a);return l.isEqual(Se.min())&&(l=Nt(a)),new jO(l,s.transformResults||[])})(t,e)))):[]}function hA(n,e){return{documents:[lA(n,e.path)]}}function fA(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=lA(n,s);const a=(function(p){if(p.length!==0)return gA(tt.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((g=>(function(T){return{field:ll(T.field),direction:eL(T.dir)}})(g)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=ly(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function pA(n){let e=uA(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ee(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=(function(v){const T=mA(v);return T instanceof tt&&w_(T)?T.getFilters():[T]})(t.where));let l=[];t.orderBy&&(l=(function(v){return v.map((T=>(function(x){return new Gc(ul(x.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(v){let T;return T=typeof v=="object"?v.value:v,ud(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(v){const T=!!v.before,C=v.values||[];return new zi(C,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(v){const T=!v.before,C=v.values||[];return new zi(C,T)})(t.endAt)),U1(e,s,l,a,d,"F",f,p)}function ZO(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function mA(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ul(t.unaryFilter.field);return We.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ul(t.unaryFilter.field);return We.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ul(t.unaryFilter.field);return We.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ul(t.unaryFilter.field);return We.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return me(61313);default:return me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return We.create(ul(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return me(58110);default:return me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return tt.create(t.compositeFilter.filters.map((r=>mA(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me(1026)}})(t.compositeFilter.op))})(n):me(30097,{filter:n})}function eL(n){return WO[n]}function tL(n){return HO[n]}function nL(n){return GO[n]}function ll(n){return{fieldPath:n.canonicalString()}}function ul(n){return gt.fromServerFormat(n.fieldPath)}function gA(n){return n instanceof We?(function(t){if(t.op==="=="){if(WI(t.value))return{unaryFilter:{field:ll(t.field),op:"IS_NAN"}};if(qI(t.value))return{unaryFilter:{field:ll(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(WI(t.value))return{unaryFilter:{field:ll(t.field),op:"IS_NOT_NAN"}};if(qI(t.value))return{unaryFilter:{field:ll(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ll(t.field),op:tL(t.op),value:t.value}}})(n):n instanceof tt?(function(t){const r=t.getFilters().map((s=>gA(s)));return r.length===1?r[0]:{compositeFilter:{op:nL(t.op),filters:r}}})(n):me(54877,{filter:n})}function rL(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function yA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ks{constructor(e,t,r,s,a=Se.min(),l=Se.min(),d=St.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new ks(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class _A{constructor(e){this.yt=e}}function sL(n,e){let t;if(e.document)t=dA(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ue.fromSegments(e.noDocument.path),s=ta(e.noDocument.readTime);t=ht.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return me(56709);{const r=ue.fromSegments(e.unknownDocument.path),s=ta(e.unknownDocument.version);t=ht.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new Ze(s[0],s[1]);return Se.fromTimestamp(a)})(e.readTime)),t}function lT(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Vf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:Kc(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Ol(a,l.version.toTimestamp()),createTime:Ol(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ea(e.version)};else{if(!e.isUnknownDocument())return me(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:ea(e.version)}}return r}function Vf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ea(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ta(n){const e=new Ze(n.seconds,n.nanoseconds);return Se.fromTimestamp(e)}function Do(n,e){const t=(e.baseMutations||[]).map((a=>dy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>dy(n.yt,a))),s=Ze.fromMillis(e.localWriteTimeMs);return new A_(e.batchId,s,t,r)}function mc(n){const e=ta(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ta(n.lastLimboFreeSnapshotVersion):Se.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Ee(l===1,1966,{count:l}),Sn(Jl(uA(a.documents[0])))})(n.query):(function(a){return Sn(pA(a))})(n.query),new ks(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,St.fromBase64String(n.resumeToken))}function vA(n,e){const t=ea(e.snapshotVersion),r=ea(e.lastLimboFreeSnapshotVersion);let s;s=Cf(e.target)?hA(n.yt,e.target):fA(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yo(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function k_(n){const e=pA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Df(e,e.limit,"L"):e}function Sg(n,e){return new b_(e.largestBatchId,dy(n.yt,e.overlayMutation))}function uT(n,e){const t=e.path.lastSegment();return[n,_n(e.path.popLast()),t]}function cT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ea(r.readTime),documentKey:_n(r.documentKey.path),largestBatchId:r.largestBatchId}}class iL{getBundleMetadata(e,t){return dT(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:ta(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return dT(e).put((function(s){return{bundleId:s.id,createTime:ea(Nt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return hT(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:k_(a.bundledQuery),readTime:ta(a.readTime)}})(r)}))}saveNamedQuery(e,t){return hT(e).put((function(s){return{name:s.name,readTime:ea(Nt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function dT(n){return qt(n,lp)}function hT(n){return qt(n,up)}class gp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new gp(e,r)}getOverlay(e,t){return rc(e).get(uT(this.userId,t)).next((r=>r?Sg(this.serializer,r):null))}getOverlays(e,t){const r=ss();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const d=new b_(t,l);s.push(this.St(e,d))})),U.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(_n(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(rc(e).Z(Zg,d))})),U.waitFor(a)}getOverlaysForCollection(e,t,r){const s=ss(),a=_n(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return rc(e).J(Zg,l).next((d=>{for(const f of d){const p=Sg(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=ss();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return rc(e).ee({index:_1,range:d},((f,p,g)=>{const v=Sg(this.serializer,p);a.size()<s||v.largestBatchId===l?(a.set(v.getKey(),v),l=v.largestBatchId):g.done()})).next((()=>a))}St(e,t){return rc(e).put((function(s,a,l){const[d,f,p]=uT(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Qc(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function rc(n){return qt(n,cp)}class oL{bt(e){return qt(e,g_)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?St.fromUint8Array(r):St.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Vo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(mt(e.integerValue));else if("doubleValue"in e){const r=mt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Uc(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Os(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ls(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?k1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):me(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const s=kl,a=r[s].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(mt(a)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),ue.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Vo.Kt=new Vo;const nl=255;function aL(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function fT(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=aL(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class lL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),r=fT(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=fT(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(nl),this.sn(255)}_n(){this.an(nl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===nl?(this.sn(nl),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===nl?(this.an(nl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class uL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class cL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class sc{constructor(){this.cn=new lL,this.ln=new uL(this.cn),this.hn=new cL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Oo{constructor(e,t,r,s){this.Tn=e,this.In=t,this.En=r,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Oo(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:hf(this.En),directionalValue:hf(this.dn),orderedDocumentKey:hf(t),documentKey:r.path.toArray()}}Vn(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function wi(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=pT(n.En,e.En),t!==0?t:(t=pT(n.dn,e.dn),t!==0?t:ue.comparator(n.In,e.In)))}function pT(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function hf(n){return L0()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function mT(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class gT{constructor(e){this.mn=new nt(((t,r)=>gt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ee(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Jg(e);if(t!==void 0&&!this.wn(t))return!1;const r=ko(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.wn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const d=this.mn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=r[a];if(!this.Sn(d,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.fn.length||!this.bn(this.fn[l++],d))return!1}return!0}Dn(){if(this.pn)return null;let e=new nt(gt.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new rf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new rf(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new rf(r.field,r.dir==="asc"?0:1)));return new bf(bf.UNKNOWN_ID,this.collectionId,t,jc.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function wA(n){if(Ee(n instanceof We||n instanceof tt,20012),n instanceof We){if(n instanceof j1){const t=n.value.arrayValue?.values?.map((r=>We.create(n.field,"==",r)))||[];return tt.create(t,"or")}return n}const e=n.filters.map((t=>wA(t)));return tt.create(e,n.op)}function dL(n){if(n.getFilters().length===0)return[];const e=py(wA(n));return Ee(EA(e),7391),hy(e)||fy(e)?[e]:e.getFilters()}function hy(n){return n instanceof We}function fy(n){return n instanceof tt&&w_(n)}function EA(n){return hy(n)||fy(n)||(function(t){if(t instanceof tt&&sy(t)){for(const r of t.getFilters())if(!hy(r)&&!fy(r))return!1;return!0}return!1})(n)}function py(n){if(Ee(n instanceof We||n instanceof tt,34018),n instanceof We)return n;if(n.filters.length===1)return py(n.filters[0]);const e=n.filters.map((r=>py(r)));let t=tt.create(e,n.op);return t=Of(t),EA(t)?t:(Ee(t instanceof tt,64498),Ee(Nl(t),40251),Ee(t.filters.length>1,57927),t.filters.reduce(((r,s)=>C_(r,s))))}function C_(n,e){let t;return Ee(n instanceof We||n instanceof tt,38388),Ee(e instanceof We||e instanceof tt,25473),t=n instanceof We?e instanceof We?(function(s,a){return tt.create([s,a],"and")})(n,e):yT(n,e):e instanceof We?yT(e,n):(function(s,a){if(Ee(s.filters.length>0&&a.filters.length>0,48005),Nl(s)&&Nl(a))return L1(s,a.getFilters());const l=sy(s)?s:a,d=sy(s)?a:s,f=l.filters.map((p=>C_(p,d)));return tt.create(f,"or")})(n,e),Of(t)}function yT(n,e){if(Nl(e))return L1(e,n.getFilters());{const t=e.filters.map((r=>C_(n,r)));return tt.create(t,"or")}}function Of(n){if(Ee(n instanceof We||n instanceof tt,11850),n instanceof We)return n;const e=n.getFilters();if(e.length===1)return Of(e[0]);if(V1(n))return n;const t=e.map((s=>Of(s))),r=[];return t.forEach((s=>{s instanceof We?r.push(s):s instanceof tt&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:tt.create(r,n.op)}class hL{constructor(){this.Cn=new N_}addToCollectionParentIndex(e,t){return this.Cn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(tr.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(tr.min())}updateCollectionGroup(e,t,r){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class N_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new nt(qe.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new nt(qe.comparator)).toArray()}}const _T="IndexedDbIndexManager",Gh=new Uint8Array(0);class fL{constructor(e,t){this.databaseId=t,this.vn=new N_,this.Fn=new Us((r=>Yo(r)),((r,s)=>dd(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:_n(s)};return vT(e).put(a)}return U.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[r1(t),""],!1,!0);return vT(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(rs(l.parent))}return r}))}addFieldIndex(e,t){const r=ic(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=sl(e);return a.next((d=>{l.put(cT(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=ic(e),s=sl(e),a=rl(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ic(e),r=rl(e),s=sl(e);return t.Z().next((()=>r.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return U.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new gT(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=rl(e);let s=!0;const a=new Map;return U.forEach(this.Mn(t),(l=>this.xn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=je();const d=[];return U.forEach(a,((f,p)=>{Y(_T,`Using index ${(function(Z){return`id=${Z.indexId}|cg=${Z.collectionGroup}|f=${Z.fields.map((re=>`${re.fieldPath}:${re.kind}`)).join(",")}`})(f)} to execute ${Yo(t)}`);const g=(function(Z,re){const de=Jg(re);if(de===void 0)return null;for(const le of Nf(Z,de.fieldPath))switch(le.op){case"array-contains-any":return le.value.arrayValue.values||[];case"array-contains":return[le.value]}return null})(p,f),v=(function(Z,re){const de=new Map;for(const le of ko(re))for(const R of Nf(Z,le.fieldPath))switch(R.op){case"==":case"in":de.set(le.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return de.set(le.fieldPath.canonicalString(),R.value),Array.from(de.values())}return null})(p,f),T=(function(Z,re){const de=[];let le=!0;for(const R of ko(re)){const b=R.kind===0?JI(Z,R.fieldPath,Z.startAt):YI(Z,R.fieldPath,Z.startAt);de.push(b.value),le&&(le=b.inclusive)}return new zi(de,le)})(p,f),C=(function(Z,re){const de=[];let le=!0;for(const R of ko(re)){const b=R.kind===0?YI(Z,R.fieldPath,Z.endAt):JI(Z,R.fieldPath,Z.endAt);de.push(b.value),le&&(le=b.inclusive)}return new zi(de,le)})(p,f),x=this.On(f,p,T),O=this.On(f,p,C),L=this.Nn(f,p,v),ne=this.Bn(f.indexId,g,x,T.inclusive,O,C.inclusive,L);return U.forEach(ne,(oe=>r.Y(oe,t.limit).next((Z=>{Z.forEach((re=>{const de=ue.fromSegments(re.documentKey);l.has(de)||(l=l.add(de),d.push(de))}))}))))})).next((()=>d))}return U.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=dL(tt.create(e.filters,"and")).map((r=>oy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),p=f/(t!=null?t.length:1),g=[];for(let v=0;v<f;++v){const T=t?this.Ln(t[v/p]):Gh,C=this.kn(e,T,r[v%p],s),x=this.qn(e,T,a[v%p],l),O=d.map((L=>this.kn(e,T,L,!0)));g.push(...this.createRange(C,x,O))}return g}kn(e,t,r,s){const a=new Oo(e,ue.empty(),t,r);return s?a:a.An()}qn(e,t,r,s){const a=new Oo(e,ue.empty(),t,r);return s?a.An():a}xn(e,t){const r=new gT(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)r.yn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const s=this.Mn(t);return U.forEach(s,(a=>this.xn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let p=new nt(gt.comparator),g=!1;for(const v of f.filters)for(const T of v.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?g=!0:p=p.add(T.field));for(const v of f.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(g?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}Qn(e,t){const r=new sc;for(const s of ko(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.Pn(s.kind);Vo.Kt.Dt(a,l)}return r.un()}Ln(e){const t=new sc;return Vo.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new sc;return Vo.Kt.Dt(Jo(this.databaseId,t),r.Pn((function(a){const l=ko(a);return l.length===0?0:l[l.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let s=[];s.push(new sc);let a=0;for(const l of ko(e)){const d=r[a++];for(const f of s)if(this.Un(t,l.fieldPath)&&Hc(d))s=this.Kn(s,l,d);else{const p=f.Pn(l.kind);Vo.Kt.Dt(d,p)}}return this.Wn(s)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of s){const f=new sc;f.seed(d.un()),Vo.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof We&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=ic(e),s=sl(e);return(t?r.J(Xg,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const l=[];return U.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(g,v){const T=v?new jc(v.sequenceNumber,new tr(ta(v.readTime),new ue(rs(v.documentKey)),v.largestBatchId)):jc.empty(),C=g.fields.map((([x,O])=>new rf(gt.fromServerFormat(x),O)));return new bf(g.indexId,g.collectionGroup,C,T)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Oe(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=ic(e),a=sl(e);return this.Gn(e).next((l=>s.J(Xg,IDBKeyRange.bound(t,t)).next((d=>U.forEach(d,(f=>a.put(cT(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return U.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?U.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(r.set(s.collectionGroup,d),U.forEach(d,(f=>this.zn(e,s,f).next((p=>{const g=this.jn(a,f);return p.isEqual(g)?U.resolve():this.Jn(e,a,f,p,g)})))))))}))}Hn(e,t,r,s){return rl(e).put(s.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,s){return rl(e).delete(s.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const s=rl(e);let a=new nt(wi);return s.ee({index:y1,range:IDBKeyRange.only([r.indexId,this.uid,hf(this.$n(r,t))])},((l,d)=>{a=a.add(new Oo(r.indexId,t,mT(d.arrayValue),mT(d.directionalValue)))})).next((()=>a))}jn(e,t){let r=new nt(wi);const s=this.Qn(t,e);if(s==null)return r;const a=Jg(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Hc(l))for(const d of l.arrayValue.values||[])r=r.add(new Oo(t.indexId,e.key,this.Ln(d),s))}else r=r.add(new Oo(t.indexId,e.key,Gh,s));return r}Jn(e,t,r,s,a){Y(_T,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,g,v,T){const C=f.getIterator(),x=p.getIterator();let O=tl(C),L=tl(x);for(;O||L;){let ne=!1,oe=!1;if(O&&L){const Z=g(O,L);Z<0?oe=!0:Z>0&&(ne=!0)}else O!=null?oe=!0:ne=!0;ne?(v(L),L=tl(x)):oe?(T(O),O=tl(C)):(O=tl(C),L=tl(x))}})(s,a,wi,(d=>{l.push(this.Hn(e,t,r,d))}),(d=>{l.push(this.Yn(e,t,r,d))})),U.waitFor(l)}Gn(e){let t=1;return sl(e).ee({index:g1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>wi(l,d))).filter(((l,d,f)=>!d||wi(l,f[d-1])!==0));const s=[];s.push(e);for(const l of r){const d=wi(l,e),f=wi(l,t);if(d===0)s[0]=e.An();else if(d>0&&f<0)s.push(l),s.push(l.An());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const d=s[l].Vn(this.uid,Gh,ue.empty()),f=s[l+1].Vn(this.uid,Gh,ue.empty());a.push(IDBKeyRange.bound(d,f))}return a}Zn(e,t){return wi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(wT)}getMinOffset(e,t){return U.mapArray(this.Mn(t),(r=>this.xn(e,r).next((s=>s||me(44426))))).next(wT)}}function vT(n){return qt(n,$c)}function rl(n){return qt(n,xc)}function ic(n){return qt(n,m_)}function sl(n){return qt(n,Ac)}function wT(n){Ee(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;h_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new tr(e.readTime,e.documentKey,t)}const ET={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},IA=41943040;class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function TA(n,e,t){const r=n.store(Sr),s=n.store(xl),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=r.ee({range:l},((g,v,T)=>(d++,T.delete())));a.push(f.next((()=>{Ee(d===1,47070,{batchId:t.batchId})})));const p=[];for(const g of t.mutations){const v=f1(e,g.key.path,t.batchId);a.push(s.delete(v)),p.push(g.key)}return U.waitFor(a).next((()=>p))}function Lf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw me(14731);e=n.noDocument}return JSON.stringify(e).length}pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(IA,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);class yp{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,t,r,s){Ee(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new yp(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ei(e).ee({index:Fo,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=cl(e),l=Ei(e);return l.add({}).next((d=>{Ee(typeof d=="number",49019);const f=new A_(d,t,r,s),p=(function(C,x,O){const L=O.baseMutations.map((oe=>Qc(C.yt,oe))),ne=O.mutations.map((oe=>Qc(C.yt,oe)));return{userId:x,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:L,mutations:ne}})(this.serializer,this.userId,f),g=[];let v=new nt(((T,C)=>Oe(T.canonicalString(),C.canonicalString())));for(const T of s){const C=f1(this.userId,T.key.path,d);v=v.add(T.key.path.popLast()),g.push(l.put(p)),g.push(a.put(C,GV))}return v.forEach((T=>{g.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Xn[d]=f.keys()})),U.waitFor(g).next((()=>f))}))}lookupMutationBatch(e,t){return Ei(e).get(t).next((r=>r?(Ee(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Do(this.serializer,r)):null))}er(e,t){return this.Xn[t]?U.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Ei(e).ee({index:Fo,range:s},((l,d,f)=>{d.userId===this.userId&&(Ee(d.batchId>=r,47524,{tr:r}),a=Do(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Di;return Ei(e).ee({index:Fo,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Di],[this.userId,Number.POSITIVE_INFINITY]);return Ei(e).J(Fo,t).next((r=>r.map((s=>Do(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=sf(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return cl(e).ee({range:s},((l,d,f)=>{const[p,g,v]=l,T=rs(g);if(p===this.userId&&t.path.isEqual(T))return Ei(e).get(v).next((C=>{if(!C)throw me(61480,{nr:l,batchId:v});Ee(C.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:C.userId,batchId:v}),a.push(Do(this.serializer,C))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new nt(Oe);const s=[];return t.forEach((a=>{const l=sf(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=cl(e).ee({range:d},((p,g,v)=>{const[T,C,x]=p,O=rs(C);T===this.userId&&a.path.isEqual(O)?r=r.add(x):v.done()}));s.push(f)})),U.waitFor(s).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=sf(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new nt(Oe);return cl(e).ee({range:l},((f,p,g)=>{const[v,T,C]=f,x=rs(T);v===this.userId&&r.isPrefixOf(x)?x.length===s&&(d=d.add(C)):g.done()})).next((()=>this.rr(e,d)))}rr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(Ei(e).get(a).next((l=>{if(l===null)throw me(35274,{batchId:a});Ee(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Do(this.serializer,l))})))})),U.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return TA(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),U.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return U.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return cl(e).ee({range:r},((a,l,d)=>{if(a[0]===this.userId){const f=rs(a[1]);s.push(f)}else d.done()})).next((()=>{Ee(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return SA(e,this.userId,t)}_r(e){return AA(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Di,lastStreamToken:""}))}}function SA(n,e,t){const r=sf(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return cl(n).ee({range:a,X:!0},((d,f,p)=>{const[g,v,T]=d;g===e&&v===s&&(l=!0),p.done()})).next((()=>l))}function Ei(n){return qt(n,Sr)}function cl(n){return qt(n,xl)}function AA(n){return qt(n,Bc)}class na{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new na(0)}static cr(){return new na(-1)}}class pL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new na(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Se.fromTimestamp(new Ze(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>il(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ee(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return il(e).ee(((l,d)=>{const f=mc(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>U.waitFor(a))).next((()=>s))}forEachTarget(e,t){return il(e).ee(((r,s)=>{const a=mc(s);t(a)}))}lr(e){return IT(e).get(kf).next((t=>(Ee(t!==null,2888),t)))}hr(e,t){return IT(e).put(kf,t)}Pr(e,t){return il(e).put(vA(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Yo(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return il(e).ee({range:s,index:m1},((l,d,f)=>{const p=mc(d);dd(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=Ai(e);return t.forEach((l=>{const d=_n(l.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,l))})),U.waitFor(s)}removeMatchingKeys(e,t,r){const s=Ai(e);return U.forEach(t,(a=>{const l=_n(a.path);return U.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Ai(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Ai(e);let a=je();return s.ee({range:r,X:!0},((l,d,f)=>{const p=rs(l[1]),g=new ue(p);a=a.add(g)})).next((()=>a))}containsKey(e,t){const r=_n(t.path),s=IDBKeyRange.bound([r],[r1(r)],!1,!0);let a=0;return Ai(e).ee({index:p_,X:!0,range:s},(([l,d],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return il(e).get(t).next((r=>r?mc(r):null))}}function il(n){return qt(n,bl)}function IT(n){return qt(n,qo)}function Ai(n){return qt(n,Rl)}const TT="LruGarbageCollector",mL=1048576;function ST([n,e],[t,r]){const s=Oe(n,t);return s===0?Oe(e,r):s}class gL{constructor(e){this.Ir=e,this.buffer=new nt(ST),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ST(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xA{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(TT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ji(t)?Y(TT,"Ignoring IndexedDB error during garbage collection: ",t):await Qi(t)}await this.Vr(3e5)}))}}class yL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(Vn.ce);const r=new gL(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(ET)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ET):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,a,l,d,f,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,l=Date.now(),this.nthSequenceNumber(e,s)))).next((v=>(r=v,d=Date.now(),this.removeTargets(e,r,t)))).next((v=>(a=v,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(p=Date.now(),ol()<=$e.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-g}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:v}))))}}function bA(n,e){return new yL(n,e)}class _L{constructor(e,t){this.db=e,this.garbageCollector=bA(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,s)=>t(s)))}addReference(e,t,r){return Kh(e,r)}removeReference(e,t,r){return Kh(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Kh(e,t)}br(e,t){return(function(s,a){let l=!1;return AA(s).te((d=>SA(s,d,a).next((f=>(f&&(l=!0),U.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,d)=>{if(d<=t){const f=this.br(e,l).next((p=>{if(!p)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,Se.min()),Ai(e).delete((function(v){return[0,_n(v.path)]})(l)))))}));s.push(f)}})).next((()=>U.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Kh(e,t)}Sr(e,t){const r=Ai(e);let s,a=Vn.ce;return r.ee({index:p_},(([l,d],{path:f,sequenceNumber:p})=>{l===0?(a!==Vn.ce&&t(new ue(rs(s)),a),a=p,s=f):a=Vn.ce})).next((()=>{a!==Vn.ce&&t(new ue(rs(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kh(n,e){return Ai(n).put((function(r,s){return{targetId:0,path:_n(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}class RA{constructor(){this.changes=new Us((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?U.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ro(e).put(r)}removeEntry(e,t,r){return Ro(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Vf(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=ht.newInvalidDocument(t);return Ro(e).ee({index:of,range:IDBKeyRange.only(oc(t))},((s,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:ht.newInvalidDocument(t)};return Ro(e).ee({index:of,range:IDBKeyRange.only(oc(t))},((s,a)=>{r={document:this.Cr(t,a),size:Lf(a)}})).next((()=>r))}getEntries(e,t){let r=Ln();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);r=r.insert(s,l)})).next((()=>r))}Mr(e,t){let r=Ln(),s=new at(ue.comparator);return this.Fr(e,t,((a,l)=>{const d=this.Cr(a,l);r=r.insert(a,d),s=s.insert(a,Lf(l))})).next((()=>({documents:r,Or:s})))}Fr(e,t,r){if(t.isEmpty())return U.resolve();let s=new nt(bT);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(oc(s.first()),oc(s.last())),l=s.getIterator();let d=l.getNext();return Ro(e).ee({index:of,range:a},((f,p,g)=>{const v=ue.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&bT(d,v)<0;)r(d,null),d=l.getNext();d&&d.isEqual(v)&&(r(d,p),d=l.hasNext()?l.getNext():null),d?g.j(oc(d)):g.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),Vf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ro(e).J(IDBKeyRange.bound(d,f,!0)).next((p=>{a?.incrementDocumentReadCount(p.length);let g=Ln();for(const v of p){const T=this.Cr(ue.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);T.isFoundDocument()&&(fd(t,T)||s.has(T.key))&&(g=g.insert(T.key,T))}return g}))}getAllFromCollectionGroup(e,t,r,s){let a=Ln();const l=xT(t,r),d=xT(t,tr.max());return Ro(e).ee({index:p1,range:IDBKeyRange.bound(l,d,!0)},((f,p,g)=>{const v=this.Cr(ue.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(v.key,v),a.size===s&&g.done()})).next((()=>a))}newChangeBuffer(e){return new wL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return AT(e).get(Yg).next((t=>(Ee(!!t,20021),t)))}Dr(e,t){return AT(e).put(Yg,t)}Cr(e,t){if(t){const r=sL(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Se.min())))return r}return ht.newInvalidDocument(e)}}function PA(n){return new vL(n)}class wL extends RA{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Us((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new nt(((a,l)=>Oe(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=lT(this.Nr.serializer,l);s=s.add(a.path.popLast());const p=Lf(f);r+=p-d.size,t.push(this.Nr.addEntry(e,a,f))}else if(r-=d.size,this.trackRemovals){const f=lT(this.Nr.serializer,l.convertToNoDocument(Se.min()));t.push(this.Nr.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),U.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function AT(n){return qt(n,zc)}function Ro(n){return qt(n,Pf)}function oc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xT(n,e){const t=e.documentKey.path.toArray();return[n,Vf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function bT(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=Oe(t[a],r[a]),s)return s;return s=Oe(t.length,r.length),s||(s=Oe(t[t.length-2],r[r.length-2]),s||Oe(t[t.length-1],r[r.length-1]))}class EL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class kA{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Pc(r.mutation,s,On.empty(),Ze.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,je()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=je()){const s=ss();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=fc();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=ss();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,je())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,s){let a=Ln();const l=Rc(),d=(function(){return Rc()})();return t.forEach(((f,p)=>{const g=r.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof Bs)?a=a.insert(p.key,p):g!==void 0?(l.set(p.key,g.mutation.getFieldMask()),Pc(g.mutation,p,g.mutation.getFieldMask(),Ze.now())):l.set(p.key,On.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,g)=>l.set(p,g))),t.forEach(((p,g)=>d.set(p,new EL(g,l.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const r=Rc();let s=new at(((l,d)=>l-d)),a=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let g=r.get(f)||On.empty();g=d.applyToLocalView(p,g),r.set(f,g);const v=(s.get(d.batchId)||je()).add(f);s=s.insert(d.batchId,v)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,g=f.value,v=H1();g.forEach((T=>{if(!a.has(T)){const C=Z1(t.get(T),r.get(T));C!==null&&v.set(T,C),a=a.add(T)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,v))}return U.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return ue.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):E_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):U.resolve(ss());let d=Al,f=a;return l.next((p=>U.forEach(p,((g,v)=>(d<v.largestBatchId&&(d=v.largestBatchId),a.get(g)?U.resolve():this.remoteDocumentCache.getEntry(e,g).next((T=>{f=f.insert(g,T)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,je()))).next((g=>({batchId:d,changes:W1(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ue(t)).next((r=>{let s=fc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=fc();return this.indexManager.getCollectionParents(e,a).next((d=>U.forEach(d,(f=>{const p=(function(v,T){return new js(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((g=>{g.forEach(((v,T)=>{l=l.insert(v,T)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,p)=>{const g=p.getKey();l.get(g)===null&&(l=l.insert(g,ht.newInvalidDocument(g)))}));let d=fc();return l.forEach(((f,p)=>{const g=a.get(f);g!==void 0&&Pc(g.mutation,p,On.empty(),Ze.now()),fd(t,p)&&(d=d.insert(f,p))})),d}))}}class IL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return U.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Nt(s.createTime)}})(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:k_(s.bundledQuery),readTime:Nt(s.readTime)}})(t)),U.resolve()}}class TL{constructor(){this.overlays=new at(ue.comparator),this.qr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ss();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.St(e,t,a)})),U.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,t,r){const s=ss(),a=t.length+1,l=new ue(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return U.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new at(((p,g)=>p-g));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let g=a.get(p.largestBatchId);g===null&&(g=ss(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const d=ss(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,g)=>d.set(p,g))),!(d.size()>=s)););return U.resolve(d)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new b_(t,r));let a=this.qr.get(t);a===void 0&&(a=je(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class SL{constructor(){this.sessionToken=St.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}}class D_{constructor(){this.Qr=new nt(Qt.$r),this.Ur=new nt(Qt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Qt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Qt(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ue(new qe([])),r=new Qt(t,e),s=new Qt(t,e+1),a=[];return this.Ur.forEachInRange([r,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ue(new qe([])),r=new Qt(t,e),s=new Qt(t,e+1);let a=je();return this.Ur.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Qt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Qt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ue.comparator(e.key,t.key)||Oe(e.Yr,t.Yr)}static Kr(e,t){return Oe(e.Yr,t.Yr)||ue.comparator(e.key,t.key)}}class AL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new nt(Qt.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new A_(a,t,r,s);this.mutationQueue.push(l);for(const d of s)this.Zr=this.Zr.add(new Qt(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return U.resolve(l)}lookupMutationBatch(e,t){return U.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),a=s<0?0:s;return U.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Di:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Qt(t,0),s=new Qt(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,s],(l=>{const d=this.Xr(l.Yr);a.push(d)})),U.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new nt(Oe);return t.forEach((s=>{const a=new Qt(s,0),l=new Qt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(d=>{r=r.add(d.Yr)}))})),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;ue.isDocumentKey(a)||(a=a.child(""));const l=new Qt(new ue(a),0);let d=new nt(Oe);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(d=d.add(f.Yr)),!0)}),l),U.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ee(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(t.mutations,(s=>{const a=new Qt(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Qt(t,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xL{constructor(e){this.ri=e,this.docs=(function(){return new at(ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return U.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(t))}getEntries(e,t){let r=Ln();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():ht.newInvalidDocument(s))})),U.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=Ln();const l=t.path,d=new ue(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:g}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||h_(l1(g),r)<=0||(s.has(g.key)||fd(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return U.resolve(a)}getAllFromCollectionGroup(e,t,r,s){me(9500)}ii(e,t){return U.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new bL(this)}getSize(e){return U.resolve(this.size)}}class bL extends RA{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),U.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class RL{constructor(e){this.persistence=e,this.si=new Us((t=>Yo(t)),dd),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.oi=0,this._i=new D_,this.targetCount=0,this.ai=na.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),U.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new na(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.Pr(t),U.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.si.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),U.waitFor(a).next((()=>s))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return U.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),U.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),U.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return U.resolve(r)}containsKey(e,t){return U.resolve(this._i.containsKey(t))}}class V_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Vn(0),this.li=!1,this.li=!0,this.hi=new SL,this.referenceDelegate=e(this),this.Pi=new RL(this),this.indexManager=new hL,this.remoteDocumentCache=(function(s){return new xL(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new _A(t),this.Ii=new IL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new TL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new AL(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Y("MemoryPersistence","Starting transaction:",e);const s=new PL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return U.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class PL extends c1{constructor(e){super(),this.currentSequenceNumber=e}}class _p{constructor(e){this.persistence=e,this.Ri=new D_,this.Vi=null}static mi(e){return new _p(e)}get fi(){if(this.Vi)return this.Vi;throw me(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),U.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,(r=>{const s=ue.fromPath(r);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Se.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Mf{constructor(e,t){this.persistence=e,this.pi=new Us((r=>_n(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=bA(this,t)}static mi(e,t){return new Mf(e,t)}Ei(){}di(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return U.forEach(this.pi,((r,s)=>this.br(e,r,s).next((a=>a?U.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((d=>{d||(r++,a.removeEntry(l,Se.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=lf(e.data.value)),t}br(e,t,r){return U.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class kL{constructor(e){this.serializer=e}k(e,t,r,s){const a=new ap("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore(cd)})(e),(function(f){f.createObjectStore(Bc,{keyPath:HV}),f.createObjectStore(Sr,{keyPath:FI,autoIncrement:!0}).createIndex(Fo,jI,{unique:!0}),f.createObjectStore(xl)})(e),RT(e),(function(f){f.createObjectStore(Co)})(e));let l=U.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Rl),f.deleteObjectStore(bl),f.deleteObjectStore(qo)})(e),RT(e)),l=l.next((()=>(function(f){const p=f.store(qo),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return p.put(kf,g)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,p){return p.store(Sr).J().next((v=>{f.deleteObjectStore(Sr),f.createObjectStore(Sr,{keyPath:FI,autoIncrement:!0}).createIndex(Fo,jI,{unique:!0});const T=p.store(Sr),C=v.map((x=>T.put(x)));return U.waitFor(C)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Pl,{keyPath:tO})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.yi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(zc)})(e),this.wi(a))))),r<7&&s>=7&&(l=l.next((()=>this.Si(a)))),r<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.Di(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(lp,{keyPath:nO})})(e),(function(f){f.createObjectStore(up,{keyPath:rO})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(cp,{keyPath:cO});p.createIndex(Zg,dO,{unique:!1}),p.createIndex(_1,hO,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(Pf,{keyPath:KV});p.createIndex(of,QV),p.createIndex(p1,JV)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Co)))),r<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(m_,{keyPath:sO,autoIncrement:!0}).createIndex(Xg,iO,{unique:!1}),f.createObjectStore(Ac,{keyPath:oO}).createIndex(g1,aO,{unique:!1}),f.createObjectStore(xc,{keyPath:lO}).createIndex(y1,uO,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(Ac).clear()})).next((()=>{t.objectStore(xc).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(g_,{keyPath:fO})})(e)}))),r<18&&s>=18&&L0()&&(l=l.next((()=>{t.objectStore(Ac).clear()})).next((()=>{t.objectStore(xc).clear()}))),l}wi(e){let t=0;return e.store(Co).ee(((r,s)=>{t+=Lf(s)})).next((()=>{const r={byteSize:t};return e.store(zc).put(Yg,r)}))}yi(e){const t=e.store(Bc),r=e.store(Sr);return t.J().next((s=>U.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Di],[a.userId,a.lastAcknowledgedBatchId]);return r.J(Fo,l).next((d=>U.forEach(d,(f=>{Ee(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Do(this.serializer,f);return TA(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(Rl),r=e.store(Co);return e.store(qo).get(kf).next((s=>{const a=[];return r.ee(((l,d)=>{const f=new qe(l),p=(function(v){return[0,_n(v)]})(f);a.push(t.get(p).next((g=>g?U.resolve():(v=>t.put({targetId:0,path:_n(v),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>U.waitFor(a)))}))}bi(e,t){e.createObjectStore($c,{keyPath:eO});const r=t.store($c),s=new N_,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return r.put({collectionId:d,parent:_n(f)})}};return t.store(Co).ee({X:!0},((l,d)=>{const f=new qe(l);return a(f.popLast())})).next((()=>t.store(xl).ee({X:!0},(([l,d,f],p)=>{const g=rs(d);return a(g.popLast())}))))}Di(e){const t=e.store(bl);return t.ee(((r,s)=>{const a=mc(s),l=vA(this.serializer,a);return t.put(l)}))}Ci(e,t){const r=t.store(Co),s=[];return r.ee(((a,l)=>{const d=t.store(Pf),f=(function(v){return v.document?new ue(qe.fromString(v.document.name).popFirst(5)):v.noDocument?ue.fromSegments(v.noDocument.path):v.unknownDocument?ue.fromSegments(v.unknownDocument.path):me(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>U.waitFor(s)))}Fi(e,t){const r=t.store(Sr),s=PA(this.serializer),a=new V_(_p.mi,this.serializer.yt);return r.J().next((l=>{const d=new Map;return l.forEach((f=>{let p=d.get(f.userId)??je();Do(this.serializer,f).keys().forEach((g=>p=p.add(g))),d.set(f.userId,p)})),U.forEach(d,((f,p)=>{const g=new Jt(p),v=gp.wt(this.serializer,g),T=a.getIndexManager(g),C=yp.wt(g,this.serializer,T,a.referenceDelegate);return new kA(s,C,v,T).recalculateAndSaveOverlaysForDocumentKeys(new ey(t,Vn.ce),f).next()}))}))}}function RT(n){n.createObjectStore(Rl,{keyPath:XV}).createIndex(p_,ZV,{unique:!0}),n.createObjectStore(bl,{keyPath:"targetId"}).createIndex(m1,YV,{unique:!0}),n.createObjectStore(qo)}const Ii="IndexedDbPersistence",Ag=18e5,xg=5e3,bg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",CA="main";class O_{constructor(e,t,r,s,a,l,d,f,p,g,v=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=l,this.document=d,this.xi=p,this.Oi=g,this.Ni=v,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!O_.v())throw new Q(W.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _L(this,s),this.$i=t+CA,this.serializer=new _A(f),this.Ui=new is(this.$i,this.Ni,new kL(this.serializer)),this.hi=new oL,this.Pi=new pL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=PA(this.serializer),this.Ii=new iL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,g===!1&&Ct(Ii,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(W.FAILED_PRECONDITION,bg);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Vn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Qh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ji(e))return Y(Ii,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Y(Ii,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return ac(e).get(el).next((t=>U.resolve(this.es(t))))}ts(e){return Qh(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ag)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=qt(t,Pl);return r.J().next((s=>{const a=this.ss(s,Ag),l=s.filter((d=>a.indexOf(d)===-1));return U.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?U.resolve(!0):ac(e).get(el).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xg)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Q(W.FAILED_PRECONDITION,bg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qh(e).J().next((r=>this.ss(r,xg).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Y(Ii,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[cd,Pl],(e=>{const t=new ey(e,Vn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Qh(e).J().next((t=>this.ss(t,Ag).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return yp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return gp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Y(Ii,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?gO:f===17?I1:f===16?mO:f===15?y_:f===14?E1:f===13?w1:f===12?pO:f===11?v1:void me(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(d=>(l=new ey(d,this.ci?this.ci.next():Vn.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Ct(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Q(W.FAILED_PRECONDITION,u1);return r(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Is(e){return ac(e).get(el).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xg)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Q(W.FAILED_PRECONDITION,bg)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ac(e).put(el,t)}static v(){return is.v()}Zi(e){const t=ac(e);return t.get(el).next((r=>this.es(r)?(Y(Ii,"Releasing primary lease."),t.delete(el)):U.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ct(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;O0()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Y(Ii,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ct(Ii,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ct("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ac(n){return qt(n,cd)}function Qh(n){return qt(n,Pl)}function L_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class M_{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=je(),s=je();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new M_(e,t.fromCache,r,s)}}class CL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class NA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return O0()?8:d1(wt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new CL;return this.Ss(e,t,l).next((d=>{if(a.result=d,this.Vs)return this.bs(e,t,l,d.size)}))})).next((()=>a.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(ol()<=$e.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",al(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(ol()<=$e.DEBUG&&Y("QueryEngine","Query:",al(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ol()<=$e.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",al(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sn(t))):U.resolve())}ys(e,t){if(XI(t))return U.resolve(null);let r=Sn(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Df(t,null,"F"),r=Sn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=je(...a);return this.ps.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.Ds(t,d);return this.Cs(t,p,l,f.readTime)?this.ys(e,Df(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,r,s){return XI(t)||s.isEqual(Se.min())?U.resolve(null):this.ps.getDocuments(e,r).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,r,s)?U.resolve(null):(ol()<=$e.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),al(t)),this.vs(e,l,t,a1(s,Al)).next((d=>d)))}))}Ds(e,t){let r=new nt($1(e));return t.forEach(((s,a)=>{fd(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,r){return ol()<=$e.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",al(t)),this.ps.getDocumentsMatchingQuery(e,t,tr.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}const F_="LocalStore",NL=3e8;class DL{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new at(Oe),this.xs=new Us((a=>Yo(a)),dd),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function DA(n,e,t,r){return new DL(n,e,t,r)}async function VA(n,e){const t=he(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let f=je();for(const p of s){l.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}for(const p of a){d.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(r,f).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function VL(n,e){const t=he(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,g){const v=p.batch,T=v.keys();let C=U.resolve();return T.forEach((x=>{C=C.next((()=>g.getEntry(f,x))).next((O=>{const L=p.docVersions.get(x);Ee(L!==null,48541),O.version.compareTo(L)<0&&(v.applyToRemoteDocument(O,p),O.isValidDocument()&&(O.setReadTime(p.commitVersion),g.addEntry(O)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(f,v)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=je();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function OA(n){const e=he(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function OL(n,e){const t=he(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const d=[];e.targetChanges.forEach(((g,v)=>{const T=s.get(v);if(!T)return;d.push(t.Pi.removeMatchingKeys(a,g.removedDocuments,v).next((()=>t.Pi.addMatchingKeys(a,g.addedDocuments,v))));let C=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(v)!==null?C=C.withResumeToken(St.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):g.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(g.resumeToken,r)),s=s.insert(v,C),(function(O,L,ne){return O.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=NL?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(T,C,g)&&d.push(t.Pi.updateTargetData(a,C))}));let f=Ln(),p=je();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))})),d.push(LA(a,l,e.documentUpdates).next((g=>{f=g.ks,p=g.qs}))),!r.isEqual(Se.min())){const g=t.Pi.getLastRemoteSnapshotVersion(a).next((v=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(g)}return U.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=s,a)))}function LA(n,e,t){let r=je(),s=je();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=Ln();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(Se.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):Y(F_,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:l,qs:s}}))}function LL(n,e){const t=he(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Di),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ll(n,e){const t=he(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((a=>a?(s=a,U.resolve(s)):t.Pi.allocateTargetId(r).next((l=>(s=new ks(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Ml(n,e,t){const r=he(n),s=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!Ji(l))throw l;Y(F_,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Ff(n,e,t){const r=he(n);let s=Se.min(),a=je();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,g){const v=he(f),T=v.xs.get(g);return T!==void 0?U.resolve(v.Ms.get(T)):v.Pi.getTargetData(p,g)})(r,l,Sn(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>r.Fs.getDocumentsMatchingQuery(l,e,t?s:Se.min(),t?a:je()))).next((d=>(jA(r,z1(e),d),{documents:d,Qs:a})))))}function MA(n,e){const t=he(n),r=he(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>r.At(a,e).next((l=>l?l.target:null))))}function FA(n,e){const t=he(n),r=t.Os.get(e)||Se.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,a1(r,Al),Number.MAX_SAFE_INTEGER))).then((s=>(jA(t,e,s),s)))}function jA(n,e,t){let r=n.Os.get(e)||Se.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}async function ML(n,e,t,r){const s=he(n);let a=je(),l=Ln();for(const p of t){const g=e.$s(p.metadata.name);p.document&&(a=a.add(g));const v=e.Us(p);v.setReadTime(e.Ks(p.metadata.readTime)),l=l.insert(g,v)}const d=s.Ns.newChangeBuffer({trackRemovals:!0}),f=await Ll(s,(function(g){return Sn(Jl(qe.fromString(`__bundle__/docs/${g}`)))})(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",(p=>LA(p,d,l).next((g=>(d.apply(p),g))).next((g=>s.Pi.removeMatchingKeysForTargetId(p,f.targetId).next((()=>s.Pi.addMatchingKeys(p,a,f.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(p,g.ks,g.qs))).next((()=>g.ks))))))}async function FL(n,e,t=je()){const r=await Ll(n,Sn(k_(e.bundledQuery))),s=he(n);return s.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Nt(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return s.Ii.saveNamedQuery(a,e);const d=r.withResumeToken(St.EMPTY_BYTE_STRING,l);return s.Ms=s.Ms.insert(d.targetId,d),s.Pi.updateTargetData(a,d).next((()=>s.Pi.removeMatchingKeysForTargetId(a,r.targetId))).next((()=>s.Pi.addMatchingKeys(a,t,r.targetId))).next((()=>s.Ii.saveNamedQuery(a,e)))}))}const UA="firestore_clients";function PT(n,e){return`${UA}_${n}_${e}`}const BA="firestore_mutations";function kT(n,e,t){let r=`${BA}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const zA="firestore_targets";function Rg(n,e){return`${zA}_${n}_${e}`}const Jr="SharedClientState";class jf{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Ws(e,t,r){const s=JSON.parse(r);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new Q(s.error.code,s.error.message))),l?new jf(e,t,s.state,a):(Ct(Jr,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class kc{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let s,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(s=new Q(r.error.code,r.error.message))),a?new kc(e,r.state,s):(Ct(Jr,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Uf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,a=I_();for(let l=0;s&&l<r.activeTargetIds.length;++l)s=h1(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return s?new Uf(e,a):(Ct(Jr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class j_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new j_(t.clientId,t.onlineState):(Ct(Jr,`Failed to parse online state: ${e}`),null)}}class my{constructor(){this.activeTargetIds=I_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Pg{constructor(e,t,r,s,a){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new at(Oe),this.started=!1,this.Xs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=PT(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new my),this.ro=new RegExp(`^${UA}_${l}_([^_]*)$`),this.io=new RegExp(`^${BA}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${zA}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(PT(this.persistenceKey,r));if(s){const a=Uf.Ws(r,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Rg(this.persistenceKey,e));if(s){const a=kc.Ws(e,s);a&&(r=a.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Rg(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((s=>{this.Po(s)})),this.currentUser=e,r.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Y(Jr,"READ",e,t),t}setItem(e,t){Y(Jr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Y(Jr,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Y(Jr,"EVENT",t.key,t.newValue),t.key===this.eo)return void Ct("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(a){let l=Vn.ce;if(a!=null)try{const d=JSON.parse(a);Ee(typeof d=="number",30636,{So:a}),l=d}catch(d){Ct(Jr,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);r!==Vn.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const s=new jf(this.currentUser,e,t,r),a=kT(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=kT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const s=Rg(this.persistenceKey,e),a=new kc(e,t,r);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return Uf.Ws(r,t)}fo(e,t){const r=this.io.exec(e),s=Number(r[1]),a=r[2]!==void 0?r[2]:null;return jf.Ws(new Jt(a),s,t)}yo(e,t){const r=this.so.exec(e),s=Number(r[1]);return kc.Ws(s,t)}uo(e){return j_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Y(Jr,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(r),l=[],d=[];return a.forEach((f=>{s.has(f)||l.push(f)})),s.forEach((f=>{a.has(f)||d.push(f)})),this.syncEngine.Fo(l,d).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=I_();return e.forEach(((r,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class $A{constructor(){this.Mo=new my,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new my,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class jL{Oo(e){}shutdown(){}}const CT="ConnectivityMonitor";class NT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(CT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(CT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Jh=null;function gy(){return Jh===null?Jh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jh++,"0x"+Jh.toString(16)}const kg="RestConnection",UL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class BL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===ty?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,a){const l=gy(),d=this.zo(e,t.toUriEncodedString());Y(kg,`Sending RPC '${e}' ${l}:`,d,r);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,a);const{host:p}=new URL(d),g=Hi(p);return this.Jo(e,d,f,r,g).then((v=>(Y(kg,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw us(kg,`RPC '${e}' ${l} failed with error: `,v,"url: ",d,"request:",r),v}))}Ho(e,t,r,s,a,l){return this.Go(e,t,r,s,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ql})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const r=UL[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class zL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const fn="WebChannelConnection";class $L extends BL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,a){const l=gy();return new Promise(((d,f)=>{const p=new JS;p.setWithCredentials(!0),p.listenOnce(YS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case nf.NO_ERROR:const v=p.getResponseJson();Y(fn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),d(v);break;case nf.TIMEOUT:Y(fn,`RPC '${e}' ${l} timed out`),f(new Q(W.DEADLINE_EXCEEDED,"Request time out"));break;case nf.HTTP_ERROR:const T=p.getStatus();if(Y(fn,`RPC '${e}' ${l} failed with status:`,T,"response text:",p.getResponseText()),T>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const x=C?.error;if(x&&x.status&&x.message){const O=(function(ne){const oe=ne.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(oe)>=0?oe:W.UNKNOWN})(x.status);f(new Q(O,x.message))}else f(new Q(W.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Q(W.UNAVAILABLE,"Connection failed."));break;default:me(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Y(fn,`RPC '${e}' ${l} completed.`)}}));const g=JSON.stringify(s);Y(fn,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",g,r,15)}))}T_(e,t,r){const s=gy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=e1(),d=ZS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const g=a.join("");Y(fn,`Creating RPC '${e}' stream ${s}: ${g}`,f);const v=l.createWebChannel(g,f);this.I_(v);let T=!1,C=!1;const x=new zL({Yo:L=>{C?Y(fn,`Not sending because RPC '${e}' stream ${s} is closed:`,L):(T||(Y(fn,`Opening RPC '${e}' stream ${s} transport.`),v.open(),T=!0),Y(fn,`RPC '${e}' stream ${s} sending:`,L),v.send(L))},Zo:()=>v.close()}),O=(L,ne,oe)=>{L.listen(ne,(Z=>{try{oe(Z)}catch(re){setTimeout((()=>{throw re}),0)}}))};return O(v,hc.EventType.OPEN,(()=>{C||(Y(fn,`RPC '${e}' stream ${s} transport opened.`),x.o_())})),O(v,hc.EventType.CLOSE,(()=>{C||(C=!0,Y(fn,`RPC '${e}' stream ${s} transport closed`),x.a_(),this.E_(v))})),O(v,hc.EventType.ERROR,(L=>{C||(C=!0,us(fn,`RPC '${e}' stream ${s} transport errored. Name:`,L.name,"Message:",L.message),x.a_(new Q(W.UNAVAILABLE,"The operation could not be completed")))})),O(v,hc.EventType.MESSAGE,(L=>{if(!C){const ne=L.data[0];Ee(!!ne,16349);const oe=ne,Z=oe?.error||oe[0]?.error;if(Z){Y(fn,`RPC '${e}' stream ${s} received error:`,Z);const re=Z.status;let de=(function(b){const A=Ft[b];if(A!==void 0)return nA(A)})(re),le=Z.message;de===void 0&&(de=W.INTERNAL,le="Unknown error status: "+re+" with message "+Z.message),C=!0,x.a_(new Q(de,le)),v.close()}else Y(fn,`RPC '${e}' stream ${s} received:`,ne),x.u_(ne)}})),O(d,XS.STAT_EVENT,(L=>{L.stat===Kg.PROXY?Y(fn,`RPC '${e}' stream ${s} detected buffering proxy`):L.stat===Kg.NOPROXY&&Y(fn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{x.__()}),0),x}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function qA(){return typeof window<"u"?window:null}function ff(){return typeof document<"u"?document:null}function yd(n){return new KO(n,!0)}class U_{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const DT="PersistentStream";class WA{constructor(e,t,r,s,a,l,d,f){this.Mi=e,this.S_=r,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new U_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ct(t.toString()),Ct("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new Q(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Y(DT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Y(DT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qL extends WA{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=YO(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Se.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Se.min():l.readTime?Nt(l.readTime):Se.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=cy(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=Cf(f)?{documents:hA(a,f)}:{query:fA(a,f).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=oA(a,l.resumeToken);const p=ly(a,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(Se.min())>0){d.readTime=Ol(a,l.snapshotVersion.toTimestamp());const p=ly(a,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const r=ZO(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=cy(this.serializer),t.removeTarget=e,this.q_(t)}}class WL extends WA{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=XO(e.writeResults,e.commitTime),r=Nt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=cy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Qc(this.serializer,r)))};this.q_(t)}}class HL{}class GL extends HL{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(W.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,uy(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Q(W.UNKNOWN,a.toString())}))}Ho(e,t,r,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Ho(e,uy(t,r),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Q(W.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class KL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ct(t),this.aa=!1):Y("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ra="RemoteStore";class QL{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{r.enqueueAndForget((async()=>{Xi(this)&&(Y(ra,"Restarting streams for network reachability change."),await(async function(f){const p=he(f);p.Ea.add(4),await Zl(p),p.Ra.set("Unknown"),p.Ea.delete(4),await _d(p)})(this))}))})),this.Ra=new KL(r,s)}}async function _d(n){if(Xi(n))for(const e of n.da)await e(!0)}async function Zl(n){for(const e of n.da)await e(!1)}function vp(n,e){const t=he(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$_(t)?z_(t):tu(t).O_()&&B_(t,e))}function Fl(n,e){const t=he(n),r=tu(t);t.Ia.delete(e),r.O_()&&HA(t,e),t.Ia.size===0&&(r.O_()?r.L_():Xi(t)&&t.Ra.set("Unknown"))}function B_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tu(n).Y_(e)}function HA(n,e){n.Va.Ue(e),tu(n).Z_(e)}function z_(n){n.Va=new qO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),tu(n).start(),n.Ra.ua()}function $_(n){return Xi(n)&&!tu(n).x_()&&n.Ia.size>0}function Xi(n){return he(n).Ea.size===0}function GA(n){n.Va=void 0}async function JL(n){n.Ra.set("Online")}async function YL(n){n.Ia.forEach(((e,t)=>{B_(n,e)}))}async function XL(n,e){GA(n),$_(n)?(n.Ra.ha(e),z_(n)):n.Ra.set("Unknown")}async function ZL(n,e,t){if(n.Ra.set("Online"),e instanceof iA&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ia.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ia.delete(d),s.Va.removeTarget(d))})(n,e)}catch(r){Y(ra,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Bf(n,r)}else if(e instanceof df?n.Va.Ze(e):e instanceof sA?n.Va.st(e):n.Va.tt(e),!t.isEqual(Se.min()))try{const r=await OA(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.Va.Tt(l);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const g=a.Ia.get(p);g&&a.Ia.set(p,g.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,p)=>{const g=a.Ia.get(f);if(!g)return;a.Ia.set(f,g.withResumeToken(St.EMPTY_BYTE_STRING,g.snapshotVersion)),HA(a,f);const v=new ks(g.target,f,p,g.sequenceNumber);B_(a,v)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){Y(ra,"Failed to raise snapshot:",r),await Bf(n,r)}}async function Bf(n,e,t){if(!Ji(e))throw e;n.Ea.add(1),await Zl(n),n.Ra.set("Offline"),t||(t=()=>OA(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Y(ra,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await _d(n)}))}function KA(n,e){return e().catch((t=>Bf(n,t,e)))}async function eu(n){const e=he(n),t=$i(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Di;for(;eM(e);)try{const s=await LL(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,tM(e,s)}catch(s){await Bf(e,s)}QA(e)&&JA(e)}function eM(n){return Xi(n)&&n.Ta.length<10}function tM(n,e){n.Ta.push(e);const t=$i(n);t.O_()&&t.X_&&t.ea(e.mutations)}function QA(n){return Xi(n)&&!$i(n).x_()&&n.Ta.length>0}function JA(n){$i(n).start()}async function nM(n){$i(n).ra()}async function rM(n){const e=$i(n);for(const t of n.Ta)e.ea(t.mutations)}async function sM(n,e,t){const r=n.Ta.shift(),s=x_.from(r,e,t);await KA(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await eu(n)}async function iM(n,e){e&&$i(n).X_&&await(async function(r,s){if((function(l){return tA(l)&&l!==W.ABORTED})(s.code)){const a=r.Ta.shift();$i(r).B_(),await KA(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await eu(r)}})(n,e),QA(n)&&JA(n)}async function VT(n,e){const t=he(n);t.asyncQueue.verifyOperationInProgress(),Y(ra,"RemoteStore received new credentials");const r=Xi(t);t.Ea.add(3),await Zl(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _d(t)}async function yy(n,e){const t=he(n);e?(t.Ea.delete(2),await _d(t)):e||(t.Ea.add(2),await Zl(t),t.Ra.set("Unknown"))}function tu(n){return n.ma||(n.ma=(function(t,r,s){const a=he(t);return a.sa(),new qL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:JL.bind(null,n),t_:YL.bind(null,n),r_:XL.bind(null,n),H_:ZL.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),$_(n)?z_(n):n.Ra.set("Unknown")):(await n.ma.stop(),GA(n))}))),n.ma}function $i(n){return n.fa||(n.fa=(function(t,r,s){const a=he(t);return a.sa(),new WL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:nM.bind(null,n),r_:iM.bind(null,n),ta:rM.bind(null,n),na:sM.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await eu(n)):(await n.fa.stop(),n.Ta.length>0&&(Y(ra,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class q_{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new on,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,d=new q_(e,t,l,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nu(n,e){if(Ct("AsyncQueue",`${e}: ${n}`),Ji(n))return new Q(W.UNAVAILABLE,`${e}: ${n}`);throw n}class _l{static emptySet(e){return new _l(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ue.comparator(t.key,r.key):(t,r)=>ue.comparator(t.key,r.key),this.keyedMap=fc(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new _l;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class OT{constructor(){this.ga=new at(ue.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):me(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class jl{constructor(e,t,r,s,a,l,d,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new jl(e,t,_l.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class oM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class aM{constructor(){this.queries=LT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=he(t),a=s.queries;s.queries=LT(),a.forEach(((l,d)=>{for(const f of d.Sa)f.onError(r)}))})(this,new Q(W.ABORTED,"Firestore shutting down"))}}function LT(){return new Us((n=>B1(n)),hd)}async function W_(n,e){const t=he(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(r=2):(a=new oM,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=nu(l,`Initialization of query '${al(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&G_(t)}async function H_(n,e){const t=he(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function lM(n,e){const t=he(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.Sa)d.Fa(s)&&(r=!0);l.wa=s}}r&&G_(t)}function uM(n,e,t){const r=he(n),s=r.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);r.queries.delete(e)}function G_(n){n.Ca.forEach((e=>{e.next()}))}var _y,MT;(MT=_y||(_y={})).Ma="default",MT.Cache="cache";class K_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new jl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=jl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_y.Cache}}class cM{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class FT{constructor(e){this.serializer=e}$s(e){return os(this.serializer,e)}Us(e){return e.metadata.exists?dA(this.serializer,e.document,!1):ht.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Nt(e)}}class dM{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=YA(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=qe.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new FT(this.serializer);for(const s of e)if(s.metadata.queries){const a=r.$s(s.metadata.name);for(const l of s.metadata.queries){const d=(t.get(l)||je()).add(a);t.set(l,d)}}return t}async ja(e){const t=await ML(e,new FT(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await FL(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function YA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class XA{constructor(e){this.key=e}}class ZA{constructor(e){this.key=e}}class ex{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=je(),this.mutatedKeys=je(),this.eu=$1(e),this.tu=new _l(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new OT,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,v)=>{const T=s.get(g),C=fd(this.query,v)?v:null,x=!!T&&this.mutatedKeys.has(T.key),O=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let L=!1;T&&C?T.data.isEqual(C.data)?x!==O&&(r.track({type:3,doc:C}),L=!0):this.su(T,C)||(r.track({type:2,doc:C}),L=!0,(f&&this.eu(C,f)>0||p&&this.eu(C,p)<0)&&(d=!0)):!T&&C?(r.track({type:0,doc:C}),L=!0):T&&!C&&(r.track({type:1,doc:T}),L=!0,(f||p)&&(d=!0)),L&&(C?(l=l.add(C),a=O?a.add(g):a.delete(g)):(l=l.delete(g),a=a.delete(g)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{tu:l,iu:r,Cs:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((g,v)=>(function(C,x){const O=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me(20277,{Rt:L})}};return O(C)-O(x)})(g.type,v.type)||this.eu(g.doc,v.doc))),this.ou(r),s=s??!1;const d=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,l.length!==0||p?{snapshot:new jl(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new OT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=je(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new ZA(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new XA(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=je();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return jl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zi="SyncEngine";class hM{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class fM{constructor(e){this.key=e,this.hu=!1}}class pM{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Us((d=>B1(d)),hd),this.Iu=new Map,this.Eu=new Set,this.du=new at(ue.comparator),this.Au=new Map,this.Ru=new D_,this.Vu={},this.mu=new Map,this.fu=na.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function mM(n,e,t=!0){const r=wp(n);let s;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await tx(r,e,t,!0),s}async function gM(n,e){const t=wp(n);await tx(t,e,!0,!1)}async function tx(n,e,t,r){const s=await Ll(n.localStore,Sn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await Q_(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&vp(n.remoteStore,s),d}async function Q_(n,e,t,r,s){n.pu=(v,T,C)=>(async function(O,L,ne,oe){let Z=L.view.ru(ne);Z.Cs&&(Z=await Ff(O.localStore,L.query,!1).then((({documents:R})=>L.view.ru(R,Z))));const re=oe&&oe.targetChanges.get(L.targetId),de=oe&&oe.targetMismatches.get(L.targetId)!=null,le=L.view.applyChanges(Z,O.isPrimaryClient,re,de);return vy(O,L.targetId,le.au),le.snapshot})(n,v,T,C);const a=await Ff(n.localStore,e,!0),l=new ex(e,a.Qs),d=l.ru(a.documents),f=gd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,f);vy(n,t,p.au);const g=new hM(e,t,l);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function yM(n,e,t){const r=he(n),s=r.Tu.get(e),a=r.Iu.get(s.targetId);if(a.length>1)return r.Iu.set(s.targetId,a.filter((l=>!hd(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Ml(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Fl(r.remoteStore,s.targetId),Ul(r,s.targetId)})).catch(Qi)):(Ul(r,s.targetId),await Ml(r.localStore,s.targetId,!0))}async function _M(n,e){const t=he(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Fl(t.remoteStore,r.targetId))}async function vM(n,e,t){const r=Z_(n);try{const s=await(function(l,d){const f=he(l),p=Ze.now(),g=d.reduce(((C,x)=>C.add(x.key)),je());let v,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let x=Ln(),O=je();return f.Ns.getEntries(C,g).next((L=>{x=L,x.forEach(((ne,oe)=>{oe.isValidDocument()||(O=O.add(ne))}))})).next((()=>f.localDocuments.getOverlayedDocuments(C,x))).next((L=>{v=L;const ne=[];for(const oe of d){const Z=BO(oe,v.get(oe.key).overlayedDocument);Z!=null&&ne.push(new Bs(oe.key,Z,N1(Z.value.mapValue),yt.exists(!0)))}return f.mutationQueue.addMutationBatch(C,p,ne,d)})).next((L=>{T=L;const ne=L.applyToLocalDocumentSet(v,O);return f.documentOverlayCache.saveOverlays(C,L.batchId,ne)}))})).then((()=>({batchId:T.batchId,changes:W1(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let p=l.Vu[l.currentUser.toKey()];p||(p=new at(Oe)),p=p.insert(d,f),l.Vu[l.currentUser.toKey()]=p})(r,s.batchId,t),await zs(r,s.changes),await eu(r.remoteStore)}catch(s){const a=nu(s,"Failed to persist write");t.reject(a)}}async function nx(n,e){const t=he(n);try{const r=await OL(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(Ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?Ee(l.hu,14607):s.removedDocuments.size>0&&(Ee(l.hu,42227),l.hu=!1))})),await zs(t,r,e)}catch(r){await Qi(r)}}function jT(n,e,t){const r=he(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=he(l);f.onlineState=d;let p=!1;f.queries.forEach(((g,v)=>{for(const T of v.Sa)T.va(d)&&(p=!0)})),p&&G_(f)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wM(n,e,t){const r=he(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),a=s&&s.key;if(a){let l=new at(ue.comparator);l=l.insert(a,ht.newNoDocument(a,Se.min()));const d=je().add(a),f=new md(Se.min(),new Map,new at(Oe),l,d);await nx(r,f),r.du=r.du.remove(a),r.Au.delete(e),X_(r)}else await Ml(r.localStore,e,!1).then((()=>Ul(r,e,t))).catch(Qi)}async function EM(n,e){const t=he(n),r=e.batch.batchId;try{const s=await VL(t.localStore,e);Y_(t,r,null),J_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await zs(t,s)}catch(s){await Qi(s)}}async function IM(n,e,t){const r=he(n);try{const s=await(function(l,d){const f=he(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return f.mutationQueue.lookupMutationBatch(p,d).next((v=>(Ee(v!==null,37113),g=v.keys(),f.mutationQueue.removeMutationBatch(p,v)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,g,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>f.localDocuments.getDocuments(p,g)))}))})(r.localStore,e);Y_(r,e,t),J_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await zs(r,s)}catch(s){await Qi(s)}}async function TM(n,e){const t=he(n);Xi(t.remoteStore)||Y(Zi,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(l){const d=he(l);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>d.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===Di)return void e.resolve();const s=t.mu.get(r)||[];s.push(e),t.mu.set(r,s)}catch(r){const s=nu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function J_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Y_(n,e,t){const r=he(n);let s=r.Vu[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Ul(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||rx(n,r)}))}function rx(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Fl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),X_(n))}function vy(n,e,t){for(const r of t)r instanceof XA?(n.Ru.addReference(r.key,e),SM(n,r)):r instanceof ZA?(Y(Zi,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||rx(n,r.key)):me(19791,{wu:r})}function SM(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Y(Zi,"New document in limbo: "+t),n.Eu.add(r),X_(n))}function X_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ue(qe.fromString(e)),r=n.fu.next();n.Au.set(r,new fM(t)),n.du=n.du.insert(t,r),vp(n.remoteStore,new ks(Sn(Jl(t.path)),r,"TargetPurposeLimboResolution",Vn.ce))}}async function zs(n,e,t){const r=he(n),s=[],a=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((d,f)=>{l.push(r.pu(f,e,t).then((p=>{if((p||t)&&r.isPrimaryClient){const g=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;r.sharedClientState.updateQueryState(f.targetId,g?"current":"not-current")}if(p){s.push(p);const g=M_.As(f.targetId,p);a.push(g)}})))})),await Promise.all(l),r.Pu.H_(s),await(async function(f,p){const g=he(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>U.forEach(p,(T=>U.forEach(T.Es,(C=>g.persistence.referenceDelegate.addReference(v,T.targetId,C))).next((()=>U.forEach(T.ds,(C=>g.persistence.referenceDelegate.removeReference(v,T.targetId,C)))))))))}catch(v){if(!Ji(v))throw v;Y(F_,"Failed to update sequence numbers: "+v)}for(const v of p){const T=v.targetId;if(!v.fromCache){const C=g.Ms.get(T),x=C.snapshotVersion,O=C.withLastLimboFreeSnapshotVersion(x);g.Ms=g.Ms.insert(T,O)}}})(r.localStore,a))}async function AM(n,e){const t=he(n);if(!t.currentUser.isEqual(e)){Y(Zi,"User change. New user:",e.toKey());const r=await VA(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new Q(W.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zs(t,r.Ls)}}function xM(n,e){const t=he(n),r=t.Au.get(e);if(r&&r.hu)return je().add(r.key);{let s=je();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const d=t.Tu.get(l);s=s.unionWith(d.view.nu)}return s}}async function bM(n,e){const t=he(n),r=await Ff(t.localStore,e.query,!0),s=e.view.cu(r);return t.isPrimaryClient&&vy(t,e.targetId,s.au),s}async function RM(n,e){const t=he(n);return FA(t.localStore,e).then((r=>zs(t,r)))}async function PM(n,e,t,r){const s=he(n),a=await(function(d,f){const p=he(d),g=he(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(v=>g.er(v,f).next((T=>T?p.localDocuments.getDocuments(v,T):U.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await eu(s.remoteStore):t==="acknowledged"||t==="rejected"?(Y_(s,e,r||null),J_(s,e),(function(d,f){he(he(d).mutationQueue).ir(f)})(s.localStore,e)):me(6720,"Unknown batchState",{Su:t}),await zs(s,a)):Y(Zi,"Cannot apply mutation batch with id: "+e)}async function kM(n,e){const t=he(n);if(wp(t),Z_(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await UT(t,r.toArray());t.gu=!0,await yy(t.remoteStore,!0);for(const a of s)vp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const r=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):s=s.then((()=>(Ul(t,l),Ml(t.localStore,l,!0)))),Fl(t.remoteStore,l)})),await s,await UT(t,r),(function(l){const d=he(l);d.Au.forEach(((f,p)=>{Fl(d.remoteStore,p)})),d.Ru.Jr(),d.Au=new Map,d.du=new at(ue.comparator)})(t),t.gu=!1,await yy(t.remoteStore,!1)}}async function UT(n,e,t){const r=he(n),s=[],a=[];for(const l of e){let d;const f=r.Iu.get(l);if(f&&f.length!==0){d=await Ll(r.localStore,Sn(f[0]));for(const p of f){const g=r.Tu.get(p),v=await bM(r,g);v.snapshot&&a.push(v.snapshot)}}else{const p=await MA(r.localStore,l);d=await Ll(r.localStore,p),await Q_(r,sx(p),l,!1,d.resumeToken)}s.push(d)}return r.Pu.H_(a),s}function sx(n){return U1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function CM(n){return(function(t){return he(he(t).persistence).Ts()})(he(n).localStore)}async function NM(n,e,t,r){const s=he(n);if(s.gu)return void Y(Zi,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await FA(s.localStore,z1(a[0])),d=md.createSynthesizedRemoteEventForCurrentChange(e,t==="current",St.EMPTY_BYTE_STRING);await zs(s,l,d);break}case"rejected":await Ml(s.localStore,e,!0),Ul(s,e,r);break;default:me(64155,t)}}async function DM(n,e,t){const r=wp(n);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Y(Zi,"Adding an already active target "+s);continue}const a=await MA(r.localStore,s),l=await Ll(r.localStore,a);await Q_(r,sx(a),l.targetId,!1,l.resumeToken),vp(r.remoteStore,l)}for(const s of t)r.Iu.has(s)&&await Ml(r.localStore,s,!1).then((()=>{Fl(r.remoteStore,s),Ul(r,s)})).catch(Qi)}}function wp(n){const e=he(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wM.bind(null,e),e.Pu.H_=lM.bind(null,e.eventManager),e.Pu.yu=uM.bind(null,e.eventManager),e}function Z_(n){const e=he(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IM.bind(null,e),e}function VM(n,e,t){const r=he(n);(async function(a,l,d){try{const f=await l.getMetadata();if(await(function(C,x){const O=he(C),L=Nt(x.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",(ne=>O.Ii.getBundleMetadata(ne,x.id))).then((ne=>!!ne&&ne.createTime.compareTo(L)>=0))})(a.localStore,f))return await l.close(),d._completeWith((function(C){return{taskState:"Success",documentsLoaded:C.totalDocuments,bytesLoaded:C.totalBytes,totalDocuments:C.totalDocuments,totalBytes:C.totalBytes}})(f)),Promise.resolve(new Set);d._updateProgress(YA(f));const p=new dM(f,l.serializer);let g=await l.bu();for(;g;){const T=await p.Ga(g);T&&d._updateProgress(T),g=await l.bu()}const v=await p.ja(a.localStore);return await zs(a,v.Ha,void 0),await(function(C,x){const O=he(C);return O.persistence.runTransaction("Save bundle","readwrite",(L=>O.Ii.saveBundleMetadata(L,x)))})(a.localStore,f),d._completeWith(v.progress),Promise.resolve(v.Ja)}catch(f){return us(Zi,`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((s=>{r.sharedClientState.notifyBundleLoaded(s)}))}class Jc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return DA(this.persistence,new NA,e.initialUser,this.serializer)}Cu(e){return new V_(_p.mi,this.serializer)}Du(e){return new $A}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jc.provider={build:()=>new Jc};class OM extends Jc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ee(this.persistence.referenceDelegate instanceof Mf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new xA(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new V_((r=>Mf.mi(r,t)),this.serializer)}}class ix extends Jc{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Z_(this.xu.syncEngine),await eu(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return DA(this.persistence,new NA,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new xA(r,e.asyncQueue,t)}Mu(e,t){const r=new qV(t,this.persistence);return new $V(e.asyncQueue,r)}Cu(e){const t=L_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new O_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,qA(),ff(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new $A}}class LM extends ix{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Pg&&(this.sharedClientState.syncEngine={Co:PM.bind(null,t),vo:NM.bind(null,t),Fo:DM.bind(null,t),Ts:CM.bind(null,t),Do:RM.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await kM(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=qA();if(!Pg.v(t))throw new Q(W.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=L_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Pg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Yc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=AM.bind(null,this.syncEngine),await yy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new aM})()}createDatastore(e){const t=yd(e.databaseInfo.databaseId),r=(function(a){return new $L(a)})(e.databaseInfo);return(function(a,l,d,f){return new GL(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,d){return new QL(r,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>jT(this.syncEngine,t,0)),(function(){return NT.v()?new NT:new jL})())}createSyncEngine(e,t){return(function(s,a,l,d,f,p,g){const v=new pM(s,a,l,d,f,p);return g&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=he(t);Y(ra,"RemoteStore shutting down."),r.Ea.add(5),await Zl(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Yc.provider={build:()=>new Yc};function BT(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ct("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class MM{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new on,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(r);return new cM(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class FM{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Q(W.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,a){const l=he(s),d={documents:a.map((v=>Kc(l.serializer,v)))},f=await l.Ho("BatchGetDocuments",l.serializer.databaseId,qe.emptyPath(),d,a.length),p=new Map;f.forEach((v=>{const T=JO(l.serializer,v);p.set(T.key.toString(),T)}));const g=[];return a.forEach((v=>{const T=p.get(v.toString());Ee(!!T,55234,{key:v}),g.push(T)})),g})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const s=ue.fromPath(r);this.mutations.push(new S_(s,this.precondition(s)))})),await(async function(r,s){const a=he(r),l={writes:s.map((d=>Qc(a.serializer,d)))};await a.Go("Commit",a.serializer.databaseId,qe.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw me(50498,{Gu:e.constructor.name});t=Se.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Q(W.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?yt.exists(!1):yt.updateTime(t):yt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new Q(W.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yt.updateTime(t)}return yt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class jM{constructor(e,t,r,s,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=a,this.zu=r.maxAttempts,this.M_=new U_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new FM(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((s=>{this.Yu(s)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!ud(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!tA(t)}return!1}}const qi="FirestoreClient";class UM{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Jt.UNAUTHENTICATED,this.clientId=c_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{Y(qi,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(Y(qi,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new on;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=nu(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Cg(n,e){n.asyncQueue.verifyOperationInProgress(),Y(qi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await VA(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function zT(n,e){n.asyncQueue.verifyOperationInProgress();const t=await ev(n);Y(qi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>VT(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>VT(e.remoteStore,s))),n._onlineComponents=e}async function ev(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Y(qi,"Using user provided OfflineComponentProvider");try{await Cg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;us("Error using user provided cache. Falling back to memory cache: "+t),await Cg(n,new Jc)}}else Y(qi,"Using default OfflineComponentProvider"),await Cg(n,new OM(void 0));return n._offlineComponents}async function Ip(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Y(qi,"Using user provided OnlineComponentProvider"),await zT(n,n._uninitializedComponentsProvider._online)):(Y(qi,"Using default OnlineComponentProvider"),await zT(n,new Yc))),n._onlineComponents}function ox(n){return ev(n).then((e=>e.persistence))}function tv(n){return ev(n).then((e=>e.localStore))}function ax(n){return Ip(n).then((e=>e.remoteStore))}function nv(n){return Ip(n).then((e=>e.syncEngine))}function BM(n){return Ip(n).then((e=>e.datastore))}async function Bl(n){const e=await Ip(n),t=e.eventManager;return t.onListen=mM.bind(null,e.syncEngine),t.onUnlisten=yM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=gM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_M.bind(null,e.syncEngine),t}function zM(n){return n.asyncQueue.enqueue((async()=>{const e=await ox(n),t=await ax(n);return e.setNetworkEnabled(!0),(function(s){const a=he(s);return a.Ea.delete(0),_d(a)})(t)}))}function $M(n){return n.asyncQueue.enqueue((async()=>{const e=await ox(n),t=await ax(n);return e.setNetworkEnabled(!1),(async function(s){const a=he(s);a.Ea.add(0),await Zl(a),a.Ra.set("Offline")})(t)}))}function qM(n,e){const t=new on;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const d=await(function(p,g){const v=he(p);return v.persistence.runTransaction("read document","readonly",(T=>v.localDocuments.getDocument(T,g)))})(s,a);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new Q(W.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=nu(d,`Failed to get document '${a} from cache`);l.reject(f)}})(await tv(n),e,t))),t.promise}function lx(n,e,t={}){const r=new on;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const g=new Ep({next:T=>{g.Nu(),l.enqueueAndForget((()=>H_(a,v)));const C=T.docs.has(d);!C&&T.fromCache?p.reject(new Q(W.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&T.fromCache&&f&&f.source==="server"?p.reject(new Q(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new K_(Jl(d.path),g,{includeMetadataChanges:!0,qa:!0});return W_(a,v)})(await Bl(n),n.asyncQueue,e,t,r))),r.promise}function WM(n,e){const t=new on;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const d=await Ff(s,a,!0),f=new ex(a,d.Qs),p=f.ru(d.documents),g=f.applyChanges(p,!1);l.resolve(g.snapshot)}catch(d){const f=nu(d,`Failed to execute query '${a} against cache`);l.reject(f)}})(await tv(n),e,t))),t.promise}function ux(n,e,t={}){const r=new on;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const g=new Ep({next:T=>{g.Nu(),l.enqueueAndForget((()=>H_(a,v))),T.fromCache&&f.source==="server"?p.reject(new Q(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new K_(d,g,{includeMetadataChanges:!0,qa:!0});return W_(a,v)})(await Bl(n),n.asyncQueue,e,t,r))),r.promise}function HM(n,e){const t=new Ep(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,a){he(s).Ca.add(a),a.next()})(await Bl(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,a){he(s).Ca.delete(a)})(await Bl(n),t)))}}function GM(n,e,t,r){const s=(function(l,d){let f;return f=typeof l=="string"?rA().encode(l):l,(function(g,v){return new MM(g,v)})((function(g,v){if(g instanceof Uint8Array)return BT(g,v);if(g instanceof ArrayBuffer)return BT(new Uint8Array(g),v);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),d)})(t,yd(e));n.asyncQueue.enqueueAndForget((async()=>{VM(await nv(n),s,r)}))}function KM(n,e){return n.asyncQueue.enqueue((async()=>(function(r,s){const a=he(r);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,s)))})(await tv(n),e)))}function cx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const $T=new Map;const dx="firestore.googleapis.com",qT=!0;class WT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dx,this.ssl=qT}else this.host=e.host,this.ssl=e.ssl??qT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=IA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mL)throw new Q(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cx(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vd{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new CV;switch(r.type){case"firstParty":return new OV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=$T.get(t);r&&(Y("ComponentProvider","Removing Datastore"),$T.delete(t),r.terminate())})(this),Promise.resolve()}}function QM(n,e,t,r={}){n=Je(n,vd);const s=Hi(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;s&&(Oy(`https://${d}`),Ly("Firestore",!0)),a.host!==dx&&a.host!==d&&us("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:d,ssl:s,emulatorOptions:r};if(!Oi(f,l)&&(n._setSettings(f),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=Jt.MOCK_USER;else{p=KP(r.mockUserToken,n._app?.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new Q(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Jt(v)}n._authCredentials=new NV(new n1(p,g))}}let An=class hx{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hx(this.firestore,e,this._query)}},ot=class gc{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gc(this.firestore,e,this._key)}toJSON(){return{type:gc._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ld(t,gc._jsonSchema))return new gc(e,r||null,new ue(qe.fromString(t.referencePath)))}};ot._jsonSchemaVersion="firestore/documentReference/1.0",ot._jsonSchema={type:Ut("string",ot._jsonSchemaVersion),referencePath:Ut("string")};let Vi=class fx extends An{constructor(e,t,r){super(e,t,Jl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ot(this.firestore,null,new ue(e))}withConverter(e){return new fx(this.firestore,e,this._path)}};function px(n,e,...t){if(n=Ae(n),d_("collection","path",e),n instanceof vd){const r=qe.fromString(e,...t);return DI(r),new Vi(n,null,r)}{if(!(n instanceof ot||n instanceof Vi))throw new Q(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(qe.fromString(e,...t));return DI(r),new Vi(n.firestore,null,r)}}function JM(n,e){if(n=Je(n,vd),d_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Q(W.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new An(n,null,(function(r){return new js(qe.emptyPath(),r)})(e))}function zf(n,e,...t){if(n=Ae(n),arguments.length===1&&(e=c_.newId()),d_("doc","path",e),n instanceof vd){const r=qe.fromString(e,...t);return NI(r),new ot(n,null,new ue(r))}{if(!(n instanceof ot||n instanceof Vi))throw new Q(W.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(qe.fromString(e,...t));return NI(r),new ot(n.firestore,n instanceof Vi?n.converter:null,new ue(r))}}function mx(n,e){return n=Ae(n),e=Ae(e),(n instanceof ot||n instanceof Vi)&&(e instanceof ot||e instanceof Vi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function gx(n,e){return n=Ae(n),e=Ae(e),n instanceof An&&e instanceof An&&n.firestore===e.firestore&&hd(n._query,e._query)&&n.converter===e.converter}const HT="AsyncQueue";class GT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new U_(this,"async_queue_retry"),this._c=()=>{const r=ff();r&&Y(HT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ff();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ff();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new on;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ji(e))throw e;Y(HT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ct("INTERNAL UNHANDLED ERROR: ",KT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=q_.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&me(47125,{Pc:KT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function KT(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function wy(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class YM{constructor(){this._progressObserver={},this._taskCompletionResolver=new on,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const XM=-1;let Dt=class extends vd{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new GT,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GT(e),this._firestoreClient=void 0,await e}}};function vn(n){if(n._terminated)throw new Q(W.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yx(n),n._firestoreClient}function yx(n){const e=n._freezeSettings(),t=(function(s,a,l,d){return new vO(s,a,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,cx(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new UM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(n._componentsProvider))}function ZM(n,e){us("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return _x(n,Yc.provider,{build:r=>new ix(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function eF(n){us("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();_x(n,Yc.provider,{build:t=>new LM(t,e.cacheSizeBytes)})}function _x(n,e,t){if((n=Je(n,Dt))._firestoreClient||n._terminated)throw new Q(W.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Q(W.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},yx(n)}function tF(n){if(n._initialized&&!n._terminated)throw new Q(W.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new on;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!is.v())return Promise.resolve();const s=r+CA;await is.delete(s)})(L_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function nF(n){return(function(t){const r=new on;return t.asyncQueue.enqueueAndForget((async()=>TM(await nv(t),r))),r.promise})(vn(n=Je(n,Dt)))}function rF(n){return zM(vn(n=Je(n,Dt)))}function sF(n){return $M(vn(n=Je(n,Dt)))}function iF(n,e){const t=vn(n=Je(n,Dt)),r=new YM;return GM(t,n._databaseId,e,r),r}function oF(n,e){return KM(vn(n=Je(n,Dt)),e).then((t=>t?new An(n,null,t.query):null))}class mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mn(St.fromBase64String(e))}catch(t){throw new Q(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new mn(St.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ld(e,mn._jsonSchema))return mn.fromBase64String(e.bytes)}}mn._jsonSchemaVersion="firestore/bytes/1.0",mn._jsonSchema={type:Ut("string",mn._jsonSchemaVersion),bytes:Ut("string")};let Wi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Q(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let la=class{constructor(e){this._methodName=e}};class xr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Q(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Q(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xr._jsonSchemaVersion}}static fromJSON(e){if(ld(e,xr._jsonSchema))return new xr(e.latitude,e.longitude)}}xr._jsonSchemaVersion="firestore/geoPoint/1.0",xr._jsonSchema={type:Ut("string",xr._jsonSchemaVersion),latitude:Ut("number"),longitude:Ut("number")};class as{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:as._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ld(e,as._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new as(e.vectorValues);throw new Q(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}as._jsonSchemaVersion="firestore/vectorValue/1.0",as._jsonSchema={type:Ut("string",as._jsonSchemaVersion),vectorValues:Ut("object")};const aF=/^__.*__$/;class lF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yl(e,this.data,t,this.fieldTransforms)}}class vx{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me(40011,{Ac:n})}}class Tp{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Tp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $f(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(wx(this.Ac)&&aF.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class uF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yd(e)}Cc(e,t,r,s=!1){return new Tp({Ac:e,methodName:t,Dc:r,path:gt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ua(n){const e=n._freezeSettings(),t=yd(n._databaseId);return new uF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sp(n,e,t,r,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);uv("Data must be an object, but it was:",l,r);const d=Tx(r,l);let f,p;if(a.merge)f=new On(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const g=[];for(const v of a.mergeFields){const T=Ey(e,v,t);if(!l.contains(T))throw new Q(W.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Ax(g,T)||g.push(T)}f=new On(g),p=l.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,p=l.fieldTransforms;return new lF(new sn(d),f,p)}class wd extends la{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wd}}function Ex(n,e,t){return new Tp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class rv extends la{_toFieldTransform(e){return new pd(e.path,new Dl)}isEqual(e){return e instanceof rv}}class sv extends la{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Ex(this,e,!0),r=this.vc.map((a=>ca(a,t))),s=new Xo(r);return new pd(e.path,s)}isEqual(e){return e instanceof sv&&Oi(this.vc,e.vc)}}class iv extends la{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Ex(this,e,!0),r=this.vc.map((a=>ca(a,t))),s=new Zo(r);return new pd(e.path,s)}isEqual(e){return e instanceof iv&&Oi(this.vc,e.vc)}}class ov extends la{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Vl(e.serializer,K1(e.serializer,this.Fc));return new pd(e.path,t)}isEqual(e){return e instanceof ov&&this.Fc===e.Fc}}function av(n,e,t,r){const s=n.Cc(1,e,t);uv("Data must be an object, but it was:",s,r);const a=[],l=sn.empty();Yi(r,((f,p)=>{const g=cv(e,f,t);p=Ae(p);const v=s.yc(g);if(p instanceof wd)a.push(g);else{const T=ca(p,v);T!=null&&(a.push(g),l.set(g,T))}}));const d=new On(a);return new vx(l,d,s.fieldTransforms)}function lv(n,e,t,r,s,a){const l=n.Cc(1,e,t),d=[Ey(e,r,t)],f=[s];if(a.length%2!=0)throw new Q(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<a.length;T+=2)d.push(Ey(e,a[T])),f.push(a[T+1]);const p=[],g=sn.empty();for(let T=d.length-1;T>=0;--T)if(!Ax(p,d[T])){const C=d[T];let x=f[T];x=Ae(x);const O=l.yc(C);if(x instanceof wd)p.push(C);else{const L=ca(x,O);L!=null&&(p.push(C),g.set(C,L))}}const v=new On(p);return new vx(g,v,l.fieldTransforms)}function Ix(n,e,t,r=!1){return ca(t,n.Cc(r?4:3,e))}function ca(n,e){if(Sx(n=Ae(n)))return uv("Unsupported field value:",e,n),Tx(n,e);if(n instanceof la)return(function(r,s){if(!wx(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const d of r){let f=ca(d,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=Ae(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return K1(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=Ze.fromDate(r);return{timestampValue:Ol(s.serializer,a)}}if(r instanceof Ze){const a=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ol(s.serializer,a)}}if(r instanceof xr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mn)return{bytesValue:oA(s.serializer,r._byteString)};if(r instanceof ot){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:P_(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof as)return(function(l,d){return{mapValue:{fields:{[__]:{stringValue:v_},[kl]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return T_(d.serializer,p)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${op(r)}`)})(n,e)}function Tx(n,e){const t={};return T1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yi(n,((r,s)=>{const a=ca(s,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Sx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ze||n instanceof xr||n instanceof mn||n instanceof ot||n instanceof la||n instanceof as)}function uv(n,e,t){if(!Sx(t)||!i1(t)){const r=op(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Ey(n,e,t){if((e=Ae(e))instanceof Wi)return e._internalPath;if(typeof e=="string")return cv(n,e);throw $f("Field path arguments must be of type string or ",n,!1,void 0,t)}const cF=new RegExp("[~\\*/\\[\\]]");function cv(n,e,t){if(e.search(cF)>=0)throw $f(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wi(...e.split("."))._internalPath}catch{throw $f(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $f(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new Q(W.INVALID_ARGUMENT,d+n+f)}function Ax(n,e){return n.some((t=>t.isEqual(e)))}class Xc{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ap("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class dF extends Xc{data(){return super.data()}}function Ap(n,e){return typeof e=="string"?cv(n,e):e instanceof Wi?e._internalPath:e._delegate._internalPath}function xx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Q(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dv{}class Ed extends dv{}function Ti(n,e,...t){let r=[];e instanceof dv&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof hv)).length,d=a.filter((f=>f instanceof xp)).length;if(l>1||l>0&&d>0)throw new Q(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class xp extends Ed{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new xp(e,t,r)}_apply(e){const t=this._parse(e);return Rx(e._query,t),new An(e.firestore,e.converter,ay(e._query,t))}_parse(e){const t=ua(e.firestore);return(function(a,l,d,f,p,g,v){let T;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Q(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){JT(v,g);const x=[];for(const O of v)x.push(QT(f,a,O));T={arrayValue:{values:x}}}else T=QT(f,a,v)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||JT(v,g),T=Ix(d,l,v,g==="in"||g==="not-in");return We.create(p,g,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hF(n,e,t){const r=e,s=Ap("where",n);return xp._create(s,r,t)}class hv extends dv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hv(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:tt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Rx(l,f),l=ay(l,f)})(e._query,t),new An(e.firestore,e.converter,ay(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fv extends Ed{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new fv(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new Q(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Gc(a,l)})(e._query,this._field,this._direction);return new An(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new js(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function fF(n,e="asc"){const t=e,r=Ap("orderBy",n);return fv._create(r,t)}class bp extends Ed{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new bp(e,t,r)}_apply(e){return new An(e.firestore,e.converter,Df(e._query,this._limit,this._limitType))}}function pF(n){return o1("limit",n),bp._create("limit",n,"F")}function mF(n){return o1("limitToLast",n),bp._create("limitToLast",n,"L")}class Rp extends Ed{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Rp(e,t,r)}_apply(e){const t=bx(e,this.type,this._docOrFields,this._inclusive);return new An(e.firestore,e.converter,(function(s,a){return new js(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,a,s.endAt)})(e._query,t))}}function gF(...n){return Rp._create("startAt",n,!0)}function yF(...n){return Rp._create("startAfter",n,!1)}class Pp extends Ed{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Pp(e,t,r)}_apply(e){const t=bx(e,this.type,this._docOrFields,this._inclusive);return new An(e.firestore,e.converter,(function(s,a){return new js(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,a)})(e._query,t))}}function _F(...n){return Pp._create("endBefore",n,!1)}function vF(...n){return Pp._create("endAt",n,!0)}function bx(n,e,t,r){if(t[0]=Ae(t[0]),t[0]instanceof Xc)return(function(a,l,d,f,p){if(!f)throw new Q(W.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const g=[];for(const v of yl(a))if(v.field.isKeyField())g.push(Jo(l,f.key));else{const T=f.data.field(v.field);if(dp(T))throw new Q(W.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const C=v.field.canonicalString();throw new Q(W.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}g.push(T)}return new zi(g,p)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=ua(n.firestore);return(function(l,d,f,p,g,v){const T=l.explicitOrderBy;if(g.length>T.length)throw new Q(W.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let x=0;x<g.length;x++){const O=g[x];if(T[x].field.isKeyField()){if(typeof O!="string")throw new Q(W.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof O}`);if(!E_(l)&&O.indexOf("/")!==-1)throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${O}' contains a slash.`);const L=l.path.child(qe.fromString(O));if(!ue.isDocumentKey(L))throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${L}' is not because it contains an odd number of segments.`);const ne=new ue(L);C.push(Jo(d,ne))}else{const L=Ix(f,p,O);C.push(L)}}return new zi(C,v)})(n._query,n.firestore._databaseId,s,e,t,r)}}function QT(n,e,t){if(typeof(t=Ae(t))=="string"){if(t==="")throw new Q(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!E_(e)&&t.indexOf("/")!==-1)throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(qe.fromString(t));if(!ue.isDocumentKey(r))throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Jo(n,new ue(r))}if(t instanceof ot)return Jo(n,t._key);throw new Q(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${op(t)}.`)}function JT(n,e){if(!Array.isArray(n)||n.length===0)throw new Q(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Rx(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Q(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class pv{convertValue(e,t="none"){switch(Ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Yi(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[kl].arrayValue?.values?.map((r=>mt(r.doubleValue)));return new as(t)}convertGeoPoint(e){return new xr(mt(e.latitude),mt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=hp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(qc(e));default:return null}}convertTimestamp(e){const t=Os(e);return new Ze(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=qe.fromString(e);Ee(yA(r),9688,{name:e});const s=new ji(r.get(1),r.get(3)),a=new ue(r.popFirst(5));return s.isEqual(t)||Ct(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function kp(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class wF extends pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ot(this.firestore,null,t)}}class jo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let dr=class Px extends Xc{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Ap("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Px._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};dr._jsonSchemaVersion="firestore/documentSnapshot/1.0",dr._jsonSchema={type:Ut("string",dr._jsonSchemaVersion),bundleSource:Ut("string","DocumentSnapshot"),bundleName:Ut("string"),bundle:Ut("string")};let Cc=class extends dr{data(e={}){return super.data(e)}},br=class kx{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new jo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Cc(this._firestore,this._userDataWriter,r.key,r,new jo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Q(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new Cc(s._firestore,s._userDataWriter,d.doc.key,d.doc,new jo(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new Cc(s._firestore,s._userDataWriter,d.doc.key,d.doc,new jo(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),g=l.indexOf(d.doc.key)),{type:EF(d.type),doc:f,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=kx._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=c_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function EF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me(61501,{type:n})}}function Cx(n,e){return n instanceof dr&&e instanceof dr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof br&&e instanceof br&&n._firestore===e._firestore&&gx(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function IF(n){n=Je(n,ot);const e=Je(n.firestore,Dt);return lx(vn(e),n._key).then((t=>mv(e,n,t)))}br._jsonSchemaVersion="firestore/querySnapshot/1.0",br._jsonSchema={type:Ut("string",br._jsonSchemaVersion),bundleSource:Ut("string","QuerySnapshot"),bundleName:Ut("string"),bundle:Ut("string")};class da extends pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ot(this.firestore,null,t)}}function TF(n){n=Je(n,ot);const e=Je(n.firestore,Dt),t=vn(e),r=new da(e);return qM(t,n._key).then((s=>new dr(e,r,n._key,s,new jo(s!==null&&s.hasLocalMutations,!0),n.converter)))}function SF(n){n=Je(n,ot);const e=Je(n.firestore,Dt);return lx(vn(e),n._key,{source:"server"}).then((t=>mv(e,n,t)))}function AF(n){n=Je(n,An);const e=Je(n.firestore,Dt),t=vn(e),r=new da(e);return xx(n._query),ux(t,n._query).then((s=>new br(e,r,n,s)))}function xF(n){n=Je(n,An);const e=Je(n.firestore,Dt),t=vn(e),r=new da(e);return WM(t,n._query).then((s=>new br(e,r,n,s)))}function bF(n){n=Je(n,An);const e=Je(n.firestore,Dt),t=vn(e),r=new da(e);return ux(t,n._query,{source:"server"}).then((s=>new br(e,r,n,s)))}function YT(n,e,t){n=Je(n,ot);const r=Je(n.firestore,Dt),s=kp(n.converter,e,t);return Id(r,[Sp(ua(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,yt.none())])}function XT(n,e,t,...r){n=Je(n,ot);const s=Je(n.firestore,Dt),a=ua(s);let l;return l=typeof(e=Ae(e))=="string"||e instanceof Wi?lv(a,"updateDoc",n._key,e,t,r):av(a,"updateDoc",n._key,e),Id(s,[l.toMutation(n._key,yt.exists(!0))])}function RF(n){return Id(Je(n.firestore,Dt),[new Xl(n._key,yt.none())])}function PF(n,e){const t=Je(n.firestore,Dt),r=zf(n),s=kp(n.converter,e);return Id(t,[Sp(ua(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,yt.exists(!1))]).then((()=>r))}function Nx(n,...e){n=Ae(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||wy(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(wy(e[r])){const f=e[r];e[r]=f.next?.bind(f),e[r+1]=f.error?.bind(f),e[r+2]=f.complete?.bind(f)}let a,l,d;if(n instanceof ot)l=Je(n.firestore,Dt),d=Jl(n._key.path),a={next:f=>{e[r]&&e[r](mv(l,n,f))},error:e[r+1],complete:e[r+2]};else{const f=Je(n,An);l=Je(f.firestore,Dt),d=f._query;const p=new da(l);a={next:g=>{e[r]&&e[r](new br(l,p,f,g))},error:e[r+1],complete:e[r+2]},xx(n._query)}return(function(p,g,v,T){const C=new Ep(T),x=new K_(g,C,v);return p.asyncQueue.enqueueAndForget((async()=>W_(await Bl(p),x))),()=>{C.Nu(),p.asyncQueue.enqueueAndForget((async()=>H_(await Bl(p),x)))}})(vn(l),d,s,a)}function kF(n,e){return HM(vn(n=Je(n,Dt)),wy(e)?e:{next:e})}function Id(n,e){return(function(r,s){const a=new on;return r.asyncQueue.enqueueAndForget((async()=>vM(await nv(r),s,a))),a.promise})(vn(n),e)}function mv(n,e,t){const r=t.docs.get(e._key),s=new da(n);return new dr(n,s,e._key,r,new jo(t.hasPendingWrites,t.fromCache),e.converter)}const CF={maxAttempts:5};let NF=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ua(e)}set(e,t,r){this._verifyNotCommitted();const s=Pi(e,this._firestore),a=kp(s.converter,t,r),l=Sp(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,r);return this._mutations.push(l.toMutation(s._key,yt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const a=Pi(e,this._firestore);let l;return l=typeof(t=Ae(t))=="string"||t instanceof Wi?lv(this._dataReader,"WriteBatch.update",a._key,t,r,s):av(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,yt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Pi(e,this._firestore);return this._mutations=this._mutations.concat(new Xl(t._key,yt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Q(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Pi(n,e){if((n=Ae(n)).firestore!==e)throw new Q(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class DF{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ua(e)}get(e){const t=Pi(e,this._firestore),r=new wF(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return me(24041);const a=s[0];if(a.isFoundDocument())return new Xc(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new Xc(this._firestore,r,t._key,null,t.converter);throw me(18433,{doc:a})}))}set(e,t,r){const s=Pi(e,this._firestore),a=kp(s.converter,t,r),l=Sp(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,l),this}update(e,t,r,...s){const a=Pi(e,this._firestore);let l;return l=typeof(t=Ae(t))=="string"||t instanceof Wi?lv(this._dataReader,"Transaction.update",a._key,t,r,s):av(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Pi(e,this._firestore);return this._transaction.delete(t._key),this}}let VF=class extends DF{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Pi(e,this._firestore),r=new da(this._firestore);return super.get(e).then((s=>new dr(this._firestore,r,t._key,s._document,new jo(!1,!1),t.converter)))}};function OF(n,e,t){n=Je(n,Dt);const r={...CF,...t};return(function(a){if(a.maxAttempts<1)throw new Q(W.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(a,l,d){const f=new on;return a.asyncQueue.enqueueAndForget((async()=>{const p=await BM(a);new jM(a.asyncQueue,p,d,l,f).ju()})),f.promise})(vn(n),(s=>e(new VF(n,s))),r)}function LF(){return new wd("deleteField")}function MF(){return new rv("serverTimestamp")}function FF(...n){return new sv("arrayUnion",n)}function jF(...n){return new iv("arrayRemove",n)}function UF(n){return new ov("increment",n)}(function(e,t=!0){(function(s){Ql=s})(Gi),Ds(new hr("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new Dt(new DV(r.getProvider("auth-internal")),new LV(l,r.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Q(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ji(p.options.projectId,g)})(l,s),l);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),er(RI,PI,e),er(RI,PI,"esm2020")})();const BF="@firebase/firestore-compat",zF="0.4.3";function gv(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Q("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function ZT(){if(typeof Uint8Array>"u")throw new Q("unimplemented","Uint8Arrays are not available in this environment.")}function e0(){if(!yO())throw new Q("unimplemented","Blobs are unavailable in Firestore in this environment.")}let Dx=class Iy{constructor(e){this._delegate=e}static fromBase64String(e){return e0(),new Iy(mn.fromBase64String(e))}static fromUint8Array(e){return ZT(),new Iy(mn.fromUint8Array(e))}toBase64(){return e0(),this._delegate.toBase64()}toUint8Array(){return ZT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Ty(n){return $F(n,["next","error","complete"])}function $F(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class qF{enableIndexedDbPersistence(e,t){return ZM(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return eF(e._delegate)}clearIndexedDbPersistence(e){return tF(e._delegate)}}class Vx{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ji||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&us("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){QM(this._delegate,e,t,r)}enableNetwork(){return rF(this._delegate)}disableNetwork(){return sF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,s1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return nF(this._delegate)}onSnapshotsInSync(e){return kF(this._delegate,e)}get app(){if(!this._appCompat)throw new Q("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new zl(this,px(this._delegate,e))}catch(t){throw Tn(t,"collection()","Firestore.collection()")}}doc(e){try{return new cr(this,zf(this._delegate,e))}catch(t){throw Tn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new In(this,JM(this._delegate,e))}catch(t){throw Tn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return OF(this._delegate,t=>e(new Ox(this,t)))}batch(){return vn(this._delegate),new Lx(new NF(this._delegate,e=>Id(this._delegate,e)))}loadBundle(e){return iF(this._delegate,e)}namedQuery(e){return oF(this._delegate,e).then(t=>t?new In(this,t):null)}}class Cp extends pv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dx(new mn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return cr.forKey(t,this.firestore,null)}}function WF(n){PV(n)}class Ox{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Cp(e)}get(e){const t=Uo(e);return this._delegate.get(t).then(r=>new Zc(this._firestore,new dr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=Uo(e);return r?(gv("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Uo(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Uo(e);return this._delegate.delete(t),this}}class Lx{constructor(e){this._delegate=e}set(e,t,r){const s=Uo(e);return r?(gv("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Uo(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Uo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class sa{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Cc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ed(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=sa.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let a=s.get(t);return a||(a=new sa(e,new Cp(e),t),s.set(t,a)),a}}sa.INSTANCES=new WeakMap;class cr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Q("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new cr(t,new ot(t._delegate,r,new ue(e)))}static forKey(e,t,r){return new cr(t,new ot(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new zl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new zl(this.firestore,px(this._delegate,e))}catch(t){throw Tn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ae(e),e instanceof ot?mx(this._delegate,e):!1}set(e,t){t=gv("DocumentReference.set",t);try{return t?YT(this._delegate,e,t):YT(this._delegate,e)}catch(r){throw Tn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?XT(this._delegate,e):XT(this._delegate,e,t,...r)}catch(s){throw Tn(s,"updateDoc()","DocumentReference.update()")}}delete(){return RF(this._delegate)}onSnapshot(...e){const t=Mx(e),r=Fx(e,s=>new Zc(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return Nx(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=TF(this._delegate):e?.source==="server"?t=SF(this._delegate):t=IF(this._delegate),t.then(r=>new Zc(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new cr(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Tn(n,e,t){return n.message=n.message.replace(e,t),n}function Mx(n){for(const e of n)if(typeof e=="object"&&!Ty(e))return e;return{}}function Fx(n,e){let t;return Ty(n[0])?t=n[0]:Ty(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Zc{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new cr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Cx(this._delegate,e._delegate)}}class ed extends Zc{data(e){const t=this._delegate.data(e);return this._delegate._converter||kV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class In{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cp(e)}where(e,t,r){try{return new In(this.firestore,Ti(this._delegate,hF(e,t,r)))}catch(s){throw Tn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new In(this.firestore,Ti(this._delegate,fF(e,t)))}catch(r){throw Tn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new In(this.firestore,Ti(this._delegate,pF(e)))}catch(t){throw Tn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new In(this.firestore,Ti(this._delegate,mF(e)))}catch(t){throw Tn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new In(this.firestore,Ti(this._delegate,gF(...e)))}catch(t){throw Tn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new In(this.firestore,Ti(this._delegate,yF(...e)))}catch(t){throw Tn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new In(this.firestore,Ti(this._delegate,_F(...e)))}catch(t){throw Tn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new In(this.firestore,Ti(this._delegate,vF(...e)))}catch(t){throw Tn(t,"endAt()","Query.endAt()")}}isEqual(e){return gx(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=xF(this._delegate):e?.source==="server"?t=bF(this._delegate):t=AF(this._delegate),t.then(r=>new Sy(this.firestore,new br(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=Mx(e),r=Fx(e,s=>new Sy(this.firestore,new br(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return Nx(this._delegate,t,r)}withConverter(e){return new In(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class HF{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ed(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Sy{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new In(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ed(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new HF(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ed(this._firestore,r))})}isEqual(e){return Cx(this._delegate,e._delegate)}}class zl extends In{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new cr(this.firestore,e):null}doc(e){try{return e===void 0?new cr(this.firestore,zf(this._delegate)):new cr(this.firestore,zf(this._delegate,e))}catch(t){throw Tn(t,"doc()","CollectionReference.doc()")}}add(e){return PF(this._delegate,e).then(t=>new cr(this.firestore,t))}isEqual(e){return mx(this._delegate,e._delegate)}withConverter(e){return new zl(this.firestore,e?this._delegate.withConverter(sa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Uo(n){return Je(n,ot)}class yv{constructor(...e){this._delegate=new Wi(...e)}static documentId(){return new yv(gt.keyField().canonicalString())}isEqual(e){return e=Ae(e),e instanceof Wi?this._delegate._internalPath.isEqual(e._internalPath):!1}}class Lo{static serverTimestamp(){const e=MF();return e._methodName="FieldValue.serverTimestamp",new Lo(e)}static delete(){const e=LF();return e._methodName="FieldValue.delete",new Lo(e)}static arrayUnion(...e){const t=FF(...e);return t._methodName="FieldValue.arrayUnion",new Lo(t)}static arrayRemove(...e){const t=jF(...e);return t._methodName="FieldValue.arrayRemove",new Lo(t)}static increment(e){const t=UF(e);return t._methodName="FieldValue.increment",new Lo(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const GF={Firestore:Vx,GeoPoint:xr,Timestamp:Ze,Blob:Dx,Transaction:Ox,WriteBatch:Lx,DocumentReference:cr,DocumentSnapshot:Zc,Query:In,QueryDocumentSnapshot:ed,QuerySnapshot:Sy,CollectionReference:zl,FieldPath:yv,FieldValue:Lo,setLogLevel:WF,CACHE_SIZE_UNLIMITED:XM};function KF(n,e){n.INTERNAL.registerComponent(new hr("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps({...GF}))}function QF(n){KF(n,(e,t)=>new Vx(e,t,new qF)),n.registerVersion(BF,zF)}QF(yn);const JF="type.googleapis.com/google.protobuf.Int64Value",YF="type.googleapis.com/google.protobuf.UInt64Value";function jx(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function qf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>qf(e));if(typeof n=="function"||typeof n=="object")return jx(n,e=>qf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function $l(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case JF:case YF:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>$l(e)):typeof n=="function"||typeof n=="object"?jx(n,e=>$l(e)):n}const Ux="functions";const t0={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Mn extends Yt{constructor(e,t,r){super(`${Ux}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Mn.prototype)}}function XF(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Wf(n,e){let t=XF(n),r=t,s;try{const a=e&&e.error;if(a){const l=a.status;if(typeof l=="string"){if(!t0[l])return new Mn("internal","internal");t=t0[l],r=l}const d=a.message;typeof d=="string"&&(r=d),s=a.details,s!==void 0&&(s=$l(s))}}catch{}return t==="ok"?null:new Mn(t,r,s)}class ZF{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ft(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||s?.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const n0="us-central1",e4=/^data: (.*?)(?:\n|$)/;function t4(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Mn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}let n4=class{constructor(e,t,r,s,a=n0,l=(...d)=>fetch(...d)){this.app=e,this.fetchImpl=l,this.emulatorOrigin=null,this.contextProvider=new ZF(e,t,r,s),this.cancelAllRequests=new Promise(d=>{this.deleteService=()=>Promise.resolve(d())});try{const d=new URL(a);this.customDomain=d.origin+(d.pathname==="/"?"":d.pathname),this.region=n0}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function r4(n,e,t){const r=Hi(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(Oy(n.emulatorOrigin+"/backends"),Ly("Functions",!0))}function s4(n,e,t){const r=s=>a4(n,e,s,t||{});return r.stream=(s,a)=>l4(n,e,s,a),r}function i4(n,e,t){const r=s=>$x(n,e,s,t||{});return r.stream=(s,a)=>qx(n,e,s,a||{}),r}function Bx(n){return n.emulatorOrigin&&Hi(n.emulatorOrigin)?"include":void 0}async function o4(n,e,t,r,s){t["Content-Type"]="application/json";let a;try{a=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:Bx(s)})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function zx(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function a4(n,e,t,r){const s=n._url(e);return $x(n,s,t,r)}async function $x(n,e,t,r){t=qf(t);const s={data:t},a=await zx(n,r),l=r.timeout||7e4,d=t4(l),f=await Promise.race([o4(e,s,a,n.fetchImpl,n),d.promise,n.cancelAllRequests]);if(d.cancel(),!f)throw new Mn("cancelled","Firebase Functions instance was deleted.");const p=Wf(f.status,f.json);if(p)throw p;if(!f.json)throw new Mn("internal","Response is not valid JSON object.");let g=f.json.data;if(typeof g>"u"&&(g=f.json.result),typeof g>"u")throw new Mn("internal","Response is missing data field.");return{data:$l(g)}}function l4(n,e,t,r){const s=n._url(e);return qx(n,s,t,r||{})}async function qx(n,e,t,r){t=qf(t);const s={data:t},a=await zx(n,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let l;try{l=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:a,signal:r?.signal,credentials:Bx(n)})}catch(T){if(T instanceof Error&&T.name==="AbortError"){const x=new Mn("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const C=Wf(0,null);return{data:Promise.reject(C),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(C)}}}}}}let d,f;const p=new Promise((T,C)=>{d=T,f=C});r?.signal?.addEventListener("abort",()=>{const T=new Mn("cancelled","Request was cancelled.");f(T)});const g=l.body.getReader(),v=u4(g,d,f,r?.signal);return{stream:{[Symbol.asyncIterator](){const T=v.getReader();return{async next(){const{value:C,done:x}=await T.read();return{value:C,done:x}},async return(){return await T.cancel(),{done:!0,value:void 0}}}}},data:p}}function u4(n,e,t,r){const s=(l,d)=>{const f=l.match(e4);if(!f)return;const p=f[1];try{const g=JSON.parse(p);if("result"in g){e($l(g.result));return}if("message"in g){d.enqueue($l(g.message));return}if("error"in g){const v=Wf(0,g);d.error(v),t(v);return}}catch(g){if(g instanceof Mn){d.error(g),t(g);return}}},a=new TextDecoder;return new ReadableStream({start(l){let d="";return f();async function f(){if(r?.aborted){const p=new Mn("cancelled","Request was cancelled");return l.error(p),t(p),Promise.resolve()}try{const{value:p,done:g}=await n.read();if(g){d.trim()&&s(d.trim(),l),l.close();return}if(r?.aborted){const T=new Mn("cancelled","Request was cancelled");l.error(T),t(T),await n.cancel();return}d+=a.decode(p,{stream:!0});const v=d.split(`
`);d=v.pop()||"";for(const T of v)T.trim()&&s(T.trim(),l);return f()}catch(p){const g=p instanceof Mn?p:Wf(0,null);l.error(g),t(g)}}},cancel(){return n.cancel()}})}const r0="@firebase/functions",s0="0.13.1";const c4="auth-internal",d4="app-check-internal",h4="messaging-internal";function f4(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),a=t.getProvider(c4),l=t.getProvider(h4),d=t.getProvider(d4);return new n4(s,a,l,d,r)};Ds(new hr(Ux,e,"PUBLIC").setMultipleInstances(!0)),er(r0,s0,n),er(r0,s0,"esm2020")}function i0(n,e,t){r4(Ae(n),e,t)}function p4(n,e,t){return s4(Ae(n),e,t)}function m4(n,e,t){return i4(Ae(n),e,t)}f4();const g4="@firebase/functions-compat",y4="0.4.1";class Wx{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return p4(this._delegate,e,t)}httpsCallableFromURL(e,t){return m4(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(t==null)throw new Yt("functions","No origin provided to useFunctionsEmulator()");if(t[2]==null)throw new Yt("functions","Port missing in origin provided to useFunctionsEmulator()");return i0(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return i0(this._delegate,e,t)}}const _4="us-central1",v4=(n,{instanceIdentifier:e})=>{const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("functions").getImmediate({identifier:e??_4});return new Wx(t,r)};function w4(){const n={Functions:Wx};yn.INTERNAL.registerComponent(new hr("functions-compat",v4,"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}w4();yn.registerVersion(g4,y4);const E4={apiKey:"AIzaSyDummyKeyForEmulatorOnly",projectId:"schoolbook-290b6"};yn.apps.length||yn.initializeApp(E4);const kt=yn.firestore(),hl=yn.auth(),_v=yn.functions(),o0=window.location.hostname;(o0==="localhost"||o0==="127.0.0.1")&&(console.log("Using Firebase Emulators"),kt.useEmulator("127.0.0.1",8085),hl.useEmulator("http://127.0.0.1:9099",{disableWarnings:!0}),_v.useEmulator("127.0.0.1",5001));const xi=Object.freeze(Object.defineProperty({__proto__:null,auth:hl,db:kt,functions:_v},Symbol.toStringTag,{value:"Module"})),vl={onAuthStateChanged(n){return hl.onAuthStateChanged(n)},async signUp(n,e){return hl.createUserWithEmailAndPassword(n,e)},async login(n,e){return hl.signInWithEmailAndPassword(n,e)},async logout(){return hl.signOut()},async completeProfile(n){return _v.httpsCallable("completeProfile")(n)},onProfileSnapshot(n,e){return kt.collection("users").doc(n).onSnapshot(e)}};function Hx(n,e){return function(){return n.apply(e,arguments)}}const{toString:I4}=Object.prototype,{getPrototypeOf:vv}=Object,{iterator:Np,toStringTag:Gx}=Symbol,Dp=(n=>e=>{const t=I4.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Pr=n=>(n=n.toLowerCase(),e=>Dp(e)===n),Vp=n=>e=>typeof e===n,{isArray:ru}=Array,ql=Vp("undefined");function Td(n){return n!==null&&!ql(n)&&n.constructor!==null&&!ql(n.constructor)&&Fn(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Kx=Pr("ArrayBuffer");function T4(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Kx(n.buffer),e}const S4=Vp("string"),Fn=Vp("function"),Qx=Vp("number"),Sd=n=>n!==null&&typeof n=="object",A4=n=>n===!0||n===!1,pf=n=>{if(Dp(n)!=="object")return!1;const e=vv(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Gx in n)&&!(Np in n)},x4=n=>{if(!Sd(n)||Td(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},b4=Pr("Date"),R4=Pr("File"),P4=Pr("Blob"),k4=Pr("FileList"),C4=n=>Sd(n)&&Fn(n.pipe),N4=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Fn(n.append)&&((e=Dp(n))==="formdata"||e==="object"&&Fn(n.toString)&&n.toString()==="[object FormData]"))},D4=Pr("URLSearchParams"),[V4,O4,L4,M4]=["ReadableStream","Request","Response","Headers"].map(Pr),F4=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ad(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),ru(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{if(Td(n))return;const a=t?Object.getOwnPropertyNames(n):Object.keys(n),l=a.length;let d;for(r=0;r<l;r++)d=a[r],e.call(null,n[d],d,n)}}function Jx(n,e){if(Td(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Bo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Yx=n=>!ql(n)&&n!==Bo;function Ay(){const{caseless:n,skipUndefined:e}=Yx(this)&&this||{},t={},r=(s,a)=>{const l=n&&Jx(t,a)||a;pf(t[l])&&pf(s)?t[l]=Ay(t[l],s):pf(s)?t[l]=Ay({},s):ru(s)?t[l]=s.slice():(!e||!ql(s))&&(t[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Ad(arguments[s],r);return t}const j4=(n,e,t,{allOwnKeys:r}={})=>(Ad(e,(s,a)=>{t&&Fn(s)?n[a]=Hx(s,t):n[a]=s},{allOwnKeys:r}),n),U4=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),B4=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},z4=(n,e,t,r)=>{let s,a,l;const d={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),a=s.length;a-- >0;)l=s[a],(!r||r(l,n,e))&&!d[l]&&(e[l]=n[l],d[l]=!0);n=t!==!1&&vv(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},$4=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},q4=n=>{if(!n)return null;if(ru(n))return n;let e=n.length;if(!Qx(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},W4=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&vv(Uint8Array)),H4=(n,e)=>{const r=(n&&n[Np]).call(n);let s;for(;(s=r.next())&&!s.done;){const a=s.value;e.call(n,a[0],a[1])}},G4=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},K4=Pr("HTMLFormElement"),Q4=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),a0=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),J4=Pr("RegExp"),Xx=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Ad(t,(s,a)=>{let l;(l=e(s,a,n))!==!1&&(r[a]=l||s)}),Object.defineProperties(n,r)},Y4=n=>{Xx(n,(e,t)=>{if(Fn(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Fn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},X4=(n,e)=>{const t={},r=s=>{s.forEach(a=>{t[a]=!0})};return ru(n)?r(n):r(String(n).split(e)),t},Z4=()=>{},e5=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function t5(n){return!!(n&&Fn(n.append)&&n[Gx]==="FormData"&&n[Np])}const n5=n=>{const e=new Array(10),t=(r,s)=>{if(Sd(r)){if(e.indexOf(r)>=0)return;if(Td(r))return r;if(!("toJSON"in r)){e[s]=r;const a=ru(r)?[]:{};return Ad(r,(l,d)=>{const f=t(l,s+1);!ql(f)&&(a[d]=f)}),e[s]=void 0,a}}return r};return t(n,0)},r5=Pr("AsyncFunction"),s5=n=>n&&(Sd(n)||Fn(n))&&Fn(n.then)&&Fn(n.catch),Zx=((n,e)=>n?setImmediate:e?((t,r)=>(Bo.addEventListener("message",({source:s,data:a})=>{s===Bo&&a===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Bo.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Fn(Bo.postMessage)),i5=typeof queueMicrotask<"u"?queueMicrotask.bind(Bo):typeof process<"u"&&process.nextTick||Zx,o5=n=>n!=null&&Fn(n[Np]),G={isArray:ru,isArrayBuffer:Kx,isBuffer:Td,isFormData:N4,isArrayBufferView:T4,isString:S4,isNumber:Qx,isBoolean:A4,isObject:Sd,isPlainObject:pf,isEmptyObject:x4,isReadableStream:V4,isRequest:O4,isResponse:L4,isHeaders:M4,isUndefined:ql,isDate:b4,isFile:R4,isBlob:P4,isRegExp:J4,isFunction:Fn,isStream:C4,isURLSearchParams:D4,isTypedArray:W4,isFileList:k4,forEach:Ad,merge:Ay,extend:j4,trim:F4,stripBOM:U4,inherits:B4,toFlatObject:z4,kindOf:Dp,kindOfTest:Pr,endsWith:$4,toArray:q4,forEachEntry:H4,matchAll:G4,isHTMLForm:K4,hasOwnProperty:a0,hasOwnProp:a0,reduceDescriptors:Xx,freezeMethods:Y4,toObjectSet:X4,toCamelCase:Q4,noop:Z4,toFiniteNumber:e5,findKey:Jx,global:Bo,isContextDefined:Yx,isSpecCompliantForm:t5,toJSONObject:n5,isAsyncFn:r5,isThenable:s5,setImmediate:Zx,asap:i5,isIterable:o5};function Fe(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}G.inherits(Fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}});const eb=Fe.prototype,tb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{tb[n]={value:n}});Object.defineProperties(Fe,tb);Object.defineProperty(eb,"isAxiosError",{value:!0});Fe.from=(n,e,t,r,s,a)=>{const l=Object.create(eb);G.toFlatObject(n,l,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const d=n&&n.message?n.message:"Error",f=e==null&&n?n.code:e;return Fe.call(l,d,f,t,r,s),n&&l.cause==null&&Object.defineProperty(l,"cause",{value:n,configurable:!0}),l.name=n&&n.name||"Error",a&&Object.assign(l,a),l};const a5=null;function xy(n){return G.isPlainObject(n)||G.isArray(n)}function nb(n){return G.endsWith(n,"[]")?n.slice(0,-2):n}function l0(n,e,t){return n?n.concat(e).map(function(s,a){return s=nb(s),!t&&a?"["+s+"]":s}).join(t?".":""):e}function l5(n){return G.isArray(n)&&!n.some(xy)}const u5=G.toFlatObject(G,{},null,function(e){return/^is[A-Z]/.test(e)});function Op(n,e,t){if(!G.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=G.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,L){return!G.isUndefined(L[O])});const r=t.metaTokens,s=t.visitor||g,a=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(e);if(!G.isFunction(s))throw new TypeError("visitor must be a function");function p(x){if(x===null)return"";if(G.isDate(x))return x.toISOString();if(G.isBoolean(x))return x.toString();if(!f&&G.isBlob(x))throw new Fe("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(x)||G.isTypedArray(x)?f&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function g(x,O,L){let ne=x;if(x&&!L&&typeof x=="object"){if(G.endsWith(O,"{}"))O=r?O:O.slice(0,-2),x=JSON.stringify(x);else if(G.isArray(x)&&l5(x)||(G.isFileList(x)||G.endsWith(O,"[]"))&&(ne=G.toArray(x)))return O=nb(O),ne.forEach(function(Z,re){!(G.isUndefined(Z)||Z===null)&&e.append(l===!0?l0([O],re,a):l===null?O:O+"[]",p(Z))}),!1}return xy(x)?!0:(e.append(l0(L,O,a),p(x)),!1)}const v=[],T=Object.assign(u5,{defaultVisitor:g,convertValue:p,isVisitable:xy});function C(x,O){if(!G.isUndefined(x)){if(v.indexOf(x)!==-1)throw Error("Circular reference detected in "+O.join("."));v.push(x),G.forEach(x,function(ne,oe){(!(G.isUndefined(ne)||ne===null)&&s.call(e,ne,G.isString(oe)?oe.trim():oe,O,T))===!0&&C(ne,O?O.concat(oe):[oe])}),v.pop()}}if(!G.isObject(n))throw new TypeError("data must be an object");return C(n),e}function u0(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function wv(n,e){this._pairs=[],n&&Op(n,this,e)}const rb=wv.prototype;rb.append=function(e,t){this._pairs.push([e,t])};rb.toString=function(e){const t=e?function(r){return e.call(this,r,u0)}:u0;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function c5(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function sb(n,e,t){if(!e)return n;const r=t&&t.encode||c5;G.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let a;if(s?a=s(e,t):a=G.isURLSearchParams(e)?e.toString():new wv(e,t).toString(r),a){const l=n.indexOf("#");l!==-1&&(n=n.slice(0,l)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class c0{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){G.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ib={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},d5=typeof URLSearchParams<"u"?URLSearchParams:wv,h5=typeof FormData<"u"?FormData:null,f5=typeof Blob<"u"?Blob:null,p5={isBrowser:!0,classes:{URLSearchParams:d5,FormData:h5,Blob:f5},protocols:["http","https","file","blob","url","data"]},Ev=typeof window<"u"&&typeof document<"u",by=typeof navigator=="object"&&navigator||void 0,m5=Ev&&(!by||["ReactNative","NativeScript","NS"].indexOf(by.product)<0),g5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",y5=Ev&&window.location.href||"http://localhost",_5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ev,hasStandardBrowserEnv:m5,hasStandardBrowserWebWorkerEnv:g5,navigator:by,origin:y5},Symbol.toStringTag,{value:"Module"})),gn={..._5,...p5};function v5(n,e){return Op(n,new gn.classes.URLSearchParams,{visitor:function(t,r,s,a){return gn.isNode&&G.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function w5(n){return G.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function E5(n){const e={},t=Object.keys(n);let r;const s=t.length;let a;for(r=0;r<s;r++)a=t[r],e[a]=n[a];return e}function ob(n){function e(t,r,s,a){let l=t[a++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=a>=t.length;return l=!l&&G.isArray(s)?s.length:l,f?(G.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!d):((!s[l]||!G.isObject(s[l]))&&(s[l]=[]),e(t,r,s[l],a)&&G.isArray(s[l])&&(s[l]=E5(s[l])),!d)}if(G.isFormData(n)&&G.isFunction(n.entries)){const t={};return G.forEachEntry(n,(r,s)=>{e(w5(r),s,t,0)}),t}return null}function I5(n,e,t){if(G.isString(n))try{return(e||JSON.parse)(n),G.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const xd={transitional:ib,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=G.isObject(e);if(a&&G.isHTMLForm(e)&&(e=new FormData(e)),G.isFormData(e))return s?JSON.stringify(ob(e)):e;if(G.isArrayBuffer(e)||G.isBuffer(e)||G.isStream(e)||G.isFile(e)||G.isBlob(e)||G.isReadableStream(e))return e;if(G.isArrayBufferView(e))return e.buffer;if(G.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return v5(e,this.formSerializer).toString();if((d=G.isFileList(e))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Op(d?{"files[]":e}:e,f&&new f,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),I5(e)):e}],transformResponse:[function(e){const t=this.transitional||xd.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(G.isResponse(e)||G.isReadableStream(e))return e;if(e&&G.isString(e)&&(r&&!this.responseType||s)){const l=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?Fe.from(d,Fe.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gn.classes.FormData,Blob:gn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],n=>{xd.headers[n]={}});const T5=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),S5=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(l){s=l.indexOf(":"),t=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!t||e[t]&&T5[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},d0=Symbol("internals");function lc(n){return n&&String(n).trim().toLowerCase()}function mf(n){return n===!1||n==null?n:G.isArray(n)?n.map(mf):String(n)}function A5(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const x5=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Ng(n,e,t,r,s){if(G.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!G.isString(e)){if(G.isString(r))return e.indexOf(r)!==-1;if(G.isRegExp(r))return r.test(e)}}function b5(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function R5(n,e){const t=G.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,a,l){return this[r].call(this,e,s,a,l)},configurable:!0})})}let jn=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function a(d,f,p){const g=lc(f);if(!g)throw new Error("header name must be a non-empty string");const v=G.findKey(s,g);(!v||s[v]===void 0||p===!0||p===void 0&&s[v]!==!1)&&(s[v||f]=mf(d))}const l=(d,f)=>G.forEach(d,(p,g)=>a(p,g,f));if(G.isPlainObject(e)||e instanceof this.constructor)l(e,t);else if(G.isString(e)&&(e=e.trim())&&!x5(e))l(S5(e),t);else if(G.isObject(e)&&G.isIterable(e)){let d={},f,p;for(const g of e){if(!G.isArray(g))throw TypeError("Object iterator must return a key-value pair");d[p=g[0]]=(f=d[p])?G.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}l(d,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=lc(e),e){const r=G.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return A5(s);if(G.isFunction(t))return t.call(this,s,r);if(G.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=lc(e),e){const r=G.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Ng(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function a(l){if(l=lc(l),l){const d=G.findKey(r,l);d&&(!t||Ng(r,r[d],d,t))&&(delete r[d],s=!0)}}return G.isArray(e)?e.forEach(a):a(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const a=t[r];(!e||Ng(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const t=this,r={};return G.forEach(this,(s,a)=>{const l=G.findKey(r,a);if(l){t[l]=mf(s),delete t[a];return}const d=e?b5(a):String(a).trim();d!==a&&delete t[a],t[d]=mf(s),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return G.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&G.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[d0]=this[d0]={accessors:{}}).accessors,s=this.prototype;function a(l){const d=lc(l);r[d]||(R5(s,l),r[d]=!0)}return G.isArray(e)?e.forEach(a):a(e),this}};jn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.reduceDescriptors(jn.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});G.freezeMethods(jn);function Dg(n,e){const t=this||xd,r=e||t,s=jn.from(r.headers);let a=r.data;return G.forEach(n,function(d){a=d.call(t,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function ab(n){return!!(n&&n.__CANCEL__)}function su(n,e,t){Fe.call(this,n??"canceled",Fe.ERR_CANCELED,e,t),this.name="CanceledError"}G.inherits(su,Fe,{__CANCEL__:!0});function lb(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Fe("Request failed with status code "+t.status,[Fe.ERR_BAD_REQUEST,Fe.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function P5(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function k5(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,a=0,l;return e=e!==void 0?e:1e3,function(f){const p=Date.now(),g=r[a];l||(l=p),t[s]=f,r[s]=p;let v=a,T=0;for(;v!==s;)T+=t[v++],v=v%n;if(s=(s+1)%n,s===a&&(a=(a+1)%n),p-l<e)return;const C=g&&p-g;return C?Math.round(T*1e3/C):void 0}}function C5(n,e){let t=0,r=1e3/e,s,a;const l=(p,g=Date.now())=>{t=g,s=null,a&&(clearTimeout(a),a=null),n(...p)};return[(...p)=>{const g=Date.now(),v=g-t;v>=r?l(p,g):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},r-v)))},()=>s&&l(s)]}const Hf=(n,e,t=3)=>{let r=0;const s=k5(50,250);return C5(a=>{const l=a.loaded,d=a.lengthComputable?a.total:void 0,f=l-r,p=s(f),g=l<=d;r=l;const v={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:p||void 0,estimated:p&&d&&g?(d-l)/p:void 0,event:a,lengthComputable:d!=null,[e?"download":"upload"]:!0};n(v)},t)},h0=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},f0=n=>(...e)=>G.asap(()=>n(...e)),N5=gn.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,gn.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(gn.origin),gn.navigator&&/(msie|trident)/i.test(gn.navigator.userAgent)):()=>!0,D5=gn.hasStandardBrowserEnv?{write(n,e,t,r,s,a,l){if(typeof document>"u")return;const d=[`${n}=${encodeURIComponent(e)}`];G.isNumber(t)&&d.push(`expires=${new Date(t).toUTCString()}`),G.isString(r)&&d.push(`path=${r}`),G.isString(s)&&d.push(`domain=${s}`),a===!0&&d.push("secure"),G.isString(l)&&d.push(`SameSite=${l}`),document.cookie=d.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function V5(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function O5(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function ub(n,e,t){let r=!V5(e);return n&&(r||t==!1)?O5(n,e):e}const p0=n=>n instanceof jn?{...n}:n;function ia(n,e){e=e||{};const t={};function r(p,g,v,T){return G.isPlainObject(p)&&G.isPlainObject(g)?G.merge.call({caseless:T},p,g):G.isPlainObject(g)?G.merge({},g):G.isArray(g)?g.slice():g}function s(p,g,v,T){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p,v,T)}else return r(p,g,v,T)}function a(p,g){if(!G.isUndefined(g))return r(void 0,g)}function l(p,g){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p)}else return r(void 0,g)}function d(p,g,v){if(v in e)return r(p,g);if(v in n)return r(void 0,p)}const f={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(p,g,v)=>s(p0(p),p0(g),v,!0)};return G.forEach(Object.keys({...n,...e}),function(g){const v=f[g]||s,T=v(n[g],e[g],g);G.isUndefined(T)&&v!==d||(t[g]=T)}),t}const cb=n=>{const e=ia({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:d}=e;if(e.headers=l=jn.from(l),e.url=sb(ub(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),G.isFormData(t)){if(gn.hasStandardBrowserEnv||gn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(G.isFunction(t.getHeaders)){const f=t.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,v])=>{p.includes(g.toLowerCase())&&l.set(g,v)})}}if(gn.hasStandardBrowserEnv&&(r&&G.isFunction(r)&&(r=r(e)),r||r!==!1&&N5(e.url))){const f=s&&a&&D5.read(a);f&&l.set(s,f)}return e},L5=typeof XMLHttpRequest<"u",M5=L5&&function(n){return new Promise(function(t,r){const s=cb(n);let a=s.data;const l=jn.from(s.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:p}=s,g,v,T,C,x;function O(){C&&C(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let L=new XMLHttpRequest;L.open(s.method.toUpperCase(),s.url,!0),L.timeout=s.timeout;function ne(){if(!L)return;const Z=jn.from("getAllResponseHeaders"in L&&L.getAllResponseHeaders()),de={data:!d||d==="text"||d==="json"?L.responseText:L.response,status:L.status,statusText:L.statusText,headers:Z,config:n,request:L};lb(function(R){t(R),O()},function(R){r(R),O()},de),L=null}"onloadend"in L?L.onloadend=ne:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(ne)},L.onabort=function(){L&&(r(new Fe("Request aborted",Fe.ECONNABORTED,n,L)),L=null)},L.onerror=function(re){const de=re&&re.message?re.message:"Network Error",le=new Fe(de,Fe.ERR_NETWORK,n,L);le.event=re||null,r(le),L=null},L.ontimeout=function(){let re=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const de=s.transitional||ib;s.timeoutErrorMessage&&(re=s.timeoutErrorMessage),r(new Fe(re,de.clarifyTimeoutError?Fe.ETIMEDOUT:Fe.ECONNABORTED,n,L)),L=null},a===void 0&&l.setContentType(null),"setRequestHeader"in L&&G.forEach(l.toJSON(),function(re,de){L.setRequestHeader(de,re)}),G.isUndefined(s.withCredentials)||(L.withCredentials=!!s.withCredentials),d&&d!=="json"&&(L.responseType=s.responseType),p&&([T,x]=Hf(p,!0),L.addEventListener("progress",T)),f&&L.upload&&([v,C]=Hf(f),L.upload.addEventListener("progress",v),L.upload.addEventListener("loadend",C)),(s.cancelToken||s.signal)&&(g=Z=>{L&&(r(!Z||Z.type?new su(null,n,L):Z),L.abort(),L=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const oe=P5(s.url);if(oe&&gn.protocols.indexOf(oe)===-1){r(new Fe("Unsupported protocol "+oe+":",Fe.ERR_BAD_REQUEST,n));return}L.send(a||null)})},F5=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const a=function(p){if(!s){s=!0,d();const g=p instanceof Error?p:this.reason;r.abort(g instanceof Fe?g:new su(g instanceof Error?g.message:g))}};let l=e&&setTimeout(()=>{l=null,a(new Fe(`timeout ${e} of ms exceeded`,Fe.ETIMEDOUT))},e);const d=()=>{n&&(l&&clearTimeout(l),l=null,n.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),n=null)};n.forEach(p=>p.addEventListener("abort",a));const{signal:f}=r;return f.unsubscribe=()=>G.asap(d),f}},j5=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},U5=async function*(n,e){for await(const t of B5(n))yield*j5(t,e)},B5=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},m0=(n,e,t,r)=>{const s=U5(n,e);let a=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await s.next();if(p){d(),f.close();return}let v=g.byteLength;if(t){let T=a+=v;t(T)}f.enqueue(new Uint8Array(g))}catch(p){throw d(p),p}},cancel(f){return d(f),s.return()}},{highWaterMark:2})},g0=64*1024,{isFunction:Yh}=G,z5=(({Request:n,Response:e})=>({Request:n,Response:e}))(G.global),{ReadableStream:y0,TextEncoder:_0}=G.global,v0=(n,...e)=>{try{return!!n(...e)}catch{return!1}},$5=n=>{n=G.merge.call({skipUndefined:!0},z5,n);const{fetch:e,Request:t,Response:r}=n,s=e?Yh(e):typeof fetch=="function",a=Yh(t),l=Yh(r);if(!s)return!1;const d=s&&Yh(y0),f=s&&(typeof _0=="function"?(x=>O=>x.encode(O))(new _0):async x=>new Uint8Array(await new t(x).arrayBuffer())),p=a&&d&&v0(()=>{let x=!1;const O=new t(gn.origin,{body:new y0,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!O}),g=l&&d&&v0(()=>G.isReadableStream(new r("").body)),v={stream:g&&(x=>x.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!v[x]&&(v[x]=(O,L)=>{let ne=O&&O[x];if(ne)return ne.call(O);throw new Fe(`Response type '${x}' is not supported`,Fe.ERR_NOT_SUPPORT,L)})});const T=async x=>{if(x==null)return 0;if(G.isBlob(x))return x.size;if(G.isSpecCompliantForm(x))return(await new t(gn.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(G.isArrayBufferView(x)||G.isArrayBuffer(x))return x.byteLength;if(G.isURLSearchParams(x)&&(x=x+""),G.isString(x))return(await f(x)).byteLength},C=async(x,O)=>{const L=G.toFiniteNumber(x.getContentLength());return L??T(O)};return async x=>{let{url:O,method:L,data:ne,signal:oe,cancelToken:Z,timeout:re,onDownloadProgress:de,onUploadProgress:le,responseType:R,headers:b,withCredentials:A="same-origin",fetchOptions:N}=cb(x),D=e||fetch;R=R?(R+"").toLowerCase():"text";let j=F5([oe,Z&&Z.toAbortSignal()],re),k=null;const Be=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let rt;try{if(le&&p&&L!=="get"&&L!=="head"&&(rt=await C(b,ne))!==0){let F=new t(O,{method:"POST",body:ne,duplex:"half"}),K;if(G.isFormData(ne)&&(K=F.headers.get("content-type"))&&b.setContentType(K),F.body){const[Ne,Ce]=h0(rt,Hf(f0(le)));ne=m0(F.body,g0,Ne,Ce)}}G.isString(A)||(A=A?"include":"omit");const ce=a&&"credentials"in t.prototype,Ve={...N,signal:j,method:L.toUpperCase(),headers:b.normalize().toJSON(),body:ne,duplex:"half",credentials:ce?A:void 0};k=a&&new t(O,Ve);let se=await(a?D(k,N):D(O,Ve));const _e=g&&(R==="stream"||R==="response");if(g&&(de||_e&&Be)){const F={};["status","statusText","headers"].forEach(Ue=>{F[Ue]=se[Ue]});const K=G.toFiniteNumber(se.headers.get("content-length")),[Ne,Ce]=de&&h0(K,Hf(f0(de),!0))||[];se=new r(m0(se.body,g0,Ne,()=>{Ce&&Ce(),Be&&Be()}),F)}R=R||"text";let fe=await v[G.findKey(v,R)||"text"](se,x);return!_e&&Be&&Be(),await new Promise((F,K)=>{lb(F,K,{data:fe,headers:jn.from(se.headers),status:se.status,statusText:se.statusText,config:x,request:k})})}catch(ce){throw Be&&Be(),ce&&ce.name==="TypeError"&&/Load failed|fetch/i.test(ce.message)?Object.assign(new Fe("Network Error",Fe.ERR_NETWORK,x,k),{cause:ce.cause||ce}):Fe.from(ce,ce&&ce.code,x,k)}}},q5=new Map,db=n=>{let e=n&&n.env||{};const{fetch:t,Request:r,Response:s}=e,a=[r,s,t];let l=a.length,d=l,f,p,g=q5;for(;d--;)f=a[d],p=g.get(f),p===void 0&&g.set(f,p=d?new Map:$5(e)),g=p;return p};db();const Iv={http:a5,xhr:M5,fetch:{get:db}};G.forEach(Iv,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const w0=n=>`- ${n}`,W5=n=>G.isFunction(n)||n===null||n===!1;function H5(n,e){n=G.isArray(n)?n:[n];const{length:t}=n;let r,s;const a={};for(let l=0;l<t;l++){r=n[l];let d;if(s=r,!W5(r)&&(s=Iv[(d=String(r)).toLowerCase()],s===void 0))throw new Fe(`Unknown adapter '${d}'`);if(s&&(G.isFunction(s)||(s=s.get(e))))break;a[d||"#"+l]=s}if(!s){const l=Object.entries(a).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let d=t?l.length>1?`since :
`+l.map(w0).join(`
`):" "+w0(l[0]):"as no adapter specified";throw new Fe("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const hb={getAdapter:H5,adapters:Iv};function Vg(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new su(null,n)}function E0(n){return Vg(n),n.headers=jn.from(n.headers),n.data=Dg.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),hb.getAdapter(n.adapter||xd.adapter,n)(n).then(function(r){return Vg(n),r.data=Dg.call(n,n.transformResponse,r),r.headers=jn.from(r.headers),r},function(r){return ab(r)||(Vg(n),r&&r.response&&(r.response.data=Dg.call(n,n.transformResponse,r.response),r.response.headers=jn.from(r.response.headers))),Promise.reject(r)})}const fb="1.13.2",Lp={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Lp[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const I0={};Lp.transitional=function(e,t,r){function s(a,l){return"[Axios v"+fb+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,d)=>{if(e===!1)throw new Fe(s(l," has been removed"+(t?" in "+t:"")),Fe.ERR_DEPRECATED);return t&&!I0[l]&&(I0[l]=!0,console.warn(s(l," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,l,d):!0}};Lp.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function G5(n,e,t){if(typeof n!="object")throw new Fe("options must be an object",Fe.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const a=r[s],l=e[a];if(l){const d=n[a],f=d===void 0||l(d,a,n);if(f!==!0)throw new Fe("option "+a+" must be "+f,Fe.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Fe("Unknown option "+a,Fe.ERR_BAD_OPTION)}}const gf={assertOptions:G5,validators:Lp},Kr=gf.validators;let Wo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new c0,response:new c0}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ia(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&gf.assertOptions(r,{silentJSONParsing:Kr.transitional(Kr.boolean),forcedJSONParsing:Kr.transitional(Kr.boolean),clarifyTimeoutError:Kr.transitional(Kr.boolean)},!1),s!=null&&(G.isFunction(s)?t.paramsSerializer={serialize:s}:gf.assertOptions(s,{encode:Kr.function,serialize:Kr.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),gf.assertOptions(t,{baseUrl:Kr.spelling("baseURL"),withXsrfToken:Kr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=a&&G.merge(a.common,a[t.method]);a&&G.forEach(["delete","get","head","post","put","patch","common"],x=>{delete a[x]}),t.headers=jn.concat(l,a);const d=[];let f=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(t)===!1||(f=f&&O.synchronous,d.unshift(O.fulfilled,O.rejected))});const p=[];this.interceptors.response.forEach(function(O){p.push(O.fulfilled,O.rejected)});let g,v=0,T;if(!f){const x=[E0.bind(this),void 0];for(x.unshift(...d),x.push(...p),T=x.length,g=Promise.resolve(t);v<T;)g=g.then(x[v++],x[v++]);return g}T=d.length;let C=t;for(;v<T;){const x=d[v++],O=d[v++];try{C=x(C)}catch(L){O.call(this,L);break}}try{g=E0.call(this,C)}catch(x){return Promise.reject(x)}for(v=0,T=p.length;v<T;)g=g.then(p[v++],p[v++]);return g}getUri(e){e=ia(this.defaults,e);const t=ub(e.baseURL,e.url,e.allowAbsoluteUrls);return sb(t,e.params,e.paramsSerializer)}};G.forEach(["delete","get","head","options"],function(e){Wo.prototype[e]=function(t,r){return this.request(ia(r||{},{method:e,url:t,data:(r||{}).data}))}});G.forEach(["post","put","patch"],function(e){function t(r){return function(a,l,d){return this.request(ia(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Wo.prototype[e]=t(),Wo.prototype[e+"Form"]=t(!0)});let K5=class pb{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(s=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](s);r._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(d=>{r.subscribe(d),a=d}).then(s);return l.cancel=function(){r.unsubscribe(a)},l},e(function(a,l,d){r.reason||(r.reason=new su(a,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new pb(function(s){e=s}),cancel:e}}};function Q5(n){return function(t){return n.apply(null,t)}}function J5(n){return G.isObject(n)&&n.isAxiosError===!0}const Ry={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ry).forEach(([n,e])=>{Ry[e]=n});function mb(n){const e=new Wo(n),t=Hx(Wo.prototype.request,e);return G.extend(t,Wo.prototype,e,{allOwnKeys:!0}),G.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return mb(ia(n,s))},t}const Vt=mb(xd);Vt.Axios=Wo;Vt.CanceledError=su;Vt.CancelToken=K5;Vt.isCancel=ab;Vt.VERSION=fb;Vt.toFormData=Op;Vt.AxiosError=Fe;Vt.Cancel=Vt.CanceledError;Vt.all=function(e){return Promise.all(e)};Vt.spread=Q5;Vt.isAxiosError=J5;Vt.mergeConfig=ia;Vt.AxiosHeaders=jn;Vt.formToJSON=n=>ob(G.isHTMLForm(n)?new FormData(n):n);Vt.getAdapter=hb.getAdapter;Vt.HttpStatusCode=Ry;Vt.default=Vt;const{Axios:Ij,AxiosError:Tj,CanceledError:Sj,isCancel:Aj,CancelToken:xj,VERSION:bj,all:Rj,Cancel:Pj,isAxiosError:kj,spread:Cj,toFormData:Nj,AxiosHeaders:Dj,HttpStatusCode:Vj,formToJSON:Oj,getAdapter:Lj,mergeConfig:Mj}=Vt,Kt={onBooksSnapshot(n,e){return kt.collection("books").orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));n(r)},t=>{console.error("Books snapshot error:",t),e&&e(t)})},getMyBooks(n,e){return kt.collection("books").where("sellerId","==",n).orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async createBook(n){return kt.collection("books").add({...n,status:"Available",views:0})},async incrementBookView(n){return kt.collection("books").doc(n).update({views:yn.firestore.FieldValue.increment(1)})},async deleteBook(n){const{functions:e}=await Si(async()=>{const{functions:r}=await Promise.resolve().then(()=>xi);return{functions:r}},void 0);return e.httpsCallable("deleteBook")({bookId:n})},async reserveBook(n,e,t,r){try{return(await Vt.post("http://127.0.0.1:5001/schoolbook-290b6/us-central1/handleBookTransaction",{bookId:n,buyerId:e,agreedPrice:Number(t),meetingTime:r})).data}catch(s){throw s}},async startTransaction(n,e,t){if(!e)return alert("");if(e.uid===n.sellerId)return alert("");try{const r=kt.collection("transactions"),a=await r.where("bookId","==",n.id).where("buyerId","==",e.uid).get();if(!a.empty)t(a.docs[0].id);else{const l=await r.add({bookId:n.id,bookTitle:n.title,sellerId:n.sellerId,buyerId:e.uid,price:n.price,status:"Pending",timestamp:new Date});await this.addNotification({userId:n.sellerId,content:`${n.title}~`,type:"inquiry"}),t(l.id)}}catch(r){console.error(r),alert(": "+r.message)}},async confirmTransactionTime(n){const{functions:e}=await Si(async()=>{const{functions:r}=await Promise.resolve().then(()=>xi);return{functions:r}},void 0);return e.httpsCallable("confirmTransactionTime")({transactionId:n})},getUserTransactions(n,e){return kt.collection("transactions").where("buyerId","==",n).onSnapshot(e)},getSellerTransactions(n,e){return kt.collection("transactions").where("sellerId","==",n).onSnapshot(e)},async updateTransactionStatus(n,e){const{functions:t}=await Si(async()=>{const{functions:s}=await Promise.resolve().then(()=>xi);return{functions:s}},void 0);return t.httpsCallable("updateTransactionStatus")({transactionId:n,newStatus:e})},async requestReschedule(n,e,t){const{functions:r}=await Si(async()=>{const{functions:a}=await Promise.resolve().then(()=>xi);return{functions:a}},void 0);return r.httpsCallable("requestReschedule")({transactionId:n,newTime:e,reason:t})},async respondToReschedule(n,e){const{functions:t}=await Si(async()=>{const{functions:s}=await Promise.resolve().then(()=>xi);return{functions:s}},void 0);return t.httpsCallable("respondToReschedule")({transactionId:n,response:e})},onWishesSnapshot(n){return kt.collection("wishes").orderBy("timestamp","desc").onSnapshot(e=>{const t=e.docs.map(r=>({id:r.id,...r.data()}));n(t)})},async addWish({content:n,user:e,avatarId:t,image:r}){return kt.collection("wishes").add({uid:yn.auth().currentUser?.uid||"anonymous",user:e||"",avatarId:t||"default",content:n,image:r||null,timestamp:new Date})},async deleteWish(n){return kt.collection("wishes").doc(n).delete()},async addBook(n){return kt.collection("books").add({...n,status:"Available",timestamp:new Date})},async deleteTransaction(n){return kt.collection("transactions").doc(n).delete()},async markAsRead(n,e){return kt.collection("transactions").doc(n).update({unreadBy:yn.firestore.FieldValue.arrayRemove(e)})},subscribeToNotifications(n,e){return kt.collection("notifications").where("userId","==",n).orderBy("timestamp","desc").limit(20).onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async markNotificationAsRead(n){return kt.collection("notifications").doc(n).update({isRead:!0})},async addNotification({userId:n,content:e,type:t="system"}){return kt.collection("notifications").add({userId:n,content:e,type:t,isRead:!1,timestamp:new Date})},recordCheckIn(){localStorage.setItem("lastCheckIn",new Date().toDateString())},hasCheckedInToday(){return localStorage.getItem("lastCheckIn")===new Date().toDateString()}},T0={async sendMessage(n,e,t,r,s=null){if(!(!r?.trim()&&!s))try{const a=kt.collection("transactions").doc(n),l=a.collection("messages"),d=await a.get();if(d.exists){const f=d.data(),p=e===f.buyerId?f.sellerId:f.buyerId;await l.add({senderId:e,senderName:t,content:r?.trim()||"",image:s,timestamp:new Date}),await a.update({lastMessage:r?.trim()||(s?"[]":""),lastTimestamp:new Date,unreadBy:yn.firestore.FieldValue.arrayUnion(p)})}}catch(a){throw console.error("Error sending message:",a),a}},subscribeToMessages(n,e){return kt.collection("transactions").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(r=>{const s=r.docs.map(a=>({id:a.id,...a.data()}));e(s)},r=>{console.error("Error subscribing to messages:",r)})}},Mp={fontFamily:'"Noto Sans TC", "PMingLiU", sans-serif'},ke={whiteBucks:"#E8E3DF",fossilGray:"#C9C3B6",brushwood:"#9E9081",chocolateBubble:"#A58976",brownWindmill:"#756256",bgLight:"#F9F7F5"},Y5=["","","","",""],S0=[{id:"all",name:""},{id:"chi",name:""},{id:"eng",name:""},{id:"math",name:""},{id:"sci",name:""},{id:"soc",name:""},{id:"extra",name:""}],Ho=[{id:"default",name:"",price:0,src:"https://i.postimg.cc/9fW28Bc0/niu.jpg"},{id:"special1",name:"",price:100,src:"https://i.postimg.cc/zyP43KbN/tu-zi.jpg"},{id:"special2",name:"",price:100,src:"https://i.postimg.cc/pd2vGBP9/zhu.jpg"},{id:"special3",name:"",price:100,src:"https://i.postimg.cc/wB6zfk97/gou.jpg"},{id:"special4",name:"",price:100,src:"https://i.postimg.cc/qNvyYNG3/EE1D91FC-D76E-4FBA-A85F-33F8D82EAFEB.jpg"},{id:"special5",name:"",price:100,src:"https://i.postimg.cc/VkjgJMr4/84AD5380-E492-4603-B7C7-4BD68372B94A.jpg"},{id:"cat",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cat&backgroundColor=FFD700"},{id:"glasses",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=glasses&backgroundColor=4ADE80"},{id:"cool",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cool&backgroundColor=A58976"},{id:"artist",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=artist&backgroundColor=FFB6C1"},{id:"robot",name:"",price:100,src:"https://api.dicebear.com/7.x/bottts/svg?seed=robot&backgroundColor=E0E0E0"}],X5=[],Tv=n=>{if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=Math.floor((new Date-e)/1e3);return r<60?"":r<3600?`${Math.floor(r/60)}`:r<86400?`${Math.floor(r/3600)}`:r<2592e3?`${Math.floor(r/86400)}`:e.toLocaleDateString()},Sv=({type:n,price:e,originalPrice:t,large:r=!1})=>n==="exchange"?E.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:ke.brushwood},children:[E.jsx(_P,{size:r?20:14}),E.jsx("span",{children:""})]}):n==="gift"||e===0?E.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:ke.chocolateBubble},children:[E.jsx(P0,{size:r?20:14}),E.jsx("span",{children:""})]}):E.jsxs("div",{className:"flex flex-col",children:[E.jsxs("div",{className:`font-bold ${r?"text-3xl":"text-lg"}`,style:{color:ke.brownWindmill},children:["NT$ ",e]}),t&&E.jsxs("span",{className:"text-xs line-through",style:{color:ke.fossilGray},children:[" $",t]})]}),Av=(n,e=800,t=800,r=.6)=>new Promise(s=>{const a=new Image;a.src=n,a.onload=()=>{const l=document.createElement("canvas");let d=a.width,f=a.height;d>f?d>e&&(f*=e/d,d=e):f>t&&(d*=t/f,f=t),l.width=d,l.height=f,l.getContext("2d").drawImage(a,0,0,d,f),s(l.toDataURL("image/jpeg",r))}}),Z5=({items:n,onNavigate:e,currentUser:t})=>{const[r,s]=ye.useState(0),a=(n||[]).slice(0,5),[l,d]=ye.useState([]);if(ye.useEffect(()=>{if(a.length===0)return;const p=setInterval(()=>{s(g=>(g+1)%a.length)},4e3);return()=>clearInterval(p)},[a.length]),ye.useEffect(()=>{const p=[];t&&p.push(""),[...n||[]].sort((v,T)=>{const C=v.timestamp?.toDate?v.timestamp.toDate():new Date(v.timestamp||0);return(T.timestamp?.toDate?T.timestamp.toDate():new Date(T.timestamp||0))-C}).slice(0,8).forEach(v=>{const T=Tv(v.timestamp),C=v.seller?.nickname||"";p.push(`${T} ${C} ${v.title}`)}),d(p)},[n,t]),a.length===0)return null;const f=a[r];return E.jsxs("div",{className:"h-full",children:[E.jsx("div",{className:"flex items-center justify-between mb-3",children:E.jsxs("div",{className:"flex items-center gap-2 w-full",children:[E.jsx("span",{className:"bg-orange-500 text-white p-1 rounded-full animate-pulse flex-shrink-0",children:E.jsx(rP,{size:16,fill:"currentColor"})}),E.jsx("h2",{className:"text-lg font-bold tracking-wide flex-shrink-0",style:{color:ke.brownWindmill},children:""}),l.length>0&&E.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 ml-2 overflow-hidden flex-1 max-w-[500px]",children:[E.jsx(MP,{size:14,className:"text-red-500 flex-shrink-0",fill:"currentColor"}),E.jsx("div",{className:"flex-1 overflow-hidden relative h-5",children:E.jsxs("div",{className:"whitespace-nowrap absolute animate-marquee font-medium flex items-center h-full",children:[l.map((p,g)=>E.jsx("span",{className:"mr-12 inline-block",children:p},g)),l.map((p,g)=>E.jsx("span",{className:"mr-12 inline-block",children:p},`dup-${g}`))]})})]})]})}),E.jsxs("div",{className:"relative w-full h-48 bg-white rounded-2xl shadow-md overflow-hidden border cursor-pointer group",style:{borderColor:ke.whiteBucks},onClick:()=>e("product",f),children:[E.jsx("div",{className:"absolute inset-0 bg-cover bg-center blur-xl opacity-30 animate-pulse-slow transition-all duration-1000 transform scale-110",style:{backgroundImage:`url(${f.cover||f.imageBase64})`}},f.id+"-bg"),E.jsxs("div",{className:"absolute inset-0 flex items-center p-4 z-10",children:[E.jsx("div",{className:"w-28 h-36 flex-shrink-0 rounded-lg overflow-hidden shadow-lg border border-white transform transition-transform duration-500 hover:scale-105 animate-fade-in-up",children:E.jsx("img",{src:f.cover||f.imageBase64,alt:f.title,className:"w-full h-full object-cover"})},f.id+"-img"),E.jsxs("div",{className:"flex-1 ml-4 flex flex-col justify-center h-full animate-fade-in-right",children:[E.jsxs("div",{className:"flex items-start justify-between mb-1",children:[E.jsx("span",{className:"text-xs font-bold text-orange-500 bg-orange-50 px-2 py-0.5 rounded-md",children:"HOT"}),E.jsxs("span",{className:"text-xs text-gray-400",children:[r+1," / ",a.length]})]}),E.jsx("h3",{className:"font-bold text-lg text-[#5D4037] line-clamp-2 leading-tight mb-2",children:f.title}),E.jsxs("div",{className:"mt-auto",children:[E.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[E.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.grade||""}),E.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.subject}),E.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.conditionLevel})]}),E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx(Sv,{type:f.type,price:f.price,originalPrice:f.originalPrice}),E.jsx("div",{className:"w-8 h-8 rounded-full bg-[#756256] text-white flex items-center justify-center shadow-md transform translate-x-16 group-hover:translate-x-0 transition-all duration-300 opacity-0 group-hover:opacity-100",children:E.jsx(x0,{size:16})})]})]})]},f.id+"-text")]}),E.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-1.5 z-20",children:a.map((p,g)=>E.jsx("div",{className:`h-1 rounded-full overflow-hidden transition-all duration-300 ${g===r?"w-6 bg-gray-200":"w-1.5 bg-gray-300"}`,children:g===r&&E.jsx("div",{className:"h-full bg-[#756256] animate-progress-fill",style:{width:"100%"}})},g))})]}),E.jsx("style",{children:`
        @keyframes progress-fill {
          from { width: 0%; }
          to { width: 100%; }
        }
        .animate-progress-fill {
          animation: progress-fill 4s linear;
        }
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.5s ease-out forwards;
        }
        @keyframes fade-in-right {
          from { opacity: 0; transform: translateX(10px); }
          to { opacity: 1; transform: translateX(0); }
        }
        .animate-fade-in-right {
          animation: fade-in-right 0.5s ease-out forwards;
        }
        @keyframes marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(-50%); } 
        }
        .animate-marquee {
          animation: marquee 30s linear infinite;
        }
      `})]})},ej=({examCountdown:n})=>{const[e,t]=ye.useState(0),r=n?.exams||[],s=r.length>0&&r[e]?r[e]:{title:r.length===0&&n?"...":"",daysLeft:0};return E.jsxs("div",{className:"h-full",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[E.jsx("span",{className:"bg-red-500 text-white p-1 rounded-full",children:E.jsx($R,{size:16})}),E.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:ke.brownWindmill},children:""})]}),E.jsxs("div",{className:"bg-white p-3 rounded-2xl border flex flex-col justify-between h-48 relative overflow-hidden shadow-md",style:{borderColor:ke.whiteBucks},children:[E.jsx("a",{href:"https://calendar.google.com/calendar/embed?src=shsh.ylc.edu.tw_fcpdcjkto9mpulh1gg2eetr4s4%40group.calendar.google.com&ctz=Asia%2FTaipei",target:"_blank",rel:"noopener noreferrer",className:"absolute top-0 right-0 w-12 h-12 bg-red-50 rounded-bl-2xl z-20 flex items-center justify-center text-red-400 hover:text-red-500 hover:bg-red-100 transition-colors cursor-pointer",children:E.jsx(ZR,{size:18})}),E.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-center items-center",children:[E.jsxs("div",{className:"relative mb-2",children:[E.jsxs("div",{className:"text-base text-gray-500 font-bold truncate flex items-center justify-center gap-1 cursor-pointer hover:text-gray-700 transition-colors",children:[" ",s.title," ",E.jsx(HR,{size:14})]}),r.length>1&&E.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:e,onChange:a=>t(Number(a.target.value)),children:r.map((a,l)=>E.jsxs("option",{value:l,children:[a.title," (",a.displayDate||`${a.date.substring(4,6)}/${a.date.substring(6,8)}`,")"]},l))}),E.jsx("div",{className:"text-xs text-gray-400 mt-1 text-center",children:s.displayDate||s.date})]}),E.jsxs("div",{className:"flex items-baseline gap-1",children:[E.jsx("span",{className:"text-7xl font-bold text-[#756256]",children:s.daysLeft}),E.jsx("span",{className:"text-lg text-[#756256]",children:""})]})]})]})]})},tj=({wishes:n,onAddWish:e,onDeleteWish:t,currentUser:r,currentAvatar:s})=>{const[a,l]=ye.useState(!1),[d,f]=ye.useState(""),[p,g]=ye.useState(null),[v,T]=ye.useState(null),[C,x]=ye.useState(null),O=ye.useRef(null),[L,ne]=ye.useState(1),oe=5,Z=Math.ceil(n.length/oe),re=n.slice((L-1)*oe,L*oe),de=R=>{const b=R.target.files[0];if(b){const A=new FileReader;A.onloadend=async()=>{const N=await Av(A.result,400,400,.5);g(N)},A.readAsDataURL(b)}},le=()=>{!d.trim()&&!p||(e(d,p),f(""),g(null),l(!1),ne(1))};return E.jsxs("div",{className:"mb-8 px-4",children:[E.jsxs("div",{className:"flex items-center justify-between mb-3",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"bg-yellow-400 text-white p-1 rounded-full",children:E.jsx(xP,{size:16,fill:"currentColor"})}),E.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:ke.brownWindmill},children:""})]}),Z>1&&E.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[E.jsx("button",{onClick:()=>ne(R=>Math.max(1,R-1)),disabled:L===1,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:E.jsx(ky,{size:18})}),E.jsxs("span",{className:"text-gray-500 font-bold px-1",children:[L," / ",Z]}),E.jsx("button",{onClick:()=>ne(R=>Math.min(Z,R+1)),disabled:L===Z,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:E.jsx(R0,{size:18})})]})]}),E.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 space-y-3",style:{borderColor:ke.whiteBucks},children:[re.map(R=>{const b=Ho.find(D=>D.id===R.avatarId)||Ho[0],A=R.uid===r?.uid,N=C===R.id;return E.jsxs("div",{className:"flex gap-3 border-b last:border-0 pb-3 last:pb-0",style:{borderColor:ke.bgLight},children:[E.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden cursor-pointer transition-all duration-300 ${N?"bg-red-500 scale-90":"bg-gray-100"}`,onClick:()=>{A&&(N?(t(R.id),x(null)):x(R.id))},children:N?E.jsx(ts,{size:20,className:"text-white animate-bounce-short"}):E.jsx("img",{src:b.src,alt:"avatar",className:"w-full h-full object-cover"})}),E.jsxs("div",{className:"flex-1",children:[E.jsxs("div",{className:"flex justify-between items-center mb-1",children:[E.jsx("span",{className:"text-sm font-bold text-[#756256]",children:R.user}),E.jsx("span",{className:"text-xs font-normal text-gray-400",children:Tv(R.timestamp)})]}),E.jsx("p",{className:"text-sm text-[#9E9081]",children:R.content}),R.image&&E.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-gray-100 h-24 inline-block bg-gray-50",children:E.jsx("img",{src:R.image,alt:"wish thumbnail",onClick:()=>T(R.image),className:"h-full w-auto object-contain cursor-zoom-in hover:opacity-90 transition-opacity"})})]})]},R.id)}),E.jsxs("button",{onClick:()=>l(!0),className:"w-full py-2 mt-2 text-xs font-bold text-[#9E9081] border border-dashed hover:bg-[#F9F7F5] rounded-lg transition-colors flex items-center justify-center gap-1",style:{borderColor:ke.fossilGray},children:[E.jsx(gP,{size:14})," "]})]}),v&&E.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 animate-fade-in",onClick:()=>T(null),children:[E.jsx("button",{className:"absolute top-6 right-6 text-white hover:text-gray-300 transition-colors z-10 p-2",onClick:R=>{R.stopPropagation(),T(null)},children:E.jsx(ts,{size:32})}),E.jsx("img",{src:v,alt:"full preview",className:"max-w-full max-h-full object-contain rounded animate-scale-up",onClick:R=>R.stopPropagation()})]}),a&&E.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:E.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl overflow-hidden shadow-2xl animate-scale-up flex flex-col max-h-[90vh]",children:[E.jsxs("div",{className:"flex justify-between items-center p-3 border-b",style:{borderColor:ke.whiteBucks},children:[E.jsx("button",{onClick:()=>l(!1),className:"p-1",children:E.jsx(ts,{size:24,className:"text-gray-600"})}),E.jsx("span",{className:"font-bold text-[#756256] text-lg",children:""}),E.jsx("button",{onClick:le,className:"text-blue-500 font-bold text-sm px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50 disabled:hover:bg-transparent",disabled:!d.trim()&&!p,children:""})]}),E.jsxs("div",{className:"p-4 flex flex-col flex-1 overflow-y-auto",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[E.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden border border-gray-100",children:E.jsx("img",{src:s.src,alt:"avatar",className:"w-full h-full object-cover"})}),E.jsx("span",{className:"font-bold text-[#5D4037]",children:r.nickname||r.email})]}),E.jsx("textarea",{className:"w-full resize-none outline-none text-[#5D4037] placeholder-gray-400 text-lg leading-relaxed min-h-[100px]",placeholder:"...",value:d,onChange:R=>f(R.target.value),autoFocus:!0}),p&&E.jsxs("div",{className:"relative mt-2 rounded-lg overflow-hidden border border-gray-100 group",children:[E.jsx("img",{src:p,alt:"preview",className:"w-full h-auto"}),E.jsx("button",{onClick:()=>g(null),className:"absolute top-2 right-2 p-1 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors",children:E.jsx(ts,{size:16})})]})]}),E.jsxs("div",{className:"p-3 border-t bg-gray-50 flex gap-4 text-gray-400",children:[E.jsx("input",{type:"file",ref:O,className:"hidden",accept:"image/*",onChange:de}),E.jsx("button",{onClick:()=>O.current.click(),className:"p-1 hover:text-[#756256] transition-colors",children:E.jsx(b0,{size:20})})]})]})})]})},nj=({onLogin:n})=>{const[e,t]=ye.useState(!1),[r,s]=ye.useState(!1),[a,l]=ye.useState(""),[d,f]=ye.useState(""),[p,g]=ye.useState(""),[v,T]=ye.useState(""),C=async x=>{if(x.preventDefault(),s(!0),e){if(!a.endsWith("@shsh.tw")){alert(" @shsh.tw "),s(!1);return}if(!p||!v){alert(""),s(!1);return}}try{if(e){await vl.signUp(a,d);try{const O=(p.trim()[0]||"")+"";await vl.completeProfile({realName:p,studentId:v,nickname:O}),alert("")}catch(O){console.error("Profile completion failed",O),alert("")}alert(""),t(!1)}else await vl.login(a,d)}catch(O){alert((e?": ":": ")+O.message)}finally{s(!1)}};return E.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",style:{...Mp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:E.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center border",style:{borderColor:ke.whiteBucks},children:[E.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:ke.brownWindmill},children:e?"":""}),E.jsx("p",{className:"text-sm mb-6",style:{color:ke.brushwood},children:e?"":""}),E.jsxs("form",{onSubmit:C,className:"space-y-3 mb-4",children:[e&&E.jsxs(E.Fragment,{children:[E.jsx("input",{type:"text",value:p,onChange:x=>g(x.target.value),placeholder:" (+)",className:"w-full p-3 border rounded-xl bg-gray-50",required:!0}),E.jsx("input",{type:"text",value:v,onChange:x=>T(x.target.value),placeholder:"",className:"w-full p-3 border rounded-xl bg-gray-50",required:!0})]}),E.jsx("input",{type:"email",value:a,onChange:x=>l(x.target.value),placeholder:"Email (@shsh.tw)",className:"w-full p-3 border rounded-xl",required:!0}),E.jsx("input",{type:"password",value:d,onChange:x=>f(x.target.value),placeholder:"Password (6)",className:"w-full p-3 border rounded-xl",required:!0}),E.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 rounded-xl border-2 font-bold mb-3 hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:ke.whiteBucks,color:ke.brownWindmill},children:r?"...":e?"":""})]}),E.jsx("button",{onClick:()=>t(!e),className:"text-xs text-gray-400 hover:underline",children:e?"":" ()"})]})})},rj=({product:n,onBack:e,onContact:t,currentUser:r})=>{if(!n)return null;const s=r?.uid&&n.sellerId&&String(r.uid)===String(n.sellerId)||r?.studentId&&n.seller?.studentId&&r.studentId===n.seller.studentId,[a,l]=ye.useState(null);return ye.useEffect(()=>{n?.sellerId&&(async()=>{try{const{db:f}=await Si(async()=>{const{db:g}=await Promise.resolve().then(()=>xi);return{db:g}},void 0),p=await f.collection("users").doc(n.sellerId).get();p.exists&&l(p.data())}catch(f){console.error("Failed to fetch seller profile",f)}})()},[n?.sellerId]),ye.useEffect(()=>{window.scrollTo(0,0)},[]),E.jsxs("div",{className:"min-h-screen pb-24 bg-white",style:Mp,children:[E.jsxs("nav",{className:"fixed top-0 w-full z-50 flex justify-between items-center px-4 py-3 bg-white/80 backdrop-blur-md border-b",style:{borderColor:ke.whiteBucks},children:[E.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200",children:E.jsx(ky,{size:20,color:ke.brownWindmill})}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",children:E.jsx(SP,{size:20,color:ke.brownWindmill})}),E.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",children:E.jsx(oP,{size:20,color:ke.brownWindmill})})]})]}),E.jsxs("div",{className:"pt-16 pb-6 md:pt-20 md:pb-12 md:px-8 max-w-6xl mx-auto md:flex md:gap-10 md:items-start",children:[E.jsx("div",{className:"aspect-[4/3] bg-gray-100 relative md:w-1/2 md:aspect-square md:rounded-2xl md:overflow-hidden md:shadow-sm md:sticky md:top-24",children:E.jsx("img",{src:n.cover||n.imageBase64||"https://dummyimage.com/600x400/eee/aaa",alt:n.title,className:"w-full h-full object-contain bg-[#F9F7F5]"})}),E.jsxs("div",{className:"px-5 mt-6 md:w-1/2 md:px-0 md:mt-0",children:[E.jsxs("div",{className:"flex gap-2 mb-2",children:[E.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.grade}),E.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.subject})]}),E.jsx("h1",{className:"text-2xl md:text-3xl font-bold mt-4 mb-2 leading-tight",style:{color:ke.brownWindmill},children:n.title}),E.jsx("div",{className:"flex items-end gap-3 mb-6 pb-6 border-b",style:{borderColor:ke.whiteBucks},children:E.jsx(Sv,{type:n.type,price:n.price,originalPrice:n.originalPrice,large:!0})}),E.jsxs("div",{className:"space-y-6",children:[E.jsxs("div",{children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("h3",{className:"text-sm font-bold text-[#9E9081]",children:""}),E.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-2",children:[E.jsxs("span",{children:[n.views||0," "]}),E.jsx("span",{children:""}),E.jsxs("span",{className:"whitespace-nowrap",children:["",(()=>{const d=n.timestamp?.toDate?n.timestamp.toDate():new Date(n.timestamp||0),f=d.getFullYear(),p=String(d.getMonth()+1).padStart(2,"0"),g=String(d.getDate()).padStart(2,"0"),v=String(d.getHours()).padStart(2,"0"),T=String(d.getMinutes()).padStart(2,"0");return`${f}-${p}-${g} ${v}:${T}`})()]})]})]}),E.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg inline-block border border-gray-100",children:n.conditionLevel})]}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),E.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:n.description||""})]}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),E.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-[#F9F7F5] border border-stone-100",children:[E.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-white shadow-sm",children:E.jsx(VP,{size:24,className:"text-gray-500"})}),E.jsxs("div",{children:[E.jsx("div",{className:"font-bold text-[#756256] text-lg",children:a?.nickname||n.seller?.nickname||n.seller?.name}),E.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[E.jsx(RP,{size:12,fill:"#fbbf24",className:"text-yellow-400"}),E.jsx("span",{className:"font-bold text-gray-700",children:n.seller?.score||5})]})]})]})]}),!s&&E.jsx("div",{className:"hidden md:block pt-4",children:E.jsxs("button",{onClick:t,className:"w-full py-4 bg-[#756256] text-white rounded-xl font-bold shadow-lg hover:bg-[#5D4E44] transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2 text-lg",children:[E.jsx(yf,{size:20}),"  / "]})})]})]})]}),!s&&E.jsx("div",{className:"fixed bottom-0 left-0 w-full p-4 bg-white border-t safe-area-bottom flex gap-3 md:hidden z-40",style:{borderColor:ke.whiteBucks},children:E.jsxs("button",{onClick:t,className:"flex-1 py-3 bg-[#756256] text-white rounded-xl font-bold shadow-lg hover:bg-[#5D4E44] transition-colors flex items-center justify-center gap-2",children:[E.jsx(yf,{size:18})," "]})})]})},sj=({onNavigate:n,user:e,currentAvatarId:t,coins:r,wishes:s,onAddWish:a,onDeleteWish:l,books:d,isLoading:f,examCountdown:p,onToggleNotifications:g,hasUnreadNotifications:v})=>{const[T,C]=ye.useState(""),[x,O]=ye.useState("all"),[L,ne]=ye.useState("all"),[oe,Z]=ye.useState("all"),[re,de]=ye.useState("all"),[le,R]=ye.useState(1),b=20,A=()=>{ne("all"),Z("all"),de("all"),C(""),O("all"),R(1),window.scrollTo({top:0,behavior:"smooth"})};ye.useEffect(()=>{R(1)},[T,x]);const N=d.filter(ce=>{const Ve=T.toLowerCase(),se=!Ve.trim()||ce.title.toLowerCase().includes(Ve)||ce.author&&ce.author.toLowerCase().includes(Ve);let _e=!0;if(x!=="all")if(x==="extra")_e=ce.subject===""||ce.publisher==="";else if(x==="sci")_e=["","","","",""].includes(ce.subject);else if(x==="soc")_e=["","","",""].includes(ce.subject);else{const fe=S0.find(F=>F.id===x)?.name;_e=ce.subject===fe}return se&&_e}).sort((ce,Ve)=>{const se=ce.timestamp?.toDate?ce.timestamp.toDate():new Date(ce.timestamp||0);return(Ve.timestamp?.toDate?Ve.timestamp.toDate():new Date(Ve.timestamp||0))-se}),D=Math.ceil(N.length/b),j=N.slice((le-1)*b,le*b),k=Ho.find(ce=>ce.id===t)||Ho[0],Be=ye.useRef(null),rt=()=>{if(Be.current){const Ve=Be.current.getBoundingClientRect().top+window.pageYOffset+-80;window.scrollTo({top:Ve,behavior:"smooth"})}};return E.jsxs("div",{className:"min-h-screen pb-20",style:{...Mp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:[E.jsx("div",{className:"pt-6 pb-12 px-4 rounded-b-[2rem] shadow-lg",style:{background:`linear-gradient(135deg, ${ke.chocolateBubble}, ${ke.brownWindmill})`,color:ke.bgLight},children:E.jsxs("div",{className:"max-w-6xl mx-auto",children:[E.jsxs("div",{className:"flex justify-between items-center mb-6",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("div",{className:"w-8 h-8 backdrop-blur rounded-sm flex items-center justify-center font-bold font-serif",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:""}),E.jsx("span",{className:"text-xl font-bold tracking-widest",children:""})]}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("button",{onClick:A,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:E.jsx(WE,{size:20})}),E.jsxs("button",{onClick:g,className:"relative p-2 hover:bg-white/10 rounded-full transition-colors",children:[E.jsx(Og,{size:20}),v&&E.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full border border-white"})]}),E.jsxs("button",{onClick:()=>n("profile"),className:"flex items-center gap-2 hover:bg-white/20 pl-1 pr-3 py-1 rounded-full transition-all border border-white/20",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:[E.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center overflow-hidden bg-white/20",children:E.jsx("img",{src:k.src,alt:"avatar",className:"w-full h-full object-cover"})}),E.jsx("span",{className:"hidden sm:inline text-sm font-medium tracking-wide",children:e.nickname||e.email})]})]})]}),E.jsxs("div",{className:"max-w-3xl mx-auto mt-2",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4 tracking-widest text-center",children:""}),E.jsx("div",{className:"bg-[#FDFBF7] rounded-xl shadow-xl overflow-hidden p-2",children:E.jsxs("div",{className:"flex items-center border-b px-2",style:{borderColor:ke.whiteBucks},children:[E.jsx(wP,{className:"text-[#9E9081]",size:20}),E.jsx("input",{type:"text",value:T,onChange:ce=>C(ce.target.value),placeholder:"...",className:"w-full py-3 px-4 bg-transparent text-[#756256] placeholder-[#C9C3B6] outline-none"}),T&&E.jsx("button",{onClick:()=>C(""),className:"text-[#9E9081]",children:E.jsx(ts,{size:16})})]})})]})]})}),E.jsxs("div",{className:"max-w-6xl mx-auto px-4 -mt-6",children:[E.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 no-scrollbar mb-4",children:S0.map(ce=>E.jsx("button",{onClick:()=>O(ce.id),className:`whitespace-nowrap px-5 py-2 rounded-full text-sm tracking-wide shadow-sm transition-all border ${x===ce.id?"bg-[#756256] text-white border-[#756256]":"bg-[#F9F7F5] text-[#756256] border-[#E8E3DF]"}`,children:ce.name},ce.id))}),!T&&x==="all"&&E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[E.jsx("div",{className:"flex-1 min-w-0",children:E.jsx(Z5,{items:d,onNavigate:n,currentUser:e})}),E.jsx("div",{className:"w-full md:w-[320px] flex-shrink-0",children:E.jsx(ej,{examCountdown:p})})]}),E.jsx(tj,{wishes:s,onAddWish:a,onDeleteWish:l,currentUser:e,currentAvatar:k})]}),E.jsxs("div",{className:"pb-8",children:[E.jsx("div",{ref:Be,className:"flex justify-between items-end mb-4 px-1 border-b pb-2",style:{borderColor:ke.whiteBucks},children:E.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 tracking-wide",style:{color:ke.brownWindmill},children:[E.jsx(BR,{size:20,style:{color:ke.chocolateBubble}}),T||x!=="all"?"":""]})}),f?E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:Array.from({length:10}).map((ce,Ve)=>E.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-sm border border-gray-100 flex flex-col h-full",children:[E.jsx("div",{className:"aspect-square bg-gray-100 animate-pulse"}),E.jsxs("div",{className:"p-3 space-y-2 flex-1",children:[E.jsx("div",{className:"h-4 bg-gray-100 rounded w-3/4 animate-pulse"}),E.jsx("div",{className:"h-3 bg-gray-100 rounded w-1/2 animate-pulse"}),E.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-50 flex justify-between",children:[E.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/3 animate-pulse"}),E.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4 animate-pulse"})]})]})]},Ve))}):j.length>0?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:j.map(ce=>E.jsxs("div",{onClick:()=>n("product",ce),className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all cursor-pointer border flex flex-col h-full group",style:{borderColor:ke.whiteBucks},children:[E.jsxs("div",{className:"relative aspect-square bg-[#F9F7F5] overflow-hidden",children:[E.jsx("img",{src:ce.cover||ce.imageBase64||"https://dummyimage.com/400x400/eee/aaa",alt:ce.title,className:"w-full h-full object-contain group-hover:scale-105 transition-transform duration-500"}),E.jsx("div",{className:"absolute top-0 right-0 px-3 py-1.5 text-white text-xs font-bold shadow-sm rounded-bl-lg z-10",style:{backgroundColor:ce.type==="gift"||ce.price===0?ke.chocolateBubble:ke.brownWindmill},children:ce.type==="gift"||ce.price===0?"":""})]}),E.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[E.jsx("h3",{className:"font-bold text-[#756256] text-base leading-tight mb-2 line-clamp-2 min-h-[2.5em]",children:ce.title}),E.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[E.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ce.subject}),ce.grade&&ce.grade!==""&&E.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ce.grade})]}),E.jsxs("div",{className:"mt-auto flex items-end justify-between border-t pt-2 border-[#E8E3DF]",children:[E.jsxs("div",{className:"flex flex-col",children:[E.jsxs("span",{className:"text-[10px] text-gray-400 mb-1",children:["",ce.seller?.nickname||""]}),E.jsx(Sv,{type:ce.type,price:ce.price})]}),E.jsxs("div",{className:"text-[10px] text-gray-400 flex items-center gap-1 scale-90",children:[E.jsx(tP,{size:12,className:"text-gray-400"}),E.jsx("span",{className:"font-bold",children:ce.views||0})]})]})]})]},ce.id))}),D>1&&E.jsxs("div",{className:"mt-8 flex justify-center items-center gap-2",children:[E.jsx("button",{onClick:()=>{R(ce=>Math.max(1,ce-1)),rt()},disabled:le===1,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:E.jsx(ky,{size:20})}),E.jsx("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar max-w-[200px] sm:max-w-none px-2",children:Array.from({length:D}).map((ce,Ve)=>E.jsx("button",{onClick:()=>{R(Ve+1),rt()},className:`w-10 h-10 rounded-lg font-bold flex-shrink-0 transition-all shadow-sm ${le===Ve+1?"bg-[#756256] text-white":"bg-white text-[#756256] border border-gray-100 hover:bg-gray-50"}`,children:Ve+1},Ve))}),E.jsx("button",{onClick:()=>{R(ce=>Math.min(D,ce+1)),rt()},disabled:le===D,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:E.jsx(R0,{size:20})})]})]}):E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 w-full animate-fade-in text-center col-span-full",children:[E.jsx("p",{className:"text-gray-500 text-lg font-medium mb-6",children:""}),E.jsxs("button",{onClick:A,className:"px-8 py-3 rounded-xl bg-[#756256] text-white font-bold hover:bg-[#5D4E44] transition-all transform hover:-translate-y-1 shadow-md flex items-center gap-2",children:[E.jsx(WE,{size:18})," "]})]})]})]})]})},ij=({onBack:n,onNavigate:e,user:t,onLogout:r,coins:s,myAvatars:a,currentAvatarId:l,onPurchase:d,onEquip:f})=>{const[p,g]=ye.useState("shelf"),v=[],[T,C]=ye.useState(v),[x,O]=ye.useState({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null}),[L,ne]=ye.useState(!1),[oe,Z]=ye.useState(null);ye.useEffect(()=>{if(t?.uid){const A=Kt.getMyBooks(t.uid,N=>{C(N)});return()=>A()}},[t?.uid]);const re=A=>{const N=A.target.files[0];if(N){const D=new FileReader;D.onloadend=async()=>{const j=await Av(D.result,600,600,.5);O({...x,coverImagePreview:j})},D.readAsDataURL(N)}},de=async()=>{if(!x.coverImagePreview){alert("");return}if(!x.title){alert("");return}if(x.transactionType==="sell"&&!x.price){alert("");return}if(x.bookType==="textbook"){if(!x.gradeLevel){alert("");return}if(!x.subject){alert("");return}}ne(!0);try{const A={title:x.title,author:"",publisher:x.bookType==="textbook"?"":"",subject:x.bookType==="textbook"?x.subject:"",grade:x.bookType==="textbook"?x.gradeLevel:"",price:x.transactionType==="gift"?0:Number(x.price),type:x.transactionType==="gift"?"gift":"sell",conditionLevel:x.conditionLevel,description:x.description,sellerId:t.uid,seller:{nickname:t.nickname||t.email,studentId:t.studentId||"",score:t.creditScore||5},cover:x.coverImagePreview,timestamp:new Date};await Kt.addBook(A),alert(""),g("shelf"),O({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null})}catch(A){console.error(":",A),alert(": "+A.message)}finally{ne(!1)}},le=(A,N)=>{N.stopPropagation(),Z(A)},R=async()=>{if(!oe)return;const A=oe;try{await Kt.deleteBook(A),Z(null)}catch(N){console.error("Deletion failed:",N),alert(": "+N.message)}},b=Ho.find(A=>A.id===l)||Ho[0];return E.jsxs("div",{className:"min-h-screen pb-20",style:{...Mp,backgroundColor:ke.bgLight,color:ke.brownWindmill},children:[E.jsx("nav",{className:"backdrop-blur-md shadow-sm border-b sticky top-0 z-50",style:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:ke.whiteBucks},children:E.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:E.jsx(x0,{size:20,className:"rotate-180 text-[#9E9081]"})}),E.jsx("div",{className:"font-bold text-lg tracking-wide",children:""})]}),E.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-red-50 text-red-700 border border-red-200",children:[E.jsx(dP,{size:14})," "]})]})}),E.jsxs("main",{className:"max-w-2xl mx-auto px-4 py-8 space-y-8",children:[E.jsxs("div",{className:"flex flex-col items-center",children:[E.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>g("store"),children:[E.jsx("div",{className:"w-24 h-24 rounded-full border-4 shadow-md overflow-hidden bg-white",style:{borderColor:ke.bgLight},children:E.jsx("img",{src:b.src,className:"w-full h-full object-cover",alt:"User"})}),E.jsx("div",{className:"absolute bottom-0 right-0 text-white p-1.5 rounded-full border-2 border-white shadow-sm flex items-center justify-center",style:{backgroundColor:ke.chocolateBubble,width:28,height:28},children:E.jsx(pP,{size:14})})]}),E.jsx("h2",{className:"mt-4 text-xl font-bold tracking-widest",style:{color:ke.brownWindmill},children:t.nickname||t.email}),E.jsx("p",{className:"text-sm text-[#9E9081] mb-2",children:t.email}),E.jsxs("div",{className:"flex items-center gap-1 bg-yellow-100 px-3 py-1 rounded-full text-xs font-bold text-yellow-700",children:[E.jsx(Lg,{size:14,fill:"currentColor"})," ",s," "]})]}),E.jsxs("div",{className:"flex border rounded-lg overflow-hidden bg-white p-1",style:{borderColor:ke.whiteBucks},children:[E.jsx("button",{onClick:()=>g("shelf"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="shelf"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""}),E.jsx("button",{onClick:()=>g("upload"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="upload"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""}),E.jsx("button",{onClick:()=>g("store"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="store"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""})]}),p==="upload"?E.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6 space-y-4 animate-fade-in",style:{borderColor:ke.whiteBucks},children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),E.jsx("input",{type:"file",id:"cover-upload",accept:"image/*",onChange:re,className:"hidden"}),E.jsx("label",{htmlFor:"cover-upload",className:"block text-center p-8 border-2 border-dashed rounded-lg bg-[#F9F7F5] cursor-pointer hover:bg-[#E6DBC6] transition-colors",style:{borderColor:ke.fossilGray},children:x.coverImagePreview?E.jsx("img",{src:x.coverImagePreview,alt:"",className:"max-h-48 mx-auto rounded"}):E.jsxs(E.Fragment,{children:[E.jsx(uP,{className:"mx-auto text-[#9E9081] mb-2",size:32}),E.jsx("span",{className:"text-sm text-[#756256]",children:""})]})})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),E.jsx("input",{type:"text",value:x.title,onChange:A=>O({...x,title:A.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"",required:!0})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{type:"button",onClick:()=>O({...x,bookType:"textbook"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${x.bookType==="textbook"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),E.jsx("button",{type:"button",onClick:()=>O({...x,bookType:"extracurricular"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${x.bookType==="extracurricular"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),x.bookType==="textbook"&&E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),E.jsxs("select",{value:x.gradeLevel,onChange:A=>O({...x,gradeLevel:A.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),E.jsxs("select",{value:x.subject,onChange:A=>O({...x,subject:A.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""}),E.jsx("option",{value:"",children:""})]})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{type:"button",onClick:()=>O({...x,transactionType:"sell"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${x.transactionType==="sell"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),E.jsx("button",{type:"button",onClick:()=>O({...x,transactionType:"gift",price:"0"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${x.transactionType==="gift"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{children:[E.jsxs("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:[" (NT$) ",x.transactionType==="sell"&&"*"]}),E.jsx("input",{type:"number",value:x.price,onChange:A=>{const N=A.target.value;Number(N)<0||(Number(N)===0&&N!==""?O({...x,price:0,transactionType:"gift"}):O({...x,price:N}))},className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"100",disabled:x.transactionType==="gift",required:x.transactionType==="sell"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),E.jsx("select",{value:x.conditionLevel,onChange:A=>O({...x,conditionLevel:A.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:Y5.map(A=>E.jsx("option",{value:A,children:A},A))})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" ()"}),E.jsx("textarea",{value:x.description,onChange:A=>O({...x,description:A.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm h-24 resize-none",placeholder:"..."})]}),E.jsx("button",{onClick:de,disabled:L,className:"w-full py-3 bg-[#756256] text-white rounded-xl font-bold shadow-md hover:bg-[#5D4E44] transition-colors disabled:opacity-50",children:L?"...":""})]}):p==="store"?E.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 animate-fade-in",style:{borderColor:ke.whiteBucks},children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2",children:[E.jsx(kP,{size:20})," "]}),E.jsx("span",{className:"text-xs text-[#9E9081]",children:""})]}),E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:Ho.map(A=>{const N=a.includes(A.id),D=l===A.id,j=s>=A.price;return E.jsxs("div",{className:`border rounded-lg p-3 flex flex-col items-center relative transition-all ${D?"ring-2 ring-[#A58976] bg-[#F9F7F5]":"hover:border-[#A58976]"}`,style:{borderColor:ke.whiteBucks},children:[D&&E.jsx("div",{className:"absolute top-2 right-2 text-green-500",children:E.jsx(JR,{size:16,fill:"currentColor",className:"text-white"})}),E.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden mb-2 bg-gray-100",children:E.jsx("img",{src:A.src,alt:A.name,className:"w-full h-full object-cover"})}),E.jsx("div",{className:"font-bold text-sm text-[#5D4037] mb-1",children:A.name}),N?E.jsx("button",{onClick:()=>f(A.id),disabled:D,className:`w-full py-1 text-xs rounded font-bold ${D?"text-gray-400 cursor-default":"bg-[#756256] text-white hover:bg-[#5D4E44]"}`,children:D?"":""}):E.jsxs("button",{onClick:()=>d(A.id,A.price),disabled:!j,className:`w-full py-1 text-xs rounded font-bold flex items-center justify-center gap-1 ${j?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[E.jsx(Lg,{size:10})," ",A.price]})]},A.id)})})]}):E.jsx("div",{className:"space-y-4 animate-fade-in",children:T.length===0?E.jsx("div",{className:"text-center py-10 text-gray-400",children:""}):T.map(A=>E.jsxs("div",{onClick:()=>e("product",A),className:"bg-white rounded-xl shadow-sm border p-3 flex gap-4 items-center cursor-pointer hover:shadow-md transition-shadow",style:{borderColor:ke.whiteBucks},children:[E.jsx("div",{className:"w-16 h-20 bg-gray-200 rounded flex-shrink-0 overflow-hidden",children:E.jsx("img",{src:A.cover,className:"w-full h-full object-cover",alt:A.title})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("h3",{className:"font-bold text-[#756256] truncate",children:A.title}),E.jsx("div",{className:"text-sm text-[#9E9081] font-medium",children:A.price===0||A.type==="gift"?"":`NT$ ${A.price}`}),E.jsxs("div",{className:"text-xs text-gray-400 mt-1 flex items-center gap-2",children:[E.jsxs("span",{children:[A.views||0," "]}),"  ",E.jsx("span",{children:A.date})]})]}),E.jsx("button",{onClick:N=>le(A.id,N),className:"p-2 text-red-400 hover:bg-red-50 rounded-full",children:E.jsx(NP,{size:18})})]},A.id))})]}),oe&&E.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>Z(null),children:E.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center shadow-xl transform transition-all scale-100",onClick:A=>A.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-4",children:""}),E.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:""}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>Z(null),className:"flex-1 py-2.5 rounded-xl border border-gray-200 font-bold text-gray-500 hover:bg-gray-50 transition-colors",type:"button",children:""}),E.jsx("button",{onClick:R,className:"flex-1 py-2.5 rounded-xl bg-red-500 text-white font-bold hover:bg-red-600 transition-colors shadow-md",type:"button",children:""})]})]})})]})},oj=({transaction:n,currentUser:e,onClose:t})=>{const{id:r,sellerId:s,bookTitle:a,price:l}=n,[d,f]=ye.useState([]),[p,g]=ye.useState(""),[v,T]=ye.useState(null),C=ye.useRef(null),x=ye.useRef(null),O=ye.useRef(null);ye.useEffect(()=>{if(!r)return;const re=T0.subscribeToMessages(r,de=>{f(de),Kt.markAsRead(r,e.uid),setTimeout(()=>C.current?.scrollIntoView({behavior:"smooth"}),100)});return Kt.markAsRead(r,e.uid),()=>re&&re()},[r,e.uid]),ye.useEffect(()=>{x.current&&(x.current.style.height="auto",x.current.style.height=`${Math.min(x.current.scrollHeight,120)}px`)},[p]);const L=re=>{const de=re.target.files[0];if(de){const le=new FileReader;le.onloadend=async()=>{const R=await Av(le.result,800,800,.7);T(R)},le.readAsDataURL(de)}},ne=async()=>{if(!(!p.trim()&&!v))try{await T0.sendMessage(r,e.uid,e.name||e.nickname||"",p,v),g(""),T(null)}catch(re){console.error(re),alert(": "+re.message)}},oe=()=>{const re=`
      LINE
      ----------------
      ****
      ****
      ****${a}
      ****NT$ ${l}`;g(re)},Z=(re,de)=>E.jsxs("div",{className:"flex flex-col gap-2",children:[de&&E.jsx("div",{className:"rounded-lg overflow-hidden bg-gray-100 mb-1",children:E.jsx("img",{src:de,alt:"chat",className:"max-w-full h-auto object-contain cursor-pointer",onClick:()=>window.open(de,"_blank")})}),re&&re.split(/(\*\*.*?\*\*)/g).map((le,R)=>le.startsWith("**")&&le.endsWith("**")?E.jsx("strong",{children:le.slice(2,-2)},le+R):E.jsx("span",{className:"whitespace-pre-wrap",children:le},le+R))]});return E.jsxs("div",{className:"fixed bottom-4 right-4 w-80 h-[450px] bg-white rounded-t-xl rounded-bl-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[E.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center shadow-md",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(yf,{size:18}),E.jsx("span",{className:"font-bold text-sm truncate max-w-[150px]",children:a||""})]}),E.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1 transition-colors",children:E.jsx(ts,{size:16})})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3 bg-[#F9F7F5]",children:[d.length===0&&E.jsxs("div",{className:"text-center text-xs text-gray-400 mt-8 space-y-2",children:[E.jsx("div",{children:""}),E.jsxs("div",{className:"opacity-80",children:["",E.jsx("br",{}),""]})]}),d.map(re=>{const de=re.senderId===e.uid,R=(b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}):"")(re.timestamp);return E.jsxs("div",{className:`flex items-end gap-1.5 ${de?"justify-end":"justify-start"}`,children:[de&&E.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:R}),E.jsx("div",{className:`max-w-[85%] rounded-xl px-3 py-2 text-sm shadow-sm break-words ${de?"bg-[#756256] text-white rounded-tr-none":"bg-white text-gray-700 rounded-tl-none"}`,children:Z(re.content,re.image)}),!de&&E.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:R})]},re.id)}),E.jsx("div",{ref:C})]}),e.uid===s&&E.jsx("div",{className:"px-3 py-1.5 bg-[#F9F7F5] flex justify-start",children:E.jsx("button",{onClick:oe,className:"text-[10px] w-fit font-bold text-[#756256] border border-[#756256] rounded-md px-3 py-1 transform hover:translate-y-[-1px] transition-all bg-white flex items-center gap-1 shadow-sm active:translate-y-0",children:""})}),v&&E.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t flex items-center gap-2",children:[E.jsxs("div",{className:"relative w-12 h-12 rounded-md overflow-hidden border border-gray-200",children:[E.jsx("img",{src:v,alt:"preview",className:"w-full h-full object-cover"}),E.jsx("button",{onClick:()=>T(null),className:"absolute top-0 right-0 bg-black/50 text-white rounded-full p-0.5",children:E.jsx(ts,{size:10})})]}),E.jsx("span",{className:"text-[10px] text-gray-500",children:"..."})]}),E.jsxs("div",{className:"p-3 bg-white border-t flex items-end gap-2",children:[E.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:O,onChange:L}),E.jsx("button",{onClick:()=>O.current?.click(),className:"p-2 text-gray-400 hover:text-[#756256] transition-colors rounded-full hover:bg-gray-100 flex-shrink-0",children:E.jsx(b0,{size:20})}),E.jsx("textarea",{ref:x,rows:"1",value:p,onChange:re=>g(re.target.value),onKeyDown:re=>{re.key==="Enter"&&!re.shiftKey&&(re.preventDefault(),ne())},placeholder:"...",className:"w-full bg-[#F9F7F5] border-none rounded-2xl px-4 py-2 text-sm focus:ring-1 focus:ring-[#756256] outline-none resize-none transition-all scrollbar-hide py-2"}),E.jsx("button",{onClick:ne,disabled:!p.trim()&&!v,className:"p-2 bg-[#756256] text-white rounded-full hover:bg-[#5D4E44] transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md flex-shrink-0",children:E.jsx(IP,{size:18})})]})]})},aj=({currentUser:n,onSelectChat:e,onClose:t,books:r})=>{const[s,a]=ye.useState([]);ye.useEffect(()=>{if(!n)return;const d=new Map,f=v=>{v.forEach(T=>{d.set(T.id,{id:T.id,...T.data()})}),a(Array.from(d.values()).sort((T,C)=>{const x=T.timestamp?.toDate?T.timestamp.toDate():new Date(T.timestamp);return(C.timestamp?.toDate?C.timestamp.toDate():new Date(C.timestamp))-x}))},p=Kt.getUserTransactions(n.uid,f),g=Kt.getSellerTransactions(n.uid,f);return()=>{p(),g()}},[n]);const l=async(d,f)=>{if(d.stopPropagation(),window.confirm(""))try{await Kt.deleteTransaction(f),a(p=>p.filter(g=>g.id!==f))}catch(p){console.error("Delete chat failed",p)}};return E.jsxs("div",{className:"fixed bottom-24 right-4 w-80 max-h-96 bg-white rounded-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[E.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center",children:[E.jsx("span",{className:"font-bold",children:""}),E.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1",children:E.jsx(ts,{size:16})})]}),E.jsxs("div",{className:"overflow-y-auto p-2 space-y-2 bg-[#F9F7F5] flex-1",children:[s.length===0&&E.jsx("div",{className:"text-center text-gray-400 py-4 text-sm",children:""}),s.map(d=>{const f=r.some(p=>p.id===d.bookId);return E.jsxs("div",{onClick:f?()=>e(d):p=>l(p,d.id),className:`p-3 rounded-lg cursor-pointer transition-colors shadow-sm border border-gray-100 relative ${f?"bg-white hover:bg-gray-50":"bg-gray-100 grayscale hover:bg-gray-200"}`,children:[d.unreadBy?.includes(n.uid)&&E.jsx("div",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white shadow-sm z-10"}),E.jsx("div",{className:"font-bold text-[#756256] text-sm truncate pr-4",children:d.bookTitle}),E.jsx("div",{className:"text-xs text-gray-500 flex justify-between mt-1",children:f?E.jsxs(E.Fragment,{children:[E.jsx("span",{children:d.buyerId===n.uid?"":""}),E.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] ${d.status==="Completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:d.status==="Pending"?"":d.status})]}):E.jsx("span",{className:"text-gray-500 font-bold w-full text-center",children:"()"})})]},d.id)})]})]})},lj=({notifications:n,onClose:e,onMarkAsRead:t})=>E.jsxs("div",{className:"fixed top-16 right-4 sm:right-20 w-80 max-h-[400px] bg-white rounded-2xl shadow-2xl flex flex-col z-[60] animate-slide-up border border-stone-100 overflow-hidden",children:[E.jsxs("div",{className:"bg-white p-4 border-b flex justify-between items-center",children:[E.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2",children:[E.jsx(Og,{size:18,className:"text-[#A58976]"}),""]}),E.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:E.jsx(ts,{size:18})})]}),E.jsx("div",{className:"overflow-y-auto flex-1 bg-[#F9F7F5] p-2 space-y-2",children:n.length===0?E.jsxs("div",{className:"py-12 text-center text-gray-400 text-sm flex flex-col items-center gap-2",children:[E.jsx(Og,{size:32,className:"opacity-20"}),""]}):n.map(r=>E.jsxs("div",{onClick:()=>!r.isRead&&t(r.id),className:`p-3 rounded-xl transition-all cursor-pointer border relative ${r.isRead?"bg-white/50 border-transparent grayscale-[0.3]":"bg-white border-blue-50 shadow-sm font-medium"}`,children:[!r.isRead&&E.jsx("div",{className:"absolute top-3 left-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),E.jsx("div",{className:"text-xs text-[#756256] mb-1 leading-relaxed pl-2",children:r.content}),E.jsx("div",{className:"text-[10px] text-gray-400 pl-2",children:Tv(r.timestamp)})]},r.id))}),n.length>0&&E.jsx("div",{className:"p-3 bg-white border-t text-center",children:E.jsx("button",{className:"text-[10px] font-bold text-[#A58976] hover:underline",children:""})})]}),uj=()=>{const[n,e]=ye.useState("login"),[t,r]=ye.useState(null),[s,a]=ye.useState(null),[l,d]=ye.useState(null),[f,p]=ye.useState(!1),[g,v]=ye.useState(!1),[T,C]=ye.useState([]),x=T.some(pe=>!pe.isRead),[O,L]=ye.useState([]),ne=O.some(pe=>pe.unreadBy?.includes(t?.uid));ye.useEffect(()=>{if(!t?.uid)return;const pe=Le=>{const lt=Le.docs.map(Un=>({id:Un.id,...Un.data()}));L(Un=>{const $s=new Map(Un.map(xn=>[xn.id,xn]));return lt.forEach(xn=>$s.set(xn.id,xn)),Array.from($s.values())})},Pe=Kt.getUserTransactions(t.uid,pe),xe=Kt.getSellerTransactions(t.uid,pe);return()=>{Pe(),xe()}},[t?.uid]);const[oe,Z]=ye.useState([]),[re,de]=ye.useState(!0),[le,R]=ye.useState({exams:[]});ye.useEffect(()=>{(async()=>{try{const{functions:Pe}=await Si(async()=>{const{functions:lt}=await Promise.resolve().then(()=>xi);return{functions:lt}},void 0),Le=await Pe.httpsCallable("getExamCountdown")();Le.data&&Le.data.exams?R(Le.data):R({exams:[]})}catch(Pe){console.error("Failed to fetch countdown:",Pe),R({exams:[]})}})()},[]);const[b,A]=ye.useState(0),[N,D]=ye.useState(!1),[j,k]=ye.useState(X5),[Be,rt]=ye.useState(["default"]),[ce,Ve]=ye.useState("default");ye.useEffect(()=>{let pe=null;const Pe=vl.onAuthStateChanged(xe=>{xe?(r({uid:xe.uid,email:xe.email,...xe,nickname:xe.email.split("@")[0]}),e("home"),unsubProfile=vl.onProfileSnapshot(xe.uid,Le=>{if(Le.exists){const lt=Le.data();r(Un=>({...Un,...lt,uid:xe.uid})),A(lt.coins||0),rt(lt.myAvatars||["default"])}}),unsubBooks=Kt.onBooksSnapshot(Le=>{Z(Le),de(!1)},Le=>{console.error("Global books fetch failed:",Le),de(!1)}),unsubWishes=Kt.onWishesSnapshot(Le=>{k(Le)}),pe=Kt.subscribeToNotifications(xe.uid,Le=>{C(Le)})):(r(null),e("login"),C([]),unsubProfile&&unsubProfile(),unsubBooks&&unsubBooks(),unsubWishes&&unsubWishes(),pe&&pe())});return()=>{Pe(),unsubProfile&&unsubProfile(),unsubBooks&&unsubBooks(),unsubWishes&&unsubWishes(),pe&&pe()}},[]);const se=()=>E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>D(!1),children:E.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center relative shadow-xl transform transition-all scale-100",onClick:pe=>pe.stopPropagation(),children:[E.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2",children:E.jsx("div",{className:"bg-yellow-400 p-3 rounded-full shadow-lg border-4 border-white",children:E.jsx(P0,{size:32,className:"text-white"})})}),E.jsxs("div",{className:"mt-6",children:[E.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-2",children:""}),E.jsx("p",{className:"text-gray-500 mb-6",children:" 5 "}),E.jsxs("div",{className:"flex items-center justify-center gap-2 text-2xl font-bold text-yellow-600 mb-6 bg-yellow-50 py-3 rounded-xl border border-yellow-100",children:[E.jsx(Lg,{size:28,fill:"currentColor"})," +5"]}),E.jsx("button",{onClick:()=>D(!1),className:"w-full py-3 rounded-xl bg-[#A58976] text-white font-bold hover:bg-[#8D735F] transition-colors",children:""})]})]})}),_e=(pe,Pe)=>{pe==="product"&&(a(Pe),Pe&&Pe.id&&Kt.incrementBookView(Pe.id)),e(pe)},fe=async()=>{await vl.logout()},F=async(pe,Pe)=>{try{await Kt.addWish({content:pe,image:Pe,user:t.nickname||t.realName||t.email,avatarId:ce})}catch(xe){console.error("Failed to add wish:",xe),alert("")}},K=async pe=>{try{window.confirm("")&&await Kt.deleteWish(pe)}catch(Pe){console.error("Failed to delete wish:",Pe),alert("")}},Ne=async(pe,Pe)=>{if(b<Pe){alert("");return}if(window.confirm(` ${Pe} `))try{const{functions:xe}=await Si(async()=>{const{functions:lt}=await Promise.resolve().then(()=>xi);return{functions:lt}},void 0);await xe.httpsCallable("purchaseItem")({itemId:pe,price:Pe,type:"avatar"}),alert("")}catch(xe){console.error(xe),alert(": "+xe.message)}},Ce=pe=>{Ve(pe)};if(!t&&n!=="login")return null;const Ue=()=>{switch(n){case"login":return E.jsx(nj,{});case"home":return E.jsx(sj,{onNavigate:_e,user:t,coins:b,wishes:j,onAddWish:F,onDeleteWish:K,books:oe,isLoading:re,currentAvatarId:ce,unreadCount:0,examCountdown:le,onToggleNotifications:()=>v(!g),hasUnreadNotifications:x});case"product":return E.jsx(rj,{product:s,currentUser:t,onBack:()=>_e("home"),onContact:async()=>{try{await Kt.startTransaction(s,t,pe=>{d({id:pe,bookId:s.id,bookTitle:s.title,sellerId:s.sellerId,price:s.price})})}catch(pe){console.error(pe),alert("")}}});case"profile":return E.jsx(ij,{user:t,onBack:()=>_e("home"),onNavigate:_e,onLogout:fe,coins:b,myAvatars:Be,currentAvatarId:ce,onPurchase:Ne,onEquip:Ce});default:return E.jsx("div",{children:"404"})}};return E.jsxs(E.Fragment,{children:[Ue(),N&&E.jsx(se,{}),l&&E.jsx(oj,{transaction:l,currentUser:t,onClose:()=>d(null)}),g&&E.jsx(lj,{notifications:T,onClose:()=>v(!1),onMarkAsRead:async pe=>{await Kt.markNotificationAsRead(pe)}}),t&&n!=="login"&&!l&&E.jsxs(E.Fragment,{children:[E.jsxs("button",{onClick:()=>p(!f),className:"fixed bottom-6 right-6 w-14 h-14 bg-[#756256] text-white rounded-full shadow-lg flex items-center justify-center hover:bg-[#5D4E44] transition-all transform hover:scale-105 z-40 border-2 border-white",children:[f?E.jsx(ts,{size:24}):E.jsx(yf,{size:24}),!f&&ne&&E.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full border-2 border-white shadow-sm animate-pulse"})]}),f&&E.jsx(aj,{currentUser:t,books:oe,onSelectChat:pe=>{d(pe),p(!1)},onClose:()=>p(!1)})]})]})};kR.createRoot(document.getElementById("root")).render(E.jsx(ye.StrictMode,{children:E.jsx(uj,{})}));
