(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function kR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var cg={exports:{}},tu={},ug={exports:{}},Ue={};var OE;function CR(){if(OE)return Ue;OE=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),w=Symbol.iterator;function T(j){return j===null||typeof j!="object"?null:(j=w&&j[w]||j["@@iterator"],typeof j=="function"?j:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,L={};function V(j,K,Re){this.props=j,this.context=K,this.refs=L,this.updater=Re||N}V.prototype.isReactComponent={},V.prototype.setState=function(j,K){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,K,"setState")},V.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function se(){}se.prototype=V.prototype;function ie(j,K,Re){this.props=j,this.context=K,this.refs=L,this.updater=Re||N}var Q=ie.prototype=new se;Q.constructor=ie,A(Q,V.prototype),Q.isPureReactComponent=!0;var pe=Array.isArray,te=Object.prototype.hasOwnProperty,ae={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function S(j,K,Re){var ke,Me={},Fe=null,Je=null;if(K!=null)for(ke in K.ref!==void 0&&(Je=K.ref),K.key!==void 0&&(Fe=""+K.key),K)te.call(K,ke)&&!b.hasOwnProperty(ke)&&(Me[ke]=K[ke]);var We=arguments.length-2;if(We===1)Me.children=Re;else if(1<We){for(var rt=Array(We),rn=0;rn<We;rn++)rt[rn]=arguments[rn+2];Me.children=rt}if(j&&j.defaultProps)for(ke in We=j.defaultProps,We)Me[ke]===void 0&&(Me[ke]=We[ke]);return{$$typeof:n,type:j,key:Fe,ref:Je,props:Me,_owner:ae.current}}function k(j,K){return{$$typeof:n,type:j.type,key:K,ref:j.ref,props:j.props,_owner:j._owner}}function D(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function R(j){var K={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Re){return K[Re]})}var M=/\/+/g;function P(j,K){return typeof j=="object"&&j!==null&&j.key!=null?R(""+j.key):K.toString(36)}function Ce(j,K,Re,ke,Me){var Fe=typeof j;(Fe==="undefined"||Fe==="boolean")&&(j=null);var Je=!1;if(j===null)Je=!0;else switch(Fe){case"string":case"number":Je=!0;break;case"object":switch(j.$$typeof){case n:case e:Je=!0}}if(Je)return Je=j,Me=Me(Je),j=ke===""?"."+P(Je,0):ke,pe(Me)?(Re="",j!=null&&(Re=j.replace(M,"$&/")+"/"),Ce(Me,K,Re,"",function(rn){return rn})):Me!=null&&(D(Me)&&(Me=k(Me,Re+(!Me.key||Je&&Je.key===Me.key?"":(""+Me.key).replace(M,"$&/")+"/")+j)),K.push(Me)),1;if(Je=0,ke=ke===""?".":ke+":",pe(j))for(var We=0;We<j.length;We++){Fe=j[We];var rt=ke+P(Fe,We);Je+=Ce(Fe,K,Re,rt,Me)}else if(rt=T(j),typeof rt=="function")for(j=rt.call(j),We=0;!(Fe=j.next()).done;)Fe=Fe.value,rt=ke+P(Fe,We++),Je+=Ce(Fe,K,Re,rt,Me);else if(Fe==="object")throw K=String(j),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Je}function tt(j,K,Re){if(j==null)return j;var ke=[],Me=0;return Ce(j,ke,"","",function(Fe){return K.call(Re,Fe,Me++)}),ke}function $e(j){if(j._status===-1){var K=j._result;K=K(),K.then(function(Re){(j._status===0||j._status===-1)&&(j._status=1,j._result=Re)},function(Re){(j._status===0||j._status===-1)&&(j._status=2,j._result=Re)}),j._status===-1&&(j._status=0,j._result=K)}if(j._status===1)return j._result.default;throw j._result}var ue={current:null},Y={transition:null},ve={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Y,ReactCurrentOwner:ae};function de(){throw Error("act(...) is not supported in production builds of React.")}return Ue.Children={map:tt,forEach:function(j,K,Re){tt(j,function(){K.apply(this,arguments)},Re)},count:function(j){var K=0;return tt(j,function(){K++}),K},toArray:function(j){return tt(j,function(K){return K})||[]},only:function(j){if(!D(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Ue.Component=V,Ue.Fragment=t,Ue.Profiler=s,Ue.PureComponent=ie,Ue.StrictMode=r,Ue.Suspense=f,Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ve,Ue.act=de,Ue.cloneElement=function(j,K,Re){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var ke=A({},j.props),Me=j.key,Fe=j.ref,Je=j._owner;if(K!=null){if(K.ref!==void 0&&(Fe=K.ref,Je=ae.current),K.key!==void 0&&(Me=""+K.key),j.type&&j.type.defaultProps)var We=j.type.defaultProps;for(rt in K)te.call(K,rt)&&!b.hasOwnProperty(rt)&&(ke[rt]=K[rt]===void 0&&We!==void 0?We[rt]:K[rt])}var rt=arguments.length-2;if(rt===1)ke.children=Re;else if(1<rt){We=Array(rt);for(var rn=0;rn<rt;rn++)We[rn]=arguments[rn+2];ke.children=We}return{$$typeof:n,type:j.type,key:Me,ref:Fe,props:ke,_owner:Je}},Ue.createContext=function(j){return j={$$typeof:l,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:a,_context:j},j.Consumer=j},Ue.createElement=S,Ue.createFactory=function(j){var K=S.bind(null,j);return K.type=j,K},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(j){return{$$typeof:d,render:j}},Ue.isValidElement=D,Ue.lazy=function(j){return{$$typeof:g,_payload:{_status:-1,_result:j},_init:$e}},Ue.memo=function(j,K){return{$$typeof:p,type:j,compare:K===void 0?null:K}},Ue.startTransition=function(j){var K=Y.transition;Y.transition={};try{j()}finally{Y.transition=K}},Ue.unstable_act=de,Ue.useCallback=function(j,K){return ue.current.useCallback(j,K)},Ue.useContext=function(j){return ue.current.useContext(j)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(j){return ue.current.useDeferredValue(j)},Ue.useEffect=function(j,K){return ue.current.useEffect(j,K)},Ue.useId=function(){return ue.current.useId()},Ue.useImperativeHandle=function(j,K,Re){return ue.current.useImperativeHandle(j,K,Re)},Ue.useInsertionEffect=function(j,K){return ue.current.useInsertionEffect(j,K)},Ue.useLayoutEffect=function(j,K){return ue.current.useLayoutEffect(j,K)},Ue.useMemo=function(j,K){return ue.current.useMemo(j,K)},Ue.useReducer=function(j,K,Re){return ue.current.useReducer(j,K,Re)},Ue.useRef=function(j){return ue.current.useRef(j)},Ue.useState=function(j){return ue.current.useState(j)},Ue.useSyncExternalStore=function(j,K,Re){return ue.current.useSyncExternalStore(j,K,Re)},Ue.useTransition=function(){return ue.current.useTransition()},Ue.version="18.3.1",Ue}var LE;function ky(){return LE||(LE=1,ug.exports=CR()),ug.exports}var ME;function NR(){if(ME)return tu;ME=1;var n=ky(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,p){var g,w={},T=null,N=null;p!==void 0&&(T=""+p),f.key!==void 0&&(T=""+f.key),f.ref!==void 0&&(N=f.ref);for(g in f)r.call(f,g)&&!a.hasOwnProperty(g)&&(w[g]=f[g]);if(d&&d.defaultProps)for(g in f=d.defaultProps,f)w[g]===void 0&&(w[g]=f[g]);return{$$typeof:e,type:d,key:T,ref:N,props:w,_owner:s.current}}return tu.Fragment=t,tu.jsx=l,tu.jsxs=l,tu}var FE;function DR(){return FE||(FE=1,cg.exports=NR()),cg.exports}var v=DR(),he=ky();const VR=kR(he);var Hh={},dg={exports:{}},Fn={},hg={exports:{}},fg={};var jE;function OR(){return jE||(jE=1,(function(n){function e(Y,ve){var de=Y.length;Y.push(ve);e:for(;0<de;){var j=de-1>>>1,K=Y[j];if(0<s(K,ve))Y[j]=ve,Y[de]=K,de=j;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var ve=Y[0],de=Y.pop();if(de!==ve){Y[0]=de;e:for(var j=0,K=Y.length,Re=K>>>1;j<Re;){var ke=2*(j+1)-1,Me=Y[ke],Fe=ke+1,Je=Y[Fe];if(0>s(Me,de))Fe<K&&0>s(Je,Me)?(Y[j]=Je,Y[Fe]=de,j=Fe):(Y[j]=Me,Y[ke]=de,j=ke);else if(Fe<K&&0>s(Je,de))Y[j]=Je,Y[Fe]=de,j=Fe;else break e}}return ve}function s(Y,ve){var de=Y.sortIndex-ve.sortIndex;return de!==0?de:Y.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],p=[],g=1,w=null,T=3,N=!1,A=!1,L=!1,V=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(Y){for(var ve=t(p);ve!==null;){if(ve.callback===null)r(p);else if(ve.startTime<=Y)r(p),ve.sortIndex=ve.expirationTime,e(f,ve);else break;ve=t(p)}}function pe(Y){if(L=!1,Q(Y),!A)if(t(f)!==null)A=!0,$e(te);else{var ve=t(p);ve!==null&&ue(pe,ve.startTime-Y)}}function te(Y,ve){A=!1,L&&(L=!1,se(S),S=-1),N=!0;var de=T;try{for(Q(ve),w=t(f);w!==null&&(!(w.expirationTime>ve)||Y&&!R());){var j=w.callback;if(typeof j=="function"){w.callback=null,T=w.priorityLevel;var K=j(w.expirationTime<=ve);ve=n.unstable_now(),typeof K=="function"?w.callback=K:w===t(f)&&r(f),Q(ve)}else r(f);w=t(f)}if(w!==null)var Re=!0;else{var ke=t(p);ke!==null&&ue(pe,ke.startTime-ve),Re=!1}return Re}finally{w=null,T=de,N=!1}}var ae=!1,b=null,S=-1,k=5,D=-1;function R(){return!(n.unstable_now()-D<k)}function M(){if(b!==null){var Y=n.unstable_now();D=Y;var ve=!0;try{ve=b(!0,Y)}finally{ve?P():(ae=!1,b=null)}}else ae=!1}var P;if(typeof ie=="function")P=function(){ie(M)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,tt=Ce.port2;Ce.port1.onmessage=M,P=function(){tt.postMessage(null)}}else P=function(){V(M,0)};function $e(Y){b=Y,ae||(ae=!0,P())}function ue(Y,ve){S=V(function(){Y(n.unstable_now())},ve)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){A||N||(A=!0,$e(te))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(Y){switch(T){case 1:case 2:case 3:var ve=3;break;default:ve=T}var de=T;T=ve;try{return Y()}finally{T=de}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,ve){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var de=T;T=Y;try{return ve()}finally{T=de}},n.unstable_scheduleCallback=function(Y,ve,de){var j=n.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?j+de:j):de=j,Y){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=de+K,Y={id:g++,callback:ve,priorityLevel:Y,startTime:de,expirationTime:K,sortIndex:-1},de>j?(Y.sortIndex=de,e(p,Y),t(f)===null&&Y===t(p)&&(L?(se(S),S=-1):L=!0,ue(pe,de-j))):(Y.sortIndex=K,e(f,Y),A||N||(A=!0,$e(te))),Y},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(Y){var ve=T;return function(){var de=T;T=ve;try{return Y.apply(this,arguments)}finally{T=de}}}})(fg)),fg}var UE;function LR(){return UE||(UE=1,hg.exports=OR()),hg.exports}var BE;function MR(){if(BE)return Fn;BE=1;var n=ky(),e=LR();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},w={};function T(i){return f.call(w,i)?!0:f.call(g,i)?!1:p.test(i)?w[i]=!0:(g[i]=!0,!1)}function N(i,o,c,h){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function A(i,o,c,h){if(o===null||typeof o>"u"||N(i,o,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function L(i,o,c,h,m,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=c,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){V[i]=new L(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];V[o]=new L(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){V[i]=new L(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){V[i]=new L(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){V[i]=new L(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){V[i]=new L(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){V[i]=new L(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){V[i]=new L(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){V[i]=new L(i,5,!1,i.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function ie(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(se,ie);V[o]=new L(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(se,ie);V[o]=new L(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(se,ie);V[o]=new L(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){V[i]=new L(i,1,!1,i.toLowerCase(),null,!1,!1)}),V.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){V[i]=new L(i,1,!1,i.toLowerCase(),null,!0,!0)});function Q(i,o,c,h){var m=V.hasOwnProperty(o)?V[o]:null;(m!==null?m.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(A(o,c,m,h)&&(c=null),h||m===null?T(o)&&(c===null?i.removeAttribute(o):i.setAttribute(o,""+c)):m.mustUseProperty?i[m.propertyName]=c===null?m.type===3?!1:"":c:(o=m.attributeName,h=m.attributeNamespace,c===null?i.removeAttribute(o):(m=m.type,c=m===3||m===4&&c===!0?"":""+c,h?i.setAttributeNS(h,o,c):i.setAttribute(o,c))))}var pe=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),ae=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),R=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),Ce=Symbol.for("react.suspense_list"),tt=Symbol.for("react.memo"),$e=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Y=Symbol.iterator;function ve(i){return i===null||typeof i!="object"?null:(i=Y&&i[Y]||i["@@iterator"],typeof i=="function"?i:null)}var de=Object.assign,j;function K(i){if(j===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);j=o&&o[1]||""}return`
`+j+i}var Re=!1;function ke(i,o){if(!i||Re)return"";Re=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(q){var h=q}Reflect.construct(i,[],o)}else{try{o.call()}catch(q){h=q}i.call(o.prototype)}else{try{throw Error()}catch(q){h=q}i()}}catch(q){if(q&&h&&typeof q.stack=="string"){for(var m=q.stack.split(`
`),y=h.stack.split(`
`),I=m.length-1,C=y.length-1;1<=I&&0<=C&&m[I]!==y[C];)C--;for(;1<=I&&0<=C;I--,C--)if(m[I]!==y[C]){if(I!==1||C!==1)do if(I--,C--,0>C||m[I]!==y[C]){var O=`
`+m[I].replace(" at new "," at ");return i.displayName&&O.includes("<anonymous>")&&(O=O.replace("<anonymous>",i.displayName)),O}while(1<=I&&0<=C);break}}}finally{Re=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?K(i):""}function Me(i){switch(i.tag){case 5:return K(i.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return i=ke(i.type,!1),i;case 11:return i=ke(i.type.render,!1),i;case 1:return i=ke(i.type,!0),i;default:return""}}function Fe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case b:return"Fragment";case ae:return"Portal";case k:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case Ce:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case R:return(i.displayName||"Context")+".Consumer";case D:return(i._context.displayName||"Context")+".Provider";case M:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case tt:return o=i.displayName||null,o!==null?o:Fe(i.type)||"Memo";case $e:o=i._payload,i=i._init;try{return Fe(i(o))}catch{}}return null}function Je(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fe(o);case 8:return o===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function We(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function rn(i){var o=rt(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,y=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return m.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Zs(i){i._valueTracker||(i._valueTracker=rn(i))}function Pe(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return i&&(h=rt(i)?i.checked?"true":"false":i.value),i=h,i!==c?(o.setValue(i),!0):!1}function je(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function lt(i,o){var c=o.checked;return de({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function bt(i,o){var c=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;c=We(o.value!=null?o.value:c),i._wrapperState={initialChecked:h,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function sn(i,o){o=o.checked,o!=null&&Q(i,"checked",o,!1)}function jt(i,o){sn(i,o);var c=We(o.value),h=o.type;if(c!=null)h==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ye(i,o.type,c):o.hasOwnProperty("defaultValue")&&Ye(i,o.type,We(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Lr(i,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,c||o===i.value||(i.value=o),i.defaultValue=o}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function Ye(i,o,c){(o!=="number"||je(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var At=Array.isArray;function Nn(i,o,c,h){if(i=i.options,o){o={};for(var m=0;m<c.length;m++)o["$"+c[m]]=!0;for(c=0;c<i.length;c++)m=o.hasOwnProperty("$"+i[c].value),i[c].selected!==m&&(i[c].selected=m),m&&h&&(i[c].defaultSelected=!0)}else{for(c=""+We(c),o=null,m=0;m<i.length;m++){if(i[m].value===c){i[m].selected=!0,h&&(i[m].defaultSelected=!0);return}o!==null||i[m].disabled||(o=i[m])}o!==null&&(o.selected=!0)}}function lo(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return de({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function uc(i,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(t(92));if(At(c)){if(1<c.length)throw Error(t(93));c=c[0]}o=c}o==null&&(o=""),c=o}i._wrapperState={initialValue:We(c)}}function Nd(i,o){var c=We(o.value),h=We(o.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),o.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),h!=null&&(i.defaultValue=""+h)}function ei(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function dc(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function va(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?dc(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var ti,Dd=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,h,m){MSApp.execUnsafeLocalFunction(function(){return i(o,c,h,m)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(ti=ti||document.createElement("div"),ti.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ti.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function co(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var ni={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vd=["Webkit","ms","Moz","O"];Object.keys(ni).forEach(function(i){Vd.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),ni[o]=ni[i]})});function ri(i,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||ni.hasOwnProperty(i)&&ni[i]?(""+o).trim():o+"px"}function wa(i,o){i=i.style;for(var c in o)if(o.hasOwnProperty(c)){var h=c.indexOf("--")===0,m=ri(c,o[c],h);c==="float"&&(c="cssFloat"),h?i.setProperty(c,m):i[c]=m}}var hc=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wr(i,o){if(o){if(hc[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Ea(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var si=null;function Ia(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Es=null,Is=null,Rt=null;function fc(i){if(i=Uc(i)){if(typeof Es!="function")throw Error(t(280));var o=i.stateNode;o&&(o=ah(o),Es(i.stateNode,i.type,o))}}function ii(i){Is?Rt?Rt.push(i):Rt=[i]:Is=i}function oi(){if(Is){var i=Is,o=Rt;if(Rt=Is=null,fc(i),o)for(i=0;i<o.length;i++)fc(o[i])}}function Od(i,o){return i(o)}function Ld(){}var Mr=!1;function Md(i,o,c){if(Mr)return i(o,c);Mr=!0;try{return Od(i,o,c)}finally{Mr=!1,(Is!==null||Rt!==null)&&(Ld(),oi())}}function uo(i,o){var c=i.stateNode;if(c===null)return null;var h=ah(c);if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,o,typeof c));return c}var ai=!1;if(d)try{var li={};Object.defineProperty(li,"passive",{get:function(){ai=!0}}),window.addEventListener("test",li,li),window.removeEventListener("test",li,li)}catch{ai=!1}function Fd(i,o,c,h,m,y,I,C,O){var q=Array.prototype.slice.call(arguments,3);try{o.apply(c,q)}catch(ee){this.onError(ee)}}var Ts=!1,Fr=null,Ta=!1,ar=null,jd={onError:function(i){Ts=!0,Fr=i}};function Ud(i,o,c,h,m,y,I,C,O){Ts=!1,Fr=null,Fd.apply(jd,arguments)}function pc(i,o,c,h,m,y,I,C,O){if(Ud.apply(this,arguments),Ts){if(Ts){var q=Fr;Ts=!1,Fr=null}else throw Error(t(198));Ta||(Ta=!0,ar=q)}}function Er(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function mc(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Bd(i){if(Er(i)!==i)throw Error(t(188))}function zd(i){var o=i.alternate;if(!o){if(o=Er(i),o===null)throw Error(t(188));return o!==i?null:i}for(var c=i,h=o;;){var m=c.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){c=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===c)return Bd(m),i;if(y===h)return Bd(m),o;y=y.sibling}throw Error(t(188))}if(c.return!==h.return)c=m,h=y;else{for(var I=!1,C=m.child;C;){if(C===c){I=!0,c=m,h=y;break}if(C===h){I=!0,h=m,c=y;break}C=C.sibling}if(!I){for(C=y.child;C;){if(C===c){I=!0,c=y,h=m;break}if(C===h){I=!0,h=y,c=m;break}C=C.sibling}if(!I)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:o}function $d(i){return i=zd(i),i!==null?ho(i):null}function ho(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=ho(i);if(o!==null)return o;i=i.sibling}return null}var gc=e.unstable_scheduleCallback,xa=e.unstable_cancelCallback,fo=e.unstable_shouldYield,xs=e.unstable_requestPaint,ht=e.unstable_now,Up=e.unstable_getCurrentPriorityLevel,Sa=e.unstable_ImmediatePriority,yc=e.unstable_UserBlockingPriority,po=e.unstable_NormalPriority,_c=e.unstable_LowPriority,ba=e.unstable_IdlePriority,mo=null,Hn=null;function qd(i){if(Hn&&typeof Hn.onCommitFiberRoot=="function")try{Hn.onCommitFiberRoot(mo,i,void 0,(i.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:go,jr=Math.log,lr=Math.LN2;function go(i){return i>>>=0,i===0?32:31-(jr(i)/lr|0)|0}var Ur=64,ci=4194304;function et(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Ss(i,o){var c=i.pendingLanes;if(c===0)return 0;var h=0,m=i.suspendedLanes,y=i.pingedLanes,I=c&268435455;if(I!==0){var C=I&~m;C!==0?h=et(C):(y&=I,y!==0&&(h=et(y)))}else I=c&~m,I!==0?h=et(I):y!==0&&(h=et(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&m)===0&&(m=h&-h,y=o&-o,m>=y||m===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=c&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)c=31-Gn(o),m=1<<c,h|=i[c],o&=~m;return h}function yo(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _o(i,o){for(var c=i.suspendedLanes,h=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-Gn(y),C=1<<I,O=m[I];O===-1?((C&c)===0||(C&h)!==0)&&(m[I]=yo(C,o)):O<=o&&(i.expiredLanes|=C),y&=~C}}function vc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function wc(){var i=Ur;return Ur<<=1,(Ur&4194240)===0&&(Ur=64),i}function Ec(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function vo(i,o,c){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Gn(o),i[o]=c}function Bp(i,o){var c=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<c;){var m=31-Gn(c),y=1<<m;o[m]=0,h[m]=-1,i[m]=-1,c&=~y}}function Ic(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var h=31-Gn(c),m=1<<h;m&o|i[h]&o&&(i[h]|=o),c&=~m}}var He=0;function Br(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Tc,Aa,xc,Sc,bc,zr=!1,Ra=[],$r=null,qr=null,on=null,wo=new Map,bs=new Map,Kn=[],Wd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ui(i,o){switch(i){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":qr=null;break;case"mouseover":case"mouseout":on=null;break;case"pointerover":case"pointerout":wo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":bs.delete(o.pointerId)}}function Ir(i,o,c,h,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},o!==null&&(o=Uc(o),o!==null&&Aa(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),i)}function Hd(i,o,c,h,m){switch(o){case"focusin":return $r=Ir($r,i,o,c,h,m),!0;case"dragenter":return qr=Ir(qr,i,o,c,h,m),!0;case"mouseover":return on=Ir(on,i,o,c,h,m),!0;case"pointerover":var y=m.pointerId;return wo.set(y,Ir(wo.get(y)||null,i,o,c,h,m)),!0;case"gotpointercapture":return y=m.pointerId,bs.set(y,Ir(bs.get(y)||null,i,o,c,h,m)),!0}return!1}function Pa(i){var o=xo(i.target);if(o!==null){var c=Er(o);if(c!==null){if(o=c.tag,o===13){if(o=mc(c),o!==null){i.blockedOn=o,bc(i.priority,function(){xc(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function at(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=ka(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);si=h,c.target.dispatchEvent(h),si=null}else return o=Uc(c),o!==null&&Aa(o),i.blockedOn=c,!1;o.shift()}return!0}function Gd(i,o,c){at(i)&&c.delete(o)}function zp(){zr=!1,$r!==null&&at($r)&&($r=null),qr!==null&&at(qr)&&(qr=null),on!==null&&at(on)&&(on=null),wo.forEach(Gd),bs.forEach(Gd)}function di(i,o){i.blockedOn===o&&(i.blockedOn=null,zr||(zr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zp)))}function hi(i){function o(m){return di(m,i)}if(0<Ra.length){di(Ra[0],i);for(var c=1;c<Ra.length;c++){var h=Ra[c];h.blockedOn===i&&(h.blockedOn=null)}}for($r!==null&&di($r,i),qr!==null&&di(qr,i),on!==null&&di(on,i),wo.forEach(o),bs.forEach(o),c=0;c<Kn.length;c++)h=Kn[c],h.blockedOn===i&&(h.blockedOn=null);for(;0<Kn.length&&(c=Kn[0],c.blockedOn===null);)Pa(c),c.blockedOn===null&&Kn.shift()}var As=pe.ReactCurrentBatchConfig,Rs=!0;function Wr(i,o,c,h){var m=He,y=As.transition;As.transition=null;try{He=1,Ac(i,o,c,h)}finally{He=m,As.transition=y}}function Kd(i,o,c,h){var m=He,y=As.transition;As.transition=null;try{He=4,Ac(i,o,c,h)}finally{He=m,As.transition=y}}function Ac(i,o,c,h){if(Rs){var m=ka(i,o,c,h);if(m===null)Zp(i,o,h,Hr,c),ui(i,h);else if(Hd(m,i,o,c,h))h.stopPropagation();else if(ui(i,h),o&4&&-1<Wd.indexOf(i)){for(;m!==null;){var y=Uc(m);if(y!==null&&Tc(y),y=ka(i,o,c,h),y===null&&Zp(i,o,h,Hr,c),y===m)break;m=y}m!==null&&h.stopPropagation()}else Zp(i,o,h,null,c)}}var Hr=null;function ka(i,o,c,h){if(Hr=null,i=Ia(h),i=xo(i),i!==null)if(o=Er(i),o===null)i=null;else if(c=o.tag,c===13){if(i=mc(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Hr=i,null}function Ca(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Up()){case Sa:return 1;case yc:return 4;case po:case _c:return 16;case ba:return 536870912;default:return 16}default:return 16}}var Qn=null,Na=null,Ps=null;function Qd(){if(Ps)return Ps;var i,o=Na,c=o.length,h,m="value"in Qn?Qn.value:Qn.textContent,y=m.length;for(i=0;i<c&&o[i]===m[i];i++);var I=c-i;for(h=1;h<=I&&o[c-h]===m[y-h];h++);return Ps=m.slice(i,1<h?1-h:void 0)}function Eo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Gr(){return!0}function Rc(){return!1}function mn(i){function o(c,h,m,y,I){this._reactName=c,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var C in i)i.hasOwnProperty(C)&&(c=i[C],this[C]=c?c(y):y[C]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Gr:Rc,this.isPropagationStopped=Rc,this}return de(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Gr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Gr)},persist:function(){},isPersistent:Gr}),o}var Kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Io=mn(Kr),fi=de({},Kr,{view:0,detail:0}),Da=mn(fi),Va,Oa,Jn,To=de({},fi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ve,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Jn&&(Jn&&i.type==="mousemove"?(Va=i.screenX-Jn.screenX,Oa=i.screenY-Jn.screenY):Oa=Va=0,Jn=i),Va)},movementY:function(i){return"movementY"in i?i.movementY:Oa}}),Pc=mn(To),Jd=de({},To,{dataTransfer:0}),Yd=mn(Jd),La=de({},fi,{relatedTarget:0}),an=mn(La),Xd=de({},Kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zd=mn(Xd),pi=de({},Kr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),u=mn(pi),_=de({},Kr,{data:0}),E=mn(_),x={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function le(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=H[i])?!!o[i]:!1}function Ve(){return le}var Dt=de({},fi,{key:function(i){if(i.key){var o=x[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Eo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?z[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ve,charCode:function(i){return i.type==="keypress"?Eo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Eo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),st=mn(Dt),Ut=de({},To,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yn=mn(Ut),ks=de({},fi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ve}),Qr=mn(ks),Jr=de({},Kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ma=mn(Jr),kc=de({},To,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),xA=mn(kc),SA=[9,13,27,32],$p=d&&"CompositionEvent"in window,Cc=null;d&&"documentMode"in document&&(Cc=document.documentMode);var bA=d&&"TextEvent"in window&&!Cc,Av=d&&(!$p||Cc&&8<Cc&&11>=Cc),Rv=" ",Pv=!1;function kv(i,o){switch(i){case"keyup":return SA.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cv(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Fa=!1;function AA(i,o){switch(i){case"compositionend":return Cv(o);case"keypress":return o.which!==32?null:(Pv=!0,Rv);case"textInput":return i=o.data,i===Rv&&Pv?null:i;default:return null}}function RA(i,o){if(Fa)return i==="compositionend"||!$p&&kv(i,o)?(i=Qd(),Ps=Na=Qn=null,Fa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Av&&o.locale!=="ko"?null:o.data;default:return null}}var PA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nv(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!PA[i.type]:o==="textarea"}function Dv(i,o,c,h){ii(h),o=sh(o,"onChange"),0<o.length&&(c=new Io("onChange","change",null,c,h),i.push({event:c,listeners:o}))}var Nc=null,Dc=null;function kA(i){Yv(i,0)}function eh(i){var o=$a(i);if(Pe(o))return i}function CA(i,o){if(i==="change")return o}var Vv=!1;if(d){var qp;if(d){var Wp="oninput"in document;if(!Wp){var Ov=document.createElement("div");Ov.setAttribute("oninput","return;"),Wp=typeof Ov.oninput=="function"}qp=Wp}else qp=!1;Vv=qp&&(!document.documentMode||9<document.documentMode)}function Lv(){Nc&&(Nc.detachEvent("onpropertychange",Mv),Dc=Nc=null)}function Mv(i){if(i.propertyName==="value"&&eh(Dc)){var o=[];Dv(o,Dc,i,Ia(i)),Md(kA,o)}}function NA(i,o,c){i==="focusin"?(Lv(),Nc=o,Dc=c,Nc.attachEvent("onpropertychange",Mv)):i==="focusout"&&Lv()}function DA(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return eh(Dc)}function VA(i,o){if(i==="click")return eh(o)}function OA(i,o){if(i==="input"||i==="change")return eh(o)}function LA(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Tr=typeof Object.is=="function"?Object.is:LA;function Vc(i,o){if(Tr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var m=c[h];if(!f.call(o,m)||!Tr(i[m],o[m]))return!1}return!0}function Fv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function jv(i,o){var c=Fv(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=o&&h>=o)return{node:c,offset:o-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Fv(c)}}function Uv(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Uv(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Bv(){for(var i=window,o=je();o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=je(i.document)}return o}function Hp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function MA(i){var o=Bv(),c=i.focusedElem,h=i.selectionRange;if(o!==c&&c&&c.ownerDocument&&Uv(c.ownerDocument.documentElement,c)){if(h!==null&&Hp(c)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(i,c.value.length);else if(i=(o=c.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var m=c.textContent.length,y=Math.min(h.start,m);h=h.end===void 0?y:Math.min(h.end,m),!i.extend&&y>h&&(m=h,h=y,y=m),m=jv(c,y);var I=jv(c,h);m&&I&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=c;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)i=o[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var FA=d&&"documentMode"in document&&11>=document.documentMode,ja=null,Gp=null,Oc=null,Kp=!1;function zv(i,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Kp||ja==null||ja!==je(h)||(h=ja,"selectionStart"in h&&Hp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Oc&&Vc(Oc,h)||(Oc=h,h=sh(Gp,"onSelect"),0<h.length&&(o=new Io("onSelect","select",null,o,c),i.push({event:o,listeners:h}),o.target=ja)))}function th(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var Ua={animationend:th("Animation","AnimationEnd"),animationiteration:th("Animation","AnimationIteration"),animationstart:th("Animation","AnimationStart"),transitionend:th("Transition","TransitionEnd")},Qp={},$v={};d&&($v=document.createElement("div").style,"AnimationEvent"in window||(delete Ua.animationend.animation,delete Ua.animationiteration.animation,delete Ua.animationstart.animation),"TransitionEvent"in window||delete Ua.transitionend.transition);function nh(i){if(Qp[i])return Qp[i];if(!Ua[i])return i;var o=Ua[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in $v)return Qp[i]=o[c];return i}var qv=nh("animationend"),Wv=nh("animationiteration"),Hv=nh("animationstart"),Gv=nh("transitionend"),Kv=new Map,Qv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(i,o){Kv.set(i,o),a(o,[i])}for(var Jp=0;Jp<Qv.length;Jp++){var Yp=Qv[Jp],jA=Yp.toLowerCase(),UA=Yp[0].toUpperCase()+Yp.slice(1);mi(jA,"on"+UA)}mi(qv,"onAnimationEnd"),mi(Wv,"onAnimationIteration"),mi(Hv,"onAnimationStart"),mi("dblclick","onDoubleClick"),mi("focusin","onFocus"),mi("focusout","onBlur"),mi(Gv,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lc));function Jv(i,o,c){var h=i.type||"unknown-event";i.currentTarget=c,pc(h,o,void 0,i),i.currentTarget=null}function Yv(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],m=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var C=h[I],O=C.instance,q=C.currentTarget;if(C=C.listener,O!==y&&m.isPropagationStopped())break e;Jv(m,C,q),y=O}else for(I=0;I<h.length;I++){if(C=h[I],O=C.instance,q=C.currentTarget,C=C.listener,O!==y&&m.isPropagationStopped())break e;Jv(m,C,q),y=O}}}if(Ta)throw i=ar,Ta=!1,ar=null,i}function ft(i,o){var c=o[im];c===void 0&&(c=o[im]=new Set);var h=i+"__bubble";c.has(h)||(Xv(o,i,2,!1),c.add(h))}function Xp(i,o,c){var h=0;o&&(h|=4),Xv(c,i,h,o)}var rh="_reactListening"+Math.random().toString(36).slice(2);function Mc(i){if(!i[rh]){i[rh]=!0,r.forEach(function(c){c!=="selectionchange"&&(BA.has(c)||Xp(c,!1,i),Xp(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[rh]||(o[rh]=!0,Xp("selectionchange",!1,o))}}function Xv(i,o,c,h){switch(Ca(o)){case 1:var m=Wr;break;case 4:m=Kd;break;default:m=Ac}c=m.bind(null,o,c,i),m=void 0,!ai||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),h?m!==void 0?i.addEventListener(o,c,{capture:!0,passive:m}):i.addEventListener(o,c,!0):m!==void 0?i.addEventListener(o,c,{passive:m}):i.addEventListener(o,c,!1)}function Zp(i,o,c,h,m){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var C=h.stateNode.containerInfo;if(C===m||C.nodeType===8&&C.parentNode===m)break;if(I===4)for(I=h.return;I!==null;){var O=I.tag;if((O===3||O===4)&&(O=I.stateNode.containerInfo,O===m||O.nodeType===8&&O.parentNode===m))return;I=I.return}for(;C!==null;){if(I=xo(C),I===null)return;if(O=I.tag,O===5||O===6){h=y=I;continue e}C=C.parentNode}}h=h.return}Md(function(){var q=y,ee=Ia(c),re=[];e:{var X=Kv.get(i);if(X!==void 0){var ge=Io,_e=i;switch(i){case"keypress":if(Eo(c)===0)break e;case"keydown":case"keyup":ge=st;break;case"focusin":_e="focus",ge=an;break;case"focusout":_e="blur",ge=an;break;case"beforeblur":case"afterblur":ge=an;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Pc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Yd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=Qr;break;case qv:case Wv:case Hv:ge=Zd;break;case Gv:ge=Ma;break;case"scroll":ge=Da;break;case"wheel":ge=xA;break;case"copy":case"cut":case"paste":ge=u;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=Yn}var Ee=(o&4)!==0,Vt=!Ee&&i==="scroll",B=Ee?X!==null?X+"Capture":null:X;Ee=[];for(var F=q,$;F!==null;){$=F;var oe=$.stateNode;if($.tag===5&&oe!==null&&($=oe,B!==null&&(oe=uo(F,B),oe!=null&&Ee.push(Fc(F,oe,$)))),Vt)break;F=F.return}0<Ee.length&&(X=new ge(X,_e,null,c,ee),re.push({event:X,listeners:Ee}))}}if((o&7)===0){e:{if(X=i==="mouseover"||i==="pointerover",ge=i==="mouseout"||i==="pointerout",X&&c!==si&&(_e=c.relatedTarget||c.fromElement)&&(xo(_e)||_e[Cs]))break e;if((ge||X)&&(X=ee.window===ee?ee:(X=ee.ownerDocument)?X.defaultView||X.parentWindow:window,ge?(_e=c.relatedTarget||c.toElement,ge=q,_e=_e?xo(_e):null,_e!==null&&(Vt=Er(_e),_e!==Vt||_e.tag!==5&&_e.tag!==6)&&(_e=null)):(ge=null,_e=q),ge!==_e)){if(Ee=Pc,oe="onMouseLeave",B="onMouseEnter",F="mouse",(i==="pointerout"||i==="pointerover")&&(Ee=Yn,oe="onPointerLeave",B="onPointerEnter",F="pointer"),Vt=ge==null?X:$a(ge),$=_e==null?X:$a(_e),X=new Ee(oe,F+"leave",ge,c,ee),X.target=Vt,X.relatedTarget=$,oe=null,xo(ee)===q&&(Ee=new Ee(B,F+"enter",_e,c,ee),Ee.target=$,Ee.relatedTarget=Vt,oe=Ee),Vt=oe,ge&&_e)t:{for(Ee=ge,B=_e,F=0,$=Ee;$;$=Ba($))F++;for($=0,oe=B;oe;oe=Ba(oe))$++;for(;0<F-$;)Ee=Ba(Ee),F--;for(;0<$-F;)B=Ba(B),$--;for(;F--;){if(Ee===B||B!==null&&Ee===B.alternate)break t;Ee=Ba(Ee),B=Ba(B)}Ee=null}else Ee=null;ge!==null&&Zv(re,X,ge,Ee,!1),_e!==null&&Vt!==null&&Zv(re,Vt,_e,Ee,!0)}}e:{if(X=q?$a(q):window,ge=X.nodeName&&X.nodeName.toLowerCase(),ge==="select"||ge==="input"&&X.type==="file")var Ie=CA;else if(Nv(X))if(Vv)Ie=OA;else{Ie=DA;var be=NA}else(ge=X.nodeName)&&ge.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(Ie=VA);if(Ie&&(Ie=Ie(i,q))){Dv(re,Ie,c,ee);break e}be&&be(i,X,q),i==="focusout"&&(be=X._wrapperState)&&be.controlled&&X.type==="number"&&Ye(X,"number",X.value)}switch(be=q?$a(q):window,i){case"focusin":(Nv(be)||be.contentEditable==="true")&&(ja=be,Gp=q,Oc=null);break;case"focusout":Oc=Gp=ja=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,zv(re,c,ee);break;case"selectionchange":if(FA)break;case"keydown":case"keyup":zv(re,c,ee)}var Ae;if($p)e:{switch(i){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Fa?kv(i,c)&&(Ne="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Ne="onCompositionStart");Ne&&(Av&&c.locale!=="ko"&&(Fa||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Fa&&(Ae=Qd()):(Qn=ee,Na="value"in Qn?Qn.value:Qn.textContent,Fa=!0)),be=sh(q,Ne),0<be.length&&(Ne=new E(Ne,i,null,c,ee),re.push({event:Ne,listeners:be}),Ae?Ne.data=Ae:(Ae=Cv(c),Ae!==null&&(Ne.data=Ae)))),(Ae=bA?AA(i,c):RA(i,c))&&(q=sh(q,"onBeforeInput"),0<q.length&&(ee=new E("onBeforeInput","beforeinput",null,c,ee),re.push({event:ee,listeners:q}),ee.data=Ae))}Yv(re,o)})}function Fc(i,o,c){return{instance:i,listener:o,currentTarget:c}}function sh(i,o){for(var c=o+"Capture",h=[];i!==null;){var m=i,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=uo(i,c),y!=null&&h.unshift(Fc(i,y,m)),y=uo(i,o),y!=null&&h.push(Fc(i,y,m))),i=i.return}return h}function Ba(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Zv(i,o,c,h,m){for(var y=o._reactName,I=[];c!==null&&c!==h;){var C=c,O=C.alternate,q=C.stateNode;if(O!==null&&O===h)break;C.tag===5&&q!==null&&(C=q,m?(O=uo(c,y),O!=null&&I.unshift(Fc(c,O,C))):m||(O=uo(c,y),O!=null&&I.push(Fc(c,O,C)))),c=c.return}I.length!==0&&i.push({event:o,listeners:I})}var zA=/\r\n?/g,$A=/\u0000|\uFFFD/g;function ew(i){return(typeof i=="string"?i:""+i).replace(zA,`
`).replace($A,"")}function ih(i,o,c){if(o=ew(o),ew(i)!==o&&c)throw Error(t(425))}function oh(){}var em=null,tm=null;function nm(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,qA=typeof clearTimeout=="function"?clearTimeout:void 0,tw=typeof Promise=="function"?Promise:void 0,WA=typeof queueMicrotask=="function"?queueMicrotask:typeof tw<"u"?function(i){return tw.resolve(null).then(i).catch(HA)}:rm;function HA(i){setTimeout(function(){throw i})}function sm(i,o){var c=o,h=0;do{var m=c.nextSibling;if(i.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(h===0){i.removeChild(m),hi(o);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=m}while(c);hi(o)}function gi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function nw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}var za=Math.random().toString(36).slice(2),Yr="__reactFiber$"+za,jc="__reactProps$"+za,Cs="__reactContainer$"+za,im="__reactEvents$"+za,GA="__reactListeners$"+za,KA="__reactHandles$"+za;function xo(i){var o=i[Yr];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Cs]||c[Yr]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=nw(i);i!==null;){if(c=i[Yr])return c;i=nw(i)}return o}i=c,c=i.parentNode}return null}function Uc(i){return i=i[Yr]||i[Cs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function $a(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function ah(i){return i[jc]||null}var om=[],qa=-1;function yi(i){return{current:i}}function pt(i){0>qa||(i.current=om[qa],om[qa]=null,qa--)}function ct(i,o){qa++,om[qa]=i.current,i.current=o}var _i={},gn=yi(_i),Dn=yi(!1),So=_i;function Wa(i,o){var c=i.type.contextTypes;if(!c)return _i;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in c)m[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=m),m}function Vn(i){return i=i.childContextTypes,i!=null}function lh(){pt(Dn),pt(gn)}function rw(i,o,c){if(gn.current!==_i)throw Error(t(168));ct(gn,o),ct(Dn,c)}function sw(i,o,c){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var m in h)if(!(m in o))throw Error(t(108,Je(i)||"Unknown",m));return de({},c,h)}function ch(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||_i,So=gn.current,ct(gn,i),ct(Dn,Dn.current),!0}function iw(i,o,c){var h=i.stateNode;if(!h)throw Error(t(169));c?(i=sw(i,o,So),h.__reactInternalMemoizedMergedChildContext=i,pt(Dn),pt(gn),ct(gn,i)):pt(Dn),ct(Dn,c)}var Ns=null,uh=!1,am=!1;function ow(i){Ns===null?Ns=[i]:Ns.push(i)}function QA(i){uh=!0,ow(i)}function vi(){if(!am&&Ns!==null){am=!0;var i=0,o=He;try{var c=Ns;for(He=1;i<c.length;i++){var h=c[i];do h=h(!0);while(h!==null)}Ns=null,uh=!1}catch(m){throw Ns!==null&&(Ns=Ns.slice(i+1)),gc(Sa,vi),m}finally{He=o,am=!1}}return null}var Ha=[],Ga=0,dh=null,hh=0,cr=[],ur=0,bo=null,Ds=1,Vs="";function Ao(i,o){Ha[Ga++]=hh,Ha[Ga++]=dh,dh=i,hh=o}function aw(i,o,c){cr[ur++]=Ds,cr[ur++]=Vs,cr[ur++]=bo,bo=i;var h=Ds;i=Vs;var m=32-Gn(h)-1;h&=~(1<<m),c+=1;var y=32-Gn(o)+m;if(30<y){var I=m-m%5;y=(h&(1<<I)-1).toString(32),h>>=I,m-=I,Ds=1<<32-Gn(o)+m|c<<m|h,Vs=y+i}else Ds=1<<y|c<<m|h,Vs=i}function lm(i){i.return!==null&&(Ao(i,1),aw(i,1,0))}function cm(i){for(;i===dh;)dh=Ha[--Ga],Ha[Ga]=null,hh=Ha[--Ga],Ha[Ga]=null;for(;i===bo;)bo=cr[--ur],cr[ur]=null,Vs=cr[--ur],cr[ur]=null,Ds=cr[--ur],cr[ur]=null}var Xn=null,Zn=null,yt=!1,xr=null;function lw(i,o){var c=pr(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=i,o=i.deletions,o===null?(i.deletions=[c],i.flags|=16):o.push(c)}function cw(i,o){switch(i.tag){case 5:var c=i.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Xn=i,Zn=gi(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Xn=i,Zn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=bo!==null?{id:Ds,overflow:Vs}:null,i.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=pr(18,null,null,0),c.stateNode=o,c.return=i,i.child=c,Xn=i,Zn=null,!0):!1;default:return!1}}function um(i){return(i.mode&1)!==0&&(i.flags&128)===0}function dm(i){if(yt){var o=Zn;if(o){var c=o;if(!cw(i,o)){if(um(i))throw Error(t(418));o=gi(c.nextSibling);var h=Xn;o&&cw(i,o)?lw(h,c):(i.flags=i.flags&-4097|2,yt=!1,Xn=i)}}else{if(um(i))throw Error(t(418));i.flags=i.flags&-4097|2,yt=!1,Xn=i}}}function uw(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Xn=i}function fh(i){if(i!==Xn)return!1;if(!yt)return uw(i),yt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!nm(i.type,i.memoizedProps)),o&&(o=Zn)){if(um(i))throw dw(),Error(t(418));for(;o;)lw(i,o),o=gi(o.nextSibling)}if(uw(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(o===0){Zn=gi(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}i=i.nextSibling}Zn=null}}else Zn=Xn?gi(i.stateNode.nextSibling):null;return!0}function dw(){for(var i=Zn;i;)i=gi(i.nextSibling)}function Ka(){Zn=Xn=null,yt=!1}function hm(i){xr===null?xr=[i]:xr.push(i)}var JA=pe.ReactCurrentBatchConfig;function Bc(i,o,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,i));var m=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var C=m.refs;I===null?delete C[y]:C[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function ph(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function hw(i){var o=i._init;return o(i._payload)}function fw(i){function o(B,F){if(i){var $=B.deletions;$===null?(B.deletions=[F],B.flags|=16):$.push(F)}}function c(B,F){if(!i)return null;for(;F!==null;)o(B,F),F=F.sibling;return null}function h(B,F){for(B=new Map;F!==null;)F.key!==null?B.set(F.key,F):B.set(F.index,F),F=F.sibling;return B}function m(B,F){return B=Ai(B,F),B.index=0,B.sibling=null,B}function y(B,F,$){return B.index=$,i?($=B.alternate,$!==null?($=$.index,$<F?(B.flags|=2,F):$):(B.flags|=2,F)):(B.flags|=1048576,F)}function I(B){return i&&B.alternate===null&&(B.flags|=2),B}function C(B,F,$,oe){return F===null||F.tag!==6?(F=rg($,B.mode,oe),F.return=B,F):(F=m(F,$),F.return=B,F)}function O(B,F,$,oe){var Ie=$.type;return Ie===b?ee(B,F,$.props.children,oe,$.key):F!==null&&(F.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===$e&&hw(Ie)===F.type)?(oe=m(F,$.props),oe.ref=Bc(B,F,$),oe.return=B,oe):(oe=Fh($.type,$.key,$.props,null,B.mode,oe),oe.ref=Bc(B,F,$),oe.return=B,oe)}function q(B,F,$,oe){return F===null||F.tag!==4||F.stateNode.containerInfo!==$.containerInfo||F.stateNode.implementation!==$.implementation?(F=sg($,B.mode,oe),F.return=B,F):(F=m(F,$.children||[]),F.return=B,F)}function ee(B,F,$,oe,Ie){return F===null||F.tag!==7?(F=Oo($,B.mode,oe,Ie),F.return=B,F):(F=m(F,$),F.return=B,F)}function re(B,F,$){if(typeof F=="string"&&F!==""||typeof F=="number")return F=rg(""+F,B.mode,$),F.return=B,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case te:return $=Fh(F.type,F.key,F.props,null,B.mode,$),$.ref=Bc(B,null,F),$.return=B,$;case ae:return F=sg(F,B.mode,$),F.return=B,F;case $e:var oe=F._init;return re(B,oe(F._payload),$)}if(At(F)||ve(F))return F=Oo(F,B.mode,$,null),F.return=B,F;ph(B,F)}return null}function X(B,F,$,oe){var Ie=F!==null?F.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return Ie!==null?null:C(B,F,""+$,oe);if(typeof $=="object"&&$!==null){switch($.$$typeof){case te:return $.key===Ie?O(B,F,$,oe):null;case ae:return $.key===Ie?q(B,F,$,oe):null;case $e:return Ie=$._init,X(B,F,Ie($._payload),oe)}if(At($)||ve($))return Ie!==null?null:ee(B,F,$,oe,null);ph(B,$)}return null}function ge(B,F,$,oe,Ie){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return B=B.get($)||null,C(F,B,""+oe,Ie);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case te:return B=B.get(oe.key===null?$:oe.key)||null,O(F,B,oe,Ie);case ae:return B=B.get(oe.key===null?$:oe.key)||null,q(F,B,oe,Ie);case $e:var be=oe._init;return ge(B,F,$,be(oe._payload),Ie)}if(At(oe)||ve(oe))return B=B.get($)||null,ee(F,B,oe,Ie,null);ph(F,oe)}return null}function _e(B,F,$,oe){for(var Ie=null,be=null,Ae=F,Ne=F=0,Xt=null;Ae!==null&&Ne<$.length;Ne++){Ae.index>Ne?(Xt=Ae,Ae=null):Xt=Ae.sibling;var Xe=X(B,Ae,$[Ne],oe);if(Xe===null){Ae===null&&(Ae=Xt);break}i&&Ae&&Xe.alternate===null&&o(B,Ae),F=y(Xe,F,Ne),be===null?Ie=Xe:be.sibling=Xe,be=Xe,Ae=Xt}if(Ne===$.length)return c(B,Ae),yt&&Ao(B,Ne),Ie;if(Ae===null){for(;Ne<$.length;Ne++)Ae=re(B,$[Ne],oe),Ae!==null&&(F=y(Ae,F,Ne),be===null?Ie=Ae:be.sibling=Ae,be=Ae);return yt&&Ao(B,Ne),Ie}for(Ae=h(B,Ae);Ne<$.length;Ne++)Xt=ge(Ae,B,Ne,$[Ne],oe),Xt!==null&&(i&&Xt.alternate!==null&&Ae.delete(Xt.key===null?Ne:Xt.key),F=y(Xt,F,Ne),be===null?Ie=Xt:be.sibling=Xt,be=Xt);return i&&Ae.forEach(function(Ri){return o(B,Ri)}),yt&&Ao(B,Ne),Ie}function Ee(B,F,$,oe){var Ie=ve($);if(typeof Ie!="function")throw Error(t(150));if($=Ie.call($),$==null)throw Error(t(151));for(var be=Ie=null,Ae=F,Ne=F=0,Xt=null,Xe=$.next();Ae!==null&&!Xe.done;Ne++,Xe=$.next()){Ae.index>Ne?(Xt=Ae,Ae=null):Xt=Ae.sibling;var Ri=X(B,Ae,Xe.value,oe);if(Ri===null){Ae===null&&(Ae=Xt);break}i&&Ae&&Ri.alternate===null&&o(B,Ae),F=y(Ri,F,Ne),be===null?Ie=Ri:be.sibling=Ri,be=Ri,Ae=Xt}if(Xe.done)return c(B,Ae),yt&&Ao(B,Ne),Ie;if(Ae===null){for(;!Xe.done;Ne++,Xe=$.next())Xe=re(B,Xe.value,oe),Xe!==null&&(F=y(Xe,F,Ne),be===null?Ie=Xe:be.sibling=Xe,be=Xe);return yt&&Ao(B,Ne),Ie}for(Ae=h(B,Ae);!Xe.done;Ne++,Xe=$.next())Xe=ge(Ae,B,Ne,Xe.value,oe),Xe!==null&&(i&&Xe.alternate!==null&&Ae.delete(Xe.key===null?Ne:Xe.key),F=y(Xe,F,Ne),be===null?Ie=Xe:be.sibling=Xe,be=Xe);return i&&Ae.forEach(function(PR){return o(B,PR)}),yt&&Ao(B,Ne),Ie}function Vt(B,F,$,oe){if(typeof $=="object"&&$!==null&&$.type===b&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case te:e:{for(var Ie=$.key,be=F;be!==null;){if(be.key===Ie){if(Ie=$.type,Ie===b){if(be.tag===7){c(B,be.sibling),F=m(be,$.props.children),F.return=B,B=F;break e}}else if(be.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===$e&&hw(Ie)===be.type){c(B,be.sibling),F=m(be,$.props),F.ref=Bc(B,be,$),F.return=B,B=F;break e}c(B,be);break}else o(B,be);be=be.sibling}$.type===b?(F=Oo($.props.children,B.mode,oe,$.key),F.return=B,B=F):(oe=Fh($.type,$.key,$.props,null,B.mode,oe),oe.ref=Bc(B,F,$),oe.return=B,B=oe)}return I(B);case ae:e:{for(be=$.key;F!==null;){if(F.key===be)if(F.tag===4&&F.stateNode.containerInfo===$.containerInfo&&F.stateNode.implementation===$.implementation){c(B,F.sibling),F=m(F,$.children||[]),F.return=B,B=F;break e}else{c(B,F);break}else o(B,F);F=F.sibling}F=sg($,B.mode,oe),F.return=B,B=F}return I(B);case $e:return be=$._init,Vt(B,F,be($._payload),oe)}if(At($))return _e(B,F,$,oe);if(ve($))return Ee(B,F,$,oe);ph(B,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,F!==null&&F.tag===6?(c(B,F.sibling),F=m(F,$),F.return=B,B=F):(c(B,F),F=rg($,B.mode,oe),F.return=B,B=F),I(B)):c(B,F)}return Vt}var Qa=fw(!0),pw=fw(!1),mh=yi(null),gh=null,Ja=null,fm=null;function pm(){fm=Ja=gh=null}function mm(i){var o=mh.current;pt(mh),i._currentValue=o}function gm(i,o,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===c)break;i=i.return}}function Ya(i,o){gh=i,fm=Ja=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(On=!0),i.firstContext=null)}function dr(i){var o=i._currentValue;if(fm!==i)if(i={context:i,memoizedValue:o,next:null},Ja===null){if(gh===null)throw Error(t(308));Ja=i,gh.dependencies={lanes:0,firstContext:i}}else Ja=Ja.next=i;return o}var Ro=null;function ym(i){Ro===null?Ro=[i]:Ro.push(i)}function mw(i,o,c,h){var m=o.interleaved;return m===null?(c.next=c,ym(o)):(c.next=m.next,m.next=c),o.interleaved=c,Os(i,h)}function Os(i,o){i.lanes|=o;var c=i.alternate;for(c!==null&&(c.lanes|=o),c=i,i=i.return;i!==null;)i.childLanes|=o,c=i.alternate,c!==null&&(c.childLanes|=o),c=i,i=i.return;return c.tag===3?c.stateNode:null}var wi=!1;function _m(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gw(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ls(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Ei(i,o,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ke&2)!==0){var m=h.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),h.pending=o,Os(i,c)}return m=h.interleaved,m===null?(o.next=o,ym(h)):(o.next=m.next,m.next=o),h.interleaved=o,Os(i,c)}function yh(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,Ic(i,c)}}function yw(i,o){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var m=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var I={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};y===null?m=y=I:y=y.next=I,c=c.next}while(c!==null);y===null?m=y=o:y=y.next=o}else m=y=o;c={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}function _h(i,o,c,h){var m=i.updateQueue;wi=!1;var y=m.firstBaseUpdate,I=m.lastBaseUpdate,C=m.shared.pending;if(C!==null){m.shared.pending=null;var O=C,q=O.next;O.next=null,I===null?y=q:I.next=q,I=O;var ee=i.alternate;ee!==null&&(ee=ee.updateQueue,C=ee.lastBaseUpdate,C!==I&&(C===null?ee.firstBaseUpdate=q:C.next=q,ee.lastBaseUpdate=O))}if(y!==null){var re=m.baseState;I=0,ee=q=O=null,C=y;do{var X=C.lane,ge=C.eventTime;if((h&X)===X){ee!==null&&(ee=ee.next={eventTime:ge,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var _e=i,Ee=C;switch(X=o,ge=c,Ee.tag){case 1:if(_e=Ee.payload,typeof _e=="function"){re=_e.call(ge,re,X);break e}re=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ee.payload,X=typeof _e=="function"?_e.call(ge,re,X):_e,X==null)break e;re=de({},re,X);break e;case 2:wi=!0}}C.callback!==null&&C.lane!==0&&(i.flags|=64,X=m.effects,X===null?m.effects=[C]:X.push(C))}else ge={eventTime:ge,lane:X,tag:C.tag,payload:C.payload,callback:C.callback,next:null},ee===null?(q=ee=ge,O=re):ee=ee.next=ge,I|=X;if(C=C.next,C===null){if(C=m.shared.pending,C===null)break;X=C,C=X.next,X.next=null,m.lastBaseUpdate=X,m.shared.pending=null}}while(!0);if(ee===null&&(O=re),m.baseState=O,m.firstBaseUpdate=q,m.lastBaseUpdate=ee,o=m.shared.interleaved,o!==null){m=o;do I|=m.lane,m=m.next;while(m!==o)}else y===null&&(m.shared.lanes=0);Co|=I,i.lanes=I,i.memoizedState=re}}function _w(i,o,c){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],m=h.callback;if(m!==null){if(h.callback=null,h=c,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var zc={},Xr=yi(zc),$c=yi(zc),qc=yi(zc);function Po(i){if(i===zc)throw Error(t(174));return i}function vm(i,o){switch(ct(qc,o),ct($c,i),ct(Xr,zc),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:va(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=va(o,i)}pt(Xr),ct(Xr,o)}function Xa(){pt(Xr),pt($c),pt(qc)}function vw(i){Po(qc.current);var o=Po(Xr.current),c=va(o,i.type);o!==c&&(ct($c,i),ct(Xr,c))}function wm(i){$c.current===i&&(pt(Xr),pt($c))}var Et=yi(0);function vh(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Em=[];function Im(){for(var i=0;i<Em.length;i++)Em[i]._workInProgressVersionPrimary=null;Em.length=0}var wh=pe.ReactCurrentDispatcher,Tm=pe.ReactCurrentBatchConfig,ko=0,It=null,Wt=null,Jt=null,Eh=!1,Wc=!1,Hc=0,YA=0;function yn(){throw Error(t(321))}function xm(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!Tr(i[c],o[c]))return!1;return!0}function Sm(i,o,c,h,m,y){if(ko=y,It=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,wh.current=i===null||i.memoizedState===null?tR:nR,i=c(h,m),Wc){y=0;do{if(Wc=!1,Hc=0,25<=y)throw Error(t(301));y+=1,Jt=Wt=null,o.updateQueue=null,wh.current=rR,i=c(h,m)}while(Wc)}if(wh.current=xh,o=Wt!==null&&Wt.next!==null,ko=0,Jt=Wt=It=null,Eh=!1,o)throw Error(t(300));return i}function bm(){var i=Hc!==0;return Hc=0,i}function Zr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?It.memoizedState=Jt=i:Jt=Jt.next=i,Jt}function hr(){if(Wt===null){var i=It.alternate;i=i!==null?i.memoizedState:null}else i=Wt.next;var o=Jt===null?It.memoizedState:Jt.next;if(o!==null)Jt=o,Wt=i;else{if(i===null)throw Error(t(310));Wt=i,i={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Jt===null?It.memoizedState=Jt=i:Jt=Jt.next=i}return Jt}function Gc(i,o){return typeof o=="function"?o(i):o}function Am(i){var o=hr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var h=Wt,m=h.baseQueue,y=c.pending;if(y!==null){if(m!==null){var I=m.next;m.next=y.next,y.next=I}h.baseQueue=m=y,c.pending=null}if(m!==null){y=m.next,h=h.baseState;var C=I=null,O=null,q=y;do{var ee=q.lane;if((ko&ee)===ee)O!==null&&(O=O.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),h=q.hasEagerState?q.eagerState:i(h,q.action);else{var re={lane:ee,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};O===null?(C=O=re,I=h):O=O.next=re,It.lanes|=ee,Co|=ee}q=q.next}while(q!==null&&q!==y);O===null?I=h:O.next=C,Tr(h,o.memoizedState)||(On=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=O,c.lastRenderedState=h}if(i=c.interleaved,i!==null){m=i;do y=m.lane,It.lanes|=y,Co|=y,m=m.next;while(m!==i)}else m===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Rm(i){var o=hr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var h=c.dispatch,m=c.pending,y=o.memoizedState;if(m!==null){c.pending=null;var I=m=m.next;do y=i(y,I.action),I=I.next;while(I!==m);Tr(y,o.memoizedState)||(On=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,h]}function ww(){}function Ew(i,o){var c=It,h=hr(),m=o(),y=!Tr(h.memoizedState,m);if(y&&(h.memoizedState=m,On=!0),h=h.queue,Pm(xw.bind(null,c,h,i),[i]),h.getSnapshot!==o||y||Jt!==null&&Jt.memoizedState.tag&1){if(c.flags|=2048,Kc(9,Tw.bind(null,c,h,m,o),void 0,null),Yt===null)throw Error(t(349));(ko&30)!==0||Iw(c,o,m)}return m}function Iw(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function Tw(i,o,c,h){o.value=c,o.getSnapshot=h,Sw(o)&&bw(i)}function xw(i,o,c){return c(function(){Sw(o)&&bw(i)})}function Sw(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!Tr(i,c)}catch{return!0}}function bw(i){var o=Os(i,1);o!==null&&Rr(o,i,1,-1)}function Aw(i){var o=Zr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gc,lastRenderedState:i},o.queue=i,i=i.dispatch=eR.bind(null,It,i),[o.memoizedState,i]}function Kc(i,o,c,h){return i={tag:i,create:o,destroy:c,deps:h,next:null},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.lastEffect=i.next=i):(c=o.lastEffect,c===null?o.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,o.lastEffect=i)),i}function Rw(){return hr().memoizedState}function Ih(i,o,c,h){var m=Zr();It.flags|=i,m.memoizedState=Kc(1|o,c,void 0,h===void 0?null:h)}function Th(i,o,c,h){var m=hr();h=h===void 0?null:h;var y=void 0;if(Wt!==null){var I=Wt.memoizedState;if(y=I.destroy,h!==null&&xm(h,I.deps)){m.memoizedState=Kc(o,c,y,h);return}}It.flags|=i,m.memoizedState=Kc(1|o,c,y,h)}function Pw(i,o){return Ih(8390656,8,i,o)}function Pm(i,o){return Th(2048,8,i,o)}function kw(i,o){return Th(4,2,i,o)}function Cw(i,o){return Th(4,4,i,o)}function Nw(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Dw(i,o,c){return c=c!=null?c.concat([i]):null,Th(4,4,Nw.bind(null,o,i),c)}function km(){}function Vw(i,o){var c=hr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&xm(o,h[1])?h[0]:(c.memoizedState=[i,o],i)}function Ow(i,o){var c=hr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&xm(o,h[1])?h[0]:(i=i(),c.memoizedState=[i,o],i)}function Lw(i,o,c){return(ko&21)===0?(i.baseState&&(i.baseState=!1,On=!0),i.memoizedState=c):(Tr(c,o)||(c=wc(),It.lanes|=c,Co|=c,i.baseState=!0),o)}function XA(i,o){var c=He;He=c!==0&&4>c?c:4,i(!0);var h=Tm.transition;Tm.transition={};try{i(!1),o()}finally{He=c,Tm.transition=h}}function Mw(){return hr().memoizedState}function ZA(i,o,c){var h=Si(i);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},Fw(i))jw(o,c);else if(c=mw(i,o,c,h),c!==null){var m=An();Rr(c,i,h,m),Uw(c,o,h)}}function eR(i,o,c){var h=Si(i),m={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(Fw(i))jw(o,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,C=y(I,c);if(m.hasEagerState=!0,m.eagerState=C,Tr(C,I)){var O=o.interleaved;O===null?(m.next=m,ym(o)):(m.next=O.next,O.next=m),o.interleaved=m;return}}catch{}c=mw(i,o,m,h),c!==null&&(m=An(),Rr(c,i,h,m),Uw(c,o,h))}}function Fw(i){var o=i.alternate;return i===It||o!==null&&o===It}function jw(i,o){Wc=Eh=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function Uw(i,o,c){if((c&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,Ic(i,c)}}var xh={readContext:dr,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},tR={readContext:dr,useCallback:function(i,o){return Zr().memoizedState=[i,o===void 0?null:o],i},useContext:dr,useEffect:Pw,useImperativeHandle:function(i,o,c){return c=c!=null?c.concat([i]):null,Ih(4194308,4,Nw.bind(null,o,i),c)},useLayoutEffect:function(i,o){return Ih(4194308,4,i,o)},useInsertionEffect:function(i,o){return Ih(4,2,i,o)},useMemo:function(i,o){var c=Zr();return o=o===void 0?null:o,i=i(),c.memoizedState=[i,o],i},useReducer:function(i,o,c){var h=Zr();return o=c!==void 0?c(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=ZA.bind(null,It,i),[h.memoizedState,i]},useRef:function(i){var o=Zr();return i={current:i},o.memoizedState=i},useState:Aw,useDebugValue:km,useDeferredValue:function(i){return Zr().memoizedState=i},useTransition:function(){var i=Aw(!1),o=i[0];return i=XA.bind(null,i[1]),Zr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,c){var h=It,m=Zr();if(yt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=o(),Yt===null)throw Error(t(349));(ko&30)!==0||Iw(h,o,c)}m.memoizedState=c;var y={value:c,getSnapshot:o};return m.queue=y,Pw(xw.bind(null,h,y,i),[i]),h.flags|=2048,Kc(9,Tw.bind(null,h,y,c,o),void 0,null),c},useId:function(){var i=Zr(),o=Yt.identifierPrefix;if(yt){var c=Vs,h=Ds;c=(h&~(1<<32-Gn(h)-1)).toString(32)+c,o=":"+o+"R"+c,c=Hc++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=YA++,o=":"+o+"r"+c.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},nR={readContext:dr,useCallback:Vw,useContext:dr,useEffect:Pm,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Cw,useMemo:Ow,useReducer:Am,useRef:Rw,useState:function(){return Am(Gc)},useDebugValue:km,useDeferredValue:function(i){var o=hr();return Lw(o,Wt.memoizedState,i)},useTransition:function(){var i=Am(Gc)[0],o=hr().memoizedState;return[i,o]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Mw,unstable_isNewReconciler:!1},rR={readContext:dr,useCallback:Vw,useContext:dr,useEffect:Pm,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Cw,useMemo:Ow,useReducer:Rm,useRef:Rw,useState:function(){return Rm(Gc)},useDebugValue:km,useDeferredValue:function(i){var o=hr();return Wt===null?o.memoizedState=i:Lw(o,Wt.memoizedState,i)},useTransition:function(){var i=Rm(Gc)[0],o=hr().memoizedState;return[i,o]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Mw,unstable_isNewReconciler:!1};function Sr(i,o){if(i&&i.defaultProps){o=de({},o),i=i.defaultProps;for(var c in i)o[c]===void 0&&(o[c]=i[c]);return o}return o}function Cm(i,o,c,h){o=i.memoizedState,c=c(h,o),c=c==null?o:de({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Sh={isMounted:function(i){return(i=i._reactInternals)?Er(i)===i:!1},enqueueSetState:function(i,o,c){i=i._reactInternals;var h=An(),m=Si(i),y=Ls(h,m);y.payload=o,c!=null&&(y.callback=c),o=Ei(i,y,m),o!==null&&(Rr(o,i,m,h),yh(o,i,m))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var h=An(),m=Si(i),y=Ls(h,m);y.tag=1,y.payload=o,c!=null&&(y.callback=c),o=Ei(i,y,m),o!==null&&(Rr(o,i,m,h),yh(o,i,m))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=An(),h=Si(i),m=Ls(c,h);m.tag=2,o!=null&&(m.callback=o),o=Ei(i,m,h),o!==null&&(Rr(o,i,h,c),yh(o,i,h))}};function Bw(i,o,c,h,m,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Vc(c,h)||!Vc(m,y):!0}function zw(i,o,c){var h=!1,m=_i,y=o.contextType;return typeof y=="object"&&y!==null?y=dr(y):(m=Vn(o)?So:gn.current,h=o.contextTypes,y=(h=h!=null)?Wa(i,m):_i),o=new o(c,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Sh,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=y),o}function $w(i,o,c,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==i&&Sh.enqueueReplaceState(o,o.state,null)}function Nm(i,o,c,h){var m=i.stateNode;m.props=c,m.state=i.memoizedState,m.refs={},_m(i);var y=o.contextType;typeof y=="object"&&y!==null?m.context=dr(y):(y=Vn(o)?So:gn.current,m.context=Wa(i,y)),m.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(Cm(i,o,y,c),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&Sh.enqueueReplaceState(m,m.state,null),_h(i,c,m,h),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function Za(i,o){try{var c="",h=o;do c+=Me(h),h=h.return;while(h);var m=c}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:m,digest:null}}function Dm(i,o,c){return{value:i,source:null,stack:c??null,digest:o??null}}function Vm(i,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var sR=typeof WeakMap=="function"?WeakMap:Map;function qw(i,o,c){c=Ls(-1,c),c.tag=3,c.payload={element:null};var h=o.value;return c.callback=function(){Nh||(Nh=!0,Qm=h),Vm(i,o)},c}function Ww(i,o,c){c=Ls(-1,c),c.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var m=o.value;c.payload=function(){return h(m)},c.callback=function(){Vm(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(c.callback=function(){Vm(i,o),typeof h!="function"&&(Ti===null?Ti=new Set([this]):Ti.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),c}function Hw(i,o,c){var h=i.pingCache;if(h===null){h=i.pingCache=new sR;var m=new Set;h.set(o,m)}else m=h.get(o),m===void 0&&(m=new Set,h.set(o,m));m.has(c)||(m.add(c),i=_R.bind(null,i,o,c),o.then(i,i))}function Gw(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Kw(i,o,c,h,m){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=Ls(-1,1),o.tag=2,Ei(c,o,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var iR=pe.ReactCurrentOwner,On=!1;function bn(i,o,c,h){o.child=i===null?pw(o,null,c,h):Qa(o,i.child,c,h)}function Qw(i,o,c,h,m){c=c.render;var y=o.ref;return Ya(o,m),h=Sm(i,o,c,h,y,m),c=bm(),i!==null&&!On?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,Ms(i,o,m)):(yt&&c&&lm(o),o.flags|=1,bn(i,o,h,m),o.child)}function Jw(i,o,c,h,m){if(i===null){var y=c.type;return typeof y=="function"&&!ng(y)&&y.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=y,Yw(i,o,y,h,m)):(i=Fh(c.type,null,h,o,o.mode,m),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&m)===0){var I=y.memoizedProps;if(c=c.compare,c=c!==null?c:Vc,c(I,h)&&i.ref===o.ref)return Ms(i,o,m)}return o.flags|=1,i=Ai(y,h),i.ref=o.ref,i.return=o,o.child=i}function Yw(i,o,c,h,m){if(i!==null){var y=i.memoizedProps;if(Vc(y,h)&&i.ref===o.ref)if(On=!1,o.pendingProps=h=y,(i.lanes&m)!==0)(i.flags&131072)!==0&&(On=!0);else return o.lanes=i.lanes,Ms(i,o,m)}return Om(i,o,c,h,m)}function Xw(i,o,c){var h=o.pendingProps,m=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(tl,er),er|=c;else{if((c&1073741824)===0)return i=y!==null?y.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,ct(tl,er),er|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:c,ct(tl,er),er|=h}else y!==null?(h=y.baseLanes|c,o.memoizedState=null):h=c,ct(tl,er),er|=h;return bn(i,o,m,c),o.child}function Zw(i,o){var c=o.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function Om(i,o,c,h,m){var y=Vn(c)?So:gn.current;return y=Wa(o,y),Ya(o,m),c=Sm(i,o,c,h,y,m),h=bm(),i!==null&&!On?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,Ms(i,o,m)):(yt&&h&&lm(o),o.flags|=1,bn(i,o,c,m),o.child)}function eE(i,o,c,h,m){if(Vn(c)){var y=!0;ch(o)}else y=!1;if(Ya(o,m),o.stateNode===null)Ah(i,o),zw(o,c,h),Nm(o,c,h,m),h=!0;else if(i===null){var I=o.stateNode,C=o.memoizedProps;I.props=C;var O=I.context,q=c.contextType;typeof q=="object"&&q!==null?q=dr(q):(q=Vn(c)?So:gn.current,q=Wa(o,q));var ee=c.getDerivedStateFromProps,re=typeof ee=="function"||typeof I.getSnapshotBeforeUpdate=="function";re||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(C!==h||O!==q)&&$w(o,I,h,q),wi=!1;var X=o.memoizedState;I.state=X,_h(o,h,I,m),O=o.memoizedState,C!==h||X!==O||Dn.current||wi?(typeof ee=="function"&&(Cm(o,c,ee,h),O=o.memoizedState),(C=wi||Bw(o,c,C,h,X,O,q))?(re||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=O),I.props=h,I.state=O,I.context=q,h=C):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,gw(i,o),C=o.memoizedProps,q=o.type===o.elementType?C:Sr(o.type,C),I.props=q,re=o.pendingProps,X=I.context,O=c.contextType,typeof O=="object"&&O!==null?O=dr(O):(O=Vn(c)?So:gn.current,O=Wa(o,O));var ge=c.getDerivedStateFromProps;(ee=typeof ge=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(C!==re||X!==O)&&$w(o,I,h,O),wi=!1,X=o.memoizedState,I.state=X,_h(o,h,I,m);var _e=o.memoizedState;C!==re||X!==_e||Dn.current||wi?(typeof ge=="function"&&(Cm(o,c,ge,h),_e=o.memoizedState),(q=wi||Bw(o,c,q,h,X,_e,O)||!1)?(ee||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,_e,O),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,_e,O)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||C===i.memoizedProps&&X===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&X===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=_e),I.props=h,I.state=_e,I.context=O,h=q):(typeof I.componentDidUpdate!="function"||C===i.memoizedProps&&X===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&X===i.memoizedState||(o.flags|=1024),h=!1)}return Lm(i,o,c,h,y,m)}function Lm(i,o,c,h,m,y){Zw(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return m&&iw(o,c,!1),Ms(i,o,y);h=o.stateNode,iR.current=o;var C=I&&typeof c.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=Qa(o,i.child,null,y),o.child=Qa(o,null,C,y)):bn(i,o,C,y),o.memoizedState=h.state,m&&iw(o,c,!0),o.child}function tE(i){var o=i.stateNode;o.pendingContext?rw(i,o.pendingContext,o.pendingContext!==o.context):o.context&&rw(i,o.context,!1),vm(i,o.containerInfo)}function nE(i,o,c,h,m){return Ka(),hm(m),o.flags|=256,bn(i,o,c,h),o.child}var Mm={dehydrated:null,treeContext:null,retryLane:0};function Fm(i){return{baseLanes:i,cachePool:null,transitions:null}}function rE(i,o,c){var h=o.pendingProps,m=Et.current,y=!1,I=(o.flags&128)!==0,C;if((C=I)||(C=i!==null&&i.memoizedState===null?!1:(m&2)!==0),C?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),ct(Et,m&1),i===null)return dm(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=jh(I,h,0,null),i=Oo(i,h,c,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=Fm(c),o.memoizedState=Mm,i):jm(o,I));if(m=i.memoizedState,m!==null&&(C=m.dehydrated,C!==null))return oR(i,o,I,h,C,m,c);if(y){y=h.fallback,I=o.mode,m=i.child,C=m.sibling;var O={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==m?(h=o.child,h.childLanes=0,h.pendingProps=O,o.deletions=null):(h=Ai(m,O),h.subtreeFlags=m.subtreeFlags&14680064),C!==null?y=Ai(C,y):(y=Oo(y,I,c,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?Fm(c):{baseLanes:I.baseLanes|c,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~c,o.memoizedState=Mm,h}return y=i.child,i=y.sibling,h=Ai(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=c),h.return=o,h.sibling=null,i!==null&&(c=o.deletions,c===null?(o.deletions=[i],o.flags|=16):c.push(i)),o.child=h,o.memoizedState=null,h}function jm(i,o){return o=jh({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function bh(i,o,c,h){return h!==null&&hm(h),Qa(o,i.child,null,c),i=jm(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function oR(i,o,c,h,m,y,I){if(c)return o.flags&256?(o.flags&=-257,h=Dm(Error(t(422))),bh(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,m=o.mode,h=jh({mode:"visible",children:h.children},m,0,null),y=Oo(y,m,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&Qa(o,i.child,null,I),o.child.memoizedState=Fm(I),o.memoizedState=Mm,y);if((o.mode&1)===0)return bh(i,o,I,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var C=h.dgst;return h=C,y=Error(t(419)),h=Dm(y,h,void 0),bh(i,o,I,h)}if(C=(I&i.childLanes)!==0,On||C){if(h=Yt,h!==null){switch(I&-I){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(h.suspendedLanes|I))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,Os(i,m),Rr(h,i,m,-1))}return tg(),h=Dm(Error(t(421))),bh(i,o,I,h)}return m.data==="$?"?(o.flags|=128,o.child=i.child,o=vR.bind(null,i),m._reactRetry=o,null):(i=y.treeContext,Zn=gi(m.nextSibling),Xn=o,yt=!0,xr=null,i!==null&&(cr[ur++]=Ds,cr[ur++]=Vs,cr[ur++]=bo,Ds=i.id,Vs=i.overflow,bo=o),o=jm(o,h.children),o.flags|=4096,o)}function sE(i,o,c){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),gm(i.return,o,c)}function Um(i,o,c,h,m){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:m}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=m)}function iE(i,o,c){var h=o.pendingProps,m=h.revealOrder,y=h.tail;if(bn(i,o,h.children,c),h=Et.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&sE(i,c,o);else if(i.tag===19)sE(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(ct(Et,h),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(c=o.child,m=null;c!==null;)i=c.alternate,i!==null&&vh(i)===null&&(m=c),c=c.sibling;c=m,c===null?(m=o.child,o.child=null):(m=c.sibling,c.sibling=null),Um(o,!1,m,c,y);break;case"backwards":for(c=null,m=o.child,o.child=null;m!==null;){if(i=m.alternate,i!==null&&vh(i)===null){o.child=m;break}i=m.sibling,m.sibling=c,c=m,m=i}Um(o,!0,c,null,y);break;case"together":Um(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ah(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Ms(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),Co|=o.lanes,(c&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,c=Ai(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=Ai(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function aR(i,o,c){switch(o.tag){case 3:tE(o),Ka();break;case 5:vw(o);break;case 1:Vn(o.type)&&ch(o);break;case 4:vm(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,m=o.memoizedProps.value;ct(mh,h._currentValue),h._currentValue=m;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(ct(Et,Et.current&1),o.flags|=128,null):(c&o.child.childLanes)!==0?rE(i,o,c):(ct(Et,Et.current&1),i=Ms(i,o,c),i!==null?i.sibling:null);ct(Et,Et.current&1);break;case 19:if(h=(c&o.childLanes)!==0,(i.flags&128)!==0){if(h)return iE(i,o,c);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ct(Et,Et.current),h)break;return null;case 22:case 23:return o.lanes=0,Xw(i,o,c)}return Ms(i,o,c)}var oE,Bm,aE,lE;oE=function(i,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Bm=function(){},aE=function(i,o,c,h){var m=i.memoizedProps;if(m!==h){i=o.stateNode,Po(Xr.current);var y=null;switch(c){case"input":m=lt(i,m),h=lt(i,h),y=[];break;case"select":m=de({},m,{value:void 0}),h=de({},h,{value:void 0}),y=[];break;case"textarea":m=lo(i,m),h=lo(i,h),y=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=oh)}wr(c,h);var I;c=null;for(q in m)if(!h.hasOwnProperty(q)&&m.hasOwnProperty(q)&&m[q]!=null)if(q==="style"){var C=m[q];for(I in C)C.hasOwnProperty(I)&&(c||(c={}),c[I]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(s.hasOwnProperty(q)?y||(y=[]):(y=y||[]).push(q,null));for(q in h){var O=h[q];if(C=m?.[q],h.hasOwnProperty(q)&&O!==C&&(O!=null||C!=null))if(q==="style")if(C){for(I in C)!C.hasOwnProperty(I)||O&&O.hasOwnProperty(I)||(c||(c={}),c[I]="");for(I in O)O.hasOwnProperty(I)&&C[I]!==O[I]&&(c||(c={}),c[I]=O[I])}else c||(y||(y=[]),y.push(q,c)),c=O;else q==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,C=C?C.__html:void 0,O!=null&&C!==O&&(y=y||[]).push(q,O)):q==="children"?typeof O!="string"&&typeof O!="number"||(y=y||[]).push(q,""+O):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(s.hasOwnProperty(q)?(O!=null&&q==="onScroll"&&ft("scroll",i),y||C===O||(y=[])):(y=y||[]).push(q,O))}c&&(y=y||[]).push("style",c);var q=y;(o.updateQueue=q)&&(o.flags|=4)}},lE=function(i,o,c,h){c!==h&&(o.flags|=4)};function Qc(i,o){if(!yt)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function _n(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(o)for(var m=i.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=h,i.childLanes=c,o}function lR(i,o,c){var h=o.pendingProps;switch(cm(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(o),null;case 1:return Vn(o.type)&&lh(),_n(o),null;case 3:return h=o.stateNode,Xa(),pt(Dn),pt(gn),Im(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(fh(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xr!==null&&(Xm(xr),xr=null))),Bm(i,o),_n(o),null;case 5:wm(o);var m=Po(qc.current);if(c=o.type,i!==null&&o.stateNode!=null)aE(i,o,c,h,m),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return _n(o),null}if(i=Po(Xr.current),fh(o)){h=o.stateNode,c=o.type;var y=o.memoizedProps;switch(h[Yr]=o,h[jc]=y,i=(o.mode&1)!==0,c){case"dialog":ft("cancel",h),ft("close",h);break;case"iframe":case"object":case"embed":ft("load",h);break;case"video":case"audio":for(m=0;m<Lc.length;m++)ft(Lc[m],h);break;case"source":ft("error",h);break;case"img":case"image":case"link":ft("error",h),ft("load",h);break;case"details":ft("toggle",h);break;case"input":bt(h,y),ft("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},ft("invalid",h);break;case"textarea":uc(h,y),ft("invalid",h)}wr(c,y),m=null;for(var I in y)if(y.hasOwnProperty(I)){var C=y[I];I==="children"?typeof C=="string"?h.textContent!==C&&(y.suppressHydrationWarning!==!0&&ih(h.textContent,C,i),m=["children",C]):typeof C=="number"&&h.textContent!==""+C&&(y.suppressHydrationWarning!==!0&&ih(h.textContent,C,i),m=["children",""+C]):s.hasOwnProperty(I)&&C!=null&&I==="onScroll"&&ft("scroll",h)}switch(c){case"input":Zs(h),Lr(h,y,!0);break;case"textarea":Zs(h),ei(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=oh)}h=m,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=dc(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(c,{is:h.is}):(i=I.createElement(c),c==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,c),i[Yr]=o,i[jc]=h,oE(i,o,!1,!1),o.stateNode=i;e:{switch(I=Ea(c,h),c){case"dialog":ft("cancel",i),ft("close",i),m=h;break;case"iframe":case"object":case"embed":ft("load",i),m=h;break;case"video":case"audio":for(m=0;m<Lc.length;m++)ft(Lc[m],i);m=h;break;case"source":ft("error",i),m=h;break;case"img":case"image":case"link":ft("error",i),ft("load",i),m=h;break;case"details":ft("toggle",i),m=h;break;case"input":bt(i,h),m=lt(i,h),ft("invalid",i);break;case"option":m=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},m=de({},h,{value:void 0}),ft("invalid",i);break;case"textarea":uc(i,h),m=lo(i,h),ft("invalid",i);break;default:m=h}wr(c,m),C=m;for(y in C)if(C.hasOwnProperty(y)){var O=C[y];y==="style"?wa(i,O):y==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,O!=null&&Dd(i,O)):y==="children"?typeof O=="string"?(c!=="textarea"||O!=="")&&co(i,O):typeof O=="number"&&co(i,""+O):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?O!=null&&y==="onScroll"&&ft("scroll",i):O!=null&&Q(i,y,O,I))}switch(c){case"input":Zs(i),Lr(i,h,!1);break;case"textarea":Zs(i),ei(i);break;case"option":h.value!=null&&i.setAttribute("value",""+We(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?Nn(i,!!h.multiple,y,!1):h.defaultValue!=null&&Nn(i,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=oh)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return _n(o),null;case 6:if(i&&o.stateNode!=null)lE(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(c=Po(qc.current),Po(Xr.current),fh(o)){if(h=o.stateNode,c=o.memoizedProps,h[Yr]=o,(y=h.nodeValue!==c)&&(i=Xn,i!==null))switch(i.tag){case 3:ih(h.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&ih(h.nodeValue,c,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Yr]=o,o.stateNode=h}return _n(o),null;case 13:if(pt(Et),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(yt&&Zn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)dw(),Ka(),o.flags|=98560,y=!1;else if(y=fh(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Yr]=o}else Ka(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_n(o),y=!1}else xr!==null&&(Xm(xr),xr=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=c,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Et.current&1)!==0?Ht===0&&(Ht=3):tg())),o.updateQueue!==null&&(o.flags|=4),_n(o),null);case 4:return Xa(),Bm(i,o),i===null&&Mc(o.stateNode.containerInfo),_n(o),null;case 10:return mm(o.type._context),_n(o),null;case 17:return Vn(o.type)&&lh(),_n(o),null;case 19:if(pt(Et),y=o.memoizedState,y===null)return _n(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Qc(y,!1);else{if(Ht!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=vh(i),I!==null){for(o.flags|=128,Qc(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=c,c=o.child;c!==null;)y=c,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return ct(Et,Et.current&1|2),o.child}i=i.sibling}y.tail!==null&&ht()>nl&&(o.flags|=128,h=!0,Qc(y,!1),o.lanes=4194304)}else{if(!h)if(i=vh(I),i!==null){if(o.flags|=128,h=!0,c=i.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Qc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!yt)return _n(o),null}else 2*ht()-y.renderingStartTime>nl&&c!==1073741824&&(o.flags|=128,h=!0,Qc(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(c=y.last,c!==null?c.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=ht(),o.sibling=null,c=Et.current,ct(Et,h?c&1|2:c&1),o):(_n(o),null);case 22:case 23:return eg(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(er&1073741824)!==0&&(_n(o),o.subtreeFlags&6&&(o.flags|=8192)):_n(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function cR(i,o){switch(cm(o),o.tag){case 1:return Vn(o.type)&&lh(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Xa(),pt(Dn),pt(gn),Im(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return wm(o),null;case 13:if(pt(Et),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Ka()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return pt(Et),null;case 4:return Xa(),null;case 10:return mm(o.type._context),null;case 22:case 23:return eg(),null;case 24:return null;default:return null}}var Rh=!1,vn=!1,uR=typeof WeakSet=="function"?WeakSet:Set,ye=null;function el(i,o){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Pt(i,o,h)}else c.current=null}function zm(i,o,c){try{c()}catch(h){Pt(i,o,h)}}var cE=!1;function dR(i,o){if(em=Rs,i=Bv(),Hp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var I=0,C=-1,O=-1,q=0,ee=0,re=i,X=null;t:for(;;){for(var ge;re!==c||m!==0&&re.nodeType!==3||(C=I+m),re!==y||h!==0&&re.nodeType!==3||(O=I+h),re.nodeType===3&&(I+=re.nodeValue.length),(ge=re.firstChild)!==null;)X=re,re=ge;for(;;){if(re===i)break t;if(X===c&&++q===m&&(C=I),X===y&&++ee===h&&(O=I),(ge=re.nextSibling)!==null)break;re=X,X=re.parentNode}re=ge}c=C===-1||O===-1?null:{start:C,end:O}}else c=null}c=c||{start:0,end:0}}else c=null;for(tm={focusedElem:i,selectionRange:c},Rs=!1,ye=o;ye!==null;)if(o=ye,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,ye=i;else for(;ye!==null;){o=ye;try{var _e=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(_e!==null){var Ee=_e.memoizedProps,Vt=_e.memoizedState,B=o.stateNode,F=B.getSnapshotBeforeUpdate(o.elementType===o.type?Ee:Sr(o.type,Ee),Vt);B.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var $=o.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(oe){Pt(o,o.return,oe)}if(i=o.sibling,i!==null){i.return=o.return,ye=i;break}ye=o.return}return _e=cE,cE=!1,_e}function Jc(i,o,c){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&i)===i){var y=m.destroy;m.destroy=void 0,y!==void 0&&zm(o,c,y)}m=m.next}while(m!==h)}}function Ph(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&i)===i){var h=c.create;c.destroy=h()}c=c.next}while(c!==o)}}function $m(i){var o=i.ref;if(o!==null){var c=i.stateNode;i.tag,i=c,typeof o=="function"?o(i):o.current=i}}function uE(i){var o=i.alternate;o!==null&&(i.alternate=null,uE(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Yr],delete o[jc],delete o[im],delete o[GA],delete o[KA])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function dE(i){return i.tag===5||i.tag===3||i.tag===4}function hE(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||dE(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function qm(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(i,o):c.insertBefore(i,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(i,c)):(o=c,o.appendChild(i)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=oh));else if(h!==4&&(i=i.child,i!==null))for(qm(i,o,c),i=i.sibling;i!==null;)qm(i,o,c),i=i.sibling}function Wm(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(Wm(i,o,c),i=i.sibling;i!==null;)Wm(i,o,c),i=i.sibling}var ln=null,br=!1;function Ii(i,o,c){for(c=c.child;c!==null;)fE(i,o,c),c=c.sibling}function fE(i,o,c){if(Hn&&typeof Hn.onCommitFiberUnmount=="function")try{Hn.onCommitFiberUnmount(mo,c)}catch{}switch(c.tag){case 5:vn||el(c,o);case 6:var h=ln,m=br;ln=null,Ii(i,o,c),ln=h,br=m,ln!==null&&(br?(i=ln,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):ln.removeChild(c.stateNode));break;case 18:ln!==null&&(br?(i=ln,c=c.stateNode,i.nodeType===8?sm(i.parentNode,c):i.nodeType===1&&sm(i,c),hi(i)):sm(ln,c.stateNode));break;case 4:h=ln,m=br,ln=c.stateNode.containerInfo,br=!0,Ii(i,o,c),ln=h,br=m;break;case 0:case 11:case 14:case 15:if(!vn&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var y=m,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&zm(c,o,I),m=m.next}while(m!==h)}Ii(i,o,c);break;case 1:if(!vn&&(el(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(C){Pt(c,o,C)}Ii(i,o,c);break;case 21:Ii(i,o,c);break;case 22:c.mode&1?(vn=(h=vn)||c.memoizedState!==null,Ii(i,o,c),vn=h):Ii(i,o,c);break;default:Ii(i,o,c)}}function pE(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new uR),o.forEach(function(h){var m=wR.bind(null,i,h);c.has(h)||(c.add(h),h.then(m,m))})}}function Ar(i,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var m=c[h];try{var y=i,I=o,C=I;e:for(;C!==null;){switch(C.tag){case 5:ln=C.stateNode,br=!1;break e;case 3:ln=C.stateNode.containerInfo,br=!0;break e;case 4:ln=C.stateNode.containerInfo,br=!0;break e}C=C.return}if(ln===null)throw Error(t(160));fE(y,I,m),ln=null,br=!1;var O=m.alternate;O!==null&&(O.return=null),m.return=null}catch(q){Pt(m,o,q)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)mE(o,i),o=o.sibling}function mE(i,o){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Ar(o,i),es(i),h&4){try{Jc(3,i,i.return),Ph(3,i)}catch(Ee){Pt(i,i.return,Ee)}try{Jc(5,i,i.return)}catch(Ee){Pt(i,i.return,Ee)}}break;case 1:Ar(o,i),es(i),h&512&&c!==null&&el(c,c.return);break;case 5:if(Ar(o,i),es(i),h&512&&c!==null&&el(c,c.return),i.flags&32){var m=i.stateNode;try{co(m,"")}catch(Ee){Pt(i,i.return,Ee)}}if(h&4&&(m=i.stateNode,m!=null)){var y=i.memoizedProps,I=c!==null?c.memoizedProps:y,C=i.type,O=i.updateQueue;if(i.updateQueue=null,O!==null)try{C==="input"&&y.type==="radio"&&y.name!=null&&sn(m,y),Ea(C,I);var q=Ea(C,y);for(I=0;I<O.length;I+=2){var ee=O[I],re=O[I+1];ee==="style"?wa(m,re):ee==="dangerouslySetInnerHTML"?Dd(m,re):ee==="children"?co(m,re):Q(m,ee,re,q)}switch(C){case"input":jt(m,y);break;case"textarea":Nd(m,y);break;case"select":var X=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var ge=y.value;ge!=null?Nn(m,!!y.multiple,ge,!1):X!==!!y.multiple&&(y.defaultValue!=null?Nn(m,!!y.multiple,y.defaultValue,!0):Nn(m,!!y.multiple,y.multiple?[]:"",!1))}m[jc]=y}catch(Ee){Pt(i,i.return,Ee)}}break;case 6:if(Ar(o,i),es(i),h&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,y=i.memoizedProps;try{m.nodeValue=y}catch(Ee){Pt(i,i.return,Ee)}}break;case 3:if(Ar(o,i),es(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{hi(o.containerInfo)}catch(Ee){Pt(i,i.return,Ee)}break;case 4:Ar(o,i),es(i);break;case 13:Ar(o,i),es(i),m=i.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(Km=ht())),h&4&&pE(i);break;case 22:if(ee=c!==null&&c.memoizedState!==null,i.mode&1?(vn=(q=vn)||ee,Ar(o,i),vn=q):Ar(o,i),es(i),h&8192){if(q=i.memoizedState!==null,(i.stateNode.isHidden=q)&&!ee&&(i.mode&1)!==0)for(ye=i,ee=i.child;ee!==null;){for(re=ye=ee;ye!==null;){switch(X=ye,ge=X.child,X.tag){case 0:case 11:case 14:case 15:Jc(4,X,X.return);break;case 1:el(X,X.return);var _e=X.stateNode;if(typeof _e.componentWillUnmount=="function"){h=X,c=X.return;try{o=h,_e.props=o.memoizedProps,_e.state=o.memoizedState,_e.componentWillUnmount()}catch(Ee){Pt(h,c,Ee)}}break;case 5:el(X,X.return);break;case 22:if(X.memoizedState!==null){_E(re);continue}}ge!==null?(ge.return=X,ye=ge):_E(re)}ee=ee.sibling}e:for(ee=null,re=i;;){if(re.tag===5){if(ee===null){ee=re;try{m=re.stateNode,q?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(C=re.stateNode,O=re.memoizedProps.style,I=O!=null&&O.hasOwnProperty("display")?O.display:null,C.style.display=ri("display",I))}catch(Ee){Pt(i,i.return,Ee)}}}else if(re.tag===6){if(ee===null)try{re.stateNode.nodeValue=q?"":re.memoizedProps}catch(Ee){Pt(i,i.return,Ee)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===i)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===i)break e;for(;re.sibling===null;){if(re.return===null||re.return===i)break e;ee===re&&(ee=null),re=re.return}ee===re&&(ee=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:Ar(o,i),es(i),h&4&&pE(i);break;case 21:break;default:Ar(o,i),es(i)}}function es(i){var o=i.flags;if(o&2){try{e:{for(var c=i.return;c!==null;){if(dE(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(co(m,""),h.flags&=-33);var y=hE(i);Wm(i,y,m);break;case 3:case 4:var I=h.stateNode.containerInfo,C=hE(i);qm(i,C,I);break;default:throw Error(t(161))}}catch(O){Pt(i,i.return,O)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function hR(i,o,c){ye=i,gE(i)}function gE(i,o,c){for(var h=(i.mode&1)!==0;ye!==null;){var m=ye,y=m.child;if(m.tag===22&&h){var I=m.memoizedState!==null||Rh;if(!I){var C=m.alternate,O=C!==null&&C.memoizedState!==null||vn;C=Rh;var q=vn;if(Rh=I,(vn=O)&&!q)for(ye=m;ye!==null;)I=ye,O=I.child,I.tag===22&&I.memoizedState!==null?vE(m):O!==null?(O.return=I,ye=O):vE(m);for(;y!==null;)ye=y,gE(y),y=y.sibling;ye=m,Rh=C,vn=q}yE(i)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,ye=y):yE(i)}}function yE(i){for(;ye!==null;){var o=ye;if((o.flags&8772)!==0){var c=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:vn||Ph(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!vn)if(c===null)h.componentDidMount();else{var m=o.elementType===o.type?c.memoizedProps:Sr(o.type,c.memoizedProps);h.componentDidUpdate(m,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&_w(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}_w(o,I,c)}break;case 5:var C=o.stateNode;if(c===null&&o.flags&4){c=C;var O=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":O.autoFocus&&c.focus();break;case"img":O.src&&(c.src=O.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var q=o.alternate;if(q!==null){var ee=q.memoizedState;if(ee!==null){var re=ee.dehydrated;re!==null&&hi(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}vn||o.flags&512&&$m(o)}catch(X){Pt(o,o.return,X)}}if(o===i){ye=null;break}if(c=o.sibling,c!==null){c.return=o.return,ye=c;break}ye=o.return}}function _E(i){for(;ye!==null;){var o=ye;if(o===i){ye=null;break}var c=o.sibling;if(c!==null){c.return=o.return,ye=c;break}ye=o.return}}function vE(i){for(;ye!==null;){var o=ye;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{Ph(4,o)}catch(O){Pt(o,c,O)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var m=o.return;try{h.componentDidMount()}catch(O){Pt(o,m,O)}}var y=o.return;try{$m(o)}catch(O){Pt(o,y,O)}break;case 5:var I=o.return;try{$m(o)}catch(O){Pt(o,I,O)}}}catch(O){Pt(o,o.return,O)}if(o===i){ye=null;break}var C=o.sibling;if(C!==null){C.return=o.return,ye=C;break}ye=o.return}}var fR=Math.ceil,kh=pe.ReactCurrentDispatcher,Hm=pe.ReactCurrentOwner,fr=pe.ReactCurrentBatchConfig,Ke=0,Yt=null,Bt=null,cn=0,er=0,tl=yi(0),Ht=0,Yc=null,Co=0,Ch=0,Gm=0,Xc=null,Ln=null,Km=0,nl=1/0,Fs=null,Nh=!1,Qm=null,Ti=null,Dh=!1,xi=null,Vh=0,Zc=0,Jm=null,Oh=-1,Lh=0;function An(){return(Ke&6)!==0?ht():Oh!==-1?Oh:Oh=ht()}function Si(i){return(i.mode&1)===0?1:(Ke&2)!==0&&cn!==0?cn&-cn:JA.transition!==null?(Lh===0&&(Lh=wc()),Lh):(i=He,i!==0||(i=window.event,i=i===void 0?16:Ca(i.type)),i)}function Rr(i,o,c,h){if(50<Zc)throw Zc=0,Jm=null,Error(t(185));vo(i,c,h),((Ke&2)===0||i!==Yt)&&(i===Yt&&((Ke&2)===0&&(Ch|=c),Ht===4&&bi(i,cn)),Mn(i,h),c===1&&Ke===0&&(o.mode&1)===0&&(nl=ht()+500,uh&&vi()))}function Mn(i,o){var c=i.callbackNode;_o(i,o);var h=Ss(i,i===Yt?cn:0);if(h===0)c!==null&&xa(c),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(c!=null&&xa(c),o===1)i.tag===0?QA(EE.bind(null,i)):ow(EE.bind(null,i)),WA(function(){(Ke&6)===0&&vi()}),c=null;else{switch(Br(h)){case 1:c=Sa;break;case 4:c=yc;break;case 16:c=po;break;case 536870912:c=ba;break;default:c=po}c=PE(c,wE.bind(null,i))}i.callbackPriority=o,i.callbackNode=c}}function wE(i,o){if(Oh=-1,Lh=0,(Ke&6)!==0)throw Error(t(327));var c=i.callbackNode;if(rl()&&i.callbackNode!==c)return null;var h=Ss(i,i===Yt?cn:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=Mh(i,h);else{o=h;var m=Ke;Ke|=2;var y=TE();(Yt!==i||cn!==o)&&(Fs=null,nl=ht()+500,Do(i,o));do try{gR();break}catch(C){IE(i,C)}while(!0);pm(),kh.current=y,Ke=m,Bt!==null?o=0:(Yt=null,cn=0,o=Ht)}if(o!==0){if(o===2&&(m=vc(i),m!==0&&(h=m,o=Ym(i,m))),o===1)throw c=Yc,Do(i,0),bi(i,h),Mn(i,ht()),c;if(o===6)bi(i,h);else{if(m=i.current.alternate,(h&30)===0&&!pR(m)&&(o=Mh(i,h),o===2&&(y=vc(i),y!==0&&(h=y,o=Ym(i,y))),o===1))throw c=Yc,Do(i,0),bi(i,h),Mn(i,ht()),c;switch(i.finishedWork=m,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:Vo(i,Ln,Fs);break;case 3:if(bi(i,h),(h&130023424)===h&&(o=Km+500-ht(),10<o)){if(Ss(i,0)!==0)break;if(m=i.suspendedLanes,(m&h)!==h){An(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=rm(Vo.bind(null,i,Ln,Fs),o);break}Vo(i,Ln,Fs);break;case 4:if(bi(i,h),(h&4194240)===h)break;for(o=i.eventTimes,m=-1;0<h;){var I=31-Gn(h);y=1<<I,I=o[I],I>m&&(m=I),h&=~y}if(h=m,h=ht()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*fR(h/1960))-h,10<h){i.timeoutHandle=rm(Vo.bind(null,i,Ln,Fs),h);break}Vo(i,Ln,Fs);break;case 5:Vo(i,Ln,Fs);break;default:throw Error(t(329))}}}return Mn(i,ht()),i.callbackNode===c?wE.bind(null,i):null}function Ym(i,o){var c=Xc;return i.current.memoizedState.isDehydrated&&(Do(i,o).flags|=256),i=Mh(i,o),i!==2&&(o=Ln,Ln=c,o!==null&&Xm(o)),i}function Xm(i){Ln===null?Ln=i:Ln.push.apply(Ln,i)}function pR(i){for(var o=i;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var m=c[h],y=m.getSnapshot;m=m.value;try{if(!Tr(y(),m))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function bi(i,o){for(o&=~Gm,o&=~Ch,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var c=31-Gn(o),h=1<<c;i[c]=-1,o&=~h}}function EE(i){if((Ke&6)!==0)throw Error(t(327));rl();var o=Ss(i,0);if((o&1)===0)return Mn(i,ht()),null;var c=Mh(i,o);if(i.tag!==0&&c===2){var h=vc(i);h!==0&&(o=h,c=Ym(i,h))}if(c===1)throw c=Yc,Do(i,0),bi(i,o),Mn(i,ht()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Vo(i,Ln,Fs),Mn(i,ht()),null}function Zm(i,o){var c=Ke;Ke|=1;try{return i(o)}finally{Ke=c,Ke===0&&(nl=ht()+500,uh&&vi())}}function No(i){xi!==null&&xi.tag===0&&(Ke&6)===0&&rl();var o=Ke;Ke|=1;var c=fr.transition,h=He;try{if(fr.transition=null,He=1,i)return i()}finally{He=h,fr.transition=c,Ke=o,(Ke&6)===0&&vi()}}function eg(){er=tl.current,pt(tl)}function Do(i,o){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,qA(c)),Bt!==null)for(c=Bt.return;c!==null;){var h=c;switch(cm(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&lh();break;case 3:Xa(),pt(Dn),pt(gn),Im();break;case 5:wm(h);break;case 4:Xa();break;case 13:pt(Et);break;case 19:pt(Et);break;case 10:mm(h.type._context);break;case 22:case 23:eg()}c=c.return}if(Yt=i,Bt=i=Ai(i.current,null),cn=er=o,Ht=0,Yc=null,Gm=Ch=Co=0,Ln=Xc=null,Ro!==null){for(o=0;o<Ro.length;o++)if(c=Ro[o],h=c.interleaved,h!==null){c.interleaved=null;var m=h.next,y=c.pending;if(y!==null){var I=y.next;y.next=m,h.next=I}c.pending=h}Ro=null}return i}function IE(i,o){do{var c=Bt;try{if(pm(),wh.current=xh,Eh){for(var h=It.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}Eh=!1}if(ko=0,Jt=Wt=It=null,Wc=!1,Hc=0,Hm.current=null,c===null||c.return===null){Ht=1,Yc=o,Bt=null;break}e:{var y=i,I=c.return,C=c,O=o;if(o=cn,C.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){var q=O,ee=C,re=ee.tag;if((ee.mode&1)===0&&(re===0||re===11||re===15)){var X=ee.alternate;X?(ee.updateQueue=X.updateQueue,ee.memoizedState=X.memoizedState,ee.lanes=X.lanes):(ee.updateQueue=null,ee.memoizedState=null)}var ge=Gw(I);if(ge!==null){ge.flags&=-257,Kw(ge,I,C,y,o),ge.mode&1&&Hw(y,q,o),o=ge,O=q;var _e=o.updateQueue;if(_e===null){var Ee=new Set;Ee.add(O),o.updateQueue=Ee}else _e.add(O);break e}else{if((o&1)===0){Hw(y,q,o),tg();break e}O=Error(t(426))}}else if(yt&&C.mode&1){var Vt=Gw(I);if(Vt!==null){(Vt.flags&65536)===0&&(Vt.flags|=256),Kw(Vt,I,C,y,o),hm(Za(O,C));break e}}y=O=Za(O,C),Ht!==4&&(Ht=2),Xc===null?Xc=[y]:Xc.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var B=qw(y,O,o);yw(y,B);break e;case 1:C=O;var F=y.type,$=y.stateNode;if((y.flags&128)===0&&(typeof F.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Ti===null||!Ti.has($)))){y.flags|=65536,o&=-o,y.lanes|=o;var oe=Ww(y,C,o);yw(y,oe);break e}}y=y.return}while(y!==null)}SE(c)}catch(Ie){o=Ie,Bt===c&&c!==null&&(Bt=c=c.return);continue}break}while(!0)}function TE(){var i=kh.current;return kh.current=xh,i===null?xh:i}function tg(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Yt===null||(Co&268435455)===0&&(Ch&268435455)===0||bi(Yt,cn)}function Mh(i,o){var c=Ke;Ke|=2;var h=TE();(Yt!==i||cn!==o)&&(Fs=null,Do(i,o));do try{mR();break}catch(m){IE(i,m)}while(!0);if(pm(),Ke=c,kh.current=h,Bt!==null)throw Error(t(261));return Yt=null,cn=0,Ht}function mR(){for(;Bt!==null;)xE(Bt)}function gR(){for(;Bt!==null&&!fo();)xE(Bt)}function xE(i){var o=RE(i.alternate,i,er);i.memoizedProps=i.pendingProps,o===null?SE(i):Bt=o,Hm.current=null}function SE(i){var o=i;do{var c=o.alternate;if(i=o.return,(o.flags&32768)===0){if(c=lR(c,o,er),c!==null){Bt=c;return}}else{if(c=cR(c,o),c!==null){c.flags&=32767,Bt=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ht=6,Bt=null;return}}if(o=o.sibling,o!==null){Bt=o;return}Bt=o=i}while(o!==null);Ht===0&&(Ht=5)}function Vo(i,o,c){var h=He,m=fr.transition;try{fr.transition=null,He=1,yR(i,o,c,h)}finally{fr.transition=m,He=h}return null}function yR(i,o,c,h){do rl();while(xi!==null);if((Ke&6)!==0)throw Error(t(327));c=i.finishedWork;var m=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=c.lanes|c.childLanes;if(Bp(i,y),i===Yt&&(Bt=Yt=null,cn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Dh||(Dh=!0,PE(po,function(){return rl(),null})),y=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||y){y=fr.transition,fr.transition=null;var I=He;He=1;var C=Ke;Ke|=4,Hm.current=null,dR(i,c),mE(c,i),MA(tm),Rs=!!em,tm=em=null,i.current=c,hR(c),xs(),Ke=C,He=I,fr.transition=y}else i.current=c;if(Dh&&(Dh=!1,xi=i,Vh=m),y=i.pendingLanes,y===0&&(Ti=null),qd(c.stateNode),Mn(i,ht()),o!==null)for(h=i.onRecoverableError,c=0;c<o.length;c++)m=o[c],h(m.value,{componentStack:m.stack,digest:m.digest});if(Nh)throw Nh=!1,i=Qm,Qm=null,i;return(Vh&1)!==0&&i.tag!==0&&rl(),y=i.pendingLanes,(y&1)!==0?i===Jm?Zc++:(Zc=0,Jm=i):Zc=0,vi(),null}function rl(){if(xi!==null){var i=Br(Vh),o=fr.transition,c=He;try{if(fr.transition=null,He=16>i?16:i,xi===null)var h=!1;else{if(i=xi,xi=null,Vh=0,(Ke&6)!==0)throw Error(t(331));var m=Ke;for(Ke|=4,ye=i.current;ye!==null;){var y=ye,I=y.child;if((ye.flags&16)!==0){var C=y.deletions;if(C!==null){for(var O=0;O<C.length;O++){var q=C[O];for(ye=q;ye!==null;){var ee=ye;switch(ee.tag){case 0:case 11:case 15:Jc(8,ee,y)}var re=ee.child;if(re!==null)re.return=ee,ye=re;else for(;ye!==null;){ee=ye;var X=ee.sibling,ge=ee.return;if(uE(ee),ee===q){ye=null;break}if(X!==null){X.return=ge,ye=X;break}ye=ge}}}var _e=y.alternate;if(_e!==null){var Ee=_e.child;if(Ee!==null){_e.child=null;do{var Vt=Ee.sibling;Ee.sibling=null,Ee=Vt}while(Ee!==null)}}ye=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,ye=I;else e:for(;ye!==null;){if(y=ye,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Jc(9,y,y.return)}var B=y.sibling;if(B!==null){B.return=y.return,ye=B;break e}ye=y.return}}var F=i.current;for(ye=F;ye!==null;){I=ye;var $=I.child;if((I.subtreeFlags&2064)!==0&&$!==null)$.return=I,ye=$;else e:for(I=F;ye!==null;){if(C=ye,(C.flags&2048)!==0)try{switch(C.tag){case 0:case 11:case 15:Ph(9,C)}}catch(Ie){Pt(C,C.return,Ie)}if(C===I){ye=null;break e}var oe=C.sibling;if(oe!==null){oe.return=C.return,ye=oe;break e}ye=C.return}}if(Ke=m,vi(),Hn&&typeof Hn.onPostCommitFiberRoot=="function")try{Hn.onPostCommitFiberRoot(mo,i)}catch{}h=!0}return h}finally{He=c,fr.transition=o}}return!1}function bE(i,o,c){o=Za(c,o),o=qw(i,o,1),i=Ei(i,o,1),o=An(),i!==null&&(vo(i,1,o),Mn(i,o))}function Pt(i,o,c){if(i.tag===3)bE(i,i,c);else for(;o!==null;){if(o.tag===3){bE(o,i,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ti===null||!Ti.has(h))){i=Za(c,i),i=Ww(o,i,1),o=Ei(o,i,1),i=An(),o!==null&&(vo(o,1,i),Mn(o,i));break}}o=o.return}}function _R(i,o,c){var h=i.pingCache;h!==null&&h.delete(o),o=An(),i.pingedLanes|=i.suspendedLanes&c,Yt===i&&(cn&c)===c&&(Ht===4||Ht===3&&(cn&130023424)===cn&&500>ht()-Km?Do(i,0):Gm|=c),Mn(i,o)}function AE(i,o){o===0&&((i.mode&1)===0?o=1:(o=ci,ci<<=1,(ci&130023424)===0&&(ci=4194304)));var c=An();i=Os(i,o),i!==null&&(vo(i,o,c),Mn(i,c))}function vR(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),AE(i,c)}function wR(i,o){var c=0;switch(i.tag){case 13:var h=i.stateNode,m=i.memoizedState;m!==null&&(c=m.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),AE(i,c)}var RE;RE=function(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps||Dn.current)On=!0;else{if((i.lanes&c)===0&&(o.flags&128)===0)return On=!1,aR(i,o,c);On=(i.flags&131072)!==0}else On=!1,yt&&(o.flags&1048576)!==0&&aw(o,hh,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;Ah(i,o),i=o.pendingProps;var m=Wa(o,gn.current);Ya(o,c),m=Sm(null,o,h,i,m,c);var y=bm();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Vn(h)?(y=!0,ch(o)):y=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,_m(o),m.updater=Sh,o.stateNode=m,m._reactInternals=o,Nm(o,h,i,c),o=Lm(null,o,h,!0,y,c)):(o.tag=0,yt&&y&&lm(o),bn(null,o,m,c),o=o.child),o;case 16:h=o.elementType;e:{switch(Ah(i,o),i=o.pendingProps,m=h._init,h=m(h._payload),o.type=h,m=o.tag=IR(h),i=Sr(h,i),m){case 0:o=Om(null,o,h,i,c);break e;case 1:o=eE(null,o,h,i,c);break e;case 11:o=Qw(null,o,h,i,c);break e;case 14:o=Jw(null,o,h,Sr(h.type,i),c);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Om(i,o,h,m,c);case 1:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),eE(i,o,h,m,c);case 3:e:{if(tE(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,m=y.element,gw(i,o),_h(o,h,null,c);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){m=Za(Error(t(423)),o),o=nE(i,o,h,c,m);break e}else if(h!==m){m=Za(Error(t(424)),o),o=nE(i,o,h,c,m);break e}else for(Zn=gi(o.stateNode.containerInfo.firstChild),Xn=o,yt=!0,xr=null,c=pw(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Ka(),h===m){o=Ms(i,o,c);break e}bn(i,o,h,c)}o=o.child}return o;case 5:return vw(o),i===null&&dm(o),h=o.type,m=o.pendingProps,y=i!==null?i.memoizedProps:null,I=m.children,nm(h,m)?I=null:y!==null&&nm(h,y)&&(o.flags|=32),Zw(i,o),bn(i,o,I,c),o.child;case 6:return i===null&&dm(o),null;case 13:return rE(i,o,c);case 4:return vm(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=Qa(o,null,h,c):bn(i,o,h,c),o.child;case 11:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Qw(i,o,h,m,c);case 7:return bn(i,o,o.pendingProps,c),o.child;case 8:return bn(i,o,o.pendingProps.children,c),o.child;case 12:return bn(i,o,o.pendingProps.children,c),o.child;case 10:e:{if(h=o.type._context,m=o.pendingProps,y=o.memoizedProps,I=m.value,ct(mh,h._currentValue),h._currentValue=I,y!==null)if(Tr(y.value,I)){if(y.children===m.children&&!Dn.current){o=Ms(i,o,c);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var C=y.dependencies;if(C!==null){I=y.child;for(var O=C.firstContext;O!==null;){if(O.context===h){if(y.tag===1){O=Ls(-1,c&-c),O.tag=2;var q=y.updateQueue;if(q!==null){q=q.shared;var ee=q.pending;ee===null?O.next=O:(O.next=ee.next,ee.next=O),q.pending=O}}y.lanes|=c,O=y.alternate,O!==null&&(O.lanes|=c),gm(y.return,c,o),C.lanes|=c;break}O=O.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=c,C=I.alternate,C!==null&&(C.lanes|=c),gm(I,c,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}bn(i,o,m.children,c),o=o.child}return o;case 9:return m=o.type,h=o.pendingProps.children,Ya(o,c),m=dr(m),h=h(m),o.flags|=1,bn(i,o,h,c),o.child;case 14:return h=o.type,m=Sr(h,o.pendingProps),m=Sr(h.type,m),Jw(i,o,h,m,c);case 15:return Yw(i,o,o.type,o.pendingProps,c);case 17:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:Sr(h,m),Ah(i,o),o.tag=1,Vn(h)?(i=!0,ch(o)):i=!1,Ya(o,c),zw(o,h,m),Nm(o,h,m,c),Lm(null,o,h,!0,i,c);case 19:return iE(i,o,c);case 22:return Xw(i,o,c)}throw Error(t(156,o.tag))};function PE(i,o){return gc(i,o)}function ER(i,o,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(i,o,c,h){return new ER(i,o,c,h)}function ng(i){return i=i.prototype,!(!i||!i.isReactComponent)}function IR(i){if(typeof i=="function")return ng(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===tt)return 14}return 2}function Ai(i,o){var c=i.alternate;return c===null?(c=pr(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Fh(i,o,c,h,m,y){var I=2;if(h=i,typeof i=="function")ng(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case b:return Oo(c.children,m,y,o);case S:I=8,m|=8;break;case k:return i=pr(12,c,o,m|2),i.elementType=k,i.lanes=y,i;case P:return i=pr(13,c,o,m),i.elementType=P,i.lanes=y,i;case Ce:return i=pr(19,c,o,m),i.elementType=Ce,i.lanes=y,i;case ue:return jh(c,m,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case D:I=10;break e;case R:I=9;break e;case M:I=11;break e;case tt:I=14;break e;case $e:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=pr(I,c,o,m),o.elementType=i,o.type=h,o.lanes=y,o}function Oo(i,o,c,h){return i=pr(7,i,h,o),i.lanes=c,i}function jh(i,o,c,h){return i=pr(22,i,h,o),i.elementType=ue,i.lanes=c,i.stateNode={isHidden:!1},i}function rg(i,o,c){return i=pr(6,i,null,o),i.lanes=c,i}function sg(i,o,c){return o=pr(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function TR(i,o,c,h,m){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ec(0),this.expirationTimes=Ec(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ec(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function ig(i,o,c,h,m,y,I,C,O){return i=new TR(i,o,c,C,O),o===1?(o=1,y===!0&&(o|=8)):o=0,y=pr(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},_m(y),i}function xR(i,o,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ae,key:h==null?null:""+h,children:i,containerInfo:o,implementation:c}}function kE(i){if(!i)return _i;i=i._reactInternals;e:{if(Er(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Vn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(Vn(c))return sw(i,c,o)}return o}function CE(i,o,c,h,m,y,I,C,O){return i=ig(c,h,!0,i,m,y,I,C,O),i.context=kE(null),c=i.current,h=An(),m=Si(c),y=Ls(h,m),y.callback=o??null,Ei(c,y,m),i.current.lanes=m,vo(i,m,h),Mn(i,h),i}function Uh(i,o,c,h){var m=o.current,y=An(),I=Si(m);return c=kE(c),o.context===null?o.context=c:o.pendingContext=c,o=Ls(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=Ei(m,o,I),i!==null&&(Rr(i,m,I,y),yh(i,m,I)),I}function Bh(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function NE(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function og(i,o){NE(i,o),(i=i.alternate)&&NE(i,o)}function SR(){return null}var DE=typeof reportError=="function"?reportError:function(i){console.error(i)};function ag(i){this._internalRoot=i}zh.prototype.render=ag.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Uh(i,o,null,null)},zh.prototype.unmount=ag.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;No(function(){Uh(null,i,null,null)}),o[Cs]=null}};function zh(i){this._internalRoot=i}zh.prototype.unstable_scheduleHydration=function(i){if(i){var o=Sc();i={blockedOn:null,target:i,priority:o};for(var c=0;c<Kn.length&&o!==0&&o<Kn[c].priority;c++);Kn.splice(c,0,i),c===0&&Pa(i)}};function lg(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function $h(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function VE(){}function bR(i,o,c,h,m){if(m){if(typeof h=="function"){var y=h;h=function(){var q=Bh(I);y.call(q)}}var I=CE(o,h,i,0,null,!1,!1,"",VE);return i._reactRootContainer=I,i[Cs]=I.current,Mc(i.nodeType===8?i.parentNode:i),No(),I}for(;m=i.lastChild;)i.removeChild(m);if(typeof h=="function"){var C=h;h=function(){var q=Bh(O);C.call(q)}}var O=ig(i,0,!1,null,null,!1,!1,"",VE);return i._reactRootContainer=O,i[Cs]=O.current,Mc(i.nodeType===8?i.parentNode:i),No(function(){Uh(o,O,c,h)}),O}function qh(i,o,c,h,m){var y=c._reactRootContainer;if(y){var I=y;if(typeof m=="function"){var C=m;m=function(){var O=Bh(I);C.call(O)}}Uh(o,I,i,m)}else I=bR(c,o,i,m,h);return Bh(I)}Tc=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var c=et(o.pendingLanes);c!==0&&(Ic(o,c|1),Mn(o,ht()),(Ke&6)===0&&(nl=ht()+500,vi()))}break;case 13:No(function(){var h=Os(i,1);if(h!==null){var m=An();Rr(h,i,1,m)}}),og(i,1)}},Aa=function(i){if(i.tag===13){var o=Os(i,134217728);if(o!==null){var c=An();Rr(o,i,134217728,c)}og(i,134217728)}},xc=function(i){if(i.tag===13){var o=Si(i),c=Os(i,o);if(c!==null){var h=An();Rr(c,i,o,h)}og(i,o)}},Sc=function(){return He},bc=function(i,o){var c=He;try{return He=i,o()}finally{He=c}},Es=function(i,o,c){switch(o){case"input":if(jt(i,c),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==i&&h.form===i.form){var m=ah(h);if(!m)throw Error(t(90));Pe(h),jt(h,m)}}}break;case"textarea":Nd(i,c);break;case"select":o=c.value,o!=null&&Nn(i,!!c.multiple,o,!1)}},Od=Zm,Ld=No;var AR={usingClientEntryPoint:!1,Events:[Uc,$a,ah,ii,oi,Zm]},eu={findFiberByHostInstance:xo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RR={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pe.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=$d(i),i===null?null:i.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||SR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{mo=Wh.inject(RR),Hn=Wh}catch{}}return Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AR,Fn.createPortal=function(i,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lg(o))throw Error(t(200));return xR(i,o,null,c)},Fn.createRoot=function(i,o){if(!lg(i))throw Error(t(299));var c=!1,h="",m=DE;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=ig(i,1,!1,null,null,c,!1,h,m),i[Cs]=o.current,Mc(i.nodeType===8?i.parentNode:i),new ag(o)},Fn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=$d(o),i=i===null?null:i.stateNode,i},Fn.flushSync=function(i){return No(i)},Fn.hydrate=function(i,o,c){if(!$h(o))throw Error(t(200));return qh(null,i,o,!0,c)},Fn.hydrateRoot=function(i,o,c){if(!lg(i))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,m=!1,y="",I=DE;if(c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(I=c.onRecoverableError)),o=CE(o,null,i,1,c??null,m,!1,y,I),i[Cs]=o.current,Mc(i),h)for(i=0;i<h.length;i++)c=h[i],m=c._getVersion,m=m(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,m]:o.mutableSourceEagerHydrationData.push(c,m);return new zh(o)},Fn.render=function(i,o,c){if(!$h(o))throw Error(t(200));return qh(null,i,o,!1,c)},Fn.unmountComponentAtNode=function(i){if(!$h(i))throw Error(t(40));return i._reactRootContainer?(No(function(){qh(null,null,i,!1,function(){i._reactRootContainer=null,i[Cs]=null})}),!0):!1},Fn.unstable_batchedUpdates=Zm,Fn.unstable_renderSubtreeIntoContainer=function(i,o,c,h){if(!$h(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return qh(i,o,c,!1,h)},Fn.version="18.3.1-next-f1338f8080-20240426",Fn}var zE;function FR(){if(zE)return dg.exports;zE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dg.exports=MR(),dg.exports}var $E;function jR(){if($E)return Hh;$E=1;var n=FR();return Hh.createRoot=n.createRoot,Hh.hydrateRoot=n.hydrateRoot,Hh}var UR=jR();const BR="modulepreload",zR=function(n){return"/"+n},qE={},ss=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var l=p;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");s=p(t.map(g=>{if(g=zR(g),g in qE)return;qE[g]=!0;const w=g.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${T}`))return;const N=document.createElement("link");if(N.rel=w?"stylesheet":BR,w||(N.as="script"),N.crossOrigin="",N.href=g,f&&N.setAttribute("nonce",f),document.head.appendChild(N),w)return new Promise((A,L)=>{N.addEventListener("load",A),N.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return s.then(d=>{for(const f of d||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})};const $R=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qR=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),WE=n=>{const e=qR(n);return e.charAt(0).toUpperCase()+e.slice(1)},RT=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),WR=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var HR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const GR=he.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:l,...d},f)=>he.createElement("svg",{ref:f,...HR,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:RT("lucide",s),...!a&&!WR(d)&&{"aria-hidden":"true"},...d},[...l.map(([p,g])=>he.createElement(p,g)),...Array.isArray(a)?a:[a]]));const Qe=(n,e)=>{const t=he.forwardRef(({className:r,...s},a)=>he.createElement(GR,{ref:a,iconNode:e,className:RT(`lucide-${$R(WE(n))}`,`lucide-${n}`,r),...s}));return t.displayName=WE(n),t};const KR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Cy=Qe("arrow-right",KR);const QR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Mg=Qe("bell",QR);const JR=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],YR=Qe("book-open",JR);const XR=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],ZR=Qe("book",XR);const eP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],tP=Qe("calendar",eP);const nP=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],PT=Qe("camera",nP);const rP=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sP=Qe("chevron-down",rP);const iP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ny=Qe("chevron-left",iP);const oP=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kT=Qe("chevron-right",oP);const aP=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CT=Qe("circle-check-big",aP);const lP=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],NT=Qe("coins",lP);const cP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],uP=Qe("external-link",cP);const dP=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hP=Qe("eye",dP);const fP=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],pP=Qe("flame",fP);const mP=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],DT=Qe("gift",mP);const gP=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],HE=Qe("house",gP);const yP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_P=Qe("image",yP);const vP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],wP=Qe("log-out",vP);const EP=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],IP=Qe("mail",EP);const TP=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Lu=Qe("message-circle",TP);const xP=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],SP=Qe("palette",xP);const bP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],AP=Qe("plus",bP);const RP=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],VT=Qe("repeat",RP);const PP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],kP=Qe("search",PP);const CP=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],NP=Qe("send",CP);const DP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],VP=Qe("shield-check",DP);const OP=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],OT=Qe("sparkles",OP);const LP=[["path",{d:"M12 18.338a2.1 2.1 0 0 0-.987.244L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.12 2.12 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.12 2.12 0 0 0 1.597-1.16l2.309-4.679A.53.53 0 0 1 12 2",key:"2ksp49"}]],MP=Qe("star-half",LP);const FP=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],GE=Qe("star",FP);const jP=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],UP=Qe("store",jP);const BP=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zP=Qe("trash-2",BP);const $P=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],us=Qe("x",$P);const qP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],LT=Qe("zap",qP),WP=()=>{};var KE={};const MT=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},HP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},FT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,g=a>>2,w=(a&3)<<4|d>>4;let T=(d&15)<<2|p>>6,N=p&63;f||(N=64,l||(T=64)),r.push(t[g],t[w],t[T],t[N])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(MT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):HP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const w=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||p==null||w==null)throw new GP;const T=a<<2|d>>4;if(r.push(T),p!==64){const N=d<<4&240|p>>2;if(r.push(N),w!==64){const A=p<<6&192|w;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class GP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KP=function(n){const e=MT(n);return FT.encodeByteArray(e,!0)},Ef=function(n){return KP(n).replace(/\./g,"")},Dy=function(n){try{return FT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function If(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!QP(t)||(n[t]=If(n[t],e[t]));return n}function QP(n){return n!=="__proto__"}function Vy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const JP=()=>Vy().__FIREBASE_DEFAULTS__,YP=()=>{if(typeof process>"u"||typeof KE>"u")return;const n=KE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},XP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Dy(n[1]);return e&&JSON.parse(e)},Oy=()=>{try{return WP()||JP()||YP()||XP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ly=()=>Oy()?.config,ZP=n=>Oy()?.[`_${n}`];class ek{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function eo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function My(n){return(await fetch(n,{credentials:"include"})).ok}function tk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ef(JSON.stringify(t)),Ef(JSON.stringify(l)),""].join(".")}const wu={};function nk(){const n={prod:[],emulator:[]};for(const e of Object.keys(wu))wu[e]?n.emulator.push(e):n.prod.push(e);return n}function rk(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let QE=!1;function Fy(n,e){if(typeof window>"u"||typeof document>"u"||!eo(window.location.host)||wu[n]===e||wu[n]||QE)return;wu[n]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",a=nk().prod.length>0;function l(){const T=document.getElementById(r);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,N){T.setAttribute("width","24"),T.setAttribute("id",N),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{QE=!0,l()},T}function g(T,N){T.setAttribute("id",N),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function w(){const T=rk(r),N=t("text"),A=document.getElementById(N)||document.createElement("span"),L=t("learnmore"),V=document.getElementById(L)||document.createElement("a"),se=t("preprendIcon"),ie=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Q=T.element;d(Q),g(V,L);const pe=p();f(ie,se),Q.append(ie,A,V,pe),document.body.appendChild(Q)}a?(A.innerText="Preview backend disconnected.",ie.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ie.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function Jf(){const n=Oy()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ik(){return typeof window<"u"||jT()}function jT(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ok(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function UT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BT(){const n=xt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function zT(){return!Jf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $T(){return!Jf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Mu(){try{return typeof indexedDB=="object"}catch{return!1}}function ak(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const lk="FirebaseError";class tn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=lk,Object.setPrototypeOf(this,tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fa.prototype.create)}}class fa{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?ck(a,r):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new tn(s,d,r)}}function ck(n,e){return n.replace(uk,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const uk=/\{\$([^}]+)}/g;function JE(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function dk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $i(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(YE(a)&&YE(l)){if(!$i(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function YE(n){return n!==null&&typeof n=="object"}function Ql(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function gl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function hu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qT(n,e){const t=new hk(n,e);return t.subscribe.bind(t)}class hk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");fk(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=pg),s.error===void 0&&(s.error=pg),s.complete===void 0&&(s.complete=pg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fk(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function pg(){}function xe(n){return n&&n._delegate?n._delegate:n}class _r{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mo="[DEFAULT]";class pk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ek;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gk(e))try{this.getOrInitializeService({instanceIdentifier:Mo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mo){return this.instances.has(e)}getOptions(e=Mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:mk(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Mo){return this.component?this.component.multipleInstances?e:Mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mk(n){return n===Mo?void 0:n}function gk(n){return n.instantiationMode==="EAGER"}class WT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Uy=[];var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const HT={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},yk=Be.INFO,_k={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},vk=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=_k[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yf{constructor(e){this.name=e,this._logLevel=yk,this._logHandler=vk,this._userLogHandler=null,Uy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}function wk(n){Uy.forEach(e=>{e.setLogLevel(n)})}function Ek(n,e){for(const t of Uy){let r=null;e&&e.level&&(r=HT[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,a,...l)=>{const d=l.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");a>=(r??s.logLevel)&&n({level:Be[a].toLowerCase(),message:d,args:l,type:s.name})}}}const Ik=(n,e)=>e.some(t=>n instanceof t);let XE,ZE;function Tk(){return XE||(XE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xk(){return ZE||(ZE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GT=new WeakMap,Fg=new WeakMap,KT=new WeakMap,mg=new WeakMap,By=new WeakMap;function Sk(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Fi(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&GT.set(t,n)}).catch(()=>{}),By.set(e,n),e}function bk(n){if(Fg.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Fg.set(n,e)}let jg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Fg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||KT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ak(n){jg=n(jg)}function Rk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(gg(this),e,...t);return KT.set(r,e.sort?e.sort():[e]),Fi(r)}:xk().includes(n)?function(...e){return n.apply(gg(this),e),Fi(GT.get(this))}:function(...e){return Fi(n.apply(gg(this),e))}}function Pk(n){return typeof n=="function"?Rk(n):(n instanceof IDBTransaction&&bk(n),Ik(n,Tk())?new Proxy(n,jg):n)}function Fi(n){if(n instanceof IDBRequest)return Sk(n);if(mg.has(n))return mg.get(n);const e=Pk(n);return e!==n&&(mg.set(n,e),By.set(e,n)),e}const gg=n=>By.get(n);function kk(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=Fi(l);return r&&l.addEventListener("upgradeneeded",f=>{r(Fi(l.result),f.oldVersion,f.newVersion,Fi(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const Ck=["get","getKey","getAll","getAllKeys","count"],Nk=["put","add","delete","clear"],yg=new Map;function eI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(yg.get(e))return yg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Nk.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Ck.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&f.done]))[0]};return yg.set(e,a),a}Ak(n=>({...n,get:(e,t,r)=>eI(e,t)||n.get(e,t,r),has:(e,t)=>!!eI(e,t)||n.has(e,t)}));class Dk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Vk(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Vk(n){return n.getComponent()?.type==="VERSION"}const Tf="@firebase/app",Ug="0.14.6";const zs=new Yf("@firebase/app"),Ok="@firebase/app-compat",Lk="@firebase/analytics-compat",Mk="@firebase/analytics",Fk="@firebase/app-check-compat",jk="@firebase/app-check",Uk="@firebase/auth",Bk="@firebase/auth-compat",zk="@firebase/database",$k="@firebase/data-connect",qk="@firebase/database-compat",Wk="@firebase/functions",Hk="@firebase/functions-compat",Gk="@firebase/installations",Kk="@firebase/installations-compat",Qk="@firebase/messaging",Jk="@firebase/messaging-compat",Yk="@firebase/performance",Xk="@firebase/performance-compat",Zk="@firebase/remote-config",eC="@firebase/remote-config-compat",tC="@firebase/storage",nC="@firebase/storage-compat",rC="@firebase/firestore",sC="@firebase/ai",iC="@firebase/firestore-compat",oC="firebase",aC="12.6.0";const qi="[DEFAULT]",lC={[Tf]:"fire-core",[Ok]:"fire-core-compat",[Mk]:"fire-analytics",[Lk]:"fire-analytics-compat",[jk]:"fire-app-check",[Fk]:"fire-app-check-compat",[Uk]:"fire-auth",[Bk]:"fire-auth-compat",[zk]:"fire-rtdb",[$k]:"fire-data-connect",[qk]:"fire-rtdb-compat",[Wk]:"fire-fn",[Hk]:"fire-fn-compat",[Gk]:"fire-iid",[Kk]:"fire-iid-compat",[Qk]:"fire-fcm",[Jk]:"fire-fcm-compat",[Yk]:"fire-perf",[Xk]:"fire-perf-compat",[Zk]:"fire-rc",[eC]:"fire-rc-compat",[tC]:"fire-gcs",[nC]:"fire-gcs-compat",[rC]:"fire-fst",[iC]:"fire-fst-compat",[sC]:"fire-vertex","fire-js":"fire-js",[oC]:"fire-js-all"};const Wi=new Map,xl=new Map,Sl=new Map;function Fu(n,e){try{n.container.addComponent(e)}catch(t){zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function QT(n,e){n.container.addOrOverwriteComponent(e)}function $s(n){const e=n.name;if(Sl.has(e))return zs.debug(`There were multiple attempts to register component ${e}.`),!1;Sl.set(e,n);for(const t of Wi.values())Fu(t,n);for(const t of xl.values())Fu(t,n);return!0}function JT(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function cC(n,e,t=qi){JT(n,e).clearInstance(t)}function zy(n){return n.options!==void 0}function YT(n){return zy(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function gt(n){return n==null?!1:n.settings!==void 0}function uC(){Sl.clear()}const dC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sr=new fa("app","Firebase",dC);let XT=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sr.create("app-deleted",{appName:this._name})}};function tI(n,e){const t=Dy(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,a=new Date().getTime();s-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class hC extends XT{constructor(e,t,r,s){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:r,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,s);else{const d=e;super(d.options,l,s)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&tI(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&tI(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ir(Tf,Ug,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){qy(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw sr.create("server-app-deleted")}}const to=aC;function $y(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:qi,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw sr.create("bad-app-name",{appName:String(s)});if(t||(t=Ly()),!t)throw sr.create("no-options");const a=Wi.get(s);if(a){if($i(t,a.options)&&$i(r,a.config))return a;throw sr.create("duplicate-app",{appName:s})}const l=new WT(s);for(const f of Sl.values())l.addComponent(f);const d=new XT(t,r,l);return Wi.set(s,d),d}function fC(n,e={}){if(ik()&&!jT())throw sr.create("invalid-server-app-environment");let t,r=e||{};if(n&&(zy(n)?t=n.options:YT(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=Ly()),!t)throw sr.create("no-options");const s={...r,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const a=g=>[...g].reduce((w,T)=>Math.imul(31,w)+T.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw sr.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(s)),d=xl.get(l);if(d)return d.incRefCount(r.releaseOnDeref),d;const f=new WT(l);for(const g of Sl.values())f.addComponent(g);const p=new hC(t,r,l,f);return xl.set(l,p),p}function pC(n=qi){const e=Wi.get(n);if(!e&&n===qi&&Ly())return $y();if(!e)throw sr.create("no-app",{appName:n});return e}function mC(){return Array.from(Wi.values())}async function qy(n){let e=!1;const t=n.name;Wi.has(t)?(e=!0,Wi.delete(t)):xl.has(t)&&n.decRefCount()<=0&&(xl.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function ir(n,e,t){let r=lC[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zs.warn(l.join(" "));return}$s(new _r(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function ZT(n,e){if(n!==null&&typeof n!="function")throw sr.create("invalid-log-argument");Ek(n,e)}function ex(n){wk(n)}const gC="firebase-heartbeat-database",yC=1,ju="firebase-heartbeat-store";let _g=null;function tx(){return _g||(_g=kk(gC,yC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ju)}catch(t){console.warn(t)}}}}).catch(n=>{throw sr.create("idb-open",{originalErrorMessage:n.message})})),_g}async function _C(n){try{const t=(await tx()).transaction(ju),r=await t.objectStore(ju).get(nx(n));return await t.done,r}catch(e){if(e instanceof tn)zs.warn(e.message);else{const t=sr.create("idb-get",{originalErrorMessage:e?.message});zs.warn(t.message)}}}async function nI(n,e){try{const r=(await tx()).transaction(ju,"readwrite");await r.objectStore(ju).put(e,nx(n)),await r.done}catch(t){if(t instanceof tn)zs.warn(t.message);else{const r=sr.create("idb-set",{originalErrorMessage:t?.message});zs.warn(r.message)}}}function nx(n){return`${n.name}!${n.options.appId}`}const vC=1024,wC=30;class EC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new TC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=rI();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>wC){const s=xC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=rI(),{heartbeatsToSend:t,unsentEntries:r}=IC(this._heartbeatsCache.heartbeats),s=Ef(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return zs.warn(e),""}}}function rI(){return new Date().toISOString().substring(0,10)}function IC(n,e=vC){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),sI(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),sI(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class TC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mu()?ak().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _C(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function sI(n){return Ef(JSON.stringify({version:2,heartbeats:n})).length}function xC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function SC(n){$s(new _r("platform-logger",e=>new Dk(e),"PRIVATE")),$s(new _r("heartbeat",e=>new EC(e),"PRIVATE")),ir(Tf,Ug,n),ir(Tf,Ug,"esm2020"),ir("fire-js","")}SC("");const bC=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:tn,SDK_VERSION:to,_DEFAULT_ENTRY_NAME:qi,_addComponent:Fu,_addOrOverwriteComponent:QT,_apps:Wi,_clearComponents:uC,_components:Sl,_getProvider:JT,_isFirebaseApp:zy,_isFirebaseServerApp:gt,_isFirebaseServerAppSettings:YT,_registerComponent:$s,_removeServiceInstance:cC,_serverApps:xl,deleteApp:qy,getApp:pC,getApps:mC,initializeApp:$y,initializeServerApp:fC,onLog:ZT,registerVersion:ir,setLogLevel:ex},Symbol.toStringTag,{value:"Module"}));class AC{constructor(e,t){this._delegate=e,this.firebase=t,Fu(e,new _r("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),qy(this._delegate)))}_getService(e,t=qi){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=qi){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Fu(this._delegate,e)}_addOrOverwriteComponent(e){QT(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const RC={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},iI=new fa("app-compat","Firebase",RC);function PC(n){const e={},t={__esModule:!0,initializeApp:a,app:s,registerVersion:ir,setLogLevel:ex,onLog:ZT,apps:null,SDK_VERSION:to,INTERNAL:{registerComponent:d,removeApp:r,useAsService:f,modularAPIs:bC}};t.default=t,Object.defineProperty(t,"apps",{get:l});function r(p){delete e[p]}function s(p){if(p=p||qi,!JE(e,p))throw iI.create("no-app",{appName:p});return e[p]}s.App=n;function a(p,g={}){const w=$y(p,g);if(JE(e,w.name))return e[w.name];const T=new n(w,t);return e[w.name]=T,T}function l(){return Object.keys(e).map(p=>e[p])}function d(p){const g=p.name,w=g.replace("-compat","");if($s(p)&&p.type==="PUBLIC"){const T=(N=s())=>{if(typeof N[w]!="function")throw iI.create("invalid-app-argument",{appName:g});return N[w]()};p.serviceProps!==void 0&&If(T,p.serviceProps),t[w]=T,n.prototype[w]=function(...N){return this._getService.bind(this,g).apply(this,p.multipleInstances?N:[])}}return p.type==="PUBLIC"?t[w]:null}function f(p,g){return g==="serverAuth"?null:g}return t}function rx(){const n=PC(AC);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:rx,extendNamespace:e,createSubscribe:qT,ErrorFactory:fa,deepExtend:If};function e(t){If(n,t)}return n}const kC=rx();const oI=new Yf("@firebase/app-compat"),CC="@firebase/app-compat",NC="0.5.6";function DC(n){ir(CC,NC,n)}try{const n=Vy();if(n.firebase!==void 0){oI.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&oI.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const hn=kC;DC();var VC="firebase",OC="12.7.0";hn.registerVersion(VC,OC,"app-compat");const nu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},sl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function LC(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function sx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MC=LC,FC=sx,ix=new fa("auth","Firebase",sx());const xf=new Yf("@firebase/auth");function jC(n,...e){xf.logLevel<=Be.WARN&&xf.warn(`Auth (${to}): ${n}`,...e)}function nf(n,...e){xf.logLevel<=Be.ERROR&&xf.error(`Auth (${to}): ${n}`,...e)}function pn(n,...e){throw Hy(n,...e)}function Kt(n,...e){return Hy(n,...e)}function Wy(n,e,t){const r={...FC(),[e]:t};return new fa("auth","Firebase",r).create(e,{appName:n.name})}function nn(n){return Wy(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jl(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&pn(n,"argument-error"),Wy(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ix.create(n,...e)}function ne(n,e,...t){if(!n)throw Hy(e,...t)}function ds(n){const e="INTERNAL ASSERTION FAILED: "+n;throw nf(e),new Error(e)}function Vr(n,e){n||ds(e)}function Uu(){return typeof self<"u"&&self.location?.href||""}function Gy(){return aI()==="http:"||aI()==="https:"}function aI(){return typeof self<"u"&&self.location?.protocol||null}function UC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gy()||UT()||"connection"in navigator)?navigator.onLine:!0}function BC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class od{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vr(t>e,"Short delay should be less than long delay!"),this.isMobile=sk()||jy()}get(){return UC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ky(n,e){Vr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ox{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ds("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ds("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ds("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const zC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const $C=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qC=new od(3e4,6e4);function Ct(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Nt(n,e,t,r,s={}){return ax(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=Ql({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return ok()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&eo(n.emulatorConfig.host)&&(p.credentials="include"),ox.fetch()(await lx(n,n.config.apiHost,t,d),p)})}async function ax(n,e,t){n._canInitEmulator=!1;const r={...zC,...e};try{const s=new HC(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw fu(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw fu(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw fu(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw fu(n,"user-disabled",l);const g=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Wy(n,g,p);pn(n,g)}}catch(s){if(s instanceof tn)throw s;pn(n,"network-request-failed",{message:String(s)})}}async function Gs(n,e,t,r,s={}){const a=await Nt(n,e,t,r,s);return"mfaPendingCredential"in a&&pn(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function lx(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?Ky(n.config,s):`${n.config.apiScheme}://${s}`;return $C.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function WC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class HC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Kt(this.auth,"network-request-failed")),qC.get())})}}function fu(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Kt(n,e,r);return s.customData._tokenResponse=t,s}function lI(n){return n!==void 0&&n.getResponse!==void 0}function cI(n){return n!==void 0&&n.enterprise!==void 0}class cx{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return WC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function GC(n){return(await Nt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function ux(n,e){return Nt(n,"GET","/v2/recaptchaConfig",Ct(n,e))}async function KC(n,e){return Nt(n,"POST","/v1/accounts:delete",e)}async function QC(n,e){return Nt(n,"POST","/v1/accounts:update",e)}async function Sf(n,e){return Nt(n,"POST","/v1/accounts:lookup",e)}function Eu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JC(n,e=!1){const t=xe(n),r=await t.getIdToken(e),s=Xf(r);ne(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a?.sign_in_provider;return{claims:s,token:r,authTime:Eu(vg(s.auth_time)),issuedAtTime:Eu(vg(s.iat)),expirationTime:Eu(vg(s.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function vg(n){return Number(n)*1e3}function Xf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nf("JWT malformed, contained fewer than 3 sections"),null;try{const s=Dy(t);return s?JSON.parse(s):(nf("Failed to decode base64 JWT payload"),null)}catch(s){return nf("Caught error parsing JWT payload as JSON",s?.toString()),null}}function uI(n){const e=Xf(n);return ne(e,"internal-error"),ne(typeof e.exp<"u","internal-error"),ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function qs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof tn&&YC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function YC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class XC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Bg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Eu(this.lastLoginAt),this.creationTime=Eu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Bu(n){const e=n.auth,t=await n.getIdToken(),r=await qs(n,Sf(e,{idToken:t}));ne(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const a=s.providerUserInfo?.length?dx(s.providerUserInfo):[],l=eN(n.providerData,a),d=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!l?.length,p=d?f:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Bg(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function ZC(n){const e=xe(n);await Bu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function dx(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tN(n,e){const t=await ax(n,{},async()=>{const r=Ql({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await lx(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:r};return n.emulatorConfig&&eo(n.emulatorConfig.host)&&(f.credentials="include"),ox.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nN(n,e){return Nt(n,"POST","/v2/accounts:revokeToken",Ct(n,e))}class yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ne(e.idToken,"internal-error"),ne(typeof e.idToken<"u","internal-error"),ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):uI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ne(e.length!==0,"internal-error");const t=uI(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await tN(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new yl;return r&&(ne(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(ne(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(ne(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yl,this.toJSON())}_performRefresh(){return ds("not implemented")}}function Pi(n,e){ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Cr{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new XC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Bg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await qs(this,this.stsTokenManager.getToken(this.auth,e));return ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JC(this,e)}reload(){return ZC(this)}_assign(e){this!==e&&(ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Cr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Bu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gt(this.auth.app))return Promise.reject(nn(this.auth));const e=await this.getIdToken();return await qs(this,KC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:w,emailVerified:T,isAnonymous:N,providerData:A,stsTokenManager:L}=t;ne(w&&L,e,"internal-error");const V=yl.fromJSON(this.name,L);ne(typeof w=="string",e,"internal-error"),Pi(r,e.name),Pi(s,e.name),ne(typeof T=="boolean",e,"internal-error"),ne(typeof N=="boolean",e,"internal-error"),Pi(a,e.name),Pi(l,e.name),Pi(d,e.name),Pi(f,e.name),Pi(p,e.name),Pi(g,e.name);const se=new Cr({uid:w,auth:e,email:s,emailVerified:T,displayName:r,isAnonymous:N,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:V,createdAt:p,lastLoginAt:g});return A&&Array.isArray(A)&&(se.providerData=A.map(ie=>({...ie}))),f&&(se._redirectEventId=f),se}static async _fromIdTokenResponse(e,t,r=!1){const s=new yl;s.updateFromServerResponse(t);const a=new Cr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Bu(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ne(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?dx(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!a?.length,d=new yl;d.updateFromIdToken(r);const f=new Cr({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Bg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(f,p),f}}const dI=new Map;function rr(n){Vr(n instanceof Function,"Expected a class definition");let e=dI.get(n);return e?(Vr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dI.set(n,e),e)}class hx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hx.type="NONE";const bl=hx;function Jo(n,e,t){return`firebase:${n}:${e}:${t}`}class _l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Jo(this.userKey,s.apiKey,a),this.fullPersistenceKey=Jo("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sf(this.auth,{idToken:e}).catch(()=>{});return t?Cr._fromGetAccountInfoResponse(this.auth,t,e):null}return Cr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _l(rr(bl),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||rr(bl);const l=Jo(r,e.config.apiKey,e.name);let d=null;for(const p of t)try{const g=await p._get(l);if(g){let w;if(typeof g=="string"){const T=await Sf(e,{idToken:g}).catch(()=>{});if(!T)break;w=await Cr._fromGetAccountInfoResponse(e,T,g)}else w=Cr._fromJSON(e,g);p!==a&&(d=w),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new _l(a,e,r):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new _l(a,e,r))}}function hI(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yx(e))return"Blackberry";if(_x(e))return"Webos";if(px(e))return"Safari";if((e.includes("chrome/")||mx(e))&&!e.includes("edge/"))return"Chrome";if(ad(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function fx(n=xt()){return/firefox\//i.test(n)}function px(n=xt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mx(n=xt()){return/crios\//i.test(n)}function gx(n=xt()){return/iemobile/i.test(n)}function ad(n=xt()){return/android/i.test(n)}function yx(n=xt()){return/blackberry/i.test(n)}function _x(n=xt()){return/webos/i.test(n)}function ld(n=xt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rN(n=xt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function sN(n=xt()){return ld(n)&&!!window.navigator?.standalone}function iN(){return BT()&&document.documentMode===10}function vx(n=xt()){return ld(n)||ad(n)||_x(n)||yx(n)||/windows phone/i.test(n)||gx(n)}function wx(n,e=[]){let t;switch(n){case"Browser":t=hI(xt());break;case"Worker":t=`${hI(xt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${to}/${r}`}class oN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function aN(n,e={}){return Nt(n,"GET","/v2/passwordPolicy",Ct(n,e))}const lN=6;class cN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??lN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class uN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fI(this),this.idTokenSubscription=new fI(this),this.beforeStateQueue=new oN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ix,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=rr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sf(this,{idToken:e}),r=await Cr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(gt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=r?._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===l)&&d?.user&&(r=d.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Bu(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gt(this.app))return Promise.reject(nn(this));const t=e?xe(e):null;return t&&ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gt(this.app)?Promise.reject(nn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gt(this.app)?Promise.reject(nn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(rr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aN(this),t=new cN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fa("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await nN(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&rr(e)||this._popupRedirectResolver;ne(t,this,"argument-error"),this.redirectPersistenceManager=await _l.create(this,[rr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ne(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(gt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function St(n){return xe(n)}class fI{constructor(e){this.auth=e,this.observer=null,this.addObserver=qT(t=>this.observer=t)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let cd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dN(n){cd=n}function Qy(n){return cd.loadJS(n)}function hN(){return cd.recaptchaV2Script}function fN(){return cd.recaptchaEnterpriseScript}function pN(){return cd.gapiScript}function Ex(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const mN=500,gN=6e4,Gh=1e12;class yN{constructor(e){this.auth=e,this.counter=Gh,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new wN(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||Gh;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Gh;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Gh;return this._widgets.get(t)?.execute(),""}}class _N{constructor(){this.enterprise=new vN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class vN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class wN{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ne(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=EN(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},gN)},mN))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function EN(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const IN="recaptcha-enterprise",Iu="NO_RECAPTCHA";class Ix{constructor(e){this.type=IN,this.auth=St(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{ux(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new cx(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,l(p.siteKey)}}).catch(f=>{d(f)})})}function s(a,l,d){const f=window.grecaptcha;cI(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{l(p)}).catch(()=>{l(Iu)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _N().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{r(this.auth).then(d=>{if(!t&&cI(window.grecaptcha))s(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=fN();f.length!==0&&(f+=d),Qy(f).then(()=>{s(d,a,l)}).catch(p=>{l(p)})}}).catch(d=>{l(d)})})}}async function ru(n,e,t,r=!1,s=!1){const a=new Ix(n);let l;if(s)l=Iu;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function ji(n,e,t,r,s){if(s==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await ru(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await ru(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)});else if(s==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const a=await ru(n,e,t);return r(n,a).catch(async l=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const d=await ru(n,e,t,!1,!0);return r(n,d)}return Promise.reject(l)})}else{const a=await ru(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(s+" provider is not supported.")}async function TN(n){const e=St(n),t=await ux(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new cx(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new Ix(e).verify()}function xN(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(rr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function SN(n,e,t){const r=St(n);ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!t?.disableWarnings,a=Tx(e),{host:l,port:d}=bN(e),f=d===null?"":`:${d}`,p={url:`${a}//${l}${f}/`},g=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ne(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ne($i(p,r.config.emulator)&&$i(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,eo(l)?(My(`${a}//${l}${f}`),Fy("Auth",!0)):s||AN()}function Tx(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function bN(n){const e=Tx(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:pI(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:pI(l)}}}function pI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function AN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Yl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ds("not implemented")}_getIdTokenResponse(e){return ds("not implemented")}_linkToIdToken(e,t){return ds("not implemented")}_getReauthenticationResolver(e){return ds("not implemented")}}async function xx(n,e){return Nt(n,"POST","/v1/accounts:resetPassword",Ct(n,e))}async function RN(n,e){return Nt(n,"POST","/v1/accounts:update",e)}async function PN(n,e){return Nt(n,"POST","/v1/accounts:signUp",e)}async function kN(n,e){return Nt(n,"POST","/v1/accounts:update",Ct(n,e))}async function CN(n,e){return Gs(n,"POST","/v1/accounts:signInWithPassword",Ct(n,e))}async function Zf(n,e){return Nt(n,"POST","/v1/accounts:sendOobCode",Ct(n,e))}async function NN(n,e){return Zf(n,e)}async function DN(n,e){return Zf(n,e)}async function VN(n,e){return Zf(n,e)}async function ON(n,e){return Zf(n,e)}async function LN(n,e){return Gs(n,"POST","/v1/accounts:signInWithEmailLink",Ct(n,e))}async function MN(n,e){return Gs(n,"POST","/v1/accounts:signInWithEmailLink",Ct(n,e))}class zu extends Yl{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new zu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new zu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ji(e,t,"signInWithPassword",CN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return LN(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ji(e,r,"signUpPassword",PN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return MN(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Bs(n,e){return Gs(n,"POST","/v1/accounts:signInWithIdp",Ct(n,e))}const FN="http://localhost";class _s extends Yl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _s(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...a}=t;if(!r||!s)return null;const l=new _s(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Bs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Bs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bs(e,t)}buildRequest(){const e={requestUri:FN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ql(t)}return e}}async function mI(n,e){return Nt(n,"POST","/v1/accounts:sendVerificationCode",Ct(n,e))}async function jN(n,e){return Gs(n,"POST","/v1/accounts:signInWithPhoneNumber",Ct(n,e))}async function UN(n,e){const t=await Gs(n,"POST","/v1/accounts:signInWithPhoneNumber",Ct(n,e));if(t.temporaryProof)throw fu(n,"account-exists-with-different-credential",t);return t}const BN={USER_NOT_FOUND:"user-not-found"};async function zN(n,e){const t={...e,operation:"REAUTH"};return Gs(n,"POST","/v1/accounts:signInWithPhoneNumber",Ct(n,t),BN)}class Yo extends Yl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Yo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Yo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return jN(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return UN(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return zN(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a}=e;return!r&&!t&&!s&&!a?null:new Yo({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:a})}}function $N(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qN(n){const e=gl(hu(n)).link,t=e?gl(hu(e)).deep_link_id:null,r=gl(hu(n)).deep_link_id;return(r?gl(hu(r)).link:null)||r||t||e||n}class ep{constructor(e){const t=gl(hu(e)),r=t.apiKey??null,s=t.oobCode??null,a=$N(t.mode??null);ne(r&&s&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qN(e);try{return new ep(t)}catch{return null}}}class no{constructor(){this.providerId=no.PROVIDER_ID}static credential(e,t){return zu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ep.parseLink(t);return ne(r,"argument-error"),zu._fromEmailAndCode(e,r.code,r.tenantId)}}no.PROVIDER_ID="password";no.EMAIL_PASSWORD_SIGN_IN_METHOD="password";no.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ks{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Xl extends Ks{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class vl extends Xl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ne("providerId"in t&&"signInMethod"in t,"argument-error"),_s._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return ne(e.idToken||e.accessToken,"argument-error"),_s._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return vl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return vl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:a,nonce:l,providerId:d}=e;if(!r&&!s&&!t&&!a||!d)return null;try{return new vl(d)._credential({idToken:t,accessToken:r,nonce:l,pendingToken:a})}catch{return null}}}class is extends Xl{constructor(){super("facebook.com")}static credential(e){return _s._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return is.credential(e.oauthAccessToken)}catch{return null}}}is.FACEBOOK_SIGN_IN_METHOD="facebook.com";is.PROVIDER_ID="facebook.com";class os extends Xl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _s._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return os.credential(t,r)}catch{return null}}}os.GOOGLE_SIGN_IN_METHOD="google.com";os.PROVIDER_ID="google.com";class as extends Xl{constructor(){super("github.com")}static credential(e){return _s._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return as.credentialFromTaggedObject(e)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return as.credential(e.oauthAccessToken)}catch{return null}}}as.GITHUB_SIGN_IN_METHOD="github.com";as.PROVIDER_ID="github.com";const WN="http://localhost";class Al extends Yl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Bs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Bs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:a}=t;return!r||!s||!a||r!==s?null:new Al(r,a)}static _create(e,t){return new Al(e,t)}buildRequest(){return{requestUri:WN,returnSecureToken:!0,pendingToken:this.pendingToken}}}const HN="saml.";class bf extends Ks{constructor(e){ne(e.startsWith(HN),"argument-error"),super(e)}static credentialFromResult(e){return bf.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return bf.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Al.fromJSON(e);return ne(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Al._create(r,t)}catch{return null}}}class ls extends Xl{constructor(){super("twitter.com")}static credential(e,t){return _s._fromParams({providerId:ls.PROVIDER_ID,signInMethod:ls.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ls.credentialFromTaggedObject(e)}static credentialFromError(e){return ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ls.credential(t,r)}catch{return null}}}ls.TWITTER_SIGN_IN_METHOD="twitter.com";ls.PROVIDER_ID="twitter.com";async function Sx(n,e){return Gs(n,"POST","/v1/accounts:signUp",Ct(n,e))}class vr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await Cr._fromIdTokenResponse(e,r,s),l=gI(r);return new vr({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=gI(r);return new vr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function gI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function GN(n){if(gt(n.app))return Promise.reject(nn(n));const e=St(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new vr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await Sx(e,{returnSecureToken:!0}),r=await vr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Af extends tn{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Af.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Af(e,t,r,s)}}function bx(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Af._fromErrorAndOperation(n,a,e,r):a})}function Ax(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function KN(n,e){const t=xe(n);await tp(!0,t,e);const{providerUserInfo:r}=await QC(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=Ax(r||[]);return t.providerData=t.providerData.filter(a=>s.has(a.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Jy(n,e,t=!1){const r=await qs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return vr._forOperation(n,"link",r)}async function tp(n,e,t){await Bu(e);const r=Ax(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ne(r.has(t)===n,e.auth,s)}async function Rx(n,e,t=!1){const{auth:r}=n;if(gt(r.app))return Promise.reject(nn(r));const s="reauthenticate";try{const a=await qs(n,bx(r,s,e,n),t);ne(a.idToken,r,"internal-error");const l=Xf(a.idToken);ne(l,r,"internal-error");const{sub:d}=l;return ne(n.uid===d,r,"user-mismatch"),vr._forOperation(n,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&pn(r,"user-mismatch"),a}}async function Px(n,e,t=!1){if(gt(n.app))return Promise.reject(nn(n));const r="signIn",s=await bx(n,r,e),a=await vr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}async function np(n,e){return Px(St(n),e)}async function kx(n,e){const t=xe(n);return await tp(!1,t,e.providerId),Jy(t,e)}async function Cx(n,e){return Rx(xe(n),e)}async function QN(n,e){return Gs(n,"POST","/v1/accounts:signInWithCustomToken",Ct(n,e))}async function JN(n,e){if(gt(n.app))return Promise.reject(nn(n));const t=St(n),r=await QN(t,{token:e,returnSecureToken:!0}),s=await vr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}class ud{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Yy._fromServerResponse(e,t):"totpInfo"in t?Xy._fromServerResponse(e,t):pn(e,"internal-error")}}class Yy extends ud{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Yy(t)}}class Xy extends ud{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Xy(t)}}function rp(n,e,t){ne(t.url?.length>0,n,"invalid-continue-uri"),ne(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),ne(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ne(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ne(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Zy(n){const e=St(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YN(n,e,t){const r=St(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&rp(r,s,t),await ji(r,s,"getOobCode",DN,"EMAIL_PASSWORD_PROVIDER")}async function XN(n,e,t){await xx(xe(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zy(n),r})}async function ZN(n,e){await kN(xe(n),{oobCode:e})}async function Nx(n,e){const t=xe(n),r=await xx(t,{oobCode:e}),s=r.requestType;switch(ne(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ne(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ne(r.mfaInfo,t,"internal-error");default:ne(r.email,t,"internal-error")}let a=null;return r.mfaInfo&&(a=ud._fromServerResponse(St(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:a},operation:s}}async function e2(n,e){const{data:t}=await Nx(xe(n),e);return t.email}async function t2(n,e,t){if(gt(n.app))return Promise.reject(nn(n));const r=St(n),l=await ji(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Sx,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&Zy(n),f}),d=await vr._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(d.user),d}function n2(n,e,t){return gt(n.app)?Promise.reject(nn(n)):np(xe(n),no.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Zy(n),r})}async function r2(n,e,t){const r=St(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,d){ne(d.handleCodeInApp,r,"argument-error"),d&&rp(r,l,d)}a(s,t),await ji(r,s,"getOobCode",VN,"EMAIL_PASSWORD_PROVIDER")}function s2(n,e){return ep.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function i2(n,e,t){if(gt(n.app))return Promise.reject(nn(n));const r=xe(n),s=no.credentialWithLink(e,t||Uu());return ne(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),np(r,s)}async function o2(n,e){return Nt(n,"POST","/v1/accounts:createAuthUri",Ct(n,e))}async function a2(n,e){const t=Gy()?Uu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await o2(xe(n),r);return s||[]}async function l2(n,e){const t=xe(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&rp(t.auth,s,e);const{email:a}=await NN(t.auth,s);a!==n.email&&await n.reload()}async function c2(n,e,t){const r=xe(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&rp(r.auth,a,t);const{email:l}=await ON(r.auth,a);l!==n.email&&await n.reload()}async function u2(n,e){return Nt(n,"POST","/v1/accounts:update",e)}async function d2(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=xe(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await qs(r,u2(r.auth,a));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const d=r.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function h2(n,e){const t=xe(n);return gt(t.auth.app)?Promise.reject(nn(t.auth)):Dx(t,e,null)}function f2(n,e){return Dx(xe(n),null,e)}async function Dx(n,e,t){const{auth:r}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await qs(n,RN(r,a));await n._updateTokensIfNecessary(l,!0)}function p2(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const s=Xf(n.idToken)?.firebase?.sign_in_provider;if(s){const a=s!=="anonymous"&&s!=="custom"?s:null;return new wl(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new m2(r,t);case"github.com":return new g2(r,t);case"google.com":return new y2(r,t);case"twitter.com":return new _2(r,t,n.screenName||null);case"custom":case"anonymous":return new wl(r,null);default:return new wl(r,e,t)}}class wl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class Vx extends wl{constructor(e,t,r,s){super(e,t,r),this.username=s}}class m2 extends wl{constructor(e,t){super(e,"facebook.com",t)}}class g2 extends Vx{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class y2 extends wl{constructor(e,t){super(e,"google.com",t)}}class _2 extends Vx{constructor(e,t,r){super(e,"twitter.com",t,r)}}function v2(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:p2(t)}class Wo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Wo("enroll",e,t)}static _fromMfaPendingCredential(e){return new Wo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return Wo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return Wo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class e_{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=St(e),s=t.customData._serverResponse,a=(s.mfaInfo||[]).map(d=>ud._fromServerResponse(r,d));ne(s.mfaPendingCredential,r,"internal-error");const l=Wo._fromMfaPendingCredential(s.mfaPendingCredential);return new e_(l,a,async d=>{const f=await d._process(r,l);delete s.mfaInfo,delete s.mfaPendingCredential;const p={...s,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const g=await vr._fromIdTokenResponse(r,t.operationType,p);return await r._updateCurrentUser(g.user),g;case"reauthenticate":return ne(t.user,r,"internal-error"),vr._forOperation(t.user,t.operationType,p);default:pn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function w2(n,e){const t=xe(n),r=e;return ne(e.customData.operationType,t,"argument-error"),ne(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),e_._fromError(t,r)}function yI(n,e){return Nt(n,"POST","/v2/accounts/mfaEnrollment:start",Ct(n,e))}function E2(n,e){return Nt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ct(n,e))}function I2(n,e){return Nt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ct(n,e))}class t_{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>ud._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new t_(e)}async getSession(){return Wo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),a=await qs(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await qs(this.user,I2(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const wg=new WeakMap;function T2(n){const e=xe(n);return wg.has(e)||wg.set(e,t_._fromUser(e)),wg.get(e)}const Rf="__sak";class Ox{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rf,"1"),this.storage.removeItem(Rf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const x2=1e3,S2=10;class Lx extends Ox{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);iN()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,S2):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},x2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Lx.type="LOCAL";const n_=Lx;class Mx extends Ox{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mx.type="SESSION";const ea=Mx;function b2(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new sp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,a)),f=await b2(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sp.receivers=[];function dd(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class A2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const p=dd("",20);s.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(w){const T=w;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(T.data.response);break;default:clearTimeout(g),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function $t(){return window}function R2(n){$t().location.href=n}function r_(){return typeof $t().WorkerGlobalScope<"u"&&typeof $t().importScripts=="function"}async function P2(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function k2(){return navigator?.serviceWorker?.controller||null}function C2(){return r_()?self:null}const Fx="firebaseLocalStorageDb",N2=1,Pf="firebaseLocalStorage",jx="fbase_key";class hd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ip(n,e){return n.transaction([Pf],e?"readwrite":"readonly").objectStore(Pf)}function D2(){const n=indexedDB.deleteDatabase(Fx);return new hd(n).toPromise()}function zg(){const n=indexedDB.open(Fx,N2);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Pf,{keyPath:jx})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Pf)?e(r):(r.close(),await D2(),e(await zg()))})})}async function _I(n,e,t){const r=ip(n,!0).put({[jx]:e,value:t});return new hd(r).toPromise()}async function V2(n,e){const t=ip(n,!1).get(e),r=await new hd(t).toPromise();return r===void 0?null:r.value}function vI(n,e){const t=ip(n,!0).delete(e);return new hd(t).toPromise()}const O2=800,L2=3;class Ux{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>L2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return r_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sp._getInstance(C2()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await P2(),!this.activeServiceWorker)return;this.sender=new A2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||k2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zg();return await _I(e,Rf,"1"),await vI(e,Rf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>_I(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>V2(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=ip(s,!1).getAll();return new hd(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),O2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ux.type="LOCAL";const $u=Ux;function wI(n,e){return Nt(n,"POST","/v2/accounts/mfaSignIn:start",Ct(n,e))}function M2(n,e){return Nt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ct(n,e))}const Eg=Ex("rcb"),F2=new od(3e4,6e4);class j2{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!$t().grecaptcha?.render}load(e,t=""){return ne(U2(t),e,"argument-error"),this.shouldResolveImmediately(t)&&lI($t().grecaptcha)?Promise.resolve($t().grecaptcha):new Promise((r,s)=>{const a=$t().setTimeout(()=>{s(Kt(e,"network-request-failed"))},F2.get());$t()[Eg]=()=>{$t().clearTimeout(a),delete $t()[Eg];const d=$t().grecaptcha;if(!d||!lI(d)){s(Kt(e,"internal-error"));return}const f=d.render;d.render=(p,g)=>{const w=f(p,g);return this.counter++,w},this.hostLanguage=t,r(d)};const l=`${hN()}?${Ql({onload:Eg,render:"explicit",hl:t})}`;Qy(l).catch(()=>{clearTimeout(a),s(Kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!$t().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function U2(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class B2{async load(e){return new yN(e)}clearedOneInstance(){}}const Tu="recaptcha",z2={theme:"light",type:"image"};let $2=class{constructor(e,t,r={...z2}){this.parameters=r,this.type=Tu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=St(e),this.isInvisible=this.parameters.size==="invisible",ne(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ne(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new B2:new j2,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),s(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ne(!this.parameters.sitekey,this.auth,"argument-error"),ne(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ne(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=$t()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ne(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ne(Gy()&&!r_(),this.auth,"internal-error"),await q2(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await GC(this.auth);ne(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ne(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function q2(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class s_{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Yo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function W2(n,e,t){if(gt(n.app))return Promise.reject(nn(n));const r=St(n),s=await op(r,e,xe(t));return new s_(s,a=>np(r,a))}async function H2(n,e,t){const r=xe(n);await tp(!1,r,"phone");const s=await op(r.auth,e,xe(t));return new s_(s,a=>kx(r,a))}async function G2(n,e,t){const r=xe(n);if(gt(r.auth.app))return Promise.reject(nn(r.auth));const s=await op(r.auth,e,xe(t));return new s_(s,a=>Cx(r,a))}async function op(n,e,t){if(!n._getRecaptchaConfig())try{await TN(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const s=r.session;if("phoneNumber"in r){ne(s.type==="enroll",n,"internal-error");const a={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await ji(n,a,"mfaSmsEnrollment",async(p,g)=>{if(g.phoneEnrollmentInfo.captchaResponse===Iu){ne(t?.type===Tu,p,"argument-error");const w=await Ig(p,g,t);return yI(p,w)}return yI(p,g)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{ne(s.type==="signin",n,"internal-error");const a=r.multiFactorHint?.uid||r.multiFactorUid;ne(a,n,"missing-multi-factor-info");const l={mfaPendingCredential:s.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await ji(n,l,"mfaSmsSignIn",async(g,w)=>{if(w.phoneSignInInfo.captchaResponse===Iu){ne(t?.type===Tu,g,"argument-error");const T=await Ig(g,w,t);return wI(g,T)}return wI(g,w)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await ji(n,s,"sendVerificationCode",async(f,p)=>{if(p.captchaResponse===Iu){ne(t?.type===Tu,f,"argument-error");const g=await Ig(f,p,t);return mI(f,g)}return mI(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function K2(n,e){const t=xe(n);if(gt(t.auth.app))return Promise.reject(nn(t.auth));await Jy(t,e)}async function Ig(n,e,t){ne(t.type===Tu,n,"argument-error");const r=await t.verify();ne(typeof r=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const a=s.phoneEnrollmentInfo.phoneNumber,l=s.phoneEnrollmentInfo.captchaResponse,d=s.phoneEnrollmentInfo.clientType,f=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r,captchaResponse:l,clientType:d,recaptchaVersion:f}}),s}else if("phoneSignInInfo"in s){const a=s.phoneSignInInfo.captchaResponse,l=s.phoneSignInInfo.clientType,d=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:a,clientType:l,recaptchaVersion:d}}),s}else return Object.assign(s,{recaptchaToken:r}),s}let ta=class rf{constructor(e){this.providerId=rf.PROVIDER_ID,this.auth=St(e)}verifyPhoneNumber(e,t){return op(this.auth,e,xe(t))}static credential(e,t){return Yo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return rf.credentialFromTaggedObject(t)}static credentialFromError(e){return rf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Yo._fromTokenResponse(t,r):null}};ta.PROVIDER_ID="phone";ta.PHONE_SIGN_IN_METHOD="phone";function pa(n,e){return e?rr(e):(ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class i_ extends Yl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Q2(n){return Px(n.auth,new i_(n),n.bypassAuthState)}function J2(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),Rx(t,new i_(n),n.bypassAuthState)}async function Y2(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),Jy(t,new i_(n),n.bypassAuthState)}class Bx{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Q2;case"linkViaPopup":case"linkViaRedirect":return Y2;case"reauthViaPopup":case"reauthViaRedirect":return J2;default:pn(this.auth,"internal-error")}}resolve(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const X2=new od(2e3,1e4);async function Z2(n,e,t){if(gt(n.app))return Promise.reject(Kt(n,"operation-not-supported-in-this-environment"));const r=St(n);Jl(n,e,Ks);const s=pa(r,t);return new js(r,"signInViaPopup",e,s).executeNotNull()}async function eD(n,e,t){const r=xe(n);if(gt(r.auth.app))return Promise.reject(Kt(r.auth,"operation-not-supported-in-this-environment"));Jl(r.auth,e,Ks);const s=pa(r.auth,t);return new js(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function tD(n,e,t){const r=xe(n);Jl(r.auth,e,Ks);const s=pa(r.auth,t);return new js(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class js extends Bx{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,js.currentPopupAction&&js.currentPopupAction.cancel(),js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ne(e,this.auth,"internal-error"),e}async onExecution(){Vr(this.filter.length===1,"Popup operations only handle one event");const e=dd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,js.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,X2.get())};e()}}js.currentPopupAction=null;const nD="pendingRedirect",xu=new Map;class rD extends Bx{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=xu.get(this.auth._key());if(!e){try{const r=await sD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}xu.set(this.auth._key(),e)}return this.bypassAuthState||xu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sD(n,e){const t=$x(e),r=zx(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function o_(n,e){return zx(n)._set($x(e),"true")}function iD(){xu.clear()}function a_(n,e){xu.set(n._key(),e)}function zx(n){return rr(n._redirectPersistence)}function $x(n){return Jo(nD,n.config.apiKey,n.name)}function oD(n,e,t){return aD(n,e,t)}async function aD(n,e,t){if(gt(n.app))return Promise.reject(nn(n));const r=St(n);Jl(n,e,Ks),await r._initializationPromise;const s=pa(r,t);return await o_(s,r),s._openRedirect(r,e,"signInViaRedirect")}function lD(n,e,t){return cD(n,e,t)}async function cD(n,e,t){const r=xe(n);if(Jl(r.auth,e,Ks),gt(r.auth.app))return Promise.reject(nn(r.auth));await r.auth._initializationPromise;const s=pa(r.auth,t);await o_(s,r.auth);const a=await qx(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",a)}function uD(n,e,t){return dD(n,e,t)}async function dD(n,e,t){const r=xe(n);Jl(r.auth,e,Ks),await r.auth._initializationPromise;const s=pa(r.auth,t);await tp(!1,r,e.providerId),await o_(s,r.auth);const a=await qx(r);return s._openRedirect(r.auth,e,"linkViaRedirect",a)}async function hD(n,e){return await St(n)._initializationPromise,ap(n,e,!1)}async function ap(n,e,t=!1){if(gt(n.app))return Promise.reject(nn(n));const r=St(n),s=pa(r,e),l=await new rD(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}async function qx(n){const e=dd(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const fD=600*1e3;class Wx{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Hx(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Kt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fD&&this.cachedEventUids.clear(),this.cachedEventUids.has(EI(e))}saveEventToCache(e){this.cachedEventUids.add(EI(e)),this.lastProcessedEventTime=Date.now()}}function EI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Hx({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function pD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hx(n);default:return!1}}async function Gx(n,e={}){return Nt(n,"GET","/v1/projects",e)}const mD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gD=/^https?/;async function yD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Gx(n);for(const t of e)try{if(_D(t))return}catch{}pn(n,"unauthorized-domain")}function _D(n){const e=Uu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!gD.test(t))return!1;if(mD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const vD=new od(3e4,6e4);function II(){const n=$t().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function wD(n){return new Promise((e,t)=>{function r(){II(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{II(),t(Kt(n,"network-request-failed"))},timeout:vD.get()})}if($t().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if($t().gapi?.load)r();else{const s=Ex("iframefcb");return $t()[s]=()=>{gapi.load?r():t(Kt(n,"network-request-failed"))},Qy(`${pN()}?onload=${s}`).catch(a=>t(a))}}).catch(e=>{throw sf=null,e})}let sf=null;function ED(n){return sf=sf||wD(n),sf}const ID=new od(5e3,15e3),TD="__/auth/iframe",xD="emulator/auth/iframe",SD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AD(n){const e=n.config;ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ky(e,xD):`https://${n.config.authDomain}/${TD}`,r={apiKey:e.apiKey,appName:n.name,v:to},s=bD.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Ql(r).slice(1)}`}async function RD(n){const e=await ED(n),t=$t().gapi;return ne(t,n,"internal-error"),e.open({where:document.body,url:AD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SD,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=Kt(n,"network-request-failed"),d=$t().setTimeout(()=>{a(l)},ID.get());function f(){$t().clearTimeout(d),s(r)}r.ping(f).then(f,()=>{a(l)})}))}const PD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kD=500,CD=600,ND="_blank",DD="http://localhost";class TI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VD(n,e,t,r=kD,s=CD){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f={...PD,width:r.toString(),height:s.toString(),top:a,left:l},p=xt().toLowerCase();t&&(d=mx(p)?ND:t),fx(p)&&(e=e||DD,f.scrollbars="yes");const g=Object.entries(f).reduce((T,[N,A])=>`${T}${N}=${A},`,"");if(sN(p)&&d!=="_self")return OD(e||"",d),new TI(null);const w=window.open(e||"",d,g);ne(w,n,"popup-blocked");try{w.focus()}catch{}return new TI(w)}function OD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const LD="__/auth/handler",MD="emulator/auth/handler",FD=encodeURIComponent("fac");async function $g(n,e,t,r,s,a){ne(n.config.authDomain,n,"auth-domain-config-required"),ne(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:to,eventId:s};if(e instanceof Ks){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",dk(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,w]of Object.entries(a||{}))l[g]=w}if(e instanceof Xl){const g=e.getScopes().filter(w=>w!=="");g.length>0&&(l.scopes=g.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const f=await n._getAppCheckToken(),p=f?`#${FD}=${encodeURIComponent(f)}`:"";return`${jD(n)}?${Ql(d).slice(1)}${p}`}function jD({config:n}){return n.emulator?Ky(n,MD):`https://${n.authDomain}/${LD}`}const Tg="webStorageSupport";class UD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ea,this._completeRedirectFn=ap,this._overrideRedirectResult=a_}async _openPopup(e,t,r,s){Vr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await $g(e,t,r,Uu(),s);return VD(e,a,dd())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await $g(e,t,r,Uu(),s);return R2(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(Vr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await RD(e),r=new Wx(e);return t.register("authEvent",s=>(ne(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tg,{type:Tg},s=>{const a=s?.[0]?.[Tg];a!==void 0&&t(!!a),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return vx()||px()||ld()}}const BD=UD;class zD{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ds("unexpected MultiFactorSessionType")}}}class l_ extends zD{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new l_(e)}_finalizeEnroll(e,t,r){return E2(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return M2(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Kx{constructor(){}static assertion(e){return l_._fromCredential(e)}}Kx.FACTOR_ID="phone";var xI="@firebase/auth",SI="1.12.0";class $D{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function qD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WD(n){$s(new _r("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;ne(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wx(n)},p=new uN(r,s,a,f);return xN(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$s(new _r("auth-internal",e=>{const t=St(e.getProvider("auth").getImmediate());return(r=>new $D(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ir(xI,SI,qD(n)),ir(xI,SI,"esm2020")}const HD=300;ZP("authIdTokenMaxAge");function GD(){return document.getElementsByTagName("head")?.[0]??document}dN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=Kt("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",GD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WD("Browser");function na(){return window}const KD=2e3;async function QD(n,e,t){const{BuildInfo:r}=na();Vr(e.sessionId,"AuthEvent did not contain a session ID");const s=await eV(e.sessionId),a={};return ld()?a.ibi=r.packageName:ad()?a.apn=r.packageName:pn(n,"operation-not-supported-in-this-environment"),r.displayName&&(a.appDisplayName=r.displayName),a.sessionId=s,$g(n,t,e.type,void 0,e.eventId??void 0,a)}async function JD(n){const{BuildInfo:e}=na(),t={};ld()?t.iosBundleId=e.packageName:ad()?t.androidPackageName=e.packageName:pn(n,"operation-not-supported-in-this-environment"),await Gx(n,t)}function YD(n){const{cordova:e}=na();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,rN()?"_blank":"_system","location=yes"),t(s)})})}async function XD(n,e,t){const{cordova:r}=na();let s=()=>{};try{await new Promise((a,l)=>{let d=null;function f(){a();const w=r.plugins.browsertab?.close;typeof w=="function"&&w(),typeof t?.close=="function"&&t.close()}function p(){d||(d=window.setTimeout(()=>{l(Kt(n,"redirect-cancelled-by-user"))},KD))}function g(){document?.visibilityState==="visible"&&p()}e.addPassiveListener(f),document.addEventListener("resume",p,!1),ad()&&document.addEventListener("visibilitychange",g,!1),s=()=>{e.removePassiveListener(f),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",g,!1),d&&window.clearTimeout(d)}})}finally{s()}}function ZD(n){const e=na();ne(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ne(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ne(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ne(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ne(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function eV(n){const e=tV(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function tV(n){if(Vr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const nV=20;class rV extends Wx{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function sV(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:aV(),postBody:null,tenantId:n.tenantId,error:Kt(n,"no-auth-event")}}function iV(n,e){return qg()._set(Wg(n),e)}async function bI(n){const e=await qg()._get(Wg(n));return e&&await qg()._remove(Wg(n)),e}function oV(n,e){const t=cV(e);if(t.includes("/__/auth/callback")){const r=of(t),a=(r.firebaseError?lV(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],l=a?Kt(a):null;return l?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function aV(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<nV;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function qg(){return rr(n_)}function Wg(n){return Jo("authEvent",n.config.apiKey,n.name)}function lV(n){try{return JSON.parse(n)}catch{return null}}function cV(n){const e=of(n),t=e.link?decodeURIComponent(e.link):void 0,r=of(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return of(s).link||s||r||t||n}function of(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return gl(t.join("?"))}const uV=500;class dV{constructor(){this._redirectPersistence=ea,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ap,this._overrideRedirectResult=a_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new rV(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){pn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,s){ZD(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),iD(),await this._originValidation(e);const l=sV(e,r,s);await iV(e,l);const d=await QD(e,l,t),f=await YD(d);return XD(e,a,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=JD(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:s,BuildInfo:a}=na(),l=setTimeout(async()=>{await bI(e),t.onEvent(AI())},uV),d=async g=>{clearTimeout(l);const w=await bI(e);let T=null;w&&g?.url&&(T=oV(w,g.url)),t.onEvent(T||AI())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,d);const f=s,p=`${a.packageName.toLowerCase()}://`;na().handleOpenURL=async g=>{if(g.toLowerCase().startsWith(p)&&d({url:g}),typeof f=="function")try{f(g)}catch(w){console.error(w)}}}}const hV=dV;function AI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Kt("no-auth-event")}}function fV(n,e){St(n)._logFramework(e)}var pV="@firebase/auth-compat",mV="0.6.2";const gV=1e3;function Su(){return self?.location?.protocol||null}function yV(){return Su()==="http:"||Su()==="https:"}function Qx(n=xt()){return!!((Su()==="file:"||Su()==="ionic:"||Su()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function _V(){return jy()||Jf()}function vV(){return BT()&&document?.documentMode===11}function wV(n=xt()){return/Edge\/\d+/.test(n)}function EV(n=xt()){return vV()||wV(n)}function Jx(){try{const n=self.localStorage,e=dd();if(n)return n.setItem(e,"1"),n.removeItem(e),EV()?Mu():!0}catch{return c_()&&Mu()}return!1}function c_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function xg(){return(yV()||UT()||Qx())&&!_V()&&Jx()&&!c_()}function Yx(){return Qx()&&typeof document<"u"}async function IV(){return Yx()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},gV);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function TV(){return typeof window<"u"?window:null}const nr={LOCAL:"local",NONE:"none",SESSION:"session"},su=ne,Xx="persistence";function xV(n,e){if(su(Object.values(nr).includes(e),n,"invalid-persistence-type"),jy()){su(e!==nr.SESSION,n,"unsupported-persistence-type");return}if(Jf()){su(e===nr.NONE,n,"unsupported-persistence-type");return}if(c_()){su(e===nr.NONE||e===nr.LOCAL&&Mu(),n,"unsupported-persistence-type");return}su(e===nr.NONE||Jx(),n,"unsupported-persistence-type")}async function Hg(n){await n._initializationPromise;const e=Zx(),t=Jo(Xx,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function SV(n,e){const t=Zx();if(!t)return[];const r=Jo(Xx,n,e);switch(t.getItem(r)){case nr.NONE:return[bl];case nr.LOCAL:return[$u,ea];case nr.SESSION:return[ea];default:return[]}}function Zx(){try{return TV()?.sessionStorage||null}catch{return null}}const bV=ne;class Oi{constructor(){this.browserResolver=rr(BD),this.cordovaResolver=rr(hV),this.underlyingResolver=null,this._redirectPersistence=ea,this._completeRedirectFn=ap,this._overrideRedirectResult=a_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,s)}async _openRedirect(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Yx()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return bV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await IV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function e1(n){return n.unwrap()}function AV(n){return n.wrapped()}function RV(n){return t1(n)}function PV(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new kV(n,w2(n,e))}else if(t){const r=t1(e),s=e;r&&(s.credential=r,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function t1(n){const{_tokenResponse:e}=n instanceof tn?n.customData:n;if(!e)return null;if(!(n instanceof tn)&&"temporaryProof"in e&&"phoneNumber"in e)return ta.credentialFromResult(n);const t=e.providerId;if(!t||t===nu.PASSWORD)return null;let r;switch(t){case nu.GOOGLE:r=os;break;case nu.FACEBOOK:r=is;break;case nu.GITHUB:r=as;break;case nu.TWITTER:r=ls;break;default:const{oauthIdToken:s,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:d,nonce:f}=e;return!a&&!l&&!s&&!d?null:d?t.startsWith("saml.")?Al._create(t,d):_s._fromParams({providerId:t,signInMethod:t,pendingToken:d,idToken:s,accessToken:a}):new vl(t).credential({idToken:s,accessToken:a,rawNonce:f})}return n instanceof tn?r.credentialFromError(n):r.credentialFromResult(n)}function jn(n,e){return e.catch(t=>{throw t instanceof tn&&PV(n,t),t}).then(t=>{const r=t.operationType,s=t.user;return{operationType:r,credential:RV(t),additionalUserInfo:v2(t),user:lp.getOrCreate(s)}})}async function Gg(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>jn(n,t.confirm(r))}}class kV{constructor(e,t){this.resolver=t,this.auth=AV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return jn(e1(this.auth),this.resolver.resolveSignIn(e))}}let lp=class pu{constructor(e){this._delegate=e,this.multiFactor=T2(e)}static getOrCreate(e){return pu.USER_MAP.has(e)||pu.USER_MAP.set(e,new pu(e)),pu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return jn(this.auth,kx(this._delegate,e))}async linkWithPhoneNumber(e,t){return Gg(this.auth,H2(this._delegate,e,t))}async linkWithPopup(e){return jn(this.auth,tD(this._delegate,e,Oi))}async linkWithRedirect(e){return await Hg(St(this.auth)),uD(this._delegate,e,Oi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return jn(this.auth,Cx(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Gg(this.auth,G2(this._delegate,e,t))}reauthenticateWithPopup(e){return jn(this.auth,eD(this._delegate,e,Oi))}async reauthenticateWithRedirect(e){return await Hg(St(this.auth)),lD(this._delegate,e,Oi)}sendEmailVerification(e){return l2(this._delegate,e)}async unlink(e){return await KN(this._delegate,e),this}updateEmail(e){return h2(this._delegate,e)}updatePassword(e){return f2(this._delegate,e)}updatePhoneNumber(e){return K2(this._delegate,e)}updateProfile(e){return d2(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return c2(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};lp.USER_MAP=new WeakMap;const iu=ne;class Kg{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;iu(r,"invalid-api-key",{appName:e.name}),iu(r,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?Oi:void 0;this._delegate=t.initialize({options:{persistence:CV(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(MC),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?lp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){SN(this._delegate,e,t)}applyActionCode(e){return ZN(this._delegate,e)}checkActionCode(e){return Nx(this._delegate,e)}confirmPasswordReset(e,t){return XN(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return jn(this._delegate,t2(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return a2(this._delegate,e)}isSignInWithEmailLink(e){return s2(this._delegate,e)}async getRedirectResult(){iu(xg(),this._delegate,"operation-not-supported-in-this-environment");const e=await hD(this._delegate,Oi);return e?jn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){fV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:s,error:a,complete:l}=RI(e,t,r);return this._delegate.onAuthStateChanged(s,a,l)}onIdTokenChanged(e,t,r){const{next:s,error:a,complete:l}=RI(e,t,r);return this._delegate.onIdTokenChanged(s,a,l)}sendSignInLinkToEmail(e,t){return r2(this._delegate,e,t)}sendPasswordResetEmail(e,t){return YN(this._delegate,e,t||void 0)}async setPersistence(e){xV(this._delegate,e);let t;switch(e){case nr.SESSION:t=ea;break;case nr.LOCAL:t=await rr($u)._isAvailable()?$u:n_;break;case nr.NONE:t=bl;break;default:return pn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return jn(this._delegate,GN(this._delegate))}signInWithCredential(e){return jn(this._delegate,np(this._delegate,e))}signInWithCustomToken(e){return jn(this._delegate,JN(this._delegate,e))}signInWithEmailAndPassword(e,t){return jn(this._delegate,n2(this._delegate,e,t))}signInWithEmailLink(e,t){return jn(this._delegate,i2(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Gg(this._delegate,W2(this._delegate,e,t))}async signInWithPopup(e){return iu(xg(),this._delegate,"operation-not-supported-in-this-environment"),jn(this._delegate,Z2(this._delegate,e,Oi))}async signInWithRedirect(e){return iu(xg(),this._delegate,"operation-not-supported-in-this-environment"),await Hg(this._delegate),oD(this._delegate,e,Oi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return e2(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Kg.Persistence=nr;function RI(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const s=r;return{next:l=>s(l&&lp.getOrCreate(l)),error:e,complete:t}}function CV(n,e){const t=SV(n,e);if(typeof self<"u"&&!t.includes($u)&&t.push($u),typeof window<"u")for(const r of[n_,ea])t.includes(r)||t.push(r);return t.includes(bl)||t.push(bl),t}class u_{static credential(e,t){return ta.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new ta(e1(hn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}u_.PHONE_SIGN_IN_METHOD=ta.PHONE_SIGN_IN_METHOD;u_.PROVIDER_ID=ta.PROVIDER_ID;const NV=ne;class DV{constructor(e,t,r=hn.app()){NV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new $2(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const VV="auth-compat";function OV(n){n.INTERNAL.registerComponent(new _r(VV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Kg(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:sl.EMAIL_SIGNIN,PASSWORD_RESET:sl.PASSWORD_RESET,RECOVER_EMAIL:sl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:sl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:sl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:sl.VERIFY_EMAIL}},EmailAuthProvider:no,FacebookAuthProvider:is,GithubAuthProvider:as,GoogleAuthProvider:os,OAuthProvider:vl,SAMLAuthProvider:bf,PhoneAuthProvider:u_,PhoneMultiFactorGenerator:Kx,RecaptchaVerifier:DV,TwitterAuthProvider:ls,Auth:Kg,AuthCredential:Yl,Error:tn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(pV,mV)}OV(hn);var PI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ui,n1;(function(){var n;function e(b,S){function k(){}k.prototype=S.prototype,b.F=S.prototype,b.prototype=new k,b.prototype.constructor=b,b.D=function(D,R,M){for(var P=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)P[Ce-2]=arguments[Ce];return S.prototype[R].apply(D,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(b,S,k){k||(k=0);const D=Array(16);if(typeof S=="string")for(var R=0;R<16;++R)D[R]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(R=0;R<16;++R)D[R]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=b.g[0],k=b.g[1],R=b.g[2];let M=b.g[3],P;P=S+(M^k&(R^M))+D[0]+3614090360&4294967295,S=k+(P<<7&4294967295|P>>>25),P=M+(R^S&(k^R))+D[1]+3905402710&4294967295,M=S+(P<<12&4294967295|P>>>20),P=R+(k^M&(S^k))+D[2]+606105819&4294967295,R=M+(P<<17&4294967295|P>>>15),P=k+(S^R&(M^S))+D[3]+3250441966&4294967295,k=R+(P<<22&4294967295|P>>>10),P=S+(M^k&(R^M))+D[4]+4118548399&4294967295,S=k+(P<<7&4294967295|P>>>25),P=M+(R^S&(k^R))+D[5]+1200080426&4294967295,M=S+(P<<12&4294967295|P>>>20),P=R+(k^M&(S^k))+D[6]+2821735955&4294967295,R=M+(P<<17&4294967295|P>>>15),P=k+(S^R&(M^S))+D[7]+4249261313&4294967295,k=R+(P<<22&4294967295|P>>>10),P=S+(M^k&(R^M))+D[8]+1770035416&4294967295,S=k+(P<<7&4294967295|P>>>25),P=M+(R^S&(k^R))+D[9]+2336552879&4294967295,M=S+(P<<12&4294967295|P>>>20),P=R+(k^M&(S^k))+D[10]+4294925233&4294967295,R=M+(P<<17&4294967295|P>>>15),P=k+(S^R&(M^S))+D[11]+2304563134&4294967295,k=R+(P<<22&4294967295|P>>>10),P=S+(M^k&(R^M))+D[12]+1804603682&4294967295,S=k+(P<<7&4294967295|P>>>25),P=M+(R^S&(k^R))+D[13]+4254626195&4294967295,M=S+(P<<12&4294967295|P>>>20),P=R+(k^M&(S^k))+D[14]+2792965006&4294967295,R=M+(P<<17&4294967295|P>>>15),P=k+(S^R&(M^S))+D[15]+1236535329&4294967295,k=R+(P<<22&4294967295|P>>>10),P=S+(R^M&(k^R))+D[1]+4129170786&4294967295,S=k+(P<<5&4294967295|P>>>27),P=M+(k^R&(S^k))+D[6]+3225465664&4294967295,M=S+(P<<9&4294967295|P>>>23),P=R+(S^k&(M^S))+D[11]+643717713&4294967295,R=M+(P<<14&4294967295|P>>>18),P=k+(M^S&(R^M))+D[0]+3921069994&4294967295,k=R+(P<<20&4294967295|P>>>12),P=S+(R^M&(k^R))+D[5]+3593408605&4294967295,S=k+(P<<5&4294967295|P>>>27),P=M+(k^R&(S^k))+D[10]+38016083&4294967295,M=S+(P<<9&4294967295|P>>>23),P=R+(S^k&(M^S))+D[15]+3634488961&4294967295,R=M+(P<<14&4294967295|P>>>18),P=k+(M^S&(R^M))+D[4]+3889429448&4294967295,k=R+(P<<20&4294967295|P>>>12),P=S+(R^M&(k^R))+D[9]+568446438&4294967295,S=k+(P<<5&4294967295|P>>>27),P=M+(k^R&(S^k))+D[14]+3275163606&4294967295,M=S+(P<<9&4294967295|P>>>23),P=R+(S^k&(M^S))+D[3]+4107603335&4294967295,R=M+(P<<14&4294967295|P>>>18),P=k+(M^S&(R^M))+D[8]+1163531501&4294967295,k=R+(P<<20&4294967295|P>>>12),P=S+(R^M&(k^R))+D[13]+2850285829&4294967295,S=k+(P<<5&4294967295|P>>>27),P=M+(k^R&(S^k))+D[2]+4243563512&4294967295,M=S+(P<<9&4294967295|P>>>23),P=R+(S^k&(M^S))+D[7]+1735328473&4294967295,R=M+(P<<14&4294967295|P>>>18),P=k+(M^S&(R^M))+D[12]+2368359562&4294967295,k=R+(P<<20&4294967295|P>>>12),P=S+(k^R^M)+D[5]+4294588738&4294967295,S=k+(P<<4&4294967295|P>>>28),P=M+(S^k^R)+D[8]+2272392833&4294967295,M=S+(P<<11&4294967295|P>>>21),P=R+(M^S^k)+D[11]+1839030562&4294967295,R=M+(P<<16&4294967295|P>>>16),P=k+(R^M^S)+D[14]+4259657740&4294967295,k=R+(P<<23&4294967295|P>>>9),P=S+(k^R^M)+D[1]+2763975236&4294967295,S=k+(P<<4&4294967295|P>>>28),P=M+(S^k^R)+D[4]+1272893353&4294967295,M=S+(P<<11&4294967295|P>>>21),P=R+(M^S^k)+D[7]+4139469664&4294967295,R=M+(P<<16&4294967295|P>>>16),P=k+(R^M^S)+D[10]+3200236656&4294967295,k=R+(P<<23&4294967295|P>>>9),P=S+(k^R^M)+D[13]+681279174&4294967295,S=k+(P<<4&4294967295|P>>>28),P=M+(S^k^R)+D[0]+3936430074&4294967295,M=S+(P<<11&4294967295|P>>>21),P=R+(M^S^k)+D[3]+3572445317&4294967295,R=M+(P<<16&4294967295|P>>>16),P=k+(R^M^S)+D[6]+76029189&4294967295,k=R+(P<<23&4294967295|P>>>9),P=S+(k^R^M)+D[9]+3654602809&4294967295,S=k+(P<<4&4294967295|P>>>28),P=M+(S^k^R)+D[12]+3873151461&4294967295,M=S+(P<<11&4294967295|P>>>21),P=R+(M^S^k)+D[15]+530742520&4294967295,R=M+(P<<16&4294967295|P>>>16),P=k+(R^M^S)+D[2]+3299628645&4294967295,k=R+(P<<23&4294967295|P>>>9),P=S+(R^(k|~M))+D[0]+4096336452&4294967295,S=k+(P<<6&4294967295|P>>>26),P=M+(k^(S|~R))+D[7]+1126891415&4294967295,M=S+(P<<10&4294967295|P>>>22),P=R+(S^(M|~k))+D[14]+2878612391&4294967295,R=M+(P<<15&4294967295|P>>>17),P=k+(M^(R|~S))+D[5]+4237533241&4294967295,k=R+(P<<21&4294967295|P>>>11),P=S+(R^(k|~M))+D[12]+1700485571&4294967295,S=k+(P<<6&4294967295|P>>>26),P=M+(k^(S|~R))+D[3]+2399980690&4294967295,M=S+(P<<10&4294967295|P>>>22),P=R+(S^(M|~k))+D[10]+4293915773&4294967295,R=M+(P<<15&4294967295|P>>>17),P=k+(M^(R|~S))+D[1]+2240044497&4294967295,k=R+(P<<21&4294967295|P>>>11),P=S+(R^(k|~M))+D[8]+1873313359&4294967295,S=k+(P<<6&4294967295|P>>>26),P=M+(k^(S|~R))+D[15]+4264355552&4294967295,M=S+(P<<10&4294967295|P>>>22),P=R+(S^(M|~k))+D[6]+2734768916&4294967295,R=M+(P<<15&4294967295|P>>>17),P=k+(M^(R|~S))+D[13]+1309151649&4294967295,k=R+(P<<21&4294967295|P>>>11),P=S+(R^(k|~M))+D[4]+4149444226&4294967295,S=k+(P<<6&4294967295|P>>>26),P=M+(k^(S|~R))+D[11]+3174756917&4294967295,M=S+(P<<10&4294967295|P>>>22),P=R+(S^(M|~k))+D[2]+718787259&4294967295,R=M+(P<<15&4294967295|P>>>17),P=k+(M^(R|~S))+D[9]+3951481745&4294967295,b.g[0]=b.g[0]+S&4294967295,b.g[1]=b.g[1]+(R+(P<<21&4294967295|P>>>11))&4294967295,b.g[2]=b.g[2]+R&4294967295,b.g[3]=b.g[3]+M&4294967295}r.prototype.v=function(b,S){S===void 0&&(S=b.length);const k=S-this.blockSize,D=this.C;let R=this.h,M=0;for(;M<S;){if(R==0)for(;M<=k;)s(this,b,M),M+=this.blockSize;if(typeof b=="string"){for(;M<S;)if(D[R++]=b.charCodeAt(M++),R==this.blockSize){s(this,D),R=0;break}}else for(;M<S;)if(D[R++]=b[M++],R==this.blockSize){s(this,D),R=0;break}}this.h=R,this.o+=S},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var S=1;S<b.length-8;++S)b[S]=0;S=this.o*8;for(var k=b.length-8;k<b.length;++k)b[k]=S&255,S/=256;for(this.v(b),b=Array(16),S=0,k=0;k<4;++k)for(let D=0;D<32;D+=8)b[S++]=this.g[k]>>>D&255;return b};function a(b,S){var k=d;return Object.prototype.hasOwnProperty.call(k,b)?k[b]:k[b]=S(b)}function l(b,S){this.h=S;const k=[];let D=!0;for(let R=b.length-1;R>=0;R--){const M=b[R]|0;D&&M==S||(k[R]=M,D=!1)}this.g=k}var d={};function f(b){return-128<=b&&b<128?a(b,function(S){return new l([S|0],S<0?-1:0)}):new l([b|0],b<0?-1:0)}function p(b){if(isNaN(b)||!isFinite(b))return w;if(b<0)return V(p(-b));const S=[];let k=1;for(let D=0;b>=k;D++)S[D]=b/k|0,k*=4294967296;return new l(S,0)}function g(b,S){if(b.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(b.charAt(0)=="-")return V(g(b.substring(1),S));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=p(Math.pow(S,8));let D=w;for(let M=0;M<b.length;M+=8){var R=Math.min(8,b.length-M);const P=parseInt(b.substring(M,M+R),S);R<8?(R=p(Math.pow(S,R)),D=D.j(R).add(p(P))):(D=D.j(k),D=D.add(p(P)))}return D}var w=f(0),T=f(1),N=f(16777216);n=l.prototype,n.m=function(){if(L(this))return-V(this).m();let b=0,S=1;for(let k=0;k<this.g.length;k++){const D=this.i(k);b+=(D>=0?D:4294967296+D)*S,S*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(A(this))return"0";if(L(this))return"-"+V(this).toString(b);const S=p(Math.pow(b,6));var k=this;let D="";for(;;){const R=pe(k,S).g;k=se(k,R.j(S));let M=((k.g.length>0?k.g[0]:k.h)>>>0).toString(b);if(k=R,A(k))return M+D;for(;M.length<6;)M="0"+M;D=M+D}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function A(b){if(b.h!=0)return!1;for(let S=0;S<b.g.length;S++)if(b.g[S]!=0)return!1;return!0}function L(b){return b.h==-1}n.l=function(b){return b=se(this,b),L(b)?-1:A(b)?0:1};function V(b){const S=b.g.length,k=[];for(let D=0;D<S;D++)k[D]=~b.g[D];return new l(k,~b.h).add(T)}n.abs=function(){return L(this)?V(this):this},n.add=function(b){const S=Math.max(this.g.length,b.g.length),k=[];let D=0;for(let R=0;R<=S;R++){let M=D+(this.i(R)&65535)+(b.i(R)&65535),P=(M>>>16)+(this.i(R)>>>16)+(b.i(R)>>>16);D=P>>>16,M&=65535,P&=65535,k[R]=P<<16|M}return new l(k,k[k.length-1]&-2147483648?-1:0)};function se(b,S){return b.add(V(S))}n.j=function(b){if(A(this)||A(b))return w;if(L(this))return L(b)?V(this).j(V(b)):V(V(this).j(b));if(L(b))return V(this.j(V(b)));if(this.l(N)<0&&b.l(N)<0)return p(this.m()*b.m());const S=this.g.length+b.g.length,k=[];for(var D=0;D<2*S;D++)k[D]=0;for(D=0;D<this.g.length;D++)for(let R=0;R<b.g.length;R++){const M=this.i(D)>>>16,P=this.i(D)&65535,Ce=b.i(R)>>>16,tt=b.i(R)&65535;k[2*D+2*R]+=P*tt,ie(k,2*D+2*R),k[2*D+2*R+1]+=M*tt,ie(k,2*D+2*R+1),k[2*D+2*R+1]+=P*Ce,ie(k,2*D+2*R+1),k[2*D+2*R+2]+=M*Ce,ie(k,2*D+2*R+2)}for(b=0;b<S;b++)k[b]=k[2*b+1]<<16|k[2*b];for(b=S;b<2*S;b++)k[b]=0;return new l(k,0)};function ie(b,S){for(;(b[S]&65535)!=b[S];)b[S+1]+=b[S]>>>16,b[S]&=65535,S++}function Q(b,S){this.g=b,this.h=S}function pe(b,S){if(A(S))throw Error("division by zero");if(A(b))return new Q(w,w);if(L(b))return S=pe(V(b),S),new Q(V(S.g),V(S.h));if(L(S))return S=pe(b,V(S)),new Q(V(S.g),S.h);if(b.g.length>30){if(L(b)||L(S))throw Error("slowDivide_ only works with positive integers.");for(var k=T,D=S;D.l(b)<=0;)k=te(k),D=te(D);var R=ae(k,1),M=ae(D,1);for(D=ae(D,2),k=ae(k,2);!A(D);){var P=M.add(D);P.l(b)<=0&&(R=R.add(k),M=P),D=ae(D,1),k=ae(k,1)}return S=se(b,R.j(S)),new Q(R,S)}for(R=w;b.l(S)>=0;){for(k=Math.max(1,Math.floor(b.m()/S.m())),D=Math.ceil(Math.log(k)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),M=p(k),P=M.j(S);L(P)||P.l(b)>0;)k-=D,M=p(k),P=M.j(S);A(M)&&(M=T),R=R.add(M),b=se(b,P)}return new Q(R,b)}n.B=function(b){return pe(this,b).h},n.and=function(b){const S=Math.max(this.g.length,b.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)&b.i(D);return new l(k,this.h&b.h)},n.or=function(b){const S=Math.max(this.g.length,b.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)|b.i(D);return new l(k,this.h|b.h)},n.xor=function(b){const S=Math.max(this.g.length,b.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)^b.i(D);return new l(k,this.h^b.h)};function te(b){const S=b.g.length+1,k=[];for(let D=0;D<S;D++)k[D]=b.i(D)<<1|b.i(D-1)>>>31;return new l(k,b.h)}function ae(b,S){const k=S>>5;S%=32;const D=b.g.length-k,R=[];for(let M=0;M<D;M++)R[M]=S>0?b.i(M+k)>>>S|b.i(M+k+1)<<32-S:b.i(M+k);return new l(R,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,n1=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=g,Ui=l}).apply(typeof PI<"u"?PI:typeof self<"u"?self:typeof window<"u"?window:{});var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var r1,mu,s1,af,Qg,i1,o1,a1;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kh=="object"&&Kh];for(var _=0;_<u.length;++_){var E=u[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=t(this);function s(u,_){if(_)e:{var E=r;u=u.split(".");for(var x=0;x<u.length-1;x++){var z=u[x];if(!(z in E))break e;E=E[z]}u=u[u.length-1],x=E[u],_=_(x),_!=x&&_!=null&&e(E,u,{configurable:!0,writable:!0,value:_})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(_){var E=[],x;for(x in _)Object.prototype.hasOwnProperty.call(_,x)&&E.push([x,_[x]]);return E}});var a=a||{},l=this||self;function d(u){var _=typeof u;return _=="object"&&u!=null||_=="function"}function f(u,_,E){return u.call.apply(u.bind,arguments)}function p(u,_,E){return p=f,p.apply(null,arguments)}function g(u,_){var E=Array.prototype.slice.call(arguments,1);return function(){var x=E.slice();return x.push.apply(x,arguments),u.apply(this,x)}}function w(u,_){function E(){}E.prototype=_.prototype,u.Z=_.prototype,u.prototype=new E,u.prototype.constructor=u,u.Ob=function(x,z,H){for(var le=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)le[Ve-2]=arguments[Ve];return _.prototype[z].apply(x,le)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function N(u){const _=u.length;if(_>0){const E=Array(_);for(let x=0;x<_;x++)E[x]=u[x];return E}return[]}function A(u,_){for(let x=1;x<arguments.length;x++){const z=arguments[x];var E=typeof z;if(E=E!="object"?E:z?Array.isArray(z)?"array":E:"null",E=="array"||E=="object"&&typeof z.length=="number"){E=u.length||0;const H=z.length||0;u.length=E+H;for(let le=0;le<H;le++)u[E+le]=z[le]}else u.push(z)}}class L{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function V(u){l.setTimeout(()=>{throw u},0)}function se(){var u=b;let _=null;return u.g&&(_=u.g,u.g=u.g.next,u.g||(u.h=null),_.next=null),_}class ie{constructor(){this.h=this.g=null}add(_,E){const x=Q.get();x.set(_,E),this.h?this.h.next=x:this.g=x,this.h=x}}var Q=new L(()=>new pe,u=>u.reset());class pe{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let te,ae=!1,b=new ie,S=()=>{const u=Promise.resolve(void 0);te=()=>{u.then(k)}};function k(){for(var u;u=se();){try{u.h.call(u.g)}catch(E){V(E)}var _=Q;_.j(u),_.h<100&&(_.h++,u.next=_.g,_.g=u)}ae=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(u,_){this.type=u,this.g=this.target=_,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var u=!1,_=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const E=()=>{};l.addEventListener("test",E,_),l.removeEventListener("test",E,_)}catch{}return u})();function P(u){return/^[\s\xa0]*$/.test(u)}function Ce(u,_){R.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,_)}w(Ce,R),Ce.prototype.init=function(u,_){const E=this.type=u.type,x=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=_,_=u.relatedTarget,_||(E=="mouseover"?_=u.fromElement:E=="mouseout"&&(_=u.toElement)),this.relatedTarget=_,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&Ce.Z.h.call(this)},Ce.prototype.h=function(){Ce.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var tt="closure_listenable_"+(Math.random()*1e6|0),$e=0;function ue(u,_,E,x,z){this.listener=u,this.proxy=null,this.src=_,this.type=E,this.capture=!!x,this.ha=z,this.key=++$e,this.da=this.fa=!1}function Y(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ve(u,_,E){for(const x in u)_.call(E,u[x],x,u)}function de(u,_){for(const E in u)_.call(void 0,u[E],E,u)}function j(u){const _={};for(const E in u)_[E]=u[E];return _}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Re(u,_){let E,x;for(let z=1;z<arguments.length;z++){x=arguments[z];for(E in x)u[E]=x[E];for(let H=0;H<K.length;H++)E=K[H],Object.prototype.hasOwnProperty.call(x,E)&&(u[E]=x[E])}}function ke(u){this.src=u,this.g={},this.h=0}ke.prototype.add=function(u,_,E,x,z){const H=u.toString();u=this.g[H],u||(u=this.g[H]=[],this.h++);const le=Fe(u,_,x,z);return le>-1?(_=u[le],E||(_.fa=!1)):(_=new ue(_,this.src,H,!!x,z),_.fa=E,u.push(_)),_};function Me(u,_){const E=_.type;if(E in u.g){var x=u.g[E],z=Array.prototype.indexOf.call(x,_,void 0),H;(H=z>=0)&&Array.prototype.splice.call(x,z,1),H&&(Y(_),u.g[E].length==0&&(delete u.g[E],u.h--))}}function Fe(u,_,E,x){for(let z=0;z<u.length;++z){const H=u[z];if(!H.da&&H.listener==_&&H.capture==!!E&&H.ha==x)return z}return-1}var Je="closure_lm_"+(Math.random()*1e6|0),We={};function rt(u,_,E,x,z){if(Array.isArray(_)){for(let H=0;H<_.length;H++)rt(u,_[H],E,x,z);return null}return E=Lr(E),u&&u[tt]?u.J(_,E,d(x)?!!x.capture:!1,z):rn(u,_,E,!1,x,z)}function rn(u,_,E,x,z,H){if(!_)throw Error("Invalid event type");const le=d(z)?!!z.capture:!!z;let Ve=sn(u);if(Ve||(u[Je]=Ve=new ke(u)),E=Ve.add(_,E,x,le,H),E.proxy)return E;if(x=Zs(),E.proxy=x,x.src=u,x.listener=E,u.addEventListener)M||(z=le),z===void 0&&(z=!1),u.addEventListener(_.toString(),x,z);else if(u.attachEvent)u.attachEvent(lt(_.toString()),x);else if(u.addListener&&u.removeListener)u.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Zs(){function u(E){return _.call(u.src,u.listener,E)}const _=bt;return u}function Pe(u,_,E,x,z){if(Array.isArray(_))for(var H=0;H<_.length;H++)Pe(u,_[H],E,x,z);else x=d(x)?!!x.capture:!!x,E=Lr(E),u&&u[tt]?(u=u.i,H=String(_).toString(),H in u.g&&(_=u.g[H],E=Fe(_,E,x,z),E>-1&&(Y(_[E]),Array.prototype.splice.call(_,E,1),_.length==0&&(delete u.g[H],u.h--)))):u&&(u=sn(u))&&(_=u.g[_.toString()],u=-1,_&&(u=Fe(_,E,x,z)),(E=u>-1?_[u]:null)&&je(E))}function je(u){if(typeof u!="number"&&u&&!u.da){var _=u.src;if(_&&_[tt])Me(_.i,u);else{var E=u.type,x=u.proxy;_.removeEventListener?_.removeEventListener(E,x,u.capture):_.detachEvent?_.detachEvent(lt(E),x):_.addListener&&_.removeListener&&_.removeListener(x),(E=sn(_))?(Me(E,u),E.h==0&&(E.src=null,_[Je]=null)):Y(u)}}}function lt(u){return u in We?We[u]:We[u]="on"+u}function bt(u,_){if(u.da)u=!0;else{_=new Ce(_,this);const E=u.listener,x=u.ha||u.src;u.fa&&je(u),u=E.call(x,_)}return u}function sn(u){return u=u[Je],u instanceof ke?u:null}var jt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Lr(u){return typeof u=="function"?u:(u[jt]||(u[jt]=function(_){return u.handleEvent(_)}),u[jt])}function Ye(){D.call(this),this.i=new ke(this),this.M=this,this.G=null}w(Ye,D),Ye.prototype[tt]=!0,Ye.prototype.removeEventListener=function(u,_,E,x){Pe(this,u,_,E,x)};function At(u,_){var E,x=u.G;if(x)for(E=[];x;x=x.G)E.push(x);if(u=u.M,x=_.type||_,typeof _=="string")_=new R(_,u);else if(_ instanceof R)_.target=_.target||u;else{var z=_;_=new R(x,u),Re(_,z)}z=!0;let H,le;if(E)for(le=E.length-1;le>=0;le--)H=_.g=E[le],z=Nn(H,x,!0,_)&&z;if(H=_.g=u,z=Nn(H,x,!0,_)&&z,z=Nn(H,x,!1,_)&&z,E)for(le=0;le<E.length;le++)H=_.g=E[le],z=Nn(H,x,!1,_)&&z}Ye.prototype.N=function(){if(Ye.Z.N.call(this),this.i){var u=this.i;for(const _ in u.g){const E=u.g[_];for(let x=0;x<E.length;x++)Y(E[x]);delete u.g[_],u.h--}}this.G=null},Ye.prototype.J=function(u,_,E,x){return this.i.add(String(u),_,!1,E,x)},Ye.prototype.K=function(u,_,E,x){return this.i.add(String(u),_,!0,E,x)};function Nn(u,_,E,x){if(_=u.i.g[String(_)],!_)return!0;_=_.concat();let z=!0;for(let H=0;H<_.length;++H){const le=_[H];if(le&&!le.da&&le.capture==E){const Ve=le.listener,Dt=le.ha||le.src;le.fa&&Me(u.i,le),z=Ve.call(Dt,x)!==!1&&z}}return z&&!x.defaultPrevented}function lo(u,_){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:l.setTimeout(u,_||0)}function uc(u){u.g=lo(()=>{u.g=null,u.i&&(u.i=!1,uc(u))},u.l);const _=u.h;u.h=null,u.m.apply(null,_)}class Nd extends D{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:uc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ei(u){D.call(this),this.h=u,this.g={}}w(ei,D);var dc=[];function va(u){ve(u.g,function(_,E){this.g.hasOwnProperty(E)&&je(_)},u),u.g={}}ei.prototype.N=function(){ei.Z.N.call(this),va(this)},ei.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ti=l.JSON.stringify,Dd=l.JSON.parse,co=class{stringify(u){return l.JSON.stringify(u,void 0)}parse(u){return l.JSON.parse(u,void 0)}};function ni(){}function Vd(){}var ri={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wa(){R.call(this,"d")}w(wa,R);function hc(){R.call(this,"c")}w(hc,R);var wr={},Ea=null;function si(){return Ea=Ea||new Ye}wr.Ia="serverreachability";function Ia(u){R.call(this,wr.Ia,u)}w(Ia,R);function Es(u){const _=si();At(_,new Ia(_))}wr.STAT_EVENT="statevent";function Is(u,_){R.call(this,wr.STAT_EVENT,u),this.stat=_}w(Is,R);function Rt(u){const _=si();At(_,new Is(_,u))}wr.Ja="timingevent";function fc(u,_){R.call(this,wr.Ja,u),this.size=_}w(fc,R);function ii(u,_){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){u()},_)}function oi(){this.g=!0}oi.prototype.ua=function(){this.g=!1};function Od(u,_,E,x,z,H){u.info(function(){if(u.g)if(H){var le="",Ve=H.split("&");for(let st=0;st<Ve.length;st++){var Dt=Ve[st].split("=");if(Dt.length>1){const Ut=Dt[0];Dt=Dt[1];const Yn=Ut.split("_");le=Yn.length>=2&&Yn[1]=="type"?le+(Ut+"="+Dt+"&"):le+(Ut+"=redacted&")}}}else le=null;else le=H;return"XMLHTTP REQ ("+x+") [attempt "+z+"]: "+_+`
`+E+`
`+le})}function Ld(u,_,E,x,z,H,le){u.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+z+"]: "+_+`
`+E+`
`+H+" "+le})}function Mr(u,_,E,x){u.info(function(){return"XMLHTTP TEXT ("+_+"): "+uo(u,E)+(x?" "+x:"")})}function Md(u,_){u.info(function(){return"TIMEOUT: "+_})}oi.prototype.info=function(){};function uo(u,_){if(!u.g)return _;if(!_)return null;try{const H=JSON.parse(_);if(H){for(u=0;u<H.length;u++)if(Array.isArray(H[u])){var E=H[u];if(!(E.length<2)){var x=E[1];if(Array.isArray(x)&&!(x.length<1)){var z=x[0];if(z!="noop"&&z!="stop"&&z!="close")for(let le=1;le<x.length;le++)x[le]=""}}}}return ti(H)}catch{return _}}var ai={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},li={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Fd;function Ts(){}w(Ts,ni),Ts.prototype.g=function(){return new XMLHttpRequest},Fd=new Ts;function Fr(u){return encodeURIComponent(String(u))}function Ta(u){var _=1;u=u.split(":");const E=[];for(;_>0&&u.length;)E.push(u.shift()),_--;return u.length&&E.push(u.join(":")),E}function ar(u,_,E,x){this.j=u,this.i=_,this.l=E,this.S=x||1,this.V=new ei(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new jd}function jd(){this.i=null,this.g="",this.h=!1}var Ud={},pc={};function Er(u,_,E){u.M=1,u.A=Ss(lr(_)),u.u=E,u.R=!0,mc(u,null)}function mc(u,_){u.F=Date.now(),ho(u),u.B=lr(u.A);var E=u.B,x=u.S;Array.isArray(x)||(x=[String(x)]),Sc(E.i,"t",x),u.C=0,E=u.j.L,u.h=new jd,u.g=Jd(u.j,E?_:null,!u.u),u.P>0&&(u.O=new Nd(p(u.Y,u,u.g),u.P)),_=u.V,E=u.g,x=u.ba;var z="readystatechange";Array.isArray(z)||(z&&(dc[0]=z.toString()),z=dc);for(let H=0;H<z.length;H++){const le=rt(E,z[H],x||_.handleEvent,!1,_.h||_);if(!le)break;_.g[le.key]=le}_=u.J?j(u.J):{},u.u?(u.v||(u.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,_)):(u.v="GET",u.g.ea(u.B,u.v,null,_)),Es(),Od(u.i,u.v,u.B,u.l,u.S,u.u)}ar.prototype.ba=function(u){u=u.target;const _=this.O;_&&Wr(u)==3?_.j():this.Y(u)},ar.prototype.Y=function(u){try{if(u==this.g)e:{const Ve=Wr(this.g),Dt=this.g.ya(),st=this.g.ca();if(!(Ve<3)&&(Ve!=3||this.g&&(this.h.h||this.g.la()||Kd(this.g)))){this.K||Ve!=4||Dt==7||(Dt==8||st<=0?Es(3):Es(2)),xa(this);var _=this.g.ca();this.X=_;var E=Bd(this);if(this.o=_==200,Ld(this.i,this.v,this.B,this.l,this.S,Ve,_),this.o){if(this.U&&!this.L){t:{if(this.g){var x,z=this.g;if((x=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(x)){var H=x;break t}}H=null}if(u=H)Mr(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ht(this,u);else{this.o=!1,this.m=3,Rt(12),xs(this),fo(this);break e}}if(this.R){u=!0;let Ut;for(;!this.K&&this.C<E.length;)if(Ut=$d(this,E),Ut==pc){Ve==4&&(this.m=4,Rt(14),u=!1),Mr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==Ud){this.m=4,Rt(15),Mr(this.i,this.l,E,"[Invalid Chunk]"),u=!1;break}else Mr(this.i,this.l,Ut,null),ht(this,Ut);if(zd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ve!=4||E.length!=0||this.h.h||(this.m=1,Rt(16),u=!1),this.o=this.o&&u,!u)Mr(this.i,this.l,E,"[Invalid Chunked Response]"),xs(this),fo(this);else if(E.length>0&&!this.W){this.W=!0;var le=this.j;le.g==this&&le.aa&&!le.P&&(le.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Io(le),le.P=!0,Rt(11))}}else Mr(this.i,this.l,E,null),ht(this,E);Ve==4&&xs(this),this.o&&!this.K&&(Ve==4?Va(this.j,this):(this.o=!1,ho(this)))}else Ac(this.g),_==400&&E.indexOf("Unknown SID")>0?(this.m=3,Rt(12)):(this.m=0,Rt(13)),xs(this),fo(this)}}}catch{}};function Bd(u){if(!zd(u))return u.g.la();const _=Kd(u.g);if(_==="")return"";let E="";const x=_.length,z=Wr(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return xs(u),fo(u),"";u.h.i=new l.TextDecoder}for(let H=0;H<x;H++)u.h.h=!0,E+=u.h.i.decode(_[H],{stream:!(z&&H==x-1)});return _.length=0,u.h.g+=E,u.C=0,u.h.g}function zd(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function $d(u,_){var E=u.C,x=_.indexOf(`
`,E);return x==-1?pc:(E=Number(_.substring(E,x)),isNaN(E)?Ud:(x+=1,x+E>_.length?pc:(_=_.slice(x,x+E),u.C=x+E,_)))}ar.prototype.cancel=function(){this.K=!0,xs(this)};function ho(u){u.T=Date.now()+u.H,gc(u,u.H)}function gc(u,_){if(u.D!=null)throw Error("WatchDog timer not null");u.D=ii(p(u.aa,u),_)}function xa(u){u.D&&(l.clearTimeout(u.D),u.D=null)}ar.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(Md(this.i,this.B),this.M!=2&&(Es(),Rt(17)),xs(this),this.m=2,fo(this)):gc(this,this.T-u)};function fo(u){u.j.I==0||u.K||Va(u.j,u)}function xs(u){xa(u);var _=u.O;_&&typeof _.dispose=="function"&&_.dispose(),u.O=null,va(u.V),u.g&&(_=u.g,u.g=null,_.abort(),_.dispose())}function ht(u,_){try{var E=u.j;if(E.I!=0&&(E.g==u||_c(E.h,u))){if(!u.L&&_c(E.h,u)&&E.I==3){try{var x=E.Ba.g.parse(_)}catch{x=null}if(Array.isArray(x)&&x.length==3){var z=x;if(z[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<u.F)Da(E),Qn(E);else break e;Kr(E),Rt(18)}}else E.xa=z[1],0<E.xa-E.K&&z[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=ii(p(E.Va,E),6e3));po(E.h)<=1&&E.ta&&(E.ta=void 0)}else Jn(E,11)}else if((u.L||E.g==u)&&Da(E),!P(_))for(z=E.Ba.g.parse(_),_=0;_<z.length;_++){let st=z[_];const Ut=st[0];if(!(Ut<=E.K))if(E.K=Ut,st=st[1],E.I==2)if(st[0]=="c"){E.M=st[1],E.ba=st[2];const Yn=st[3];Yn!=null&&(E.ka=Yn,E.j.info("VER="+E.ka));const ks=st[4];ks!=null&&(E.za=ks,E.j.info("SVER="+E.za));const Qr=st[5];Qr!=null&&typeof Qr=="number"&&Qr>0&&(x=1.5*Qr,E.O=x,E.j.info("backChannelRequestTimeoutMs_="+x)),x=E;const Jr=u.g;if(Jr){const Ma=Jr.g?Jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ma){var H=x.h;H.g||Ma.indexOf("spdy")==-1&&Ma.indexOf("quic")==-1&&Ma.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(ba(H,H.h),H.h=null))}if(x.G){const kc=Jr.g?Jr.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(x.wa=kc,et(x.J,x.G,kc))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-u.F,E.j.info("Handshake RTT: "+E.T+"ms")),x=E;var le=u;if(x.na=Pc(x,x.L?x.ba:null,x.W),le.L){mo(x.h,le);var Ve=le,Dt=x.O;Dt&&(Ve.H=Dt),Ve.D&&(xa(Ve),ho(Ve)),x.g=le}else mn(x);E.i.length>0&&Ps(E)}else st[0]!="stop"&&st[0]!="close"||Jn(E,7);else E.I==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Jn(E,7):Ca(E):st[0]!="noop"&&E.l&&E.l.qa(st),E.A=0)}}Es(4)}catch{}}var Up=class{constructor(u,_){this.g=u,this.map=_}};function Sa(u){this.l=u||10,l.PerformanceNavigationTiming?(u=l.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function yc(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function po(u){return u.h?1:u.g?u.g.size:0}function _c(u,_){return u.h?u.h==_:u.g?u.g.has(_):!1}function ba(u,_){u.g?u.g.add(_):u.h=_}function mo(u,_){u.h&&u.h==_?u.h=null:u.g&&u.g.has(_)&&u.g.delete(_)}Sa.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Hn(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let _=u.i;for(const E of u.g.values())_=_.concat(E.G);return _}return N(u.i)}var qd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gn(u,_){if(u){u=u.split("&");for(let E=0;E<u.length;E++){const x=u[E].indexOf("=");let z,H=null;x>=0?(z=u[E].substring(0,x),H=u[E].substring(x+1)):z=u[E],_(z,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function jr(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;u instanceof jr?(this.l=u.l,go(this,u.j),this.o=u.o,this.g=u.g,Ur(this,u.u),this.h=u.h,ci(this,bc(u.i)),this.m=u.m):u&&(_=String(u).match(qd))?(this.l=!1,go(this,_[1]||"",!0),this.o=yo(_[2]||""),this.g=yo(_[3]||"",!0),Ur(this,_[4]),this.h=yo(_[5]||"",!0),ci(this,_[6]||"",!0),this.m=yo(_[7]||"")):(this.l=!1,this.i=new He(null,this.l))}jr.prototype.toString=function(){const u=[];var _=this.j;_&&u.push(_o(_,wc,!0),":");var E=this.g;return(E||_=="file")&&(u.push("//"),(_=this.o)&&u.push(_o(_,wc,!0),"@"),u.push(Fr(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&u.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(_o(E,E.charAt(0)=="/"?vo:Ec,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",_o(E,Ic)),u.join("")},jr.prototype.resolve=function(u){const _=lr(this);let E=!!u.j;E?go(_,u.j):E=!!u.o,E?_.o=u.o:E=!!u.g,E?_.g=u.g:E=u.u!=null;var x=u.h;if(E)Ur(_,u.u);else if(E=!!u.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var z=_.h.lastIndexOf("/");z!=-1&&(x=_.h.slice(0,z+1)+x)}if(z=x,z==".."||z==".")x="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){x=z.lastIndexOf("/",0)==0,z=z.split("/");const H=[];for(let le=0;le<z.length;){const Ve=z[le++];Ve=="."?x&&le==z.length&&H.push(""):Ve==".."?((H.length>1||H.length==1&&H[0]!="")&&H.pop(),x&&le==z.length&&H.push("")):(H.push(Ve),x=!0)}x=H.join("/")}else x=z}return E?_.h=x:E=u.i.toString()!=="",E?ci(_,bc(u.i)):E=!!u.m,E&&(_.m=u.m),_};function lr(u){return new jr(u)}function go(u,_,E){u.j=E?yo(_,!0):_,u.j&&(u.j=u.j.replace(/:$/,""))}function Ur(u,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);u.u=_}else u.u=null}function ci(u,_,E){_ instanceof He?(u.i=_,Ra(u.i,u.l)):(E||(_=_o(_,Bp)),u.i=new He(_,u.l))}function et(u,_,E){u.i.set(_,E)}function Ss(u){return et(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function yo(u,_){return u?_?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function _o(u,_,E){return typeof u=="string"?(u=encodeURI(u).replace(_,vc),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function vc(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var wc=/[#\/\?@]/g,Ec=/[#\?:]/g,vo=/[#\?]/g,Bp=/[#\?@]/g,Ic=/#/g;function He(u,_){this.h=this.g=null,this.i=u||null,this.j=!!_}function Br(u){u.g||(u.g=new Map,u.h=0,u.i&&Gn(u.i,function(_,E){u.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}n=He.prototype,n.add=function(u,_){Br(this),this.i=null,u=zr(this,u);let E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(_),this.h+=1,this};function Tc(u,_){Br(u),_=zr(u,_),u.g.has(_)&&(u.i=null,u.h-=u.g.get(_).length,u.g.delete(_))}function Aa(u,_){return Br(u),_=zr(u,_),u.g.has(_)}n.forEach=function(u,_){Br(this),this.g.forEach(function(E,x){E.forEach(function(z){u.call(_,z,x,this)},this)},this)};function xc(u,_){Br(u);let E=[];if(typeof _=="string")Aa(u,_)&&(E=E.concat(u.g.get(zr(u,_))));else for(u=Array.from(u.g.values()),_=0;_<u.length;_++)E=E.concat(u[_]);return E}n.set=function(u,_){return Br(this),this.i=null,u=zr(this,u),Aa(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[_]),this.h+=1,this},n.get=function(u,_){return u?(u=xc(this,u),u.length>0?String(u[0]):_):_};function Sc(u,_,E){Tc(u,_),E.length>0&&(u.i=null,u.g.set(zr(u,_),N(E)),u.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],_=Array.from(this.g.keys());for(let x=0;x<_.length;x++){var E=_[x];const z=Fr(E);E=xc(this,E);for(let H=0;H<E.length;H++){let le=z;E[H]!==""&&(le+="="+Fr(E[H])),u.push(le)}}return this.i=u.join("&")};function bc(u){const _=new He;return _.i=u.i,u.g&&(_.g=new Map(u.g),_.h=u.h),_}function zr(u,_){return _=String(_),u.j&&(_=_.toLowerCase()),_}function Ra(u,_){_&&!u.j&&(Br(u),u.i=null,u.g.forEach(function(E,x){const z=x.toLowerCase();x!=z&&(Tc(this,x),Sc(this,z,E))},u)),u.j=_}function $r(u,_){const E=new oi;if(l.Image){const x=new Image;x.onload=g(on,E,"TestLoadImage: loaded",!0,_,x),x.onerror=g(on,E,"TestLoadImage: error",!1,_,x),x.onabort=g(on,E,"TestLoadImage: abort",!1,_,x),x.ontimeout=g(on,E,"TestLoadImage: timeout",!1,_,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=u}else _(!1)}function qr(u,_){const E=new oi,x=new AbortController,z=setTimeout(()=>{x.abort(),on(E,"TestPingServer: timeout",!1,_)},1e4);fetch(u,{signal:x.signal}).then(H=>{clearTimeout(z),H.ok?on(E,"TestPingServer: ok",!0,_):on(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(z),on(E,"TestPingServer: error",!1,_)})}function on(u,_,E,x,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),x(E)}catch{}}function wo(){this.g=new co}function bs(u){this.i=u.Sb||null,this.h=u.ab||!1}w(bs,ni),bs.prototype.g=function(){return new Kn(this.i,this.h)};function Kn(u,_){Ye.call(this),this.H=u,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Kn,Ye),n=Kn.prototype,n.open=function(u,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=_,this.readyState=1,Ir(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(_.body=u),(this.H||l).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ui(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ir(this)),this.g&&(this.readyState=3,Ir(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Wd(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function Wd(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var _=u.value?u.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!u.done}))&&(this.response=this.responseText+=_)}u.done?ui(this):Ir(this),this.readyState==3&&Wd(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,ui(this))},n.Na=function(u){this.g&&(this.response=u,ui(this))},n.ga=function(){this.g&&ui(this)};function ui(u){u.readyState=4,u.l=null,u.j=null,u.B=null,Ir(u)}n.setRequestHeader=function(u,_){this.A.append(u,_)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=_.next();return u.join(`\r
`)};function Ir(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Kn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Hd(u){let _="";return ve(u,function(E,x){_+=x,_+=":",_+=E,_+=`\r
`}),_}function Pa(u,_,E){e:{for(x in E){var x=!1;break e}x=!0}x||(E=Hd(E),typeof u=="string"?E!=null&&Fr(E):et(u,_,E))}function at(u){Ye.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(at,Ye);var Gd=/^https?$/i,zp=["POST","PUT"];n=at.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,_,E,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);_=_?_.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Fd.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(_,String(u),!0),this.B=!1}catch(H){di(this,H);return}if(u=E||"",E=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var z in x)E.set(z,x[z]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const H of x.keys())E.set(H,x.get(H));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(E.keys()).find(H=>H.toLowerCase()=="content-type"),z=l.FormData&&u instanceof l.FormData,!(Array.prototype.indexOf.call(zp,_,void 0)>=0)||x||z||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,le]of E)this.g.setRequestHeader(H,le);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(H){di(this,H)}};function di(u,_){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=_,u.o=5,hi(u),Rs(u)}function hi(u){u.A||(u.A=!0,At(u,"complete"),At(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,At(this,"complete"),At(this,"abort"),Rs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rs(this,!0)),at.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?As(this):this.Xa())},n.Xa=function(){As(this)};function As(u){if(u.h&&typeof a<"u"){if(u.v&&Wr(u)==4)setTimeout(u.Ca.bind(u),0);else if(At(u,"readystatechange"),Wr(u)==4){u.h=!1;try{const H=u.ca();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var x;if(x=H===0){let le=String(u.D).match(qd)[1]||null;!le&&l.self&&l.self.location&&(le=l.self.location.protocol.slice(0,-1)),x=!Gd.test(le?le.toLowerCase():"")}E=x}if(E)At(u,"complete"),At(u,"success");else{u.o=6;try{var z=Wr(u)>2?u.g.statusText:""}catch{z=""}u.l=z+" ["+u.ca()+"]",hi(u)}}finally{Rs(u)}}}}function Rs(u,_){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const E=u.g;u.g=null,_||At(u,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Wr(u){return u.g?u.g.readyState:0}n.ca=function(){try{return Wr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var _=this.g.responseText;return u&&_.indexOf(u)==0&&(_=_.substring(u.length)),Dd(_)}};function Kd(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ac(u){const _={};u=(u.g&&Wr(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<u.length;x++){if(P(u[x]))continue;var E=Ta(u[x]);const z=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const H=_[z]||[];_[z]=H,H.push(E)}de(_,function(x){return x.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hr(u,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||_}function ka(u){this.za=0,this.i=[],this.j=new oi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Hr("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Hr("baseRetryDelayMs",5e3,u),this.Za=Hr("retryDelaySeedMs",1e4,u),this.Ta=Hr("forwardChannelMaxRetries",2,u),this.va=Hr("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new Sa(u&&u.concurrentRequestLimit),this.Ba=new wo,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ka.prototype,n.ka=8,n.I=1,n.connect=function(u,_,E,x){Rt(0),this.W=u,this.H=_||{},E&&x!==void 0&&(this.H.OSID=E,this.H.OAID=x),this.F=this.X,this.J=Pc(this,null,this.W),Ps(this)};function Ca(u){if(Na(u),u.I==3){var _=u.V++,E=lr(u.J);if(et(E,"SID",u.M),et(E,"RID",_),et(E,"TYPE","terminate"),Gr(u,E),_=new ar(u,u.j,_),_.M=2,_.A=Ss(lr(E)),E=!1,l.navigator&&l.navigator.sendBeacon)try{E=l.navigator.sendBeacon(_.A.toString(),"")}catch{}!E&&l.Image&&(new Image().src=_.A,E=!0),E||(_.g=Jd(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ho(_)}To(u)}function Qn(u){u.g&&(Io(u),u.g.cancel(),u.g=null)}function Na(u){Qn(u),u.v&&(l.clearTimeout(u.v),u.v=null),Da(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&l.clearTimeout(u.m),u.m=null)}function Ps(u){if(!yc(u.h)&&!u.m){u.m=!0;var _=u.Ea;te||S(),ae||(te(),ae=!0),b.add(_,u),u.D=0}}function Qd(u,_){return po(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=_.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=ii(p(u.Ea,u,_),Oa(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const z=new ar(this,this.j,u);let H=this.o;if(this.U&&(H?(H=j(H),Re(H,this.U)):H=this.U),this.u!==null||this.R||(z.J=H,H=null),this.S)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var x=this.i[E];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(_+=x,_>4096){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=Rc(this,z,_),E=lr(this.J),et(E,"RID",u),et(E,"CVER",22),this.G&&et(E,"X-HTTP-Session-Id",this.G),Gr(this,E),H&&(this.R?_="headers="+Fr(Hd(H))+"&"+_:this.u&&Pa(E,this.u,H)),ba(this.h,z),this.Ra&&et(E,"TYPE","init"),this.S?(et(E,"$req",_),et(E,"SID","null"),z.U=!0,Er(z,E,null)):Er(z,E,_),this.I=2}}else this.I==3&&(u?Eo(this,u):this.i.length==0||yc(this.h)||Eo(this))};function Eo(u,_){var E;_?E=_.l:E=u.V++;const x=lr(u.J);et(x,"SID",u.M),et(x,"RID",E),et(x,"AID",u.K),Gr(u,x),u.u&&u.o&&Pa(x,u.u,u.o),E=new ar(u,u.j,E,u.D+1),u.u===null&&(E.J=u.o),_&&(u.i=_.G.concat(u.i)),_=Rc(u,E,1e3),E.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),ba(u.h,E),Er(E,x,_)}function Gr(u,_){u.H&&ve(u.H,function(E,x){et(_,x,E)}),u.l&&ve({},function(E,x){et(_,x,E)})}function Rc(u,_,E){E=Math.min(u.i.length,E);const x=u.l?p(u.l.Ka,u.l,u):null;e:{var z=u.i;let Ve=-1;for(;;){const Dt=["count="+E];Ve==-1?E>0?(Ve=z[0].g,Dt.push("ofs="+Ve)):Ve=0:Dt.push("ofs="+Ve);let st=!0;for(let Ut=0;Ut<E;Ut++){var H=z[Ut].g;const Yn=z[Ut].map;if(H-=Ve,H<0)Ve=Math.max(0,z[Ut].g-100),st=!1;else try{H="req"+H+"_"||"";try{var le=Yn instanceof Map?Yn:Object.entries(Yn);for(const[ks,Qr]of le){let Jr=Qr;d(Qr)&&(Jr=ti(Qr)),Dt.push(H+ks+"="+encodeURIComponent(Jr))}}catch(ks){throw Dt.push(H+"type="+encodeURIComponent("_badmap")),ks}}catch{x&&x(Yn)}}if(st){le=Dt.join("&");break e}}le=void 0}return u=u.i.splice(0,E),_.G=u,le}function mn(u){if(!u.g&&!u.v){u.Y=1;var _=u.Da;te||S(),ae||(te(),ae=!0),b.add(_,u),u.A=0}}function Kr(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=ii(p(u.Da,u),Oa(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,fi(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=ii(p(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Rt(10),Qn(this),fi(this))};function Io(u){u.B!=null&&(l.clearTimeout(u.B),u.B=null)}function fi(u){u.g=new ar(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var _=lr(u.na);et(_,"RID","rpc"),et(_,"SID",u.M),et(_,"AID",u.K),et(_,"CI",u.F?"0":"1"),!u.F&&u.ia&&et(_,"TO",u.ia),et(_,"TYPE","xmlhttp"),Gr(u,_),u.u&&u.o&&Pa(_,u.u,u.o),u.O&&(u.g.H=u.O);var E=u.g;u=u.ba,E.M=1,E.A=Ss(lr(_)),E.u=null,E.R=!0,mc(E,u)}n.Va=function(){this.C!=null&&(this.C=null,Qn(this),Kr(this),Rt(19))};function Da(u){u.C!=null&&(l.clearTimeout(u.C),u.C=null)}function Va(u,_){var E=null;if(u.g==_){Da(u),Io(u),u.g=null;var x=2}else if(_c(u.h,_))E=_.G,mo(u.h,_),x=1;else return;if(u.I!=0){if(_.o)if(x==1){E=_.u?_.u.length:0,_=Date.now()-_.F;var z=u.D;x=si(),At(x,new fc(x,E)),Ps(u)}else mn(u);else if(z=_.m,z==3||z==0&&_.X>0||!(x==1&&Qd(u,_)||x==2&&Kr(u)))switch(E&&E.length>0&&(_=u.h,_.i=_.i.concat(E)),z){case 1:Jn(u,5);break;case 4:Jn(u,10);break;case 3:Jn(u,6);break;default:Jn(u,2)}}}function Oa(u,_){let E=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(E*=2),E*_}function Jn(u,_){if(u.j.info("Error code "+_),_==2){var E=p(u.bb,u),x=u.Ua;const z=!x;x=new jr(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||go(x,"https"),Ss(x),z?$r(x.toString(),E):qr(x.toString(),E)}else Rt(2);u.I=0,u.l&&u.l.pa(_),To(u),Na(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function To(u){if(u.I=0,u.ja=[],u.l){const _=Hn(u.h);(_.length!=0||u.i.length!=0)&&(A(u.ja,_),A(u.ja,u.i),u.h.i.length=0,N(u.i),u.i.length=0),u.l.oa()}}function Pc(u,_,E){var x=E instanceof jr?lr(E):new jr(E);if(x.g!="")_&&(x.g=_+"."+x.g),Ur(x,x.u);else{var z=l.location;x=z.protocol,_=_?_+"."+z.hostname:z.hostname,z=+z.port;const H=new jr(null);x&&go(H,x),_&&(H.g=_),z&&Ur(H,z),E&&(H.h=E),x=H}return E=u.G,_=u.wa,E&&_&&et(x,E,_),et(x,"VER",u.ka),Gr(u,x),x}function Jd(u,_,E){if(_&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=u.Aa&&!u.ma?new at(new bs({ab:E})):new at(u.ma),_.Fa(u.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yd(){}n=Yd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function La(){}La.prototype.g=function(u,_){return new an(u,_)};function an(u,_){Ye.call(this),this.g=new ka(_),this.l=u,this.h=_&&_.messageUrlParams||null,u=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(u?u["X-WebChannel-Content-Type"]=_.messageContentType:u={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(u?u["X-WebChannel-Client-Profile"]=_.sa:u={"X-WebChannel-Client-Profile":_.sa}),this.g.U=u,(u=_&&_.Qb)&&!P(u)&&(this.g.u=u),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!P(_)&&(this.g.G=_,u=this.h,u!==null&&_ in u&&(u=this.h,_ in u&&delete u[_])),this.j=new pi(this)}w(an,Ye),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Ca(this.g)},an.prototype.o=function(u){var _=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.v&&(E={},E.__data__=ti(u),u=E);_.i.push(new Up(_.Ya++,u)),_.I==3&&Ps(_)},an.prototype.N=function(){this.g.l=null,delete this.j,Ca(this.g),delete this.g,an.Z.N.call(this)};function Xd(u){wa.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var _=u.__sm__;if(_){e:{for(const E in _){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,_=_!==null&&u in _?_[u]:void 0),this.data=_}else this.data=u}w(Xd,wa);function Zd(){hc.call(this),this.status=1}w(Zd,hc);function pi(u){this.g=u}w(pi,Yd),pi.prototype.ra=function(){At(this.g,"a")},pi.prototype.qa=function(u){At(this.g,new Xd(u))},pi.prototype.pa=function(u){At(this.g,new Zd)},pi.prototype.oa=function(){At(this.g,"b")},La.prototype.createWebChannel=La.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,a1=function(){return new La},o1=function(){return si()},i1=wr,Qg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ai.NO_ERROR=0,ai.TIMEOUT=8,ai.HTTP_ERROR=6,af=ai,li.COMPLETE="complete",s1=li,Vd.EventType=ri,ri.OPEN="a",ri.CLOSE="b",ri.ERROR="c",ri.MESSAGE="d",Ye.prototype.listen=Ye.prototype.J,mu=Vd,at.prototype.listenOnce=at.prototype.K,at.prototype.getLastError=at.prototype.Ha,at.prototype.getLastErrorCode=at.prototype.ya,at.prototype.getStatus=at.prototype.ca,at.prototype.getResponseJson=at.prototype.La,at.prototype.getResponseText=at.prototype.la,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Fa,r1=at}).apply(typeof Kh<"u"?Kh:typeof self<"u"?self:typeof window<"u"?window:{});const kI="@firebase/firestore",CI="4.9.3";class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");let Zl="12.7.0";const Hi=new Yf("@firebase/firestore");function dl(){return Hi.logLevel}function LV(n){Hi.setLogLevel(n)}function Z(n,...e){if(Hi.logLevel<=Be.DEBUG){const t=e.map(d_);Hi.debug(`Firestore (${Zl}): ${n}`,...t)}}function Ot(n,...e){if(Hi.logLevel<=Be.ERROR){const t=e.map(d_);Hi.error(`Firestore (${Zl}): ${n}`,...t)}}function vs(n,...e){if(Hi.logLevel<=Be.WARN){const t=e.map(d_);Hi.warn(`Firestore (${Zl}): ${n}`,...t)}}function d_(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function me(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,l1(n,r,t)}function l1(n,e,t){let r=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ot(r),new Error(r)}function we(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||l1(e,s,r)}function MV(n,e){n||me(57014,e)}function fe(n,e){return n}const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends tn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class c1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(en.UNAUTHENTICATED)))}shutdown(){}}class jV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class UV{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){we(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new fn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new fn,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new fn)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string",31837,{l:r}),new c1(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new en(e)}}class BV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zV{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new BV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(en.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class NI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $V{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){we(this.o===void 0,3512);const r=a=>{a.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,Z("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new NI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(we(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new NI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function qV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class h_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=qV(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function De(n,e){return n<e?-1:n>e?1:0}function Jg(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),a=e.charAt(r);if(s!==a)return Sg(s)===Sg(a)?De(s,a):Sg(s)?1:-1}return De(n.length,e.length)}const WV=55296,HV=57343;function Sg(n){const e=n.charCodeAt(0);return e>=WV&&e<=HV}function Rl(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function u1(n){return n+"\0"}const DI="__name__";class ns{constructor(e,t,r){t===void 0?t=0:t>e.length&&me(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&me(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ns.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ns?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=ns.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return De(e.length,t.length)}static compareSegments(e,t){const r=ns.isNumericId(e),s=ns.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ns.extractNumericId(e).compare(ns.extractNumericId(t)):Jg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ui.fromString(e.substring(4,e.length-2))}}class ze extends ns{construct(e,t,r){return new ze(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ze(t)}static emptyPath(){return new ze([])}}const GV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends ns{construct(e,t,r){return new vt(e,t,r)}static isValidIdentifier(e){return GV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===DI}static keyField(){return new vt([DI])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new J(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new J(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new J(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(r+=d,s++):(a(),s++)}if(a(),l)throw new J(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(t)}static emptyPath(){return new vt([])}}class ce{constructor(e){this.path=e}static fromPath(e){return new ce(ze.fromString(e))}static fromName(e){return new ce(ze.fromString(e).popFirst(5))}static empty(){return new ce(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new ze(e.slice()))}}function f_(n,e,t){if(!t)throw new J(W.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function d1(n,e,t,r){if(e===!0&&r===!0)throw new J(W.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VI(n){if(!ce.isDocumentKey(n))throw new J(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function OI(n){if(ce.isDocumentKey(n))throw new J(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function h1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function cp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":me(12329,{type:typeof n})}function Ze(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new J(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cp(n);throw new J(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function f1(n,e){if(e<=0)throw new J(W.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function qt(n,e){const t={typeString:n};return e&&(t.value=e),t}function fd(n,e){if(!h1(n))throw new J(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new J(W.INVALID_ARGUMENT,t);return!0}const LI=-62135596800,MI=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*MI);return new nt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new J(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new J(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<LI)throw new J(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MI}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fd(e,nt._jsonSchema))return new nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-LI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nt._jsonSchemaVersion="firestore/timestamp/1.0",nt._jsonSchema={type:qt("string",nt._jsonSchemaVersion),seconds:qt("number"),nanoseconds:qt("number")};class Te{static fromTimestamp(e){return new Te(e)}static min(){return new Te(new nt(0,0))}static max(){return new Te(new nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Pl=-1;class kf{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Yg(n){return n.fields.find((e=>e.kind===2))}function Fo(n){return n.fields.filter((e=>e.kind!==2))}kf.UNKNOWN_ID=-1;class lf{constructor(e,t){this.fieldPath=e,this.kind=t}}class qu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new qu(0,or.min())}}function p1(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Te.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new or(s,ce.empty(),e)}function m1(n){return new or(n.readTime,n.key,Pl)}class or{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new or(Te.min(),ce.empty(),Pl)}static max(){return new or(Te.max(),ce.empty(),Pl)}}function p_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ce.comparator(n.documentKey,e.documentKey),t!==0?t:De(n.largestBatchId,e.largestBatchId))}const g1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ro(n){if(n.code!==W.FAILED_PRECONDITION||n.message!==g1)throw n;Z("LocalStore","Unexpectedly lost primary lease")}class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):U.reject(t)}static resolve(e){return new U(((t,r)=>{t(e)}))}static reject(e){return new U(((t,r)=>{r(e)}))}static waitFor(e){return new U(((t,r)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=U.resolve(!1);for(const r of e)t=t.next((s=>s?U.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new U(((r,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((g=>{l[p]=g,++d,d===a&&r(l)}),(g=>s(g)))}}))}static doWhile(e,t){return new U(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}const tr="SimpleDb";class up{static open(e,t,r,s){try{return new up(t,e.transaction(s,r))}catch(a){throw new bu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new fn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new bu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=m_(r.target.error);this.S.reject(new bu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Z(tr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new QV(t)}}class ms{static delete(e){return Z(tr,"Removing database:",e),Uo(Vy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Mu())return!1;if(ms.F())return!0;const e=xt(),t=ms.M(e),r=0<t&&t<10,s=_1(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,ms.M(xt())===12.2&&Ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Z(tr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new bu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new J(W.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new J(W.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new bu(e,l))},s.onupgradeneeded=a=>{Z(tr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{Z(tr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=up.open(this.db,e,a?"readonly":"readwrite",r),f=s(d).next((p=>(d.C(),p))).catch((p=>(d.abort(p),U.reject(p)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&l<3;if(Z(tr,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function _1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class KV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Uo(this.U.delete())}}class bu extends J{constructor(e,t){super(W.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function so(n){return n.name==="IndexedDbTransactionError"}class QV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Z(tr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Z(tr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Uo(r)}add(e){return Z(tr,"ADD",this.store.name,e,e),Uo(this.store.add(e))}get(e){return Uo(this.store.get(e)).next((t=>(t===void 0&&(t=null),Z(tr,"GET",this.store.name,e,t),t)))}delete(e){return Z(tr,"DELETE",this.store.name,e),Uo(this.store.delete(e))}count(){return Z(tr,"COUNT",this.store.name),Uo(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new U(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.H(a,((d,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new U(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){Z(tr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const s=this.cursor(r);return this.H(s,((a,l,d)=>d.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}te(e){const t=this.cursor({});return new U(((r,s)=>{t.onerror=a=>{const l=m_(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}H(e,t){const r=[];return new U(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new KV(d),p=t(d.primaryKey,d.value,f);if(p instanceof U){const g=p.catch((w=>(f.done(),U.reject(w))));r.push(g)}f.isDone?s():f.G===null?d.continue():d.continue(f.G)}})).next((()=>U.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Uo(n){return new U(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=m_(r.target.error);t(s)}}))}let FI=!1;function m_(n){const e=ms.M(xt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new J("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return FI||(FI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Au="IndexBackfiller";class JV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Z(Au,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Z(Au,`Documents written: ${t}`)}catch(t){so(t)?Z(Au,"Ignoring IndexedDB error during index backfill: ",t):await ro(t)}await this.re(6e4)}))}}class YV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let s=t,a=!0;return U.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return Z(Au,`Processing collection: ${l}`),this.oe(e,l,s).next((d=>{s-=d,r.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((d=>(Z(Au,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=m1(a);p_(l,r)>0&&(r=l)})),new or(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Un{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Un.ce=-1;const Bi=-1;function pd(n){return n==null}function Wu(n){return n===0&&1/n==-1/0}function v1(n){return typeof n=="number"&&Number.isInteger(n)&&!Wu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Cf="";function xn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jI(e)),e=XV(n.get(t),e);return jI(e)}function XV(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Cf:t+="";break;default:t+=a}}return t}function jI(n){return n+Cf+""}function hs(n){const e=n.length;if(we(e>=2,64408,{path:n}),e===2)return we(n.charAt(0)===Cf&&n.charAt(1)==="",56145,{path:n}),ze.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Cf,a);switch((l<0||l>t)&&me(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:me(61167,{path:n})}a=l+2}return new ze(r)}const jo="remoteDocuments",md="owner",il="owner",Hu="mutationQueues",ZV="userId",kr="mutations",UI="batchId",Ho="userMutationsIndex",BI=["userId","batchId"];function cf(n,e){return[n,xn(e)]}function w1(n,e,t){return[n,xn(e),t]}const eO={},kl="documentMutations",Nf="remoteDocumentsV14",tO=["prefixPath","collectionGroup","readTime","documentId"],uf="documentKeyIndex",nO=["prefixPath","collectionGroup","documentId"],E1="collectionGroupIndex",rO=["collectionGroup","readTime","prefixPath","documentId"],Gu="remoteDocumentGlobal",Xg="remoteDocumentGlobalKey",Cl="targets",I1="queryTargetsIndex",sO=["canonicalId","targetId"],Nl="targetDocuments",iO=["targetId","path"],g_="documentTargetsIndex",oO=["path","targetId"],Df="targetGlobalKey",Xo="targetGlobal",Ku="collectionParents",aO=["collectionId","parent"],Dl="clientMetadata",lO="clientId",dp="bundles",cO="bundleId",hp="namedQueries",uO="name",y_="indexConfiguration",dO="indexId",Zg="collectionGroupIndex",hO="collectionGroup",Ru="indexState",fO=["indexId","uid"],T1="sequenceNumberIndex",pO=["uid","sequenceNumber"],Pu="indexEntries",mO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],x1="documentKeyIndex",gO=["indexId","uid","orderedDocumentKey"],fp="documentOverlays",yO=["userId","collectionPath","documentId"],ey="collectionPathOverlayIndex",_O=["userId","collectionPath","largestBatchId"],S1="collectionGroupOverlayIndex",vO=["userId","collectionGroup","largestBatchId"],__="globals",wO="name",b1=[Hu,kr,kl,jo,Cl,md,Xo,Nl,Dl,Gu,Ku,dp,hp],EO=[...b1,fp],A1=[Hu,kr,kl,Nf,Cl,md,Xo,Nl,Dl,Gu,Ku,dp,hp,fp],R1=A1,v_=[...R1,y_,Ru,Pu],IO=v_,P1=[...v_,__],TO=P1;class ty extends y1{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qt(n,e){const t=fe(n);return ms.O(t.le,e)}function zI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function io(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function k1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class dt{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new dt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qh(this.root,e,this.comparator,!0)}}class Qh{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??un.RED,this.left=s??un.EMPTY,this.right=a??un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new un(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return un.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw me(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1;un.EMPTY=new class{constructor(){this.size=0}get key(){throw me(57766)}get value(){throw me(16141)}get color(){throw me(16727)}get left(){throw me(29726)}get right(){throw me(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ot{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $I(this.data.getIterator())}getIteratorFrom(e){return new $I(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ot(this.comparator);return t.data=e,t}}class $I{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ol(n){return n.hasNext()?n.getNext():void 0}class Bn{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new ot(vt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class C1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function xO(){return typeof atob<"u"}class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new C1("Invalid base64 string: "+a):a}})(e);return new kt(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const SO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ws(n){if(we(!!n,39018),typeof n=="string"){let e=0;const t=SO.exec(n);if(we(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_t(n.seconds),nanos:_t(n.nanos)}}function _t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Hs(n){return typeof n=="string"?kt.fromBase64String(n):kt.fromUint8Array(n)}const N1="server_timestamp",D1="__type__",V1="__previous_value__",O1="__local_write_time__";function pp(n){return(n?.mapValue?.fields||{})[D1]?.stringValue===N1}function mp(n){const e=n.mapValue.fields[V1];return pp(e)?mp(e):e}function Qu(n){const e=Ws(n.mapValue.fields[O1].timestampValue);return new nt(e.seconds,e.nanos)}class bO{constructor(e,t,r,s,a,l,d,f,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=g}}const ny="(default)";class Gi{constructor(e,t){this.projectId=e,this.database=t||ny}static empty(){return new Gi("","")}get isDefaultDatabase(){return this.database===ny}isEqual(e){return e instanceof Gi&&e.projectId===this.projectId&&e.database===this.database}}const w_="__type__",L1="__max__",Li={mapValue:{fields:{__type__:{stringValue:L1}}}},E_="__vector__",Vl="value",df={nullValue:"NULL_VALUE"};function Ki(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pp(n)?4:M1(n)?9007199254740991:gp(n)?10:11:me(28295,{value:n})}function ws(n,e){if(n===e)return!0;const t=Ki(n);if(t!==Ki(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qu(n).isEqual(Qu(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=Ws(s.timestampValue),d=Ws(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return Hs(s.bytesValue).isEqual(Hs(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return _t(s.geoPointValue.latitude)===_t(a.geoPointValue.latitude)&&_t(s.geoPointValue.longitude)===_t(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return _t(s.integerValue)===_t(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=_t(s.doubleValue),d=_t(a.doubleValue);return l===d?Wu(l)===Wu(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return Rl(n.arrayValue.values||[],e.arrayValue.values||[],ws);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(zI(l)!==zI(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!ws(l[f],d[f])))return!1;return!0})(n,e);default:return me(52216,{left:n})}}function Ju(n,e){return(n.values||[]).find((t=>ws(t,e)))!==void 0}function Qi(n,e){if(n===e)return 0;const t=Ki(n),r=Ki(e);if(t!==r)return De(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return De(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=_t(a.integerValue||a.doubleValue),f=_t(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return qI(n.timestampValue,e.timestampValue);case 4:return qI(Qu(n),Qu(e));case 5:return Jg(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=Hs(a),f=Hs(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let p=0;p<d.length&&p<f.length;p++){const g=De(d[p],f[p]);if(g!==0)return g}return De(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=De(_t(a.latitude),_t(l.latitude));return d!==0?d:De(_t(a.longitude),_t(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return WI(n.arrayValue,e.arrayValue);case 10:return(function(a,l){const d=a.fields||{},f=l.fields||{},p=d[Vl]?.arrayValue,g=f[Vl]?.arrayValue,w=De(p?.values?.length||0,g?.values?.length||0);return w!==0?w:WI(p,g)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Li.mapValue&&l===Li.mapValue)return 0;if(a===Li.mapValue)return 1;if(l===Li.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=l.fields||{},g=Object.keys(p);f.sort(),g.sort();for(let w=0;w<f.length&&w<g.length;++w){const T=Jg(f[w],g[w]);if(T!==0)return T;const N=Qi(d[f[w]],p[g[w]]);if(N!==0)return N}return De(f.length,g.length)})(n.mapValue,e.mapValue);default:throw me(23264,{he:t})}}function qI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return De(n,e);const t=Ws(n),r=Ws(e),s=De(t.seconds,r.seconds);return s!==0?s:De(t.nanos,r.nanos)}function WI(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=Qi(t[s],r[s]);if(a)return a}return De(t.length,r.length)}function Ol(n){return ry(n)}function ry(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ws(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Hs(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ce.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=ry(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${ry(t.fields[l])}`;return s+"}"})(n.mapValue):me(61005,{value:n})}function hf(n){switch(Ki(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=mp(n);return e?16+hf(e):16;case 5:return 2*n.stringValue.length;case 6:return Hs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+hf(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return io(r.fields,((a,l)=>{s+=a.length+hf(l)})),s})(n.mapValue);default:throw me(13486,{value:n})}}function ra(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function sy(n){return!!n&&"integerValue"in n}function Yu(n){return!!n&&"arrayValue"in n}function HI(n){return!!n&&"nullValue"in n}function GI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ff(n){return!!n&&"mapValue"in n}function gp(n){return(n?.mapValue?.fields||{})[w_]?.stringValue===E_}function ku(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return io(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ku(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ku(n.arrayValue.values[t]);return e}return{...n}}function M1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===L1}const F1={mapValue:{fields:{[w_]:{stringValue:E_},[Vl]:{arrayValue:{}}}}};function AO(n){return"nullValue"in n?df:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ra(Gi.empty(),ce.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?gp(n)?F1:{mapValue:{}}:me(35942,{value:n})}function RO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ra(Gi.empty(),ce.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?F1:"mapValue"in n?gp(n)?{mapValue:{}}:Li:me(61959,{value:n})}function KI(n,e){const t=Qi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function QI(n,e){const t=Qi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ff(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ku(t)}setAll(e){let t=vt.emptyPath(),r={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=d.popLast()}l?r[d.lastSegment()]=ku(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());ff(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ws(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ff(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){io(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new dn(ku(this.value))}}function j1(n){const e=[];return io(n.fields,((t,r)=>{const s=new vt([t]);if(ff(r)){const a=j1(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new Bn(e)}class mt{constructor(e,t,r,s,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new mt(e,0,Te.min(),Te.min(),Te.min(),dn.empty(),0)}static newFoundDocument(e,t,r,s){return new mt(e,1,t,Te.min(),r,s,0)}static newNoDocument(e,t){return new mt(e,2,t,Te.min(),Te.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new mt(e,3,t,Te.min(),Te.min(),dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ji{constructor(e,t){this.position=e,this.inclusive=t}}function JI(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=ce.comparator(ce.fromName(l.referenceValue),t.key):r=Qi(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function YI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ws(n.position[t],e.position[t]))return!1;return!0}class Xu{constructor(e,t="asc"){this.field=e,this.dir=t}}function PO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class U1{}class qe extends U1{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new kO(e,t,r):t==="array-contains"?new DO(e,r):t==="in"?new H1(e,r):t==="not-in"?new VO(e,r):t==="array-contains-any"?new OO(e,r):new qe(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new CO(e,r):new NO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Qi(t,this.value)):t!==null&&Ki(this.value)===Ki(t)&&this.matchesComparison(Qi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends U1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new it(e,t)}matches(e){return Ll(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ll(n){return n.op==="and"}function iy(n){return n.op==="or"}function I_(n){return B1(n)&&Ll(n)}function B1(n){for(const e of n.filters)if(e instanceof it)return!1;return!0}function oy(n){if(n instanceof qe)return n.field.canonicalString()+n.op.toString()+Ol(n.value);if(I_(n))return n.filters.map((e=>oy(e))).join(",");{const e=n.filters.map((t=>oy(t))).join(",");return`${n.op}(${e})`}}function z1(n,e){return n instanceof qe?(function(r,s){return s instanceof qe&&r.op===s.op&&r.field.isEqual(s.field)&&ws(r.value,s.value)})(n,e):n instanceof it?(function(r,s){return s instanceof it&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,d)=>a&&z1(l,s.filters[d])),!0):!1})(n,e):void me(19439)}function $1(n,e){const t=n.filters.concat(e);return it.create(t,n.op)}function q1(n){return n instanceof qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ol(t.value)}`})(n):n instanceof it?(function(t){return t.op.toString()+" {"+t.getFilters().map(q1).join(" ,")+"}"})(n):"Filter"}class kO extends qe{constructor(e,t,r){super(e,t,r),this.key=ce.fromName(r.referenceValue)}matches(e){const t=ce.comparator(e.key,this.key);return this.matchesComparison(t)}}class CO extends qe{constructor(e,t){super(e,"in",t),this.keys=W1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class NO extends qe{constructor(e,t){super(e,"not-in",t),this.keys=W1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function W1(n,e){return(e.arrayValue?.values||[]).map((t=>ce.fromName(t.referenceValue)))}class DO extends qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yu(t)&&Ju(t.arrayValue,this.value)}}class H1 extends qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ju(this.value.arrayValue,t)}}class VO extends qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ju(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ju(this.value.arrayValue,t)}}class OO extends qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ju(this.value.arrayValue,r)))}}class LO{constructor(e,t=null,r=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Te=null}}function ay(n,e=null,t=[],r=[],s=null,a=null,l=null){return new LO(n,e,t,r,s,a,l)}function sa(n){const e=fe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>oy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),pd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ol(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ol(r))).join(",")),e.Te=t}return e.Te}function gd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!PO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!z1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!YI(n.startAt,e.startAt)&&YI(n.endAt,e.endAt)}function Vf(n){return ce.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Of(n,e){return n.filters.filter((t=>t instanceof qe&&t.field.isEqual(e)))}function XI(n,e,t){let r=df,s=!0;for(const a of Of(n,e)){let l=df,d=!0;switch(a.op){case"<":case"<=":l=AO(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=df}KI({value:r,inclusive:s},{value:l,inclusive:d})<0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];KI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function ZI(n,e,t){let r=Li,s=!0;for(const a of Of(n,e)){let l=Li,d=!0;switch(a.op){case">=":case">":l=RO(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Li}QI({value:r,inclusive:s},{value:l,inclusive:d})>0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];QI({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}class Qs{constructor(e,t=null,r=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function G1(n,e,t,r,s,a,l,d){return new Qs(n,e,t,r,s,a,l,d)}function ec(n){return new Qs(n)}function e0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function T_(n){return n.collectionGroup!==null}function El(n){const e=fe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new ot(vt.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Xu(a,r))})),t.has(vt.keyField().canonicalString())||e.Ie.push(new Xu(vt.keyField(),r))}return e.Ie}function kn(n){const e=fe(n);return e.Ee||(e.Ee=MO(e,El(n))),e.Ee}function MO(n,e){if(n.limitType==="F")return ay(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Xu(s.field,a)}));const t=n.endAt?new Ji(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ji(n.startAt.position,n.startAt.inclusive):null;return ay(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ly(n,e){const t=n.filters.concat([e]);return new Qs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Lf(n,e,t){return new Qs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yd(n,e){return gd(kn(n),kn(e))&&n.limitType===e.limitType}function K1(n){return`${sa(kn(n))}|lt:${n.limitType}`}function hl(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>q1(s))).join(", ")}]`),pd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Ol(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Ol(s))).join(",")),`Target(${r})`})(kn(n))}; limitType=${n.limitType})`}function _d(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ce.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of El(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,d,f){const p=JI(l,d,f);return l.inclusive?p<=0:p<0})(r.startAt,El(r),s)||r.endAt&&!(function(l,d,f){const p=JI(l,d,f);return l.inclusive?p>=0:p>0})(r.endAt,El(r),s))})(n,e)}function Q1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function J1(n){return(e,t)=>{let r=!1;for(const s of El(n)){const a=FO(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function FO(n,e,t){const r=n.field.isKeyField()?ce.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),p=d.data.field(a);return f!==null&&p!==null?Qi(f,p):me(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return me(19790,{direction:n.dir})}}class Js{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){io(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return k1(this.inner)}size(){return this.innerSize}}const jO=new dt(ce.comparator);function zn(){return jO}const Y1=new dt(ce.comparator);function gu(...n){let e=Y1;for(const t of n)e=e.insert(t.key,t);return e}function X1(n){let e=Y1;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function fs(){return Cu()}function Z1(){return Cu()}function Cu(){return new Js((n=>n.toString()),((n,e)=>n.isEqual(e)))}const UO=new dt(ce.comparator),BO=new ot(ce.comparator);function Le(...n){let e=BO;for(const t of n)e=e.add(t);return e}const zO=new ot(De);function x_(){return zO}function S_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wu(e)?"-0":e}}function eS(n){return{integerValue:""+n}}function tS(n,e){return v1(e)?eS(e):S_(n,e)}class yp{constructor(){this._=void 0}}function $O(n,e,t){return n instanceof Ml?(function(s,a){const l={fields:{[D1]:{stringValue:N1},[O1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&pp(a)&&(a=mp(a)),a&&(l.fields[V1]=a),{mapValue:l}})(t,e):n instanceof ia?rS(n,e):n instanceof oa?sS(n,e):(function(s,a){const l=nS(s,a),d=t0(l)+t0(s.Ae);return sy(l)&&sy(s.Ae)?eS(d):S_(s.serializer,d)})(n,e)}function qO(n,e,t){return n instanceof ia?rS(n,e):n instanceof oa?sS(n,e):t}function nS(n,e){return n instanceof Fl?(function(r){return sy(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Ml extends yp{}class ia extends yp{constructor(e){super(),this.elements=e}}function rS(n,e){const t=iS(e);for(const r of n.elements)t.some((s=>ws(s,r)))||t.push(r);return{arrayValue:{values:t}}}class oa extends yp{constructor(e){super(),this.elements=e}}function sS(n,e){let t=iS(e);for(const r of n.elements)t=t.filter((s=>!ws(s,r)));return{arrayValue:{values:t}}}class Fl extends yp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function t0(n){return _t(n.integerValue||n.doubleValue)}function iS(n){return Yu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vd{constructor(e,t){this.field=e,this.transform=t}}function WO(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof ia&&s instanceof ia||r instanceof oa&&s instanceof oa?Rl(r.elements,s.elements,ws):r instanceof Fl&&s instanceof Fl?ws(r.Ae,s.Ae):r instanceof Ml&&s instanceof Ml})(n.transform,e.transform)}class HO{constructor(e,t){this.version=e,this.transformResults=t}}class wt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wt}static exists(e){return new wt(void 0,e)}static updateTime(e){return new wt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _p{}function oS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new nc(n.key,wt.none()):new tc(n.key,n.data,wt.none());{const t=n.data,r=dn.empty();let s=new ot(vt.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new Ys(n.key,r,new Bn(s.toArray()),wt.none())}}function GO(n,e,t){n instanceof tc?(function(s,a,l){const d=s.value.clone(),f=r0(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Ys?(function(s,a,l){if(!pf(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=r0(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(aS(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Nu(n,e,t,r){return n instanceof tc?(function(a,l,d,f){if(!pf(a.precondition,l))return d;const p=a.value.clone(),g=s0(a.fieldTransforms,f,l);return p.setAll(g),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ys?(function(a,l,d,f){if(!pf(a.precondition,l))return d;const p=s0(a.fieldTransforms,f,l),g=l.data;return g.setAll(aS(a)),g.setAll(p),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((w=>w.field)))})(n,e,t,r):(function(a,l,d){return pf(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function KO(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=nS(r.transform,s||null);a!=null&&(t===null&&(t=dn.empty()),t.set(r.field,a))}return t||null}function n0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Rl(r,s,((a,l)=>WO(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class tc extends _p{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ys extends _p{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function aS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function r0(n,e,t){const r=new Map;we(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);r.set(a.field,qO(l,d,t[s]))}return r}function s0(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,$O(a,l,e))}return r}class nc extends _p{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class b_ extends _p{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class A_{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&GO(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Nu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Nu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Z1();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=oS(l,d);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Te.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Le())}isEqual(e){return this.batchId===e.batchId&&Rl(this.mutations,e.mutations,((t,r)=>n0(t,r)))&&Rl(this.baseMutations,e.baseMutations,((t,r)=>n0(t,r)))}}class R_{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){we(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return UO})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new R_(e,t,r,s)}}class P_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QO{constructor(e,t){this.count=e,this.unchangedNames=t}}var zt,Ge;function lS(n){switch(n){case W.OK:return me(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return me(15467,{code:n})}}function cS(n){if(n===void 0)return Ot("GRPC error has no .code"),W.UNKNOWN;switch(n){case zt.OK:return W.OK;case zt.CANCELLED:return W.CANCELLED;case zt.UNKNOWN:return W.UNKNOWN;case zt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case zt.INTERNAL:return W.INTERNAL;case zt.UNAVAILABLE:return W.UNAVAILABLE;case zt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case zt.NOT_FOUND:return W.NOT_FOUND;case zt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case zt.ABORTED:return W.ABORTED;case zt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case zt.DATA_LOSS:return W.DATA_LOSS;default:return me(39323,{code:n})}}(Ge=zt||(zt={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";function uS(){return new TextEncoder}const JO=new Ui([4294967295,4294967295],0);function i0(n){const e=uS().encode(n),t=new n1;return t.update(e),new Uint8Array(t.digest())}function o0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ui([t,r],0),new Ui([s,a],0)]}class k_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new yu(`Invalid padding: ${t}`);if(r<0)throw new yu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new yu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ui.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Ui.fromNumber(r)));return s.compare(JO)===1&&(s=new Ui([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=i0(e),[r,s]=o0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);if(!this.we(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new k_(a,s,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=i0(e),[r,s]=o0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class yu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wd{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ed.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new wd(Te.min(),s,new dt(De),zn(),Le())}}class Ed{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ed(r,t,Le(),Le(),Le())}}class mf{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class dS{constructor(e,t){this.targetId=e,this.Ce=t}}class hS{constructor(e,t,r=kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class a0{constructor(){this.ve=0,this.Fe=l0(),this.Me=kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Le(),t=Le(),r=Le();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:me(38017,{changeType:a})}})),new Ed(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=l0()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class YO{constructor(e){this.Ge=e,this.ze=new Map,this.je=zn(),this.Je=Jh(),this.He=Jh(),this.Ye=new dt(De)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(Vf(a))if(r===0){const l=new ce(a.path);this.et(t,l,mt.newNoDocument(l,Te.min()))}else we(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const d=this.ut(e),f=d?this.ct(d,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=Hs(r).toUint8Array()}catch(f){if(f instanceof C1)return vs("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new k_(l,s,a)}catch(f){return vs(f instanceof yu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const d=this.ot(l);if(d){if(a.current&&Vf(d.target)){const f=new ce(d.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,mt.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let r=Le();this.He.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new wd(e,t,this.Ye,this.je,r);return this.je=zn(),this.Je=Jh(),this.He=Jh(),this.Ye=new dt(De),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new a0,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ot(De),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ot(De),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Z("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new a0),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jh(){return new dt(ce.comparator)}function l0(){return new dt(ce.comparator)}const XO={asc:"ASCENDING",desc:"DESCENDING"},ZO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eL={and:"AND",or:"OR"};class tL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cy(n,e){return n.useProto3Json||pd(e)?e:{value:e}}function jl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nL(n,e){return jl(n,e.toTimestamp())}function Lt(n){return we(!!n,49232),Te.fromTimestamp((function(t){const r=Ws(t);return new nt(r.seconds,r.nanos)})(n))}function C_(n,e){return uy(n,e).canonicalString()}function uy(n,e){const t=(function(s){return new ze(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function pS(n){const e=ze.fromString(n);return we(xS(e),10190,{key:e.toString()}),e}function Zu(n,e){return C_(n.databaseId,e.path)}function gs(n,e){const t=pS(e);if(t.get(1)!==n.databaseId.projectId)throw new J(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new J(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ce(yS(t))}function mS(n,e){return C_(n.databaseId,e)}function gS(n){const e=pS(n);return e.length===4?ze.emptyPath():yS(e)}function dy(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yS(n){return we(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function c0(n,e,t){return{name:Zu(n,e),fields:t.value.mapValue.fields}}function _S(n,e,t){const r=gs(n,e.name),s=Lt(e.updateTime),a=e.createTime?Lt(e.createTime):Te.min(),l=new dn({mapValue:{fields:e.fields}}),d=mt.newFoundDocument(r,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function rL(n,e){return"found"in e?(function(r,s){we(!!s.found,43571),s.found.name,s.found.updateTime;const a=gs(r,s.found.name),l=Lt(s.found.updateTime),d=s.found.createTime?Lt(s.found.createTime):Te.min(),f=new dn({mapValue:{fields:s.found.fields}});return mt.newFoundDocument(a,l,d,f)})(n,e):"missing"in e?(function(r,s){we(!!s.missing,3894),we(!!s.readTime,22933);const a=gs(r,s.missing),l=Lt(s.readTime);return mt.newNoDocument(a,l)})(n,e):me(7234,{result:e})}function sL(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:me(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,g){return p.useProto3Json?(we(g===void 0||typeof g=="string",58123),kt.fromBase64String(g||"")):(we(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),kt.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const g=p.code===void 0?W.UNKNOWN:cS(p.code);return new J(g,p.message||"")})(l);t=new hS(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=gs(n,r.document.name),a=Lt(r.document.updateTime),l=r.document.createTime?Lt(r.document.createTime):Te.min(),d=new dn({mapValue:{fields:r.document.fields}}),f=mt.newFoundDocument(s,a,l,d),p=r.targetIds||[],g=r.removedTargetIds||[];t=new mf(p,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=gs(n,r.document),a=r.readTime?Lt(r.readTime):Te.min(),l=mt.newNoDocument(s,a),d=r.removedTargetIds||[];t=new mf([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=gs(n,r.document),a=r.removedTargetIds||[];t=new mf([],a,s,null)}else{if(!("filter"in e))return me(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new QO(s,a),d=r.targetId;t=new dS(d,l)}}return t}function ed(n,e){let t;if(e instanceof tc)t={update:c0(n,e.key,e.value)};else if(e instanceof nc)t={delete:Zu(n,e.key)};else if(e instanceof Ys)t={update:c0(n,e.key,e.data),updateMask:uL(e.fieldMask)};else{if(!(e instanceof b_))return me(16599,{Vt:e.type});t={verify:Zu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof Ml)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof ia)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof oa)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Fl)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw me(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:nL(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me(27497)})(n,e.precondition)),t}function hy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?wt.updateTime(Lt(a.updateTime)):a.exists!==void 0?wt.exists(a.exists):wt.none()})(e.currentDocument):wt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)we(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Ml;else if("appendMissingElements"in d){const g=d.appendMissingElements.values||[];f=new ia(g)}else if("removeAllFromArray"in d){const g=d.removeAllFromArray.values||[];f=new oa(g)}else"increment"in d?f=new Fl(l,d.increment):me(16584,{proto:d});const p=vt.fromServerFormat(d.fieldPath);return new vd(p,f)})(n,s))):[];if(e.update){e.update.name;const s=gs(n,e.update.name),a=new dn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new Bn(p.map((g=>vt.fromServerFormat(g))))})(e.updateMask);return new Ys(s,a,l,t,r)}return new tc(s,a,t,r)}if(e.delete){const s=gs(n,e.delete);return new nc(s,t)}if(e.verify){const s=gs(n,e.verify);return new b_(s,t)}return me(1463,{proto:e})}function iL(n,e){return n&&n.length>0?(we(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Lt(s.updateTime):Lt(a);return l.isEqual(Te.min())&&(l=Lt(a)),new HO(l,s.transformResults||[])})(t,e)))):[]}function vS(n,e){return{documents:[mS(n,e.path)]}}function wS(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=mS(n,s);const a=(function(p){if(p.length!==0)return TS(it.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((g=>(function(T){return{field:fl(T.field),direction:aL(T.dir)}})(g)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=cy(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function ES(n){let e=gS(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){we(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=(function(w){const T=IS(w);return T instanceof it&&I_(T)?T.getFilters():[T]})(t.where));let l=[];t.orderBy&&(l=(function(w){return w.map((T=>(function(A){return new Xu(pl(A.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(w){let T;return T=typeof w=="object"?w.value:w,pd(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(w){const T=!!w.before,N=w.values||[];return new Ji(N,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(w){const T=!w.before,N=w.values||[];return new Ji(N,T)})(t.endAt)),G1(e,s,l,a,d,"F",f,p)}function oL(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=pl(t.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=pl(t.unaryFilter.field);return qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=pl(t.unaryFilter.field);return qe.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=pl(t.unaryFilter.field);return qe.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return me(61313);default:return me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return qe.create(pl(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return me(58110);default:return me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return it.create(t.compositeFilter.filters.map((r=>IS(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me(1026)}})(t.compositeFilter.op))})(n):me(30097,{filter:n})}function aL(n){return XO[n]}function lL(n){return ZO[n]}function cL(n){return eL[n]}function fl(n){return{fieldPath:n.canonicalString()}}function pl(n){return vt.fromServerFormat(n.fieldPath)}function TS(n){return n instanceof qe?(function(t){if(t.op==="=="){if(GI(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NAN"}};if(HI(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GI(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NAN"}};if(HI(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(t.field),op:lL(t.op),value:t.value}}})(n):n instanceof it?(function(t){const r=t.getFilters().map((s=>TS(s)));return r.length===1?r[0]:{compositeFilter:{op:cL(t.op),filters:r}}})(n):me(54877,{filter:n})}function uL(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function xS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Us{constructor(e,t,r,s,a=Te.min(),l=Te.min(),d=kt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Us(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SS{constructor(e){this.yt=e}}function dL(n,e){let t;if(e.document)t=_S(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ce.fromSegments(e.noDocument.path),s=la(e.noDocument.readTime);t=mt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return me(56709);{const r=ce.fromSegments(e.unknownDocument.path),s=la(e.unknownDocument.version);t=mt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new nt(s[0],s[1]);return Te.fromTimestamp(a)})(e.readTime)),t}function u0(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Mf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:Zu(a,l.key),fields:l.data.value.mapValue.fields,updateTime:jl(a,l.version.toTimestamp()),createTime:jl(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:aa(e.version)};else{if(!e.isUnknownDocument())return me(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:aa(e.version)}}return r}function Mf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function aa(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function la(n){const e=new nt(n.seconds,n.nanoseconds);return Te.fromTimestamp(e)}function Bo(n,e){const t=(e.baseMutations||[]).map((a=>hy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>hy(n.yt,a))),s=nt.fromMillis(e.localWriteTimeMs);return new A_(e.batchId,s,t,r)}function _u(n){const e=la(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?la(n.lastLimboFreeSnapshotVersion):Te.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return we(l===1,1966,{count:l}),kn(ec(gS(a.documents[0])))})(n.query):(function(a){return kn(ES(a))})(n.query),new Us(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,kt.fromBase64String(n.resumeToken))}function bS(n,e){const t=aa(e.snapshotVersion),r=aa(e.lastLimboFreeSnapshotVersion);let s;s=Vf(e.target)?vS(n.yt,e.target):wS(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:sa(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function N_(n){const e=ES({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Lf(e,e.limit,"L"):e}function bg(n,e){return new P_(e.largestBatchId,hy(n.yt,e.overlayMutation))}function d0(n,e){const t=e.path.lastSegment();return[n,xn(e.path.popLast()),t]}function h0(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:aa(r.readTime),documentKey:xn(r.documentKey.path),largestBatchId:r.largestBatchId}}class hL{getBundleMetadata(e,t){return f0(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:la(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return f0(e).put((function(s){return{bundleId:s.id,createTime:aa(Lt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return p0(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:N_(a.bundledQuery),readTime:la(a.readTime)}})(r)}))}saveNamedQuery(e,t){return p0(e).put((function(s){return{name:s.name,readTime:aa(Lt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function f0(n){return Qt(n,dp)}function p0(n){return Qt(n,hp)}class vp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new vp(e,r)}getOverlay(e,t){return ou(e).get(d0(this.userId,t)).next((r=>r?bg(this.serializer,r):null))}getOverlays(e,t){const r=fs();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const d=new P_(t,l);s.push(this.St(e,d))})),U.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(xn(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(ou(e).Z(ey,d))})),U.waitFor(a)}getOverlaysForCollection(e,t,r){const s=fs(),a=xn(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ou(e).J(ey,l).next((d=>{for(const f of d){const p=bg(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=fs();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ou(e).ee({index:S1,range:d},((f,p,g)=>{const w=bg(this.serializer,p);a.size()<s||w.largestBatchId===l?(a.set(w.getKey(),w),l=w.largestBatchId):g.done()})).next((()=>a))}St(e,t){return ou(e).put((function(s,a,l){const[d,f,p]=d0(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:ed(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function ou(n){return Qt(n,fp)}class fL{bt(e){return Qt(e,__)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?kt.fromUint8Array(r):kt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class zo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(_t(e.integerValue));else if("doubleValue"in e){const r=_t(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Wu(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ws(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Hs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?M1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):gp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):me(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const s=Vl,a=r[s].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(_t(a)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),ce.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}zo.Kt=new zo;const al=255;function pL(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function m0(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=pL(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class mL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),r=m0(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=m0(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(al),this.sn(255)}_n(){this.an(al),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===al?(this.sn(al),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===al?(this.an(al),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class gL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class yL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class au{constructor(){this.cn=new mL,this.ln=new gL(this.cn),this.hn=new yL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class $o{constructor(e,t,r,s){this.Tn=e,this.In=t,this.En=r,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new $o(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:gf(this.En),directionalValue:gf(this.dn),orderedDocumentKey:gf(t),documentKey:r.path.toArray()}}Vn(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ki(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=g0(n.En,e.En),t!==0?t:(t=g0(n.dn,e.dn),t!==0?t:ce.comparator(n.In,e.In)))}function g0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function gf(n){return $T()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function y0(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class _0{constructor(e){this.mn=new ot(((t,r)=>vt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(we(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Yg(e);if(t!==void 0&&!this.wn(t))return!1;const r=Fo(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.wn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const d=this.mn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=r[a];if(!this.Sn(d,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.fn.length||!this.bn(this.fn[l++],d))return!1}return!0}Dn(){if(this.pn)return null;let e=new ot(vt.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new lf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new lf(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new lf(r.field,r.dir==="asc"?0:1)));return new kf(kf.UNKNOWN_ID,this.collectionId,t,qu.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function AS(n){if(we(n instanceof qe||n instanceof it,20012),n instanceof qe){if(n instanceof H1){const t=n.value.arrayValue?.values?.map((r=>qe.create(n.field,"==",r)))||[];return it.create(t,"or")}return n}const e=n.filters.map((t=>AS(t)));return it.create(e,n.op)}function _L(n){if(n.getFilters().length===0)return[];const e=my(AS(n));return we(RS(e),7391),fy(e)||py(e)?[e]:e.getFilters()}function fy(n){return n instanceof qe}function py(n){return n instanceof it&&I_(n)}function RS(n){return fy(n)||py(n)||(function(t){if(t instanceof it&&iy(t)){for(const r of t.getFilters())if(!fy(r)&&!py(r))return!1;return!0}return!1})(n)}function my(n){if(we(n instanceof qe||n instanceof it,34018),n instanceof qe)return n;if(n.filters.length===1)return my(n.filters[0]);const e=n.filters.map((r=>my(r)));let t=it.create(e,n.op);return t=Ff(t),RS(t)?t:(we(t instanceof it,64498),we(Ll(t),40251),we(t.filters.length>1,57927),t.filters.reduce(((r,s)=>D_(r,s))))}function D_(n,e){let t;return we(n instanceof qe||n instanceof it,38388),we(e instanceof qe||e instanceof it,25473),t=n instanceof qe?e instanceof qe?(function(s,a){return it.create([s,a],"and")})(n,e):v0(n,e):e instanceof qe?v0(e,n):(function(s,a){if(we(s.filters.length>0&&a.filters.length>0,48005),Ll(s)&&Ll(a))return $1(s,a.getFilters());const l=iy(s)?s:a,d=iy(s)?a:s,f=l.filters.map((p=>D_(p,d)));return it.create(f,"or")})(n,e),Ff(t)}function v0(n,e){if(Ll(e))return $1(e,n.getFilters());{const t=e.filters.map((r=>D_(n,r)));return it.create(t,"or")}}function Ff(n){if(we(n instanceof qe||n instanceof it,11850),n instanceof qe)return n;const e=n.getFilters();if(e.length===1)return Ff(e[0]);if(B1(n))return n;const t=e.map((s=>Ff(s))),r=[];return t.forEach((s=>{s instanceof qe?r.push(s):s instanceof it&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:it.create(r,n.op)}class vL{constructor(){this.Cn=new V_}addToCollectionParentIndex(e,t){return this.Cn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(or.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(or.min())}updateCollectionGroup(e,t,r){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class V_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new ot(ze.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ot(ze.comparator)).toArray()}}const w0="IndexedDbIndexManager",Yh=new Uint8Array(0);class wL{constructor(e,t){this.databaseId=t,this.vn=new V_,this.Fn=new Js((r=>sa(r)),((r,s)=>gd(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:xn(s)};return E0(e).put(a)}return U.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[u1(t),""],!1,!0);return E0(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(hs(l.parent))}return r}))}addFieldIndex(e,t){const r=lu(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=cl(e);return a.next((d=>{l.put(h0(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=lu(e),s=cl(e),a=ll(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=lu(e),r=ll(e),s=cl(e);return t.Z().next((()=>r.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return U.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new _0(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ll(e);let s=!0;const a=new Map;return U.forEach(this.Mn(t),(l=>this.xn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Le();const d=[];return U.forEach(a,((f,p)=>{Z(w0,`Using index ${(function(Q){return`id=${Q.indexId}|cg=${Q.collectionGroup}|f=${Q.fields.map((pe=>`${pe.fieldPath}:${pe.kind}`)).join(",")}`})(f)} to execute ${sa(t)}`);const g=(function(Q,pe){const te=Yg(pe);if(te===void 0)return null;for(const ae of Of(Q,te.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null})(p,f),w=(function(Q,pe){const te=new Map;for(const ae of Fo(pe))for(const b of Of(Q,ae.fieldPath))switch(b.op){case"==":case"in":te.set(ae.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return te.set(ae.fieldPath.canonicalString(),b.value),Array.from(te.values())}return null})(p,f),T=(function(Q,pe){const te=[];let ae=!0;for(const b of Fo(pe)){const S=b.kind===0?XI(Q,b.fieldPath,Q.startAt):ZI(Q,b.fieldPath,Q.startAt);te.push(S.value),ae&&(ae=S.inclusive)}return new Ji(te,ae)})(p,f),N=(function(Q,pe){const te=[];let ae=!0;for(const b of Fo(pe)){const S=b.kind===0?ZI(Q,b.fieldPath,Q.endAt):XI(Q,b.fieldPath,Q.endAt);te.push(S.value),ae&&(ae=S.inclusive)}return new Ji(te,ae)})(p,f),A=this.On(f,p,T),L=this.On(f,p,N),V=this.Nn(f,p,w),se=this.Bn(f.indexId,g,A,T.inclusive,L,N.inclusive,V);return U.forEach(se,(ie=>r.Y(ie,t.limit).next((Q=>{Q.forEach((pe=>{const te=ce.fromSegments(pe.documentKey);l.has(te)||(l=l.add(te),d.push(te))}))}))))})).next((()=>d))}return U.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=_L(it.create(e.filters,"and")).map((r=>ay(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),p=f/(t!=null?t.length:1),g=[];for(let w=0;w<f;++w){const T=t?this.Ln(t[w/p]):Yh,N=this.kn(e,T,r[w%p],s),A=this.qn(e,T,a[w%p],l),L=d.map((V=>this.kn(e,T,V,!0)));g.push(...this.createRange(N,A,L))}return g}kn(e,t,r,s){const a=new $o(e,ce.empty(),t,r);return s?a:a.An()}qn(e,t,r,s){const a=new $o(e,ce.empty(),t,r);return s?a.An():a}xn(e,t){const r=new _0(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)r.yn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const s=this.Mn(t);return U.forEach(s,(a=>this.xn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let p=new ot(vt.comparator),g=!1;for(const w of f.filters)for(const T of w.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?g=!0:p=p.add(T.field));for(const w of f.orderBy)w.field.isKeyField()||(p=p.add(w.field));return p.size+(g?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}Qn(e,t){const r=new au;for(const s of Fo(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.Pn(s.kind);zo.Kt.Dt(a,l)}return r.un()}Ln(e){const t=new au;return zo.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new au;return zo.Kt.Dt(ra(this.databaseId,t),r.Pn((function(a){const l=Fo(a);return l.length===0?0:l[l.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let s=[];s.push(new au);let a=0;for(const l of Fo(e)){const d=r[a++];for(const f of s)if(this.Un(t,l.fieldPath)&&Yu(d))s=this.Kn(s,l,d);else{const p=f.Pn(l.kind);zo.Kt.Dt(d,p)}}return this.Wn(s)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of s){const f=new au;f.seed(d.un()),zo.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof qe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=lu(e),s=cl(e);return(t?r.J(Zg,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const l=[];return U.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(g,w){const T=w?new qu(w.sequenceNumber,new or(la(w.readTime),new ce(hs(w.documentKey)),w.largestBatchId)):qu.empty(),N=g.fields.map((([A,L])=>new lf(vt.fromServerFormat(A),L)));return new kf(g.indexId,g.collectionGroup,N,T)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:De(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=lu(e),a=cl(e);return this.Gn(e).next((l=>s.J(Zg,IDBKeyRange.bound(t,t)).next((d=>U.forEach(d,(f=>a.put(h0(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return U.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?U.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(r.set(s.collectionGroup,d),U.forEach(d,(f=>this.zn(e,s,f).next((p=>{const g=this.jn(a,f);return p.isEqual(g)?U.resolve():this.Jn(e,a,f,p,g)})))))))}))}Hn(e,t,r,s){return ll(e).put(s.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,s){return ll(e).delete(s.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const s=ll(e);let a=new ot(ki);return s.ee({index:x1,range:IDBKeyRange.only([r.indexId,this.uid,gf(this.$n(r,t))])},((l,d)=>{a=a.add(new $o(r.indexId,t,y0(d.arrayValue),y0(d.directionalValue)))})).next((()=>a))}jn(e,t){let r=new ot(ki);const s=this.Qn(t,e);if(s==null)return r;const a=Yg(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Yu(l))for(const d of l.arrayValue.values||[])r=r.add(new $o(t.indexId,e.key,this.Ln(d),s))}else r=r.add(new $o(t.indexId,e.key,Yh,s));return r}Jn(e,t,r,s,a){Z(w0,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,g,w,T){const N=f.getIterator(),A=p.getIterator();let L=ol(N),V=ol(A);for(;L||V;){let se=!1,ie=!1;if(L&&V){const Q=g(L,V);Q<0?ie=!0:Q>0&&(se=!0)}else L!=null?ie=!0:se=!0;se?(w(V),V=ol(A)):ie?(T(L),L=ol(N)):(L=ol(N),V=ol(A))}})(s,a,ki,(d=>{l.push(this.Hn(e,t,r,d))}),(d=>{l.push(this.Yn(e,t,r,d))})),U.waitFor(l)}Gn(e){let t=1;return cl(e).ee({index:T1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>ki(l,d))).filter(((l,d,f)=>!d||ki(l,f[d-1])!==0));const s=[];s.push(e);for(const l of r){const d=ki(l,e),f=ki(l,t);if(d===0)s[0]=e.An();else if(d>0&&f<0)s.push(l),s.push(l.An());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const d=s[l].Vn(this.uid,Yh,ce.empty()),f=s[l+1].Vn(this.uid,Yh,ce.empty());a.push(IDBKeyRange.bound(d,f))}return a}Zn(e,t){return ki(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(I0)}getMinOffset(e,t){return U.mapArray(this.Mn(t),(r=>this.xn(e,r).next((s=>s||me(44426))))).next(I0)}}function E0(n){return Qt(n,Ku)}function ll(n){return Qt(n,Pu)}function lu(n){return Qt(n,y_)}function cl(n){return Qt(n,Ru)}function I0(n){we(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;p_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new or(e.readTime,e.documentKey,t)}const T0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},PS=41943040;class En{static withCacheSize(e){return new En(e,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function kS(n,e,t){const r=n.store(kr),s=n.store(kl),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=r.ee({range:l},((g,w,T)=>(d++,T.delete())));a.push(f.next((()=>{we(d===1,47070,{batchId:t.batchId})})));const p=[];for(const g of t.mutations){const w=w1(e,g.key.path,t.batchId);a.push(s.delete(w)),p.push(g.key)}return U.waitFor(a).next((()=>p))}function jf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw me(14731);e=n.noDocument}return JSON.stringify(e).length}En.DEFAULT_COLLECTION_PERCENTILE=10,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,En.DEFAULT=new En(PS,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),En.DISABLED=new En(-1,0,0);class wp{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,t,r,s){we(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new wp(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ci(e).ee({index:Ho,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=ml(e),l=Ci(e);return l.add({}).next((d=>{we(typeof d=="number",49019);const f=new A_(d,t,r,s),p=(function(N,A,L){const V=L.baseMutations.map((ie=>ed(N.yt,ie))),se=L.mutations.map((ie=>ed(N.yt,ie)));return{userId:A,batchId:L.batchId,localWriteTimeMs:L.localWriteTime.toMillis(),baseMutations:V,mutations:se}})(this.serializer,this.userId,f),g=[];let w=new ot(((T,N)=>De(T.canonicalString(),N.canonicalString())));for(const T of s){const N=w1(this.userId,T.key.path,d);w=w.add(T.key.path.popLast()),g.push(l.put(p)),g.push(a.put(N,eO))}return w.forEach((T=>{g.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Xn[d]=f.keys()})),U.waitFor(g).next((()=>f))}))}lookupMutationBatch(e,t){return Ci(e).get(t).next((r=>r?(we(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Bo(this.serializer,r)):null))}er(e,t){return this.Xn[t]?U.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Ci(e).ee({index:Ho,range:s},((l,d,f)=>{d.userId===this.userId&&(we(d.batchId>=r,47524,{tr:r}),a=Bo(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Bi;return Ci(e).ee({index:Ho,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Bi],[this.userId,Number.POSITIVE_INFINITY]);return Ci(e).J(Ho,t).next((r=>r.map((s=>Bo(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=cf(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return ml(e).ee({range:s},((l,d,f)=>{const[p,g,w]=l,T=hs(g);if(p===this.userId&&t.path.isEqual(T))return Ci(e).get(w).next((N=>{if(!N)throw me(61480,{nr:l,batchId:w});we(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:w}),a.push(Bo(this.serializer,N))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ot(De);const s=[];return t.forEach((a=>{const l=cf(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=ml(e).ee({range:d},((p,g,w)=>{const[T,N,A]=p,L=hs(N);T===this.userId&&a.path.isEqual(L)?r=r.add(A):w.done()}));s.push(f)})),U.waitFor(s).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=cf(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new ot(De);return ml(e).ee({range:l},((f,p,g)=>{const[w,T,N]=f,A=hs(T);w===this.userId&&r.isPrefixOf(A)?A.length===s&&(d=d.add(N)):g.done()})).next((()=>this.rr(e,d)))}rr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(Ci(e).get(a).next((l=>{if(l===null)throw me(35274,{batchId:a});we(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Bo(this.serializer,l))})))})),U.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return kS(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),U.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return U.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return ml(e).ee({range:r},((a,l,d)=>{if(a[0]===this.userId){const f=hs(a[1]);s.push(f)}else d.done()})).next((()=>{we(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return CS(e,this.userId,t)}_r(e){return NS(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Bi,lastStreamToken:""}))}}function CS(n,e,t){const r=cf(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return ml(n).ee({range:a,X:!0},((d,f,p)=>{const[g,w,T]=d;g===e&&w===s&&(l=!0),p.done()})).next((()=>l))}function Ci(n){return Qt(n,kr)}function ml(n){return Qt(n,kl)}function NS(n){return Qt(n,Hu)}class ca{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ca(0)}static cr(){return new ca(-1)}}class EL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new ca(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Te.fromTimestamp(new nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ul(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(we(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return ul(e).ee(((l,d)=>{const f=_u(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>U.waitFor(a))).next((()=>s))}forEachTarget(e,t){return ul(e).ee(((r,s)=>{const a=_u(s);t(a)}))}lr(e){return x0(e).get(Df).next((t=>(we(t!==null,2888),t)))}hr(e,t){return x0(e).put(Df,t)}Pr(e,t){return ul(e).put(bS(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=sa(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return ul(e).ee({range:s,index:I1},((l,d,f)=>{const p=_u(d);gd(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=Vi(e);return t.forEach((l=>{const d=xn(l.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,l))})),U.waitFor(s)}removeMatchingKeys(e,t,r){const s=Vi(e);return U.forEach(t,(a=>{const l=xn(a.path);return U.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Vi(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Vi(e);let a=Le();return s.ee({range:r,X:!0},((l,d,f)=>{const p=hs(l[1]),g=new ce(p);a=a.add(g)})).next((()=>a))}containsKey(e,t){const r=xn(t.path),s=IDBKeyRange.bound([r],[u1(r)],!1,!0);let a=0;return Vi(e).ee({index:g_,X:!0,range:s},(([l,d],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return ul(e).get(t).next((r=>r?_u(r):null))}}function ul(n){return Qt(n,Cl)}function x0(n){return Qt(n,Xo)}function Vi(n){return Qt(n,Nl)}const S0="LruGarbageCollector",IL=1048576;function b0([n,e],[t,r]){const s=De(n,t);return s===0?De(e,r):s}class TL{constructor(e){this.Ir=e,this.buffer=new ot(b0),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();b0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class DS{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Z(S0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){so(t)?Z(S0,"Ignoring IndexedDB error during garbage collection: ",t):await ro(t)}await this.Vr(3e5)}))}}class xL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(Un.ce);const r=new TL(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(T0)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),T0):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,a,l,d,f,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),s=this.params.maximumSequenceNumbersToCollect):s=w,l=Date.now(),this.nthSequenceNumber(e,s)))).next((w=>(r=w,d=Date.now(),this.removeTargets(e,r,t)))).next((w=>(a=w,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((w=>(p=Date.now(),dl()<=Be.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${w} documents in `+(p-f)+`ms
Total Duration: ${p-g}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:w}))))}}function VS(n,e){return new xL(n,e)}class SL{constructor(e,t){this.db=e,this.garbageCollector=VS(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,s)=>t(s)))}addReference(e,t,r){return Xh(e,r)}removeReference(e,t,r){return Xh(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Xh(e,t)}br(e,t){return(function(s,a){let l=!1;return NS(s).te((d=>CS(s,d,a).next((f=>(f&&(l=!0),U.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,d)=>{if(d<=t){const f=this.br(e,l).next((p=>{if(!p)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,Te.min()),Vi(e).delete((function(w){return[0,xn(w.path)]})(l)))))}));s.push(f)}})).next((()=>U.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Xh(e,t)}Sr(e,t){const r=Vi(e);let s,a=Un.ce;return r.ee({index:g_},(([l,d],{path:f,sequenceNumber:p})=>{l===0?(a!==Un.ce&&t(new ce(hs(s)),a),a=p,s=f):a=Un.ce})).next((()=>{a!==Un.ce&&t(new ce(hs(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xh(n,e){return Vi(n).put((function(r,s){return{targetId:0,path:xn(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}class OS{constructor(){this.changes=new Js((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?U.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Lo(e).put(r)}removeEntry(e,t,r){return Lo(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Mf(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=mt.newInvalidDocument(t);return Lo(e).ee({index:uf,range:IDBKeyRange.only(cu(t))},((s,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:mt.newInvalidDocument(t)};return Lo(e).ee({index:uf,range:IDBKeyRange.only(cu(t))},((s,a)=>{r={document:this.Cr(t,a),size:jf(a)}})).next((()=>r))}getEntries(e,t){let r=zn();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);r=r.insert(s,l)})).next((()=>r))}Mr(e,t){let r=zn(),s=new dt(ce.comparator);return this.Fr(e,t,((a,l)=>{const d=this.Cr(a,l);r=r.insert(a,d),s=s.insert(a,jf(l))})).next((()=>({documents:r,Or:s})))}Fr(e,t,r){if(t.isEmpty())return U.resolve();let s=new ot(P0);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(cu(s.first()),cu(s.last())),l=s.getIterator();let d=l.getNext();return Lo(e).ee({index:uf,range:a},((f,p,g)=>{const w=ce.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&P0(d,w)<0;)r(d,null),d=l.getNext();d&&d.isEqual(w)&&(r(d,p),d=l.hasNext()?l.getNext():null),d?g.j(cu(d)):g.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),Mf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Lo(e).J(IDBKeyRange.bound(d,f,!0)).next((p=>{a?.incrementDocumentReadCount(p.length);let g=zn();for(const w of p){const T=this.Cr(ce.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);T.isFoundDocument()&&(_d(t,T)||s.has(T.key))&&(g=g.insert(T.key,T))}return g}))}getAllFromCollectionGroup(e,t,r,s){let a=zn();const l=R0(t,r),d=R0(t,or.max());return Lo(e).ee({index:E1,range:IDBKeyRange.bound(l,d,!0)},((f,p,g)=>{const w=this.Cr(ce.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(w.key,w),a.size===s&&g.done()})).next((()=>a))}newChangeBuffer(e){return new AL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return A0(e).get(Xg).next((t=>(we(!!t,20021),t)))}Dr(e,t){return A0(e).put(Xg,t)}Cr(e,t){if(t){const r=dL(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Te.min())))return r}return mt.newInvalidDocument(e)}}function LS(n){return new bL(n)}class AL extends OS{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Js((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new ot(((a,l)=>De(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=u0(this.Nr.serializer,l);s=s.add(a.path.popLast());const p=jf(f);r+=p-d.size,t.push(this.Nr.addEntry(e,a,f))}else if(r-=d.size,this.trackRemovals){const f=u0(this.Nr.serializer,l.convertToNoDocument(Te.min()));t.push(this.Nr.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),U.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function A0(n){return Qt(n,Gu)}function Lo(n){return Qt(n,Nf)}function cu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function R0(n,e){const t=e.documentKey.path.toArray();return[n,Mf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function P0(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=De(t[a],r[a]),s)return s;return s=De(t.length,r.length),s||(s=De(t[t.length-2],r[r.length-2]),s||De(t[t.length-1],r[r.length-1]))}class RL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class MS{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Nu(r.mutation,s,Bn.empty(),nt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Le()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Le()){const s=fs();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=gu();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=fs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Le())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,s){let a=zn();const l=Cu(),d=(function(){return Cu()})();return t.forEach(((f,p)=>{const g=r.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof Ys)?a=a.insert(p.key,p):g!==void 0?(l.set(p.key,g.mutation.getFieldMask()),Nu(g.mutation,p,g.mutation.getFieldMask(),nt.now())):l.set(p.key,Bn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,g)=>l.set(p,g))),t.forEach(((p,g)=>d.set(p,new RL(g,l.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const r=Cu();let s=new dt(((l,d)=>l-d)),a=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let g=r.get(f)||Bn.empty();g=d.applyToLocalView(p,g),r.set(f,g);const w=(s.get(d.batchId)||Le()).add(f);s=s.insert(d.batchId,w)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,g=f.value,w=Z1();g.forEach((T=>{if(!a.has(T)){const N=oS(t.get(T),r.get(T));N!==null&&w.set(T,N),a=a.add(T)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,w))}return U.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return ce.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):T_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):U.resolve(fs());let d=Pl,f=a;return l.next((p=>U.forEach(p,((g,w)=>(d<w.largestBatchId&&(d=w.largestBatchId),a.get(g)?U.resolve():this.remoteDocumentCache.getEntry(e,g).next((T=>{f=f.insert(g,T)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Le()))).next((g=>({batchId:d,changes:X1(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ce(t)).next((r=>{let s=gu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=gu();return this.indexManager.getCollectionParents(e,a).next((d=>U.forEach(d,(f=>{const p=(function(w,T){return new Qs(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((g=>{g.forEach(((w,T)=>{l=l.insert(w,T)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,p)=>{const g=p.getKey();l.get(g)===null&&(l=l.insert(g,mt.newInvalidDocument(g)))}));let d=gu();return l.forEach(((f,p)=>{const g=a.get(f);g!==void 0&&Nu(g.mutation,p,Bn.empty(),nt.now()),_d(t,p)&&(d=d.insert(f,p))})),d}))}}class PL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return U.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Lt(s.createTime)}})(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:N_(s.bundledQuery),readTime:Lt(s.readTime)}})(t)),U.resolve()}}class kL{constructor(){this.overlays=new dt(ce.comparator),this.qr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const r=fs();return U.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.St(e,t,a)})),U.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,t,r){const s=fs(),a=t.length+1,l=new ce(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return U.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new dt(((p,g)=>p-g));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let g=a.get(p.largestBatchId);g===null&&(g=fs(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const d=fs(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,g)=>d.set(p,g))),!(d.size()>=s)););return U.resolve(d)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new P_(t,r));let a=this.qr.get(t);a===void 0&&(a=Le(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class CL{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}}class O_{constructor(){this.Qr=new ot(Zt.$r),this.Ur=new ot(Zt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Zt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Zt(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ce(new ze([])),r=new Zt(t,e),s=new Zt(t,e+1),a=[];return this.Ur.forEachInRange([r,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ce(new ze([])),r=new Zt(t,e),s=new Zt(t,e+1);let a=Le();return this.Ur.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Zt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Zt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ce.comparator(e.key,t.key)||De(e.Yr,t.Yr)}static Kr(e,t){return De(e.Yr,t.Yr)||ce.comparator(e.key,t.key)}}class NL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ot(Zt.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new A_(a,t,r,s);this.mutationQueue.push(l);for(const d of s)this.Zr=this.Zr.add(new Zt(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return U.resolve(l)}lookupMutationBatch(e,t){return U.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),a=s<0?0:s;return U.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Bi:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Zt(t,0),s=new Zt(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,s],(l=>{const d=this.Xr(l.Yr);a.push(d)})),U.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ot(De);return t.forEach((s=>{const a=new Zt(s,0),l=new Zt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(d=>{r=r.add(d.Yr)}))})),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;ce.isDocumentKey(a)||(a=a.child(""));const l=new Zt(new ce(a),0);let d=new ot(De);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(d=d.add(f.Yr)),!0)}),l),U.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){we(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(t.mutations,(s=>{const a=new Zt(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Zt(t,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class DL{constructor(e){this.ri=e,this.docs=(function(){return new dt(ce.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return U.resolve(r?r.document.mutableCopy():mt.newInvalidDocument(t))}getEntries(e,t){let r=zn();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():mt.newInvalidDocument(s))})),U.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=zn();const l=t.path,d=new ce(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:g}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||p_(m1(g),r)<=0||(s.has(g.key)||_d(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return U.resolve(a)}getAllFromCollectionGroup(e,t,r,s){me(9500)}ii(e,t){return U.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new VL(this)}getSize(e){return U.resolve(this.size)}}class VL extends OS{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),U.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class OL{constructor(e){this.persistence=e,this.si=new Js((t=>sa(t)),gd),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.oi=0,this._i=new O_,this.targetCount=0,this.ai=ca.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),U.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ca(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.Pr(t),U.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.si.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),U.waitFor(a).next((()=>s))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return U.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),U.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),U.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return U.resolve(r)}containsKey(e,t){return U.resolve(this._i.containsKey(t))}}class L_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Un(0),this.li=!1,this.li=!0,this.hi=new CL,this.referenceDelegate=e(this),this.Pi=new OL(this),this.indexManager=new vL,this.remoteDocumentCache=(function(s){return new DL(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new SS(t),this.Ii=new PL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new NL(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Z("MemoryPersistence","Starting transaction:",e);const s=new LL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return U.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class LL extends y1{constructor(e){super(),this.currentSequenceNumber=e}}class Ep{constructor(e){this.persistence=e,this.Ri=new O_,this.Vi=null}static mi(e){return new Ep(e)}get fi(){if(this.Vi)return this.Vi;throw me(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),U.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,(r=>{const s=ce.fromPath(r);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Te.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Uf{constructor(e,t){this.persistence=e,this.pi=new Js((r=>xn(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=VS(this,t)}static mi(e,t){return new Uf(e,t)}Ei(){}di(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return U.forEach(this.pi,((r,s)=>this.br(e,r,s).next((a=>a?U.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((d=>{d||(r++,a.removeEntry(l,Te.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hf(e.data.value)),t}br(e,t,r){return U.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ML{constructor(e){this.serializer=e}k(e,t,r,s){const a=new up("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore(md)})(e),(function(f){f.createObjectStore(Hu,{keyPath:ZV}),f.createObjectStore(kr,{keyPath:UI,autoIncrement:!0}).createIndex(Ho,BI,{unique:!0}),f.createObjectStore(kl)})(e),k0(e),(function(f){f.createObjectStore(jo)})(e));let l=U.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Nl),f.deleteObjectStore(Cl),f.deleteObjectStore(Xo)})(e),k0(e)),l=l.next((()=>(function(f){const p=f.store(Xo),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Te.min().toTimestamp(),targetCount:0};return p.put(Df,g)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,p){return p.store(kr).J().next((w=>{f.deleteObjectStore(kr),f.createObjectStore(kr,{keyPath:UI,autoIncrement:!0}).createIndex(Ho,BI,{unique:!0});const T=p.store(kr),N=w.map((A=>T.put(A)));return U.waitFor(N)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Dl,{keyPath:lO})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.yi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Gu)})(e),this.wi(a))))),r<7&&s>=7&&(l=l.next((()=>this.Si(a)))),r<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.Di(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(dp,{keyPath:cO})})(e),(function(f){f.createObjectStore(hp,{keyPath:uO})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(fp,{keyPath:yO});p.createIndex(ey,_O,{unique:!1}),p.createIndex(S1,vO,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(Nf,{keyPath:tO});p.createIndex(uf,nO),p.createIndex(E1,rO)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(jo)))),r<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(y_,{keyPath:dO,autoIncrement:!0}).createIndex(Zg,hO,{unique:!1}),f.createObjectStore(Ru,{keyPath:fO}).createIndex(T1,pO,{unique:!1}),f.createObjectStore(Pu,{keyPath:mO}).createIndex(x1,gO,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(Ru).clear()})).next((()=>{t.objectStore(Pu).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(__,{keyPath:wO})})(e)}))),r<18&&s>=18&&$T()&&(l=l.next((()=>{t.objectStore(Ru).clear()})).next((()=>{t.objectStore(Pu).clear()}))),l}wi(e){let t=0;return e.store(jo).ee(((r,s)=>{t+=jf(s)})).next((()=>{const r={byteSize:t};return e.store(Gu).put(Xg,r)}))}yi(e){const t=e.store(Hu),r=e.store(kr);return t.J().next((s=>U.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Bi],[a.userId,a.lastAcknowledgedBatchId]);return r.J(Ho,l).next((d=>U.forEach(d,(f=>{we(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Bo(this.serializer,f);return kS(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(Nl),r=e.store(jo);return e.store(Xo).get(Df).next((s=>{const a=[];return r.ee(((l,d)=>{const f=new ze(l),p=(function(w){return[0,xn(w)]})(f);a.push(t.get(p).next((g=>g?U.resolve():(w=>t.put({targetId:0,path:xn(w),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>U.waitFor(a)))}))}bi(e,t){e.createObjectStore(Ku,{keyPath:aO});const r=t.store(Ku),s=new V_,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return r.put({collectionId:d,parent:xn(f)})}};return t.store(jo).ee({X:!0},((l,d)=>{const f=new ze(l);return a(f.popLast())})).next((()=>t.store(kl).ee({X:!0},(([l,d,f],p)=>{const g=hs(d);return a(g.popLast())}))))}Di(e){const t=e.store(Cl);return t.ee(((r,s)=>{const a=_u(s),l=bS(this.serializer,a);return t.put(l)}))}Ci(e,t){const r=t.store(jo),s=[];return r.ee(((a,l)=>{const d=t.store(Nf),f=(function(w){return w.document?new ce(ze.fromString(w.document.name).popFirst(5)):w.noDocument?ce.fromSegments(w.noDocument.path):w.unknownDocument?ce.fromSegments(w.unknownDocument.path):me(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>U.waitFor(s)))}Fi(e,t){const r=t.store(kr),s=LS(this.serializer),a=new L_(Ep.mi,this.serializer.yt);return r.J().next((l=>{const d=new Map;return l.forEach((f=>{let p=d.get(f.userId)??Le();Bo(this.serializer,f).keys().forEach((g=>p=p.add(g))),d.set(f.userId,p)})),U.forEach(d,((f,p)=>{const g=new en(p),w=vp.wt(this.serializer,g),T=a.getIndexManager(g),N=wp.wt(g,this.serializer,T,a.referenceDelegate);return new MS(s,N,w,T).recalculateAndSaveOverlaysForDocumentKeys(new ty(t,Un.ce),f).next()}))}))}}function k0(n){n.createObjectStore(Nl,{keyPath:iO}).createIndex(g_,oO,{unique:!0}),n.createObjectStore(Cl,{keyPath:"targetId"}).createIndex(I1,sO,{unique:!0}),n.createObjectStore(Xo)}const Ni="IndexedDbPersistence",Ag=18e5,Rg=5e3,Pg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",FS="main";class M_{constructor(e,t,r,s,a,l,d,f,p,g,w=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=l,this.document=d,this.xi=p,this.Oi=g,this.Ni=w,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!M_.v())throw new J(W.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SL(this,s),this.$i=t+FS,this.serializer=new SS(f),this.Ui=new ms(this.$i,this.Ni,new ML(this.serializer)),this.hi=new fL,this.Pi=new EL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LS(this.serializer),this.Ii=new hL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,g===!1&&Ot(Ni,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new J(W.FAILED_PRECONDITION,Pg);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Un(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Zh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(so(e))return Z(Ni,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z(Ni,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return uu(e).get(il).next((t=>U.resolve(this.es(t))))}ts(e){return Zh(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ag)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Qt(t,Dl);return r.J().next((s=>{const a=this.ss(s,Ag),l=s.filter((d=>a.indexOf(d)===-1));return U.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?U.resolve(!0):uu(e).get(il).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Rg)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new J(W.FAILED_PRECONDITION,Pg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zh(e).J().next((r=>this.ss(r,Rg).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Z(Ni,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[md,Dl],(e=>{const t=new ty(e,Un.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Zh(e).J().next((t=>this.ss(t,Ag).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return wp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new wL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Z(Ni,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?TO:f===17?P1:f===16?IO:f===15?v_:f===14?R1:f===13?A1:f===12?EO:f===11?b1:void me(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(d=>(l=new ty(d,this.ci?this.ci.next():Un.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new J(W.FAILED_PRECONDITION,g1);return r(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Is(e){return uu(e).get(il).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Rg)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new J(W.FAILED_PRECONDITION,Pg)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return uu(e).put(il,t)}static v(){return ms.v()}Zi(e){const t=uu(e);return t.get(il).next((r=>this.es(r)?(Z(Ni,"Releasing primary lease."),t.delete(il)):U.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;zT()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Z(Ni,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ot(Ni,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ot("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function uu(n){return Qt(n,md)}function Zh(n){return Qt(n,Dl)}function F_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class j_{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Le(),s=Le();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new j_(e,t.fromCache,r,s)}}class FL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class jS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return zT()?8:_1(xt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new FL;return this.Ss(e,t,l).next((d=>{if(a.result=d,this.Vs)return this.bs(e,t,l,d.size)}))})).next((()=>a.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(dl()<=Be.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",hl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(dl()<=Be.DEBUG&&Z("QueryEngine","Query:",hl(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(dl()<=Be.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",hl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kn(t))):U.resolve())}ys(e,t){if(e0(t))return U.resolve(null);let r=kn(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Lf(t,null,"F"),r=kn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Le(...a);return this.ps.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.Ds(t,d);return this.Cs(t,p,l,f.readTime)?this.ys(e,Lf(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,r,s){return e0(t)||s.isEqual(Te.min())?U.resolve(null):this.ps.getDocuments(e,r).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,r,s)?U.resolve(null):(dl()<=Be.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),hl(t)),this.vs(e,l,t,p1(s,Pl)).next((d=>d)))}))}Ds(e,t){let r=new ot(J1(e));return t.forEach(((s,a)=>{_d(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,r){return dl()<=Be.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",hl(t)),this.ps.getDocumentsMatchingQuery(e,t,or.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}const U_="LocalStore",jL=3e8;class UL{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new dt(De),this.xs=new Js((a=>sa(a)),gd),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function US(n,e,t,r){return new UL(n,e,t,r)}async function BS(n,e){const t=fe(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let f=Le();for(const p of s){l.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}for(const p of a){d.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(r,f).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function BL(n,e){const t=fe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,g){const w=p.batch,T=w.keys();let N=U.resolve();return T.forEach((A=>{N=N.next((()=>g.getEntry(f,A))).next((L=>{const V=p.docVersions.get(A);we(V!==null,48541),L.version.compareTo(V)<0&&(w.applyToRemoteDocument(L,p),L.isValidDocument()&&(L.setReadTime(p.commitVersion),g.addEntry(L)))}))})),N.next((()=>d.mutationQueue.removeMutationBatch(f,w)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=Le();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function zS(n){const e=fe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function zL(n,e){const t=fe(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const d=[];e.targetChanges.forEach(((g,w)=>{const T=s.get(w);if(!T)return;d.push(t.Pi.removeMatchingKeys(a,g.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(a,g.addedDocuments,w))));let N=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(w)!==null?N=N.withResumeToken(kt.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):g.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(g.resumeToken,r)),s=s.insert(w,N),(function(L,V,se){return L.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=jL?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(T,N,g)&&d.push(t.Pi.updateTargetData(a,N))}));let f=zn(),p=Le();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))})),d.push($S(a,l,e.documentUpdates).next((g=>{f=g.ks,p=g.qs}))),!r.isEqual(Te.min())){const g=t.Pi.getLastRemoteSnapshotVersion(a).next((w=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(g)}return U.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=s,a)))}function $S(n,e,t){let r=Le(),s=Le();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=zn();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(Te.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):Z(U_,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:l,qs:s}}))}function $L(n,e){const t=fe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Bi),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ul(n,e){const t=fe(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((a=>a?(s=a,U.resolve(s)):t.Pi.allocateTargetId(r).next((l=>(s=new Us(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Bl(n,e,t){const r=fe(n),s=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!so(l))throw l;Z(U_,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Bf(n,e,t){const r=fe(n);let s=Te.min(),a=Le();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,g){const w=fe(f),T=w.xs.get(g);return T!==void 0?U.resolve(w.Ms.get(T)):w.Pi.getTargetData(p,g)})(r,l,kn(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>r.Fs.getDocumentsMatchingQuery(l,e,t?s:Te.min(),t?a:Le()))).next((d=>(HS(r,Q1(e),d),{documents:d,Qs:a})))))}function qS(n,e){const t=fe(n),r=fe(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>r.At(a,e).next((l=>l?l.target:null))))}function WS(n,e){const t=fe(n),r=t.Os.get(e)||Te.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,p1(r,Pl),Number.MAX_SAFE_INTEGER))).then((s=>(HS(t,e,s),s)))}function HS(n,e,t){let r=n.Os.get(e)||Te.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}async function qL(n,e,t,r){const s=fe(n);let a=Le(),l=zn();for(const p of t){const g=e.$s(p.metadata.name);p.document&&(a=a.add(g));const w=e.Us(p);w.setReadTime(e.Ks(p.metadata.readTime)),l=l.insert(g,w)}const d=s.Ns.newChangeBuffer({trackRemovals:!0}),f=await Ul(s,(function(g){return kn(ec(ze.fromString(`__bundle__/docs/${g}`)))})(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",(p=>$S(p,d,l).next((g=>(d.apply(p),g))).next((g=>s.Pi.removeMatchingKeysForTargetId(p,f.targetId).next((()=>s.Pi.addMatchingKeys(p,a,f.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(p,g.ks,g.qs))).next((()=>g.ks))))))}async function WL(n,e,t=Le()){const r=await Ul(n,kn(N_(e.bundledQuery))),s=fe(n);return s.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Lt(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return s.Ii.saveNamedQuery(a,e);const d=r.withResumeToken(kt.EMPTY_BYTE_STRING,l);return s.Ms=s.Ms.insert(d.targetId,d),s.Pi.updateTargetData(a,d).next((()=>s.Pi.removeMatchingKeysForTargetId(a,r.targetId))).next((()=>s.Pi.addMatchingKeys(a,t,r.targetId))).next((()=>s.Ii.saveNamedQuery(a,e)))}))}const GS="firestore_clients";function C0(n,e){return`${GS}_${n}_${e}`}const KS="firestore_mutations";function N0(n,e,t){let r=`${KS}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const QS="firestore_targets";function kg(n,e){return`${QS}_${n}_${e}`}const rs="SharedClientState";class zf{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Ws(e,t,r){const s=JSON.parse(r);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new J(s.error.code,s.error.message))),l?new zf(e,t,s.state,a):(Ot(rs,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Du{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let s,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(s=new J(r.error.code,r.error.message))),a?new Du(e,r.state,s):(Ot(rs,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $f{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,a=x_();for(let l=0;s&&l<r.activeTargetIds.length;++l)s=v1(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return s?new $f(e,a):(Ot(rs,`Failed to parse client data for instance '${e}': ${t}`),null)}}class B_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new B_(t.clientId,t.onlineState):(Ot(rs,`Failed to parse online state: ${e}`),null)}}class gy{constructor(){this.activeTargetIds=x_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Cg{constructor(e,t,r,s,a){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new dt(De),this.started=!1,this.Xs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=C0(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new gy),this.ro=new RegExp(`^${GS}_${l}_([^_]*)$`),this.io=new RegExp(`^${KS}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${QS}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(C0(this.persistenceKey,r));if(s){const a=$f.Ws(r,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(kg(this.persistenceKey,e));if(s){const a=Du.Ws(e,s);a&&(r=a.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kg(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((s=>{this.Po(s)})),this.currentUser=e,r.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Z(rs,"READ",e,t),t}setItem(e,t){Z(rs,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Z(rs,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Z(rs,"EVENT",t.key,t.newValue),t.key===this.eo)return void Ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(a){let l=Un.ce;if(a!=null)try{const d=JSON.parse(a);we(typeof d=="number",30636,{So:a}),l=d}catch(d){Ot(rs,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);r!==Un.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const s=new zf(this.currentUser,e,t,r),a=N0(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=N0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const s=kg(this.persistenceKey,e),a=new Du(e,t,r);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return $f.Ws(r,t)}fo(e,t){const r=this.io.exec(e),s=Number(r[1]),a=r[2]!==void 0?r[2]:null;return zf.Ws(new en(a),s,t)}yo(e,t){const r=this.so.exec(e),s=Number(r[1]);return Du.Ws(s,t)}uo(e){return B_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Z(rs,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(r),l=[],d=[];return a.forEach((f=>{s.has(f)||l.push(f)})),s.forEach((f=>{a.has(f)||d.push(f)})),this.syncEngine.Fo(l,d).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=x_();return e.forEach(((r,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class JS{constructor(){this.Mo=new gy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class HL{Oo(e){}shutdown(){}}const D0="ConnectivityMonitor";class V0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Z(D0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Z(D0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ef=null;function yy(){return ef===null?ef=(function(){return 268435456+Math.round(2147483648*Math.random())})():ef++,"0x"+ef.toString(16)}const Ng="RestConnection",GL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===ny?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,a){const l=yy(),d=this.zo(e,t.toUriEncodedString());Z(Ng,`Sending RPC '${e}' ${l}:`,d,r);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,a);const{host:p}=new URL(d),g=eo(p);return this.Jo(e,d,f,r,g).then((w=>(Z(Ng,`Received RPC '${e}' ${l}: `,w),w)),(w=>{throw vs(Ng,`RPC '${e}' ${l} failed with error: `,w,"url: ",d,"request:",r),w}))}Ho(e,t,r,s,a,l){return this.Go(e,t,r,s,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const r=GL[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class QL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wn="WebChannelConnection";class JL extends KL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,a){const l=yy();return new Promise(((d,f)=>{const p=new r1;p.setWithCredentials(!0),p.listenOnce(s1.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case af.NO_ERROR:const w=p.getResponseJson();Z(wn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(w)),d(w);break;case af.TIMEOUT:Z(wn,`RPC '${e}' ${l} timed out`),f(new J(W.DEADLINE_EXCEEDED,"Request time out"));break;case af.HTTP_ERROR:const T=p.getStatus();if(Z(wn,`RPC '${e}' ${l} failed with status:`,T,"response text:",p.getResponseText()),T>0){let N=p.getResponseJson();Array.isArray(N)&&(N=N[0]);const A=N?.error;if(A&&A.status&&A.message){const L=(function(se){const ie=se.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(ie)>=0?ie:W.UNKNOWN})(A.status);f(new J(L,A.message))}else f(new J(W.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new J(W.UNAVAILABLE,"Connection failed."));break;default:me(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Z(wn,`RPC '${e}' ${l} completed.`)}}));const g=JSON.stringify(s);Z(wn,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",g,r,15)}))}T_(e,t,r){const s=yy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=a1(),d=o1(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const g=a.join("");Z(wn,`Creating RPC '${e}' stream ${s}: ${g}`,f);const w=l.createWebChannel(g,f);this.I_(w);let T=!1,N=!1;const A=new QL({Yo:V=>{N?Z(wn,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(T||(Z(wn,`Opening RPC '${e}' stream ${s} transport.`),w.open(),T=!0),Z(wn,`RPC '${e}' stream ${s} sending:`,V),w.send(V))},Zo:()=>w.close()}),L=(V,se,ie)=>{V.listen(se,(Q=>{try{ie(Q)}catch(pe){setTimeout((()=>{throw pe}),0)}}))};return L(w,mu.EventType.OPEN,(()=>{N||(Z(wn,`RPC '${e}' stream ${s} transport opened.`),A.o_())})),L(w,mu.EventType.CLOSE,(()=>{N||(N=!0,Z(wn,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(w))})),L(w,mu.EventType.ERROR,(V=>{N||(N=!0,vs(wn,`RPC '${e}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),A.a_(new J(W.UNAVAILABLE,"The operation could not be completed")))})),L(w,mu.EventType.MESSAGE,(V=>{if(!N){const se=V.data[0];we(!!se,16349);const ie=se,Q=ie?.error||ie[0]?.error;if(Q){Z(wn,`RPC '${e}' stream ${s} received error:`,Q);const pe=Q.status;let te=(function(S){const k=zt[S];if(k!==void 0)return cS(k)})(pe),ae=Q.message;te===void 0&&(te=W.INTERNAL,ae="Unknown error status: "+pe+" with message "+Q.message),N=!0,A.a_(new J(te,ae)),w.close()}else Z(wn,`RPC '${e}' stream ${s} received:`,se),A.u_(se)}})),L(d,i1.STAT_EVENT,(V=>{V.stat===Qg.PROXY?Z(wn,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===Qg.NOPROXY&&Z(wn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function YS(){return typeof window<"u"?window:null}function yf(){return typeof document<"u"?document:null}function Id(n){return new tL(n,!0)}class z_{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&Z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const O0="PersistentStream";class XS{constructor(e,t,r,s,a,l,d,f){this.Mi=e,this.S_=r,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ot(t.toString()),Ot("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new J(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Z(O0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Z(O0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class YL extends XS{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=sL(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Te.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Te.min():l.readTime?Lt(l.readTime):Te.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=dy(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=Vf(f)?{documents:vS(a,f)}:{query:wS(a,f).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=fS(a,l.resumeToken);const p=cy(a,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(Te.min())>0){d.readTime=jl(a,l.snapshotVersion.toTimestamp());const p=cy(a,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const r=oL(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=dy(this.serializer),t.removeTarget=e,this.q_(t)}}class XL extends XS{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=iL(e.writeResults,e.commitTime),r=Lt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=dy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>ed(this.serializer,r)))};this.q_(t)}}class ZL{}class e4 extends ZL{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new J(W.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,uy(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new J(W.UNKNOWN,a.toString())}))}Ho(e,t,r,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Ho(e,uy(t,r),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new J(W.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class t4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ot(t),this.aa=!1):Z("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ua="RemoteStore";class n4{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{r.enqueueAndForget((async()=>{oo(this)&&(Z(ua,"Restarting streams for network reachability change."),await(async function(f){const p=fe(f);p.Ea.add(4),await rc(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Td(p)})(this))}))})),this.Ra=new t4(r,s)}}async function Td(n){if(oo(n))for(const e of n.da)await e(!0)}async function rc(n){for(const e of n.da)await e(!1)}function Ip(n,e){const t=fe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),W_(t)?q_(t):ic(t).O_()&&$_(t,e))}function zl(n,e){const t=fe(n),r=ic(t);t.Ia.delete(e),r.O_()&&ZS(t,e),t.Ia.size===0&&(r.O_()?r.L_():oo(t)&&t.Ra.set("Unknown"))}function $_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ic(n).Y_(e)}function ZS(n,e){n.Va.Ue(e),ic(n).Z_(e)}function q_(n){n.Va=new YO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ic(n).start(),n.Ra.ua()}function W_(n){return oo(n)&&!ic(n).x_()&&n.Ia.size>0}function oo(n){return fe(n).Ea.size===0}function eb(n){n.Va=void 0}async function r4(n){n.Ra.set("Online")}async function s4(n){n.Ia.forEach(((e,t)=>{$_(n,e)}))}async function i4(n,e){eb(n),W_(n)?(n.Ra.ha(e),q_(n)):n.Ra.set("Unknown")}async function o4(n,e,t){if(n.Ra.set("Online"),e instanceof hS&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ia.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ia.delete(d),s.Va.removeTarget(d))})(n,e)}catch(r){Z(ua,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qf(n,r)}else if(e instanceof mf?n.Va.Ze(e):e instanceof dS?n.Va.st(e):n.Va.tt(e),!t.isEqual(Te.min()))try{const r=await zS(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.Va.Tt(l);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const g=a.Ia.get(p);g&&a.Ia.set(p,g.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,p)=>{const g=a.Ia.get(f);if(!g)return;a.Ia.set(f,g.withResumeToken(kt.EMPTY_BYTE_STRING,g.snapshotVersion)),ZS(a,f);const w=new Us(g.target,f,p,g.sequenceNumber);$_(a,w)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){Z(ua,"Failed to raise snapshot:",r),await qf(n,r)}}async function qf(n,e,t){if(!so(e))throw e;n.Ea.add(1),await rc(n),n.Ra.set("Offline"),t||(t=()=>zS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Z(ua,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Td(n)}))}function tb(n,e){return e().catch((t=>qf(n,t,e)))}async function sc(n){const e=fe(n),t=Yi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Bi;for(;a4(e);)try{const s=await $L(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,l4(e,s)}catch(s){await qf(e,s)}nb(e)&&rb(e)}function a4(n){return oo(n)&&n.Ta.length<10}function l4(n,e){n.Ta.push(e);const t=Yi(n);t.O_()&&t.X_&&t.ea(e.mutations)}function nb(n){return oo(n)&&!Yi(n).x_()&&n.Ta.length>0}function rb(n){Yi(n).start()}async function c4(n){Yi(n).ra()}async function u4(n){const e=Yi(n);for(const t of n.Ta)e.ea(t.mutations)}async function d4(n,e,t){const r=n.Ta.shift(),s=R_.from(r,e,t);await tb(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await sc(n)}async function h4(n,e){e&&Yi(n).X_&&await(async function(r,s){if((function(l){return lS(l)&&l!==W.ABORTED})(s.code)){const a=r.Ta.shift();Yi(r).B_(),await tb(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await sc(r)}})(n,e),nb(n)&&rb(n)}async function L0(n,e){const t=fe(n);t.asyncQueue.verifyOperationInProgress(),Z(ua,"RemoteStore received new credentials");const r=oo(t);t.Ea.add(3),await rc(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Td(t)}async function _y(n,e){const t=fe(n);e?(t.Ea.delete(2),await Td(t)):e||(t.Ea.add(2),await rc(t),t.Ra.set("Unknown"))}function ic(n){return n.ma||(n.ma=(function(t,r,s){const a=fe(t);return a.sa(),new YL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:r4.bind(null,n),t_:s4.bind(null,n),r_:i4.bind(null,n),H_:o4.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),W_(n)?q_(n):n.Ra.set("Unknown")):(await n.ma.stop(),eb(n))}))),n.ma}function Yi(n){return n.fa||(n.fa=(function(t,r,s){const a=fe(t);return a.sa(),new XL(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:c4.bind(null,n),r_:h4.bind(null,n),ta:u4.bind(null,n),na:d4.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await sc(n)):(await n.fa.stop(),n.Ta.length>0&&(Z(ua,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class H_{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,d=new H_(e,t,l,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oc(n,e){if(Ot("AsyncQueue",`${e}: ${n}`),so(n))return new J(W.UNAVAILABLE,`${e}: ${n}`);throw n}class Il{static emptySet(e){return new Il(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ce.comparator(t.key,r.key):(t,r)=>ce.comparator(t.key,r.key),this.keyedMap=gu(),this.sortedSet=new dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Il)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Il;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class M0{constructor(){this.ga=new dt(ce.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):me(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class $l{constructor(e,t,r,s,a,l,d,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new $l(e,t,Il.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class f4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class p4{constructor(){this.queries=F0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=fe(t),a=s.queries;s.queries=F0(),a.forEach(((l,d)=>{for(const f of d.Sa)f.onError(r)}))})(this,new J(W.ABORTED,"Firestore shutting down"))}}function F0(){return new Js((n=>K1(n)),yd)}async function G_(n,e){const t=fe(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(r=2):(a=new f4,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=oc(l,`Initialization of query '${hl(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Q_(t)}async function K_(n,e){const t=fe(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function m4(n,e){const t=fe(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.Sa)d.Fa(s)&&(r=!0);l.wa=s}}r&&Q_(t)}function g4(n,e,t){const r=fe(n),s=r.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);r.queries.delete(e)}function Q_(n){n.Ca.forEach((e=>{e.next()}))}var vy,j0;(j0=vy||(vy={})).Ma="default",j0.Cache="cache";class J_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $l(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vy.Cache}}class y4{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class U0{constructor(e){this.serializer=e}$s(e){return gs(this.serializer,e)}Us(e){return e.metadata.exists?_S(this.serializer,e.document,!1):mt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Lt(e)}}class _4{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=sb(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=ze.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new U0(this.serializer);for(const s of e)if(s.metadata.queries){const a=r.$s(s.metadata.name);for(const l of s.metadata.queries){const d=(t.get(l)||Le()).add(a);t.set(l,d)}}return t}async ja(e){const t=await qL(e,new U0(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await WL(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function sb(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class ib{constructor(e){this.key=e}}class ob{constructor(e){this.key=e}}class ab{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Le(),this.mutatedKeys=Le(),this.eu=J1(e),this.tu=new Il(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new M0,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,w)=>{const T=s.get(g),N=_d(this.query,w)?w:null,A=!!T&&this.mutatedKeys.has(T.key),L=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let V=!1;T&&N?T.data.isEqual(N.data)?A!==L&&(r.track({type:3,doc:N}),V=!0):this.su(T,N)||(r.track({type:2,doc:N}),V=!0,(f&&this.eu(N,f)>0||p&&this.eu(N,p)<0)&&(d=!0)):!T&&N?(r.track({type:0,doc:N}),V=!0):T&&!N&&(r.track({type:1,doc:T}),V=!0,(f||p)&&(d=!0)),V&&(N?(l=l.add(N),a=L?a.add(g):a.delete(g)):(l=l.delete(g),a=a.delete(g)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{tu:l,iu:r,Cs:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((g,w)=>(function(N,A){const L=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me(20277,{Rt:V})}};return L(N)-L(A)})(g.type,w.type)||this.eu(g.doc,w.doc))),this.ou(r),s=s??!1;const d=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,l.length!==0||p?{snapshot:new $l(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new M0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Le(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new ob(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new ib(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Le();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return $l.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ao="SyncEngine";class v4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class w4{constructor(e){this.key=e,this.hu=!1}}class E4{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Js((d=>K1(d)),yd),this.Iu=new Map,this.Eu=new Set,this.du=new dt(ce.comparator),this.Au=new Map,this.Ru=new O_,this.Vu={},this.mu=new Map,this.fu=ca.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function I4(n,e,t=!0){const r=Tp(n);let s;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await lb(r,e,t,!0),s}async function T4(n,e){const t=Tp(n);await lb(t,e,!0,!1)}async function lb(n,e,t,r){const s=await Ul(n.localStore,kn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await Y_(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&Ip(n.remoteStore,s),d}async function Y_(n,e,t,r,s){n.pu=(w,T,N)=>(async function(L,V,se,ie){let Q=V.view.ru(se);Q.Cs&&(Q=await Bf(L.localStore,V.query,!1).then((({documents:b})=>V.view.ru(b,Q))));const pe=ie&&ie.targetChanges.get(V.targetId),te=ie&&ie.targetMismatches.get(V.targetId)!=null,ae=V.view.applyChanges(Q,L.isPrimaryClient,pe,te);return wy(L,V.targetId,ae.au),ae.snapshot})(n,w,T,N);const a=await Bf(n.localStore,e,!0),l=new ab(e,a.Qs),d=l.ru(a.documents),f=Ed.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,f);wy(n,t,p.au);const g=new v4(e,t,l);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function x4(n,e,t){const r=fe(n),s=r.Tu.get(e),a=r.Iu.get(s.targetId);if(a.length>1)return r.Iu.set(s.targetId,a.filter((l=>!yd(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Bl(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&zl(r.remoteStore,s.targetId),ql(r,s.targetId)})).catch(ro)):(ql(r,s.targetId),await Bl(r.localStore,s.targetId,!0))}async function S4(n,e){const t=fe(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),zl(t.remoteStore,r.targetId))}async function b4(n,e,t){const r=tv(n);try{const s=await(function(l,d){const f=fe(l),p=nt.now(),g=d.reduce(((N,A)=>N.add(A.key)),Le());let w,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let A=zn(),L=Le();return f.Ns.getEntries(N,g).next((V=>{A=V,A.forEach(((se,ie)=>{ie.isValidDocument()||(L=L.add(se))}))})).next((()=>f.localDocuments.getOverlayedDocuments(N,A))).next((V=>{w=V;const se=[];for(const ie of d){const Q=KO(ie,w.get(ie.key).overlayedDocument);Q!=null&&se.push(new Ys(ie.key,Q,j1(Q.value.mapValue),wt.exists(!0)))}return f.mutationQueue.addMutationBatch(N,p,se,d)})).next((V=>{T=V;const se=V.applyToLocalDocumentSet(w,L);return f.documentOverlayCache.saveOverlays(N,V.batchId,se)}))})).then((()=>({batchId:T.batchId,changes:X1(w)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let p=l.Vu[l.currentUser.toKey()];p||(p=new dt(De)),p=p.insert(d,f),l.Vu[l.currentUser.toKey()]=p})(r,s.batchId,t),await Xs(r,s.changes),await sc(r.remoteStore)}catch(s){const a=oc(s,"Failed to persist write");t.reject(a)}}async function cb(n,e){const t=fe(n);try{const r=await zL(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(we(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?we(l.hu,14607):s.removedDocuments.size>0&&(we(l.hu,42227),l.hu=!1))})),await Xs(t,r,e)}catch(r){await ro(r)}}function B0(n,e,t){const r=fe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=fe(l);f.onlineState=d;let p=!1;f.queries.forEach(((g,w)=>{for(const T of w.Sa)T.va(d)&&(p=!0)})),p&&Q_(f)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function A4(n,e,t){const r=fe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),a=s&&s.key;if(a){let l=new dt(ce.comparator);l=l.insert(a,mt.newNoDocument(a,Te.min()));const d=Le().add(a),f=new wd(Te.min(),new Map,new dt(De),l,d);await cb(r,f),r.du=r.du.remove(a),r.Au.delete(e),ev(r)}else await Bl(r.localStore,e,!1).then((()=>ql(r,e,t))).catch(ro)}async function R4(n,e){const t=fe(n),r=e.batch.batchId;try{const s=await BL(t.localStore,e);Z_(t,r,null),X_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Xs(t,s)}catch(s){await ro(s)}}async function P4(n,e,t){const r=fe(n);try{const s=await(function(l,d){const f=fe(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return f.mutationQueue.lookupMutationBatch(p,d).next((w=>(we(w!==null,37113),g=w.keys(),f.mutationQueue.removeMutationBatch(p,w)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,g,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>f.localDocuments.getDocuments(p,g)))}))})(r.localStore,e);Z_(r,e,t),X_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Xs(r,s)}catch(s){await ro(s)}}async function k4(n,e){const t=fe(n);oo(t.remoteStore)||Z(ao,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(l){const d=fe(l);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>d.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===Bi)return void e.resolve();const s=t.mu.get(r)||[];s.push(e),t.mu.set(r,s)}catch(r){const s=oc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function X_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Z_(n,e,t){const r=fe(n);let s=r.Vu[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ql(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||ub(n,r)}))}function ub(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(zl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ev(n))}function wy(n,e,t){for(const r of t)r instanceof ib?(n.Ru.addReference(r.key,e),C4(n,r)):r instanceof ob?(Z(ao,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||ub(n,r.key)):me(19791,{wu:r})}function C4(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Z(ao,"New document in limbo: "+t),n.Eu.add(r),ev(n))}function ev(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ce(ze.fromString(e)),r=n.fu.next();n.Au.set(r,new w4(t)),n.du=n.du.insert(t,r),Ip(n.remoteStore,new Us(kn(ec(t.path)),r,"TargetPurposeLimboResolution",Un.ce))}}async function Xs(n,e,t){const r=fe(n),s=[],a=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((d,f)=>{l.push(r.pu(f,e,t).then((p=>{if((p||t)&&r.isPrimaryClient){const g=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;r.sharedClientState.updateQueryState(f.targetId,g?"current":"not-current")}if(p){s.push(p);const g=j_.As(f.targetId,p);a.push(g)}})))})),await Promise.all(l),r.Pu.H_(s),await(async function(f,p){const g=fe(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>U.forEach(p,(T=>U.forEach(T.Es,(N=>g.persistence.referenceDelegate.addReference(w,T.targetId,N))).next((()=>U.forEach(T.ds,(N=>g.persistence.referenceDelegate.removeReference(w,T.targetId,N)))))))))}catch(w){if(!so(w))throw w;Z(U_,"Failed to update sequence numbers: "+w)}for(const w of p){const T=w.targetId;if(!w.fromCache){const N=g.Ms.get(T),A=N.snapshotVersion,L=N.withLastLimboFreeSnapshotVersion(A);g.Ms=g.Ms.insert(T,L)}}})(r.localStore,a))}async function N4(n,e){const t=fe(n);if(!t.currentUser.isEqual(e)){Z(ao,"User change. New user:",e.toKey());const r=await BS(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new J(W.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Xs(t,r.Ls)}}function D4(n,e){const t=fe(n),r=t.Au.get(e);if(r&&r.hu)return Le().add(r.key);{let s=Le();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const d=t.Tu.get(l);s=s.unionWith(d.view.nu)}return s}}async function V4(n,e){const t=fe(n),r=await Bf(t.localStore,e.query,!0),s=e.view.cu(r);return t.isPrimaryClient&&wy(t,e.targetId,s.au),s}async function O4(n,e){const t=fe(n);return WS(t.localStore,e).then((r=>Xs(t,r)))}async function L4(n,e,t,r){const s=fe(n),a=await(function(d,f){const p=fe(d),g=fe(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(w=>g.er(w,f).next((T=>T?p.localDocuments.getDocuments(w,T):U.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await sc(s.remoteStore):t==="acknowledged"||t==="rejected"?(Z_(s,e,r||null),X_(s,e),(function(d,f){fe(fe(d).mutationQueue).ir(f)})(s.localStore,e)):me(6720,"Unknown batchState",{Su:t}),await Xs(s,a)):Z(ao,"Cannot apply mutation batch with id: "+e)}async function M4(n,e){const t=fe(n);if(Tp(t),tv(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await z0(t,r.toArray());t.gu=!0,await _y(t.remoteStore,!0);for(const a of s)Ip(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const r=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):s=s.then((()=>(ql(t,l),Bl(t.localStore,l,!0)))),zl(t.remoteStore,l)})),await s,await z0(t,r),(function(l){const d=fe(l);d.Au.forEach(((f,p)=>{zl(d.remoteStore,p)})),d.Ru.Jr(),d.Au=new Map,d.du=new dt(ce.comparator)})(t),t.gu=!1,await _y(t.remoteStore,!1)}}async function z0(n,e,t){const r=fe(n),s=[],a=[];for(const l of e){let d;const f=r.Iu.get(l);if(f&&f.length!==0){d=await Ul(r.localStore,kn(f[0]));for(const p of f){const g=r.Tu.get(p),w=await V4(r,g);w.snapshot&&a.push(w.snapshot)}}else{const p=await qS(r.localStore,l);d=await Ul(r.localStore,p),await Y_(r,db(p),l,!1,d.resumeToken)}s.push(d)}return r.Pu.H_(a),s}function db(n){return G1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function F4(n){return(function(t){return fe(fe(t).persistence).Ts()})(fe(n).localStore)}async function j4(n,e,t,r){const s=fe(n);if(s.gu)return void Z(ao,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await WS(s.localStore,Q1(a[0])),d=wd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",kt.EMPTY_BYTE_STRING);await Xs(s,l,d);break}case"rejected":await Bl(s.localStore,e,!0),ql(s,e,r);break;default:me(64155,t)}}async function U4(n,e,t){const r=Tp(n);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Z(ao,"Adding an already active target "+s);continue}const a=await qS(r.localStore,s),l=await Ul(r.localStore,a);await Y_(r,db(a),l.targetId,!1,l.resumeToken),Ip(r.remoteStore,l)}for(const s of t)r.Iu.has(s)&&await Bl(r.localStore,s,!1).then((()=>{zl(r.remoteStore,s),ql(r,s)})).catch(ro)}}function Tp(n){const e=fe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=cb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=A4.bind(null,e),e.Pu.H_=m4.bind(null,e.eventManager),e.Pu.yu=g4.bind(null,e.eventManager),e}function tv(n){const e=fe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=R4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P4.bind(null,e),e}function B4(n,e,t){const r=fe(n);(async function(a,l,d){try{const f=await l.getMetadata();if(await(function(N,A){const L=fe(N),V=Lt(A.createTime);return L.persistence.runTransaction("hasNewerBundle","readonly",(se=>L.Ii.getBundleMetadata(se,A.id))).then((se=>!!se&&se.createTime.compareTo(V)>=0))})(a.localStore,f))return await l.close(),d._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(f)),Promise.resolve(new Set);d._updateProgress(sb(f));const p=new _4(f,l.serializer);let g=await l.bu();for(;g;){const T=await p.Ga(g);T&&d._updateProgress(T),g=await l.bu()}const w=await p.ja(a.localStore);return await Xs(a,w.Ha,void 0),await(function(N,A){const L=fe(N);return L.persistence.runTransaction("Save bundle","readwrite",(V=>L.Ii.saveBundleMetadata(V,A)))})(a.localStore,f),d._completeWith(w.progress),Promise.resolve(w.Ja)}catch(f){return vs(ao,`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((s=>{r.sharedClientState.notifyBundleLoaded(s)}))}class td{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Id(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return US(this.persistence,new jS,e.initialUser,this.serializer)}Cu(e){return new L_(Ep.mi,this.serializer)}Du(e){return new JS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}td.provider={build:()=>new td};class z4 extends td{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){we(this.persistence.referenceDelegate instanceof Uf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new DS(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new L_((r=>Uf.mi(r,t)),this.serializer)}}class hb extends td{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await tv(this.xu.syncEngine),await sc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return US(this.persistence,new jS,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new DS(r,e.asyncQueue,t)}Mu(e,t){const r=new YV(t,this.persistence);return new JV(e.asyncQueue,r)}Cu(e){const t=F_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new M_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,YS(),yf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new JS}}class $4 extends hb{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Cg&&(this.sharedClientState.syncEngine={Co:L4.bind(null,t),vo:j4.bind(null,t),Fo:U4.bind(null,t),Ts:F4.bind(null,t),Do:O4.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await M4(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=YS();if(!Cg.v(t))throw new J(W.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=F_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Cg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class nd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>B0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=N4.bind(null,this.syncEngine),await _y(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new p4})()}createDatastore(e){const t=Id(e.databaseInfo.databaseId),r=(function(a){return new JL(a)})(e.databaseInfo);return(function(a,l,d,f){return new e4(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,d){return new n4(r,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>B0(this.syncEngine,t,0)),(function(){return V0.v()?new V0:new HL})())}createSyncEngine(e,t){return(function(s,a,l,d,f,p,g){const w=new E4(s,a,l,d,f,p);return g&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=fe(t);Z(ua,"RemoteStore shutting down."),r.Ea.add(5),await rc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}nd.provider={build:()=>new nd};function $0(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class xp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ot("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class q4{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new fn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(r);return new y4(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class W4{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new J(W.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,a){const l=fe(s),d={documents:a.map((w=>Zu(l.serializer,w)))},f=await l.Ho("BatchGetDocuments",l.serializer.databaseId,ze.emptyPath(),d,a.length),p=new Map;f.forEach((w=>{const T=rL(l.serializer,w);p.set(T.key.toString(),T)}));const g=[];return a.forEach((w=>{const T=p.get(w.toString());we(!!T,55234,{key:w}),g.push(T)})),g})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new nc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const s=ce.fromPath(r);this.mutations.push(new b_(s,this.precondition(s)))})),await(async function(r,s){const a=fe(r),l={writes:s.map((d=>ed(a.serializer,d)))};await a.Go("Commit",a.serializer.databaseId,ze.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw me(50498,{Gu:e.constructor.name});t=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new J(W.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Te.min())?wt.exists(!1):wt.updateTime(t):wt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Te.min()))throw new J(W.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return wt.updateTime(t)}return wt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class H4{constructor(e,t,r,s,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=a,this.zu=r.maxAttempts,this.M_=new z_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new W4(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((s=>{this.Yu(s)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!pd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!lS(t)}return!1}}const Xi="FirestoreClient";class G4{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=h_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{Z(Xi,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(Z(Xi,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=oc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Dg(n,e){n.asyncQueue.verifyOperationInProgress(),Z(Xi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await BS(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function q0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await nv(n);Z(Xi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>L0(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>L0(e.remoteStore,s))),n._onlineComponents=e}async function nv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Z(Xi,"Using user provided OfflineComponentProvider");try{await Dg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;vs("Error using user provided cache. Falling back to memory cache: "+t),await Dg(n,new td)}}else Z(Xi,"Using default OfflineComponentProvider"),await Dg(n,new z4(void 0));return n._offlineComponents}async function Sp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Z(Xi,"Using user provided OnlineComponentProvider"),await q0(n,n._uninitializedComponentsProvider._online)):(Z(Xi,"Using default OnlineComponentProvider"),await q0(n,new nd))),n._onlineComponents}function fb(n){return nv(n).then((e=>e.persistence))}function rv(n){return nv(n).then((e=>e.localStore))}function pb(n){return Sp(n).then((e=>e.remoteStore))}function sv(n){return Sp(n).then((e=>e.syncEngine))}function K4(n){return Sp(n).then((e=>e.datastore))}async function Wl(n){const e=await Sp(n),t=e.eventManager;return t.onListen=I4.bind(null,e.syncEngine),t.onUnlisten=x4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=T4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=S4.bind(null,e.syncEngine),t}function Q4(n){return n.asyncQueue.enqueue((async()=>{const e=await fb(n),t=await pb(n);return e.setNetworkEnabled(!0),(function(s){const a=fe(s);return a.Ea.delete(0),Td(a)})(t)}))}function J4(n){return n.asyncQueue.enqueue((async()=>{const e=await fb(n),t=await pb(n);return e.setNetworkEnabled(!1),(async function(s){const a=fe(s);a.Ea.add(0),await rc(a),a.Ra.set("Offline")})(t)}))}function Y4(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const d=await(function(p,g){const w=fe(p);return w.persistence.runTransaction("read document","readonly",(T=>w.localDocuments.getDocument(T,g)))})(s,a);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new J(W.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=oc(d,`Failed to get document '${a} from cache`);l.reject(f)}})(await rv(n),e,t))),t.promise}function mb(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const g=new xp({next:T=>{g.Nu(),l.enqueueAndForget((()=>K_(a,w)));const N=T.docs.has(d);!N&&T.fromCache?p.reject(new J(W.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&T.fromCache&&f&&f.source==="server"?p.reject(new J(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),w=new J_(ec(d.path),g,{includeMetadataChanges:!0,qa:!0});return G_(a,w)})(await Wl(n),n.asyncQueue,e,t,r))),r.promise}function X4(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,a,l){try{const d=await Bf(s,a,!0),f=new ab(a,d.Qs),p=f.ru(d.documents),g=f.applyChanges(p,!1);l.resolve(g.snapshot)}catch(d){const f=oc(d,`Failed to execute query '${a} against cache`);l.reject(f)}})(await rv(n),e,t))),t.promise}function gb(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const g=new xp({next:T=>{g.Nu(),l.enqueueAndForget((()=>K_(a,w))),T.fromCache&&f.source==="server"?p.reject(new J(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),w=new J_(d,g,{includeMetadataChanges:!0,qa:!0});return G_(a,w)})(await Wl(n),n.asyncQueue,e,t,r))),r.promise}function Z4(n,e){const t=new xp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,a){fe(s).Ca.add(a),a.next()})(await Wl(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,a){fe(s).Ca.delete(a)})(await Wl(n),t)))}}function eM(n,e,t,r){const s=(function(l,d){let f;return f=typeof l=="string"?uS().encode(l):l,(function(g,w){return new q4(g,w)})((function(g,w){if(g instanceof Uint8Array)return $0(g,w);if(g instanceof ArrayBuffer)return $0(new Uint8Array(g),w);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),d)})(t,Id(e));n.asyncQueue.enqueueAndForget((async()=>{B4(await sv(n),s,r)}))}function tM(n,e){return n.asyncQueue.enqueue((async()=>(function(r,s){const a=fe(r);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,s)))})(await rv(n),e)))}function yb(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const W0=new Map;const _b="firestore.googleapis.com",H0=!0;class G0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new J(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_b,this.ssl=H0}else this.host=e.host,this.ssl=e.ssl??H0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=PS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<IL)throw new J(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}d1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yb(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xd{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new G0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new G0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new FV;switch(r.type){case"firstParty":return new zV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=W0.get(t);r&&(Z("ComponentProvider","Removing Datastore"),W0.delete(t),r.terminate())})(this),Promise.resolve()}}function nM(n,e,t,r={}){n=Ze(n,xd);const s=eo(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;s&&(My(`https://${d}`),Fy("Firestore",!0)),a.host!==_b&&a.host!==d&&vs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:d,ssl:s,emulatorOptions:r};if(!$i(f,l)&&(n._setSettings(f),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=en.MOCK_USER;else{p=tk(r.mockUserToken,n._app?.options.projectId);const w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new J(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new en(w)}n._authCredentials=new jV(new c1(p,g))}}let Cn=class vb{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vb(this.firestore,e,this._query)}},ut=class vu{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vu(this.firestore,e,this._key)}toJSON(){return{type:vu._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(fd(t,vu._jsonSchema))return new vu(e,r||null,new ce(ze.fromString(t.referencePath)))}};ut._jsonSchemaVersion="firestore/documentReference/1.0",ut._jsonSchema={type:qt("string",ut._jsonSchemaVersion),referencePath:qt("string")};let zi=class wb extends Cn{constructor(e,t,r){super(e,t,ec(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ut(this.firestore,null,new ce(e))}withConverter(e){return new wb(this.firestore,e,this._path)}};function Eb(n,e,...t){if(n=xe(n),f_("collection","path",e),n instanceof xd){const r=ze.fromString(e,...t);return OI(r),new zi(n,null,r)}{if(!(n instanceof ut||n instanceof zi))throw new J(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return OI(r),new zi(n.firestore,null,r)}}function rM(n,e){if(n=Ze(n,xd),f_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new J(W.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Cn(n,null,(function(r){return new Qs(ze.emptyPath(),r)})(e))}function Wf(n,e,...t){if(n=xe(n),arguments.length===1&&(e=h_.newId()),f_("doc","path",e),n instanceof xd){const r=ze.fromString(e,...t);return VI(r),new ut(n,null,new ce(r))}{if(!(n instanceof ut||n instanceof zi))throw new J(W.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return VI(r),new ut(n.firestore,n instanceof zi?n.converter:null,new ce(r))}}function Ib(n,e){return n=xe(n),e=xe(e),(n instanceof ut||n instanceof zi)&&(e instanceof ut||e instanceof zi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Tb(n,e){return n=xe(n),e=xe(e),n instanceof Cn&&e instanceof Cn&&n.firestore===e.firestore&&yd(n._query,e._query)&&n.converter===e.converter}const K0="AsyncQueue";class Q0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z_(this,"async_queue_retry"),this._c=()=>{const r=yf();r&&Z(K0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=yf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new fn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!so(e))throw e;Z(K0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ot("INTERNAL UNHANDLED ERROR: ",J0(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=H_.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&me(47125,{Pc:J0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function J0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Ey(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class sM{constructor(){this._progressObserver={},this._taskCompletionResolver=new fn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const iM=-1;let Mt=class extends xd{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Q0,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Q0(e),this._firestoreClient=void 0,await e}}};function Sn(n){if(n._terminated)throw new J(W.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xb(n),n._firestoreClient}function xb(n){const e=n._freezeSettings(),t=(function(s,a,l,d){return new bO(s,a,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,yb(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new G4(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(n._componentsProvider))}function oM(n,e){vs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Sb(n,nd.provider,{build:r=>new hb(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function aM(n){vs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Sb(n,nd.provider,{build:t=>new $4(t,e.cacheSizeBytes)})}function Sb(n,e,t){if((n=Ze(n,Mt))._firestoreClient||n._terminated)throw new J(W.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new J(W.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},xb(n)}function lM(n){if(n._initialized&&!n._terminated)throw new J(W.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new fn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!ms.v())return Promise.resolve();const s=r+FS;await ms.delete(s)})(F_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function cM(n){return(function(t){const r=new fn;return t.asyncQueue.enqueueAndForget((async()=>k4(await sv(t),r))),r.promise})(Sn(n=Ze(n,Mt)))}function uM(n){return Q4(Sn(n=Ze(n,Mt)))}function dM(n){return J4(Sn(n=Ze(n,Mt)))}function hM(n,e){const t=Sn(n=Ze(n,Mt)),r=new sM;return eM(t,n._databaseId,e,r),r}function fM(n,e){return tM(Sn(n=Ze(n,Mt)),e).then((t=>t?new Cn(n,null,t.query):null))}class In{constructor(e){this._byteString=e}static fromBase64String(e){try{return new In(kt.fromBase64String(e))}catch(t){throw new J(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new In(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:In._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fd(e,In._jsonSchema))return In.fromBase64String(e.bytes)}}In._jsonSchemaVersion="firestore/bytes/1.0",In._jsonSchema={type:qt("string",In._jsonSchemaVersion),bytes:qt("string")};let Zi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new J(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let ma=class{constructor(e){this._methodName=e}};class Nr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new J(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new J(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nr._jsonSchemaVersion}}static fromJSON(e){if(fd(e,Nr._jsonSchema))return new Nr(e.latitude,e.longitude)}}Nr._jsonSchemaVersion="firestore/geoPoint/1.0",Nr._jsonSchema={type:qt("string",Nr._jsonSchemaVersion),latitude:qt("number"),longitude:qt("number")};class ys{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fd(e,ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ys(e.vectorValues);throw new J(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ys._jsonSchemaVersion="firestore/vectorValue/1.0",ys._jsonSchema={type:qt("string",ys._jsonSchemaVersion),vectorValues:qt("object")};const pM=/^__.*__$/;class mM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ys(e,this.data,this.fieldMask,t,this.fieldTransforms):new tc(e,this.data,t,this.fieldTransforms)}}class bb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ys(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ab(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me(40011,{Ac:n})}}class bp{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new bp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Hf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ab(this.Ac)&&pM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gM{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Id(e)}Cc(e,t,r,s=!1){return new bp({Ac:e,methodName:t,Dc:r,path:vt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ga(n){const e=n._freezeSettings(),t=Id(n._databaseId);return new gM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ap(n,e,t,r,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);dv("Data must be an object, but it was:",l,r);const d=kb(r,l);let f,p;if(a.merge)f=new Bn(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const g=[];for(const w of a.mergeFields){const T=Iy(e,w,t);if(!l.contains(T))throw new J(W.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Nb(g,T)||g.push(T)}f=new Bn(g),p=l.fieldTransforms.filter((w=>f.covers(w.field)))}else f=null,p=l.fieldTransforms;return new mM(new dn(d),f,p)}class Sd extends ma{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sd}}function Rb(n,e,t){return new bp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class iv extends ma{_toFieldTransform(e){return new vd(e.path,new Ml)}isEqual(e){return e instanceof iv}}class ov extends ma{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Rb(this,e,!0),r=this.vc.map((a=>ya(a,t))),s=new ia(r);return new vd(e.path,s)}isEqual(e){return e instanceof ov&&$i(this.vc,e.vc)}}class av extends ma{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Rb(this,e,!0),r=this.vc.map((a=>ya(a,t))),s=new oa(r);return new vd(e.path,s)}isEqual(e){return e instanceof av&&$i(this.vc,e.vc)}}class lv extends ma{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Fl(e.serializer,tS(e.serializer,this.Fc));return new vd(e.path,t)}isEqual(e){return e instanceof lv&&this.Fc===e.Fc}}function cv(n,e,t,r){const s=n.Cc(1,e,t);dv("Data must be an object, but it was:",s,r);const a=[],l=dn.empty();io(r,((f,p)=>{const g=hv(e,f,t);p=xe(p);const w=s.yc(g);if(p instanceof Sd)a.push(g);else{const T=ya(p,w);T!=null&&(a.push(g),l.set(g,T))}}));const d=new Bn(a);return new bb(l,d,s.fieldTransforms)}function uv(n,e,t,r,s,a){const l=n.Cc(1,e,t),d=[Iy(e,r,t)],f=[s];if(a.length%2!=0)throw new J(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<a.length;T+=2)d.push(Iy(e,a[T])),f.push(a[T+1]);const p=[],g=dn.empty();for(let T=d.length-1;T>=0;--T)if(!Nb(p,d[T])){const N=d[T];let A=f[T];A=xe(A);const L=l.yc(N);if(A instanceof Sd)p.push(N);else{const V=ya(A,L);V!=null&&(p.push(N),g.set(N,V))}}const w=new Bn(p);return new bb(g,w,l.fieldTransforms)}function Pb(n,e,t,r=!1){return ya(t,n.Cc(r?4:3,e))}function ya(n,e){if(Cb(n=xe(n)))return dv("Unsupported field value:",e,n),kb(n,e);if(n instanceof ma)return(function(r,s){if(!Ab(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const d of r){let f=ya(d,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return tS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=nt.fromDate(r);return{timestampValue:jl(s.serializer,a)}}if(r instanceof nt){const a=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:jl(s.serializer,a)}}if(r instanceof Nr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof In)return{bytesValue:fS(s.serializer,r._byteString)};if(r instanceof ut){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:C_(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ys)return(function(l,d){return{mapValue:{fields:{[w_]:{stringValue:E_},[Vl]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return S_(d.serializer,p)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${cp(r)}`)})(n,e)}function kb(n,e){const t={};return k1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):io(n,((r,s)=>{const a=ya(s,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Cb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof Nr||n instanceof In||n instanceof ut||n instanceof ma||n instanceof ys)}function dv(n,e,t){if(!Cb(t)||!h1(t)){const r=cp(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Iy(n,e,t){if((e=xe(e))instanceof Zi)return e._internalPath;if(typeof e=="string")return hv(n,e);throw Hf("Field path arguments must be of type string or ",n,!1,void 0,t)}const yM=new RegExp("[~\\*/\\[\\]]");function hv(n,e,t){if(e.search(yM)>=0)throw Hf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Zi(...e.split("."))._internalPath}catch{throw Hf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Hf(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new J(W.INVALID_ARGUMENT,d+n+f)}function Nb(n,e){return n.some((t=>t.isEqual(e)))}class rd{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _M(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _M extends rd{data(){return super.data()}}function Rp(n,e){return typeof e=="string"?hv(n,e):e instanceof Zi?e._internalPath:e._delegate._internalPath}function Db(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new J(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fv{}class bd extends fv{}function Di(n,e,...t){let r=[];e instanceof fv&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof pv)).length,d=a.filter((f=>f instanceof Pp)).length;if(l>1||l>0&&d>0)throw new J(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Pp extends bd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Pp(e,t,r)}_apply(e){const t=this._parse(e);return Ob(e._query,t),new Cn(e.firestore,e.converter,ly(e._query,t))}_parse(e){const t=ga(e.firestore);return(function(a,l,d,f,p,g,w){let T;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new J(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){X0(w,g);const A=[];for(const L of w)A.push(Y0(f,a,L));T={arrayValue:{values:A}}}else T=Y0(f,a,w)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||X0(w,g),T=Pb(d,l,w,g==="in"||g==="not-in");return qe.create(p,g,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vM(n,e,t){const r=e,s=Rp("where",n);return Pp._create(s,r,t)}class pv extends fv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pv(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:it.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Ob(l,f),l=ly(l,f)})(e._query,t),new Cn(e.firestore,e.converter,ly(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mv extends bd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mv(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new J(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new J(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xu(a,l)})(e._query,this._field,this._direction);return new Cn(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Qs(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function wM(n,e="asc"){const t=e,r=Rp("orderBy",n);return mv._create(r,t)}class kp extends bd{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new kp(e,t,r)}_apply(e){return new Cn(e.firestore,e.converter,Lf(e._query,this._limit,this._limitType))}}function EM(n){return f1("limit",n),kp._create("limit",n,"F")}function IM(n){return f1("limitToLast",n),kp._create("limitToLast",n,"L")}class Cp extends bd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Cp(e,t,r)}_apply(e){const t=Vb(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(s,a){return new Qs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,a,s.endAt)})(e._query,t))}}function TM(...n){return Cp._create("startAt",n,!0)}function xM(...n){return Cp._create("startAfter",n,!1)}class Np extends bd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Np(e,t,r)}_apply(e){const t=Vb(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(s,a){return new Qs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,a)})(e._query,t))}}function SM(...n){return Np._create("endBefore",n,!1)}function bM(...n){return Np._create("endAt",n,!0)}function Vb(n,e,t,r){if(t[0]=xe(t[0]),t[0]instanceof rd)return(function(a,l,d,f,p){if(!f)throw new J(W.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const g=[];for(const w of El(a))if(w.field.isKeyField())g.push(ra(l,f.key));else{const T=f.data.field(w.field);if(pp(T))throw new J(W.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const N=w.field.canonicalString();throw new J(W.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}g.push(T)}return new Ji(g,p)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=ga(n.firestore);return(function(l,d,f,p,g,w){const T=l.explicitOrderBy;if(g.length>T.length)throw new J(W.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let A=0;A<g.length;A++){const L=g[A];if(T[A].field.isKeyField()){if(typeof L!="string")throw new J(W.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof L}`);if(!T_(l)&&L.indexOf("/")!==-1)throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${L}' contains a slash.`);const V=l.path.child(ze.fromString(L));if(!ce.isDocumentKey(V))throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const se=new ce(V);N.push(ra(d,se))}else{const V=Pb(f,p,L);N.push(V)}}return new Ji(N,w)})(n._query,n.firestore._databaseId,s,e,t,r)}}function Y0(n,e,t){if(typeof(t=xe(t))=="string"){if(t==="")throw new J(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!T_(e)&&t.indexOf("/")!==-1)throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ze.fromString(t));if(!ce.isDocumentKey(r))throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ra(n,new ce(r))}if(t instanceof ut)return ra(n,t._key);throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cp(t)}.`)}function X0(n,e){if(!Array.isArray(n)||n.length===0)throw new J(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ob(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new J(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class gv{convertValue(e,t="none"){switch(Ki(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return io(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[Vl].arrayValue?.values?.map((r=>_t(r.doubleValue)));return new ys(t)}convertGeoPoint(e){return new Nr(_t(e.latitude),_t(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=mp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Qu(e));default:return null}}convertTimestamp(e){const t=Ws(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ze.fromString(e);we(xS(r),9688,{name:e});const s=new Gi(r.get(1),r.get(3)),a=new ce(r.popFirst(5));return s.isEqual(t)||Ot(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function Dp(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class AM extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ut(this.firestore,null,t)}}class Go{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let yr=class Lb extends rd{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Rp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Lb._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};yr._jsonSchemaVersion="firestore/documentSnapshot/1.0",yr._jsonSchema={type:qt("string",yr._jsonSchemaVersion),bundleSource:qt("string","DocumentSnapshot"),bundleName:qt("string"),bundle:qt("string")};let Vu=class extends yr{data(e={}){return super.data(e)}},Dr=class Mb{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Go(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Vu(this._firestore,this._userDataWriter,r.key,r,new Go(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new J(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new Vu(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Go(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new Vu(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Go(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),g=l.indexOf(d.doc.key)),{type:RM(d.type),doc:f,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Mb._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=h_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function RM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me(61501,{type:n})}}function Fb(n,e){return n instanceof yr&&e instanceof yr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Dr&&e instanceof Dr&&n._firestore===e._firestore&&Tb(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function PM(n){n=Ze(n,ut);const e=Ze(n.firestore,Mt);return mb(Sn(e),n._key).then((t=>yv(e,n,t)))}Dr._jsonSchemaVersion="firestore/querySnapshot/1.0",Dr._jsonSchema={type:qt("string",Dr._jsonSchemaVersion),bundleSource:qt("string","QuerySnapshot"),bundleName:qt("string"),bundle:qt("string")};class _a extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new In(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ut(this.firestore,null,t)}}function kM(n){n=Ze(n,ut);const e=Ze(n.firestore,Mt),t=Sn(e),r=new _a(e);return Y4(t,n._key).then((s=>new yr(e,r,n._key,s,new Go(s!==null&&s.hasLocalMutations,!0),n.converter)))}function CM(n){n=Ze(n,ut);const e=Ze(n.firestore,Mt);return mb(Sn(e),n._key,{source:"server"}).then((t=>yv(e,n,t)))}function NM(n){n=Ze(n,Cn);const e=Ze(n.firestore,Mt),t=Sn(e),r=new _a(e);return Db(n._query),gb(t,n._query).then((s=>new Dr(e,r,n,s)))}function DM(n){n=Ze(n,Cn);const e=Ze(n.firestore,Mt),t=Sn(e),r=new _a(e);return X4(t,n._query).then((s=>new Dr(e,r,n,s)))}function VM(n){n=Ze(n,Cn);const e=Ze(n.firestore,Mt),t=Sn(e),r=new _a(e);return gb(t,n._query,{source:"server"}).then((s=>new Dr(e,r,n,s)))}function Z0(n,e,t){n=Ze(n,ut);const r=Ze(n.firestore,Mt),s=Dp(n.converter,e,t);return Ad(r,[Ap(ga(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,wt.none())])}function eT(n,e,t,...r){n=Ze(n,ut);const s=Ze(n.firestore,Mt),a=ga(s);let l;return l=typeof(e=xe(e))=="string"||e instanceof Zi?uv(a,"updateDoc",n._key,e,t,r):cv(a,"updateDoc",n._key,e),Ad(s,[l.toMutation(n._key,wt.exists(!0))])}function OM(n){return Ad(Ze(n.firestore,Mt),[new nc(n._key,wt.none())])}function LM(n,e){const t=Ze(n.firestore,Mt),r=Wf(n),s=Dp(n.converter,e);return Ad(t,[Ap(ga(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,wt.exists(!1))]).then((()=>r))}function jb(n,...e){n=xe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Ey(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Ey(e[r])){const f=e[r];e[r]=f.next?.bind(f),e[r+1]=f.error?.bind(f),e[r+2]=f.complete?.bind(f)}let a,l,d;if(n instanceof ut)l=Ze(n.firestore,Mt),d=ec(n._key.path),a={next:f=>{e[r]&&e[r](yv(l,n,f))},error:e[r+1],complete:e[r+2]};else{const f=Ze(n,Cn);l=Ze(f.firestore,Mt),d=f._query;const p=new _a(l);a={next:g=>{e[r]&&e[r](new Dr(l,p,f,g))},error:e[r+1],complete:e[r+2]},Db(n._query)}return(function(p,g,w,T){const N=new xp(T),A=new J_(g,N,w);return p.asyncQueue.enqueueAndForget((async()=>G_(await Wl(p),A))),()=>{N.Nu(),p.asyncQueue.enqueueAndForget((async()=>K_(await Wl(p),A)))}})(Sn(l),d,s,a)}function MM(n,e){return Z4(Sn(n=Ze(n,Mt)),Ey(e)?e:{next:e})}function Ad(n,e){return(function(r,s){const a=new fn;return r.asyncQueue.enqueueAndForget((async()=>b4(await sv(r),s,a))),a.promise})(Sn(n),e)}function yv(n,e,t){const r=t.docs.get(e._key),s=new _a(n);return new yr(n,s,e._key,r,new Go(t.hasPendingWrites,t.fromCache),e.converter)}const FM={maxAttempts:5};let jM=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ga(e)}set(e,t,r){this._verifyNotCommitted();const s=Mi(e,this._firestore),a=Dp(s.converter,t,r),l=Ap(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,r);return this._mutations.push(l.toMutation(s._key,wt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const a=Mi(e,this._firestore);let l;return l=typeof(t=xe(t))=="string"||t instanceof Zi?uv(this._dataReader,"WriteBatch.update",a._key,t,r,s):cv(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,wt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Mi(e,this._firestore);return this._mutations=this._mutations.concat(new nc(t._key,wt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Mi(n,e){if((n=xe(n)).firestore!==e)throw new J(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class UM{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ga(e)}get(e){const t=Mi(e,this._firestore),r=new AM(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return me(24041);const a=s[0];if(a.isFoundDocument())return new rd(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new rd(this._firestore,r,t._key,null,t.converter);throw me(18433,{doc:a})}))}set(e,t,r){const s=Mi(e,this._firestore),a=Dp(s.converter,t,r),l=Ap(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,l),this}update(e,t,r,...s){const a=Mi(e,this._firestore);let l;return l=typeof(t=xe(t))=="string"||t instanceof Zi?uv(this._dataReader,"Transaction.update",a._key,t,r,s):cv(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Mi(e,this._firestore);return this._transaction.delete(t._key),this}}let BM=class extends UM{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mi(e,this._firestore),r=new _a(this._firestore);return super.get(e).then((s=>new yr(this._firestore,r,t._key,s._document,new Go(!1,!1),t.converter)))}};function zM(n,e,t){n=Ze(n,Mt);const r={...FM,...t};return(function(a){if(a.maxAttempts<1)throw new J(W.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(a,l,d){const f=new fn;return a.asyncQueue.enqueueAndForget((async()=>{const p=await K4(a);new H4(a.asyncQueue,p,d,l,f).ju()})),f.promise})(Sn(n),(s=>e(new BM(n,s))),r)}function $M(){return new Sd("deleteField")}function qM(){return new iv("serverTimestamp")}function WM(...n){return new ov("arrayUnion",n)}function HM(...n){return new av("arrayRemove",n)}function GM(n){return new lv("increment",n)}(function(e,t=!0){(function(s){Zl=s})(to),$s(new _r("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new Mt(new UV(r.getProvider("auth-internal")),new $V(l,r.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new J(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gi(p.options.projectId,g)})(l,s),l);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),ir(kI,CI,e),ir(kI,CI,"esm2020")})();const KM="@firebase/firestore-compat",QM="0.4.3";function _v(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new J("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function tT(){if(typeof Uint8Array>"u")throw new J("unimplemented","Uint8Arrays are not available in this environment.")}function nT(){if(!xO())throw new J("unimplemented","Blobs are unavailable in Firestore in this environment.")}let Ub=class Ty{constructor(e){this._delegate=e}static fromBase64String(e){return nT(),new Ty(In.fromBase64String(e))}static fromUint8Array(e){return tT(),new Ty(In.fromUint8Array(e))}toBase64(){return nT(),this._delegate.toBase64()}toUint8Array(){return tT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function xy(n){return JM(n,["next","error","complete"])}function JM(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class YM{enableIndexedDbPersistence(e,t){return oM(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return aM(e._delegate)}clearIndexedDbPersistence(e){return lM(e._delegate)}}class Bb{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&vs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){nM(this._delegate,e,t,r)}enableNetwork(){return uM(this._delegate)}disableNetwork(){return dM(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,d1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return cM(this._delegate)}onSnapshotsInSync(e){return MM(this._delegate,e)}get app(){if(!this._appCompat)throw new J("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Hl(this,Eb(this._delegate,e))}catch(t){throw Pn(t,"collection()","Firestore.collection()")}}doc(e){try{return new gr(this,Wf(this._delegate,e))}catch(t){throw Pn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Rn(this,rM(this._delegate,e))}catch(t){throw Pn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return zM(this._delegate,t=>e(new zb(this,t)))}batch(){return Sn(this._delegate),new $b(new jM(this._delegate,e=>Ad(this._delegate,e)))}loadBundle(e){return hM(this._delegate,e)}namedQuery(e){return fM(this._delegate,e).then(t=>t?new Rn(this,t):null)}}class Vp extends gv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ub(new In(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return gr.forKey(t,this.firestore,null)}}function XM(n){LV(n)}class zb{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Vp(e)}get(e){const t=Ko(e);return this._delegate.get(t).then(r=>new sd(this._firestore,new yr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=Ko(e);return r?(_v("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Ko(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Ko(e);return this._delegate.delete(t),this}}class $b{constructor(e){this._delegate=e}set(e,t,r){const s=Ko(e);return r?(_v("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const a=Ko(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...s),this}delete(e){const t=Ko(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class da{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Vu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new id(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=da.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let a=s.get(t);return a||(a=new da(e,new Vp(e),t),s.set(t,a)),a}}da.INSTANCES=new WeakMap;class gr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Vp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new J("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new gr(t,new ut(t._delegate,r,new ce(e)))}static forKey(e,t,r){return new gr(t,new ut(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Hl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Hl(this.firestore,Eb(this._delegate,e))}catch(t){throw Pn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=xe(e),e instanceof ut?Ib(this._delegate,e):!1}set(e,t){t=_v("DocumentReference.set",t);try{return t?Z0(this._delegate,e,t):Z0(this._delegate,e)}catch(r){throw Pn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?eT(this._delegate,e):eT(this._delegate,e,t,...r)}catch(s){throw Pn(s,"updateDoc()","DocumentReference.update()")}}delete(){return OM(this._delegate)}onSnapshot(...e){const t=qb(e),r=Wb(e,s=>new sd(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return jb(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=kM(this._delegate):e?.source==="server"?t=CM(this._delegate):t=PM(this._delegate),t.then(r=>new sd(this.firestore,new yr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new gr(this.firestore,e?this._delegate.withConverter(da.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Pn(n,e,t){return n.message=n.message.replace(e,t),n}function qb(n){for(const e of n)if(typeof e=="object"&&!xy(e))return e;return{}}function Wb(n,e){let t;return xy(n[0])?t=n[0]:xy(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class sd{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new gr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Fb(this._delegate,e._delegate)}}class id extends sd{data(e){const t=this._delegate.data(e);return this._delegate._converter||MV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Rn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Vp(e)}where(e,t,r){try{return new Rn(this.firestore,Di(this._delegate,vM(e,t,r)))}catch(s){throw Pn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Rn(this.firestore,Di(this._delegate,wM(e,t)))}catch(r){throw Pn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Rn(this.firestore,Di(this._delegate,EM(e)))}catch(t){throw Pn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Rn(this.firestore,Di(this._delegate,IM(e)))}catch(t){throw Pn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Rn(this.firestore,Di(this._delegate,TM(...e)))}catch(t){throw Pn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Rn(this.firestore,Di(this._delegate,xM(...e)))}catch(t){throw Pn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Rn(this.firestore,Di(this._delegate,SM(...e)))}catch(t){throw Pn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Rn(this.firestore,Di(this._delegate,bM(...e)))}catch(t){throw Pn(t,"endAt()","Query.endAt()")}}isEqual(e){return Tb(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=DM(this._delegate):e?.source==="server"?t=VM(this._delegate):t=NM(this._delegate),t.then(r=>new Sy(this.firestore,new Dr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=qb(e),r=Wb(e,s=>new Sy(this.firestore,new Dr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return jb(this._delegate,t,r)}withConverter(e){return new Rn(this.firestore,e?this._delegate.withConverter(da.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class ZM{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new id(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Sy{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Rn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new id(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new ZM(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new id(this._firestore,r))})}isEqual(e){return Fb(this._delegate,e._delegate)}}class Hl extends Rn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new gr(this.firestore,e):null}doc(e){try{return e===void 0?new gr(this.firestore,Wf(this._delegate)):new gr(this.firestore,Wf(this._delegate,e))}catch(t){throw Pn(t,"doc()","CollectionReference.doc()")}}add(e){return LM(this._delegate,e).then(t=>new gr(this.firestore,t))}isEqual(e){return Ib(this._delegate,e._delegate)}withConverter(e){return new Hl(this.firestore,e?this._delegate.withConverter(da.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ko(n){return Ze(n,ut)}class vv{constructor(...e){this._delegate=new Zi(...e)}static documentId(){return new vv(vt.keyField().canonicalString())}isEqual(e){return e=xe(e),e instanceof Zi?this._delegate._internalPath.isEqual(e._internalPath):!1}}class qo{static serverTimestamp(){const e=qM();return e._methodName="FieldValue.serverTimestamp",new qo(e)}static delete(){const e=$M();return e._methodName="FieldValue.delete",new qo(e)}static arrayUnion(...e){const t=WM(...e);return t._methodName="FieldValue.arrayUnion",new qo(t)}static arrayRemove(...e){const t=HM(...e);return t._methodName="FieldValue.arrayRemove",new qo(t)}static increment(e){const t=GM(e);return t._methodName="FieldValue.increment",new qo(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const eF={Firestore:Bb,GeoPoint:Nr,Timestamp:nt,Blob:Ub,Transaction:zb,WriteBatch:$b,DocumentReference:gr,DocumentSnapshot:sd,Query:Rn,QueryDocumentSnapshot:id,QuerySnapshot:Sy,CollectionReference:Hl,FieldPath:vv,FieldValue:qo,setLogLevel:XM,CACHE_SIZE_UNLIMITED:iM};function tF(n,e){n.INTERNAL.registerComponent(new _r("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps({...eF}))}function nF(n){tF(n,(e,t)=>new Bb(e,t,new YM)),n.registerVersion(KM,QM)}nF(hn);const rF="type.googleapis.com/google.protobuf.Int64Value",sF="type.googleapis.com/google.protobuf.UInt64Value";function Hb(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Gf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Gf(e));if(typeof n=="function"||typeof n=="object")return Hb(n,e=>Gf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Gl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case rF:case sF:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Gl(e)):typeof n=="function"||typeof n=="object"?Hb(n,e=>Gl(e)):n}const Gb="functions";const rT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $n extends tn{constructor(e,t,r){super(`${Gb}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,$n.prototype)}}function iF(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Kf(n,e){let t=iF(n),r=t,s;try{const a=e&&e.error;if(a){const l=a.status;if(typeof l=="string"){if(!rT[l])return new $n("internal","internal");t=rT[l],r=l}const d=a.message;typeof d=="string"&&(r=d),s=a.details,s!==void 0&&(s=Gl(s))}}catch{}return t==="ok"?null:new $n(t,r,s)}class oF{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,gt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||s?.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const sT="us-central1",aF=/^data: (.*?)(?:\n|$)/;function lF(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new $n("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}let cF=class{constructor(e,t,r,s,a=sT,l=(...d)=>fetch(...d)){this.app=e,this.fetchImpl=l,this.emulatorOrigin=null,this.contextProvider=new oF(e,t,r,s),this.cancelAllRequests=new Promise(d=>{this.deleteService=()=>Promise.resolve(d())});try{const d=new URL(a);this.customDomain=d.origin+(d.pathname==="/"?"":d.pathname),this.region=sT}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function uF(n,e,t){const r=eo(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(My(n.emulatorOrigin+"/backends"),Fy("Functions",!0))}function dF(n,e,t){const r=s=>pF(n,e,s,t||{});return r.stream=(s,a)=>mF(n,e,s,a),r}function hF(n,e,t){const r=s=>Jb(n,e,s,t||{});return r.stream=(s,a)=>Yb(n,e,s,a||{}),r}function Kb(n){return n.emulatorOrigin&&eo(n.emulatorOrigin)?"include":void 0}async function fF(n,e,t,r,s){t["Content-Type"]="application/json";let a;try{a=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:Kb(s)})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function Qb(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function pF(n,e,t,r){const s=n._url(e);return Jb(n,s,t,r)}async function Jb(n,e,t,r){t=Gf(t);const s={data:t},a=await Qb(n,r),l=r.timeout||7e4,d=lF(l),f=await Promise.race([fF(e,s,a,n.fetchImpl,n),d.promise,n.cancelAllRequests]);if(d.cancel(),!f)throw new $n("cancelled","Firebase Functions instance was deleted.");const p=Kf(f.status,f.json);if(p)throw p;if(!f.json)throw new $n("internal","Response is not valid JSON object.");let g=f.json.data;if(typeof g>"u"&&(g=f.json.result),typeof g>"u")throw new $n("internal","Response is missing data field.");return{data:Gl(g)}}function mF(n,e,t,r){const s=n._url(e);return Yb(n,s,t,r||{})}async function Yb(n,e,t,r){t=Gf(t);const s={data:t},a=await Qb(n,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let l;try{l=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:a,signal:r?.signal,credentials:Kb(n)})}catch(T){if(T instanceof Error&&T.name==="AbortError"){const A=new $n("cancelled","Request was cancelled.");return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}const N=Kf(0,null);return{data:Promise.reject(N),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(N)}}}}}}let d,f;const p=new Promise((T,N)=>{d=T,f=N});r?.signal?.addEventListener("abort",()=>{const T=new $n("cancelled","Request was cancelled.");f(T)});const g=l.body.getReader(),w=gF(g,d,f,r?.signal);return{stream:{[Symbol.asyncIterator](){const T=w.getReader();return{async next(){const{value:N,done:A}=await T.read();return{value:N,done:A}},async return(){return await T.cancel(),{done:!0,value:void 0}}}}},data:p}}function gF(n,e,t,r){const s=(l,d)=>{const f=l.match(aF);if(!f)return;const p=f[1];try{const g=JSON.parse(p);if("result"in g){e(Gl(g.result));return}if("message"in g){d.enqueue(Gl(g.message));return}if("error"in g){const w=Kf(0,g);d.error(w),t(w);return}}catch(g){if(g instanceof $n){d.error(g),t(g);return}}},a=new TextDecoder;return new ReadableStream({start(l){let d="";return f();async function f(){if(r?.aborted){const p=new $n("cancelled","Request was cancelled");return l.error(p),t(p),Promise.resolve()}try{const{value:p,done:g}=await n.read();if(g){d.trim()&&s(d.trim(),l),l.close();return}if(r?.aborted){const T=new $n("cancelled","Request was cancelled");l.error(T),t(T),await n.cancel();return}d+=a.decode(p,{stream:!0});const w=d.split(`
`);d=w.pop()||"";for(const T of w)T.trim()&&s(T.trim(),l);return f()}catch(p){const g=p instanceof $n?p:Kf(0,null);l.error(g),t(g)}}},cancel(){return n.cancel()}})}const iT="@firebase/functions",oT="0.13.1";const yF="auth-internal",_F="app-check-internal",vF="messaging-internal";function wF(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),a=t.getProvider(yF),l=t.getProvider(vF),d=t.getProvider(_F);return new cF(s,a,l,d,r)};$s(new _r(Gb,e,"PUBLIC").setMultipleInstances(!0)),ir(iT,oT,n),ir(iT,oT,"esm2020")}function aT(n,e,t){uF(xe(n),e,t)}function EF(n,e,t){return dF(xe(n),e,t)}function IF(n,e,t){return hF(xe(n),e,t)}wF();const TF="@firebase/functions-compat",xF="0.4.1";class Xb{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return EF(this._delegate,e,t)}httpsCallableFromURL(e,t){return IF(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(t==null)throw new tn("functions","No origin provided to useFunctionsEmulator()");if(t[2]==null)throw new tn("functions","Port missing in origin provided to useFunctionsEmulator()");return aT(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return aT(this._delegate,e,t)}}const SF="us-central1",bF=(n,{instanceIdentifier:e})=>{const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("functions").getImmediate({identifier:e??SF});return new Xb(t,r)};function AF(){const n={Functions:Xb};hn.INTERNAL.registerComponent(new _r("functions-compat",bF,"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}AF();hn.registerVersion(TF,xF);const RF={apiKey:"AIzaSyDummyKeyForEmulatorOnly",projectId:"schoolbook-290b6"};hn.apps.length||hn.initializeApp(RF);const Tt=hn.firestore(),Pr=hn.auth(),Ou=hn.functions(),lT=window.location.hostname;(lT==="localhost"||lT==="127.0.0.1")&&(console.log("Using Firebase Emulators"),Tt.useEmulator("127.0.0.1",8088),Pr.useEmulator("http://127.0.0.1:9099",{disableWarnings:!0}),Ou.useEmulator("127.0.0.1",5001));const cs=Object.freeze(Object.defineProperty({__proto__:null,auth:Pr,db:Tt,firebase:hn,functions:Ou},Symbol.toStringTag,{value:"Module"})),mr={onAuthStateChanged(n){return Pr.onAuthStateChanged(n)},async signUp(n,e){return Pr.createUserWithEmailAndPassword(n,e)},async login(n,e){return Pr.signInWithEmailAndPassword(n,e)},async logout(){return Pr.signOut()},async sendVerificationLink(n){const e={url:window.location.href,handleCodeInApp:!0};return Pr.sendSignInLinkToEmail(n,e)},isSignInWithEmailLink(n){return Pr.isSignInWithEmailLink(n)},async signInWithLink(n,e){return Pr.signInWithEmailLink(n,e)},async updateUserPassword(n){if(!Pr.currentUser)throw new Error("");return Pr.currentUser.updatePassword(n)},async completeProfile(n){return Ou.httpsCallable("completeProfile")(n)},onProfileSnapshot(n,e){return Tt.collection("users").doc(n).onSnapshot(e)},async getBindingCode(){return Ou.httpsCallable("generateBindingCode")()},async unbindLineAccount(){return Ou.httpsCallable("unbindLineAccount")()}};function Zb(n,e){return function(){return n.apply(e,arguments)}}const{toString:PF}=Object.prototype,{getPrototypeOf:wv}=Object,{iterator:Op,toStringTag:eA}=Symbol,Lp=(n=>e=>{const t=PF.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Or=n=>(n=n.toLowerCase(),e=>Lp(e)===n),Mp=n=>e=>typeof e===n,{isArray:ac}=Array,Kl=Mp("undefined");function Rd(n){return n!==null&&!Kl(n)&&n.constructor!==null&&!Kl(n.constructor)&&qn(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const tA=Or("ArrayBuffer");function kF(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&tA(n.buffer),e}const CF=Mp("string"),qn=Mp("function"),nA=Mp("number"),Pd=n=>n!==null&&typeof n=="object",NF=n=>n===!0||n===!1,_f=n=>{if(Lp(n)!=="object")return!1;const e=wv(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(eA in n)&&!(Op in n)},DF=n=>{if(!Pd(n)||Rd(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},VF=Or("Date"),OF=Or("File"),LF=Or("Blob"),MF=Or("FileList"),FF=n=>Pd(n)&&qn(n.pipe),jF=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||qn(n.append)&&((e=Lp(n))==="formdata"||e==="object"&&qn(n.toString)&&n.toString()==="[object FormData]"))},UF=Or("URLSearchParams"),[BF,zF,$F,qF]=["ReadableStream","Request","Response","Headers"].map(Or),WF=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kd(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),ac(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{if(Rd(n))return;const a=t?Object.getOwnPropertyNames(n):Object.keys(n),l=a.length;let d;for(r=0;r<l;r++)d=a[r],e.call(null,n[d],d,n)}}function rA(n,e){if(Rd(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Qo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,sA=n=>!Kl(n)&&n!==Qo;function by(){const{caseless:n,skipUndefined:e}=sA(this)&&this||{},t={},r=(s,a)=>{const l=n&&rA(t,a)||a;_f(t[l])&&_f(s)?t[l]=by(t[l],s):_f(s)?t[l]=by({},s):ac(s)?t[l]=s.slice():(!e||!Kl(s))&&(t[l]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&kd(arguments[s],r);return t}const HF=(n,e,t,{allOwnKeys:r}={})=>(kd(e,(s,a)=>{t&&qn(s)?n[a]=Zb(s,t):n[a]=s},{allOwnKeys:r}),n),GF=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),KF=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},QF=(n,e,t,r)=>{let s,a,l;const d={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),a=s.length;a-- >0;)l=s[a],(!r||r(l,n,e))&&!d[l]&&(e[l]=n[l],d[l]=!0);n=t!==!1&&wv(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},JF=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},YF=n=>{if(!n)return null;if(ac(n))return n;let e=n.length;if(!nA(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},XF=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&wv(Uint8Array)),ZF=(n,e)=>{const r=(n&&n[Op]).call(n);let s;for(;(s=r.next())&&!s.done;){const a=s.value;e.call(n,a[0],a[1])}},ej=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},tj=Or("HTMLFormElement"),nj=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),cT=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),rj=Or("RegExp"),iA=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};kd(t,(s,a)=>{let l;(l=e(s,a,n))!==!1&&(r[a]=l||s)}),Object.defineProperties(n,r)},sj=n=>{iA(n,(e,t)=>{if(qn(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(qn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},ij=(n,e)=>{const t={},r=s=>{s.forEach(a=>{t[a]=!0})};return ac(n)?r(n):r(String(n).split(e)),t},oj=()=>{},aj=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function lj(n){return!!(n&&qn(n.append)&&n[eA]==="FormData"&&n[Op])}const cj=n=>{const e=new Array(10),t=(r,s)=>{if(Pd(r)){if(e.indexOf(r)>=0)return;if(Rd(r))return r;if(!("toJSON"in r)){e[s]=r;const a=ac(r)?[]:{};return kd(r,(l,d)=>{const f=t(l,s+1);!Kl(f)&&(a[d]=f)}),e[s]=void 0,a}}return r};return t(n,0)},uj=Or("AsyncFunction"),dj=n=>n&&(Pd(n)||qn(n))&&qn(n.then)&&qn(n.catch),oA=((n,e)=>n?setImmediate:e?((t,r)=>(Qo.addEventListener("message",({source:s,data:a})=>{s===Qo&&a===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Qo.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",qn(Qo.postMessage)),hj=typeof queueMicrotask<"u"?queueMicrotask.bind(Qo):typeof process<"u"&&process.nextTick||oA,fj=n=>n!=null&&qn(n[Op]),G={isArray:ac,isArrayBuffer:tA,isBuffer:Rd,isFormData:jF,isArrayBufferView:kF,isString:CF,isNumber:nA,isBoolean:NF,isObject:Pd,isPlainObject:_f,isEmptyObject:DF,isReadableStream:BF,isRequest:zF,isResponse:$F,isHeaders:qF,isUndefined:Kl,isDate:VF,isFile:OF,isBlob:LF,isRegExp:rj,isFunction:qn,isStream:FF,isURLSearchParams:UF,isTypedArray:XF,isFileList:MF,forEach:kd,merge:by,extend:HF,trim:WF,stripBOM:GF,inherits:KF,toFlatObject:QF,kindOf:Lp,kindOfTest:Or,endsWith:JF,toArray:YF,forEachEntry:ZF,matchAll:ej,isHTMLForm:tj,hasOwnProperty:cT,hasOwnProp:cT,reduceDescriptors:iA,freezeMethods:sj,toObjectSet:ij,toCamelCase:nj,noop:oj,toFiniteNumber:aj,findKey:rA,global:Qo,isContextDefined:sA,isSpecCompliantForm:lj,toJSONObject:cj,isAsyncFn:uj,isThenable:dj,setImmediate:oA,asap:hj,isIterable:fj};function Oe(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}G.inherits(Oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}});const aA=Oe.prototype,lA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{lA[n]={value:n}});Object.defineProperties(Oe,lA);Object.defineProperty(aA,"isAxiosError",{value:!0});Oe.from=(n,e,t,r,s,a)=>{const l=Object.create(aA);G.toFlatObject(n,l,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const d=n&&n.message?n.message:"Error",f=e==null&&n?n.code:e;return Oe.call(l,d,f,t,r,s),n&&l.cause==null&&Object.defineProperty(l,"cause",{value:n,configurable:!0}),l.name=n&&n.name||"Error",a&&Object.assign(l,a),l};const pj=null;function Ay(n){return G.isPlainObject(n)||G.isArray(n)}function cA(n){return G.endsWith(n,"[]")?n.slice(0,-2):n}function uT(n,e,t){return n?n.concat(e).map(function(s,a){return s=cA(s),!t&&a?"["+s+"]":s}).join(t?".":""):e}function mj(n){return G.isArray(n)&&!n.some(Ay)}const gj=G.toFlatObject(G,{},null,function(e){return/^is[A-Z]/.test(e)});function Fp(n,e,t){if(!G.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=G.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(L,V){return!G.isUndefined(V[L])});const r=t.metaTokens,s=t.visitor||g,a=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(e);if(!G.isFunction(s))throw new TypeError("visitor must be a function");function p(A){if(A===null)return"";if(G.isDate(A))return A.toISOString();if(G.isBoolean(A))return A.toString();if(!f&&G.isBlob(A))throw new Oe("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(A)||G.isTypedArray(A)?f&&typeof Blob=="function"?new Blob([A]):Buffer.from(A):A}function g(A,L,V){let se=A;if(A&&!V&&typeof A=="object"){if(G.endsWith(L,"{}"))L=r?L:L.slice(0,-2),A=JSON.stringify(A);else if(G.isArray(A)&&mj(A)||(G.isFileList(A)||G.endsWith(L,"[]"))&&(se=G.toArray(A)))return L=cA(L),se.forEach(function(Q,pe){!(G.isUndefined(Q)||Q===null)&&e.append(l===!0?uT([L],pe,a):l===null?L:L+"[]",p(Q))}),!1}return Ay(A)?!0:(e.append(uT(V,L,a),p(A)),!1)}const w=[],T=Object.assign(gj,{defaultVisitor:g,convertValue:p,isVisitable:Ay});function N(A,L){if(!G.isUndefined(A)){if(w.indexOf(A)!==-1)throw Error("Circular reference detected in "+L.join("."));w.push(A),G.forEach(A,function(se,ie){(!(G.isUndefined(se)||se===null)&&s.call(e,se,G.isString(ie)?ie.trim():ie,L,T))===!0&&N(se,L?L.concat(ie):[ie])}),w.pop()}}if(!G.isObject(n))throw new TypeError("data must be an object");return N(n),e}function dT(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Ev(n,e){this._pairs=[],n&&Fp(n,this,e)}const uA=Ev.prototype;uA.append=function(e,t){this._pairs.push([e,t])};uA.toString=function(e){const t=e?function(r){return e.call(this,r,dT)}:dT;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function yj(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function dA(n,e,t){if(!e)return n;const r=t&&t.encode||yj;G.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let a;if(s?a=s(e,t):a=G.isURLSearchParams(e)?e.toString():new Ev(e,t).toString(r),a){const l=n.indexOf("#");l!==-1&&(n=n.slice(0,l)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class hT{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){G.forEach(this.handlers,function(r){r!==null&&e(r)})}}const hA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},_j=typeof URLSearchParams<"u"?URLSearchParams:Ev,vj=typeof FormData<"u"?FormData:null,wj=typeof Blob<"u"?Blob:null,Ej={isBrowser:!0,classes:{URLSearchParams:_j,FormData:vj,Blob:wj},protocols:["http","https","file","blob","url","data"]},Iv=typeof window<"u"&&typeof document<"u",Ry=typeof navigator=="object"&&navigator||void 0,Ij=Iv&&(!Ry||["ReactNative","NativeScript","NS"].indexOf(Ry.product)<0),Tj=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",xj=Iv&&window.location.href||"http://localhost",Sj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Iv,hasStandardBrowserEnv:Ij,hasStandardBrowserWebWorkerEnv:Tj,navigator:Ry,origin:xj},Symbol.toStringTag,{value:"Module"})),Tn={...Sj,...Ej};function bj(n,e){return Fp(n,new Tn.classes.URLSearchParams,{visitor:function(t,r,s,a){return Tn.isNode&&G.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function Aj(n){return G.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Rj(n){const e={},t=Object.keys(n);let r;const s=t.length;let a;for(r=0;r<s;r++)a=t[r],e[a]=n[a];return e}function fA(n){function e(t,r,s,a){let l=t[a++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=a>=t.length;return l=!l&&G.isArray(s)?s.length:l,f?(G.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!d):((!s[l]||!G.isObject(s[l]))&&(s[l]=[]),e(t,r,s[l],a)&&G.isArray(s[l])&&(s[l]=Rj(s[l])),!d)}if(G.isFormData(n)&&G.isFunction(n.entries)){const t={};return G.forEachEntry(n,(r,s)=>{e(Aj(r),s,t,0)}),t}return null}function Pj(n,e,t){if(G.isString(n))try{return(e||JSON.parse)(n),G.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Cd={transitional:hA,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=G.isObject(e);if(a&&G.isHTMLForm(e)&&(e=new FormData(e)),G.isFormData(e))return s?JSON.stringify(fA(e)):e;if(G.isArrayBuffer(e)||G.isBuffer(e)||G.isStream(e)||G.isFile(e)||G.isBlob(e)||G.isReadableStream(e))return e;if(G.isArrayBufferView(e))return e.buffer;if(G.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bj(e,this.formSerializer).toString();if((d=G.isFileList(e))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Fp(d?{"files[]":e}:e,f&&new f,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),Pj(e)):e}],transformResponse:[function(e){const t=this.transitional||Cd.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(G.isResponse(e)||G.isReadableStream(e))return e;if(e&&G.isString(e)&&(r&&!this.responseType||s)){const l=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?Oe.from(d,Oe.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Tn.classes.FormData,Blob:Tn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],n=>{Cd.headers[n]={}});const kj=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Cj=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(l){s=l.indexOf(":"),t=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!t||e[t]&&kj[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},fT=Symbol("internals");function du(n){return n&&String(n).trim().toLowerCase()}function vf(n){return n===!1||n==null?n:G.isArray(n)?n.map(vf):String(n)}function Nj(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Dj=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Vg(n,e,t,r,s){if(G.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!G.isString(e)){if(G.isString(r))return e.indexOf(r)!==-1;if(G.isRegExp(r))return r.test(e)}}function Vj(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Oj(n,e){const t=G.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,a,l){return this[r].call(this,e,s,a,l)},configurable:!0})})}let Wn=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function a(d,f,p){const g=du(f);if(!g)throw new Error("header name must be a non-empty string");const w=G.findKey(s,g);(!w||s[w]===void 0||p===!0||p===void 0&&s[w]!==!1)&&(s[w||f]=vf(d))}const l=(d,f)=>G.forEach(d,(p,g)=>a(p,g,f));if(G.isPlainObject(e)||e instanceof this.constructor)l(e,t);else if(G.isString(e)&&(e=e.trim())&&!Dj(e))l(Cj(e),t);else if(G.isObject(e)&&G.isIterable(e)){let d={},f,p;for(const g of e){if(!G.isArray(g))throw TypeError("Object iterator must return a key-value pair");d[p=g[0]]=(f=d[p])?G.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}l(d,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=du(e),e){const r=G.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return Nj(s);if(G.isFunction(t))return t.call(this,s,r);if(G.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=du(e),e){const r=G.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Vg(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function a(l){if(l=du(l),l){const d=G.findKey(r,l);d&&(!t||Vg(r,r[d],d,t))&&(delete r[d],s=!0)}}return G.isArray(e)?e.forEach(a):a(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const a=t[r];(!e||Vg(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const t=this,r={};return G.forEach(this,(s,a)=>{const l=G.findKey(r,a);if(l){t[l]=vf(s),delete t[a];return}const d=e?Vj(a):String(a).trim();d!==a&&delete t[a],t[d]=vf(s),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return G.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&G.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[fT]=this[fT]={accessors:{}}).accessors,s=this.prototype;function a(l){const d=du(l);r[d]||(Oj(s,l),r[d]=!0)}return G.isArray(e)?e.forEach(a):a(e),this}};Wn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.reduceDescriptors(Wn.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});G.freezeMethods(Wn);function Og(n,e){const t=this||Cd,r=e||t,s=Wn.from(r.headers);let a=r.data;return G.forEach(n,function(d){a=d.call(t,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function pA(n){return!!(n&&n.__CANCEL__)}function lc(n,e,t){Oe.call(this,n??"canceled",Oe.ERR_CANCELED,e,t),this.name="CanceledError"}G.inherits(lc,Oe,{__CANCEL__:!0});function mA(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Oe("Request failed with status code "+t.status,[Oe.ERR_BAD_REQUEST,Oe.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Lj(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Mj(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,a=0,l;return e=e!==void 0?e:1e3,function(f){const p=Date.now(),g=r[a];l||(l=p),t[s]=f,r[s]=p;let w=a,T=0;for(;w!==s;)T+=t[w++],w=w%n;if(s=(s+1)%n,s===a&&(a=(a+1)%n),p-l<e)return;const N=g&&p-g;return N?Math.round(T*1e3/N):void 0}}function Fj(n,e){let t=0,r=1e3/e,s,a;const l=(p,g=Date.now())=>{t=g,s=null,a&&(clearTimeout(a),a=null),n(...p)};return[(...p)=>{const g=Date.now(),w=g-t;w>=r?l(p,g):(s=p,a||(a=setTimeout(()=>{a=null,l(s)},r-w)))},()=>s&&l(s)]}const Qf=(n,e,t=3)=>{let r=0;const s=Mj(50,250);return Fj(a=>{const l=a.loaded,d=a.lengthComputable?a.total:void 0,f=l-r,p=s(f),g=l<=d;r=l;const w={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:p||void 0,estimated:p&&d&&g?(d-l)/p:void 0,event:a,lengthComputable:d!=null,[e?"download":"upload"]:!0};n(w)},t)},pT=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},mT=n=>(...e)=>G.asap(()=>n(...e)),jj=Tn.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Tn.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Tn.origin),Tn.navigator&&/(msie|trident)/i.test(Tn.navigator.userAgent)):()=>!0,Uj=Tn.hasStandardBrowserEnv?{write(n,e,t,r,s,a,l){if(typeof document>"u")return;const d=[`${n}=${encodeURIComponent(e)}`];G.isNumber(t)&&d.push(`expires=${new Date(t).toUTCString()}`),G.isString(r)&&d.push(`path=${r}`),G.isString(s)&&d.push(`domain=${s}`),a===!0&&d.push("secure"),G.isString(l)&&d.push(`SameSite=${l}`),document.cookie=d.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Bj(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function zj(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function gA(n,e,t){let r=!Bj(e);return n&&(r||t==!1)?zj(n,e):e}const gT=n=>n instanceof Wn?{...n}:n;function ha(n,e){e=e||{};const t={};function r(p,g,w,T){return G.isPlainObject(p)&&G.isPlainObject(g)?G.merge.call({caseless:T},p,g):G.isPlainObject(g)?G.merge({},g):G.isArray(g)?g.slice():g}function s(p,g,w,T){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p,w,T)}else return r(p,g,w,T)}function a(p,g){if(!G.isUndefined(g))return r(void 0,g)}function l(p,g){if(G.isUndefined(g)){if(!G.isUndefined(p))return r(void 0,p)}else return r(void 0,g)}function d(p,g,w){if(w in e)return r(p,g);if(w in n)return r(void 0,p)}const f={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(p,g,w)=>s(gT(p),gT(g),w,!0)};return G.forEach(Object.keys({...n,...e}),function(g){const w=f[g]||s,T=w(n[g],e[g],g);G.isUndefined(T)&&w!==d||(t[g]=T)}),t}const yA=n=>{const e=ha({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:l,auth:d}=e;if(e.headers=l=Wn.from(l),e.url=dA(gA(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),G.isFormData(t)){if(Tn.hasStandardBrowserEnv||Tn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(G.isFunction(t.getHeaders)){const f=t.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,w])=>{p.includes(g.toLowerCase())&&l.set(g,w)})}}if(Tn.hasStandardBrowserEnv&&(r&&G.isFunction(r)&&(r=r(e)),r||r!==!1&&jj(e.url))){const f=s&&a&&Uj.read(a);f&&l.set(s,f)}return e},$j=typeof XMLHttpRequest<"u",qj=$j&&function(n){return new Promise(function(t,r){const s=yA(n);let a=s.data;const l=Wn.from(s.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:p}=s,g,w,T,N,A;function L(){N&&N(),A&&A(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let V=new XMLHttpRequest;V.open(s.method.toUpperCase(),s.url,!0),V.timeout=s.timeout;function se(){if(!V)return;const Q=Wn.from("getAllResponseHeaders"in V&&V.getAllResponseHeaders()),te={data:!d||d==="text"||d==="json"?V.responseText:V.response,status:V.status,statusText:V.statusText,headers:Q,config:n,request:V};mA(function(b){t(b),L()},function(b){r(b),L()},te),V=null}"onloadend"in V?V.onloadend=se:V.onreadystatechange=function(){!V||V.readyState!==4||V.status===0&&!(V.responseURL&&V.responseURL.indexOf("file:")===0)||setTimeout(se)},V.onabort=function(){V&&(r(new Oe("Request aborted",Oe.ECONNABORTED,n,V)),V=null)},V.onerror=function(pe){const te=pe&&pe.message?pe.message:"Network Error",ae=new Oe(te,Oe.ERR_NETWORK,n,V);ae.event=pe||null,r(ae),V=null},V.ontimeout=function(){let pe=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const te=s.transitional||hA;s.timeoutErrorMessage&&(pe=s.timeoutErrorMessage),r(new Oe(pe,te.clarifyTimeoutError?Oe.ETIMEDOUT:Oe.ECONNABORTED,n,V)),V=null},a===void 0&&l.setContentType(null),"setRequestHeader"in V&&G.forEach(l.toJSON(),function(pe,te){V.setRequestHeader(te,pe)}),G.isUndefined(s.withCredentials)||(V.withCredentials=!!s.withCredentials),d&&d!=="json"&&(V.responseType=s.responseType),p&&([T,A]=Qf(p,!0),V.addEventListener("progress",T)),f&&V.upload&&([w,N]=Qf(f),V.upload.addEventListener("progress",w),V.upload.addEventListener("loadend",N)),(s.cancelToken||s.signal)&&(g=Q=>{V&&(r(!Q||Q.type?new lc(null,n,V):Q),V.abort(),V=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const ie=Lj(s.url);if(ie&&Tn.protocols.indexOf(ie)===-1){r(new Oe("Unsupported protocol "+ie+":",Oe.ERR_BAD_REQUEST,n));return}V.send(a||null)})},Wj=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const a=function(p){if(!s){s=!0,d();const g=p instanceof Error?p:this.reason;r.abort(g instanceof Oe?g:new lc(g instanceof Error?g.message:g))}};let l=e&&setTimeout(()=>{l=null,a(new Oe(`timeout ${e} of ms exceeded`,Oe.ETIMEDOUT))},e);const d=()=>{n&&(l&&clearTimeout(l),l=null,n.forEach(p=>{p.unsubscribe?p.unsubscribe(a):p.removeEventListener("abort",a)}),n=null)};n.forEach(p=>p.addEventListener("abort",a));const{signal:f}=r;return f.unsubscribe=()=>G.asap(d),f}},Hj=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},Gj=async function*(n,e){for await(const t of Kj(n))yield*Hj(t,e)},Kj=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},yT=(n,e,t,r)=>{const s=Gj(n,e);let a=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await s.next();if(p){d(),f.close();return}let w=g.byteLength;if(t){let T=a+=w;t(T)}f.enqueue(new Uint8Array(g))}catch(p){throw d(p),p}},cancel(f){return d(f),s.return()}},{highWaterMark:2})},_T=64*1024,{isFunction:tf}=G,Qj=(({Request:n,Response:e})=>({Request:n,Response:e}))(G.global),{ReadableStream:vT,TextEncoder:wT}=G.global,ET=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Jj=n=>{n=G.merge.call({skipUndefined:!0},Qj,n);const{fetch:e,Request:t,Response:r}=n,s=e?tf(e):typeof fetch=="function",a=tf(t),l=tf(r);if(!s)return!1;const d=s&&tf(vT),f=s&&(typeof wT=="function"?(A=>L=>A.encode(L))(new wT):async A=>new Uint8Array(await new t(A).arrayBuffer())),p=a&&d&&ET(()=>{let A=!1;const L=new t(Tn.origin,{body:new vT,method:"POST",get duplex(){return A=!0,"half"}}).headers.has("Content-Type");return A&&!L}),g=l&&d&&ET(()=>G.isReadableStream(new r("").body)),w={stream:g&&(A=>A.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(A=>{!w[A]&&(w[A]=(L,V)=>{let se=L&&L[A];if(se)return se.call(L);throw new Oe(`Response type '${A}' is not supported`,Oe.ERR_NOT_SUPPORT,V)})});const T=async A=>{if(A==null)return 0;if(G.isBlob(A))return A.size;if(G.isSpecCompliantForm(A))return(await new t(Tn.origin,{method:"POST",body:A}).arrayBuffer()).byteLength;if(G.isArrayBufferView(A)||G.isArrayBuffer(A))return A.byteLength;if(G.isURLSearchParams(A)&&(A=A+""),G.isString(A))return(await f(A)).byteLength},N=async(A,L)=>{const V=G.toFiniteNumber(A.getContentLength());return V??T(L)};return async A=>{let{url:L,method:V,data:se,signal:ie,cancelToken:Q,timeout:pe,onDownloadProgress:te,onUploadProgress:ae,responseType:b,headers:S,withCredentials:k="same-origin",fetchOptions:D}=yA(A),R=e||fetch;b=b?(b+"").toLowerCase():"text";let M=Wj([ie,Q&&Q.toAbortSignal()],pe),P=null;const Ce=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let tt;try{if(ae&&p&&V!=="get"&&V!=="head"&&(tt=await N(S,se))!==0){let j=new t(L,{method:"POST",body:se,duplex:"half"}),K;if(G.isFormData(se)&&(K=j.headers.get("content-type"))&&S.setContentType(K),j.body){const[Re,ke]=pT(tt,Qf(mT(ae)));se=yT(j.body,_T,Re,ke)}}G.isString(k)||(k=k?"include":"omit");const $e=a&&"credentials"in t.prototype,ue={...D,signal:M,method:V.toUpperCase(),headers:S.normalize().toJSON(),body:se,duplex:"half",credentials:$e?k:void 0};P=a&&new t(L,ue);let Y=await(a?R(P,D):R(L,ue));const ve=g&&(b==="stream"||b==="response");if(g&&(te||ve&&Ce)){const j={};["status","statusText","headers"].forEach(Me=>{j[Me]=Y[Me]});const K=G.toFiniteNumber(Y.headers.get("content-length")),[Re,ke]=te&&pT(K,Qf(mT(te),!0))||[];Y=new r(yT(Y.body,_T,Re,()=>{ke&&ke(),Ce&&Ce()}),j)}b=b||"text";let de=await w[G.findKey(w,b)||"text"](Y,A);return!ve&&Ce&&Ce(),await new Promise((j,K)=>{mA(j,K,{data:de,headers:Wn.from(Y.headers),status:Y.status,statusText:Y.statusText,config:A,request:P})})}catch($e){throw Ce&&Ce(),$e&&$e.name==="TypeError"&&/Load failed|fetch/i.test($e.message)?Object.assign(new Oe("Network Error",Oe.ERR_NETWORK,A,P),{cause:$e.cause||$e}):Oe.from($e,$e&&$e.code,A,P)}}},Yj=new Map,_A=n=>{let e=n&&n.env||{};const{fetch:t,Request:r,Response:s}=e,a=[r,s,t];let l=a.length,d=l,f,p,g=Yj;for(;d--;)f=a[d],p=g.get(f),p===void 0&&g.set(f,p=d?new Map:Jj(e)),g=p;return p};_A();const Tv={http:pj,xhr:qj,fetch:{get:_A}};G.forEach(Tv,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const IT=n=>`- ${n}`,Xj=n=>G.isFunction(n)||n===null||n===!1;function Zj(n,e){n=G.isArray(n)?n:[n];const{length:t}=n;let r,s;const a={};for(let l=0;l<t;l++){r=n[l];let d;if(s=r,!Xj(r)&&(s=Tv[(d=String(r)).toLowerCase()],s===void 0))throw new Oe(`Unknown adapter '${d}'`);if(s&&(G.isFunction(s)||(s=s.get(e))))break;a[d||"#"+l]=s}if(!s){const l=Object.entries(a).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let d=t?l.length>1?`since :
`+l.map(IT).join(`
`):" "+IT(l[0]):"as no adapter specified";throw new Oe("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const vA={getAdapter:Zj,adapters:Tv};function Lg(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new lc(null,n)}function TT(n){return Lg(n),n.headers=Wn.from(n.headers),n.data=Og.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),vA.getAdapter(n.adapter||Cd.adapter,n)(n).then(function(r){return Lg(n),r.data=Og.call(n,n.transformResponse,r),r.headers=Wn.from(r.headers),r},function(r){return pA(r)||(Lg(n),r&&r.response&&(r.response.data=Og.call(n,n.transformResponse,r.response),r.response.headers=Wn.from(r.response.headers))),Promise.reject(r)})}const wA="1.13.2",jp={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{jp[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const xT={};jp.transitional=function(e,t,r){function s(a,l){return"[Axios v"+wA+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,d)=>{if(e===!1)throw new Oe(s(l," has been removed"+(t?" in "+t:"")),Oe.ERR_DEPRECATED);return t&&!xT[l]&&(xT[l]=!0,console.warn(s(l," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,l,d):!0}};jp.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function e5(n,e,t){if(typeof n!="object")throw new Oe("options must be an object",Oe.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const a=r[s],l=e[a];if(l){const d=n[a],f=d===void 0||l(d,a,n);if(f!==!0)throw new Oe("option "+a+" must be "+f,Oe.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Oe("Unknown option "+a,Oe.ERR_BAD_OPTION)}}const wf={assertOptions:e5,validators:jp},ts=wf.validators;let Zo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new hT,response:new hT}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ha(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&wf.assertOptions(r,{silentJSONParsing:ts.transitional(ts.boolean),forcedJSONParsing:ts.transitional(ts.boolean),clarifyTimeoutError:ts.transitional(ts.boolean)},!1),s!=null&&(G.isFunction(s)?t.paramsSerializer={serialize:s}:wf.assertOptions(s,{encode:ts.function,serialize:ts.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),wf.assertOptions(t,{baseUrl:ts.spelling("baseURL"),withXsrfToken:ts.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=a&&G.merge(a.common,a[t.method]);a&&G.forEach(["delete","get","head","post","put","patch","common"],A=>{delete a[A]}),t.headers=Wn.concat(l,a);const d=[];let f=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(t)===!1||(f=f&&L.synchronous,d.unshift(L.fulfilled,L.rejected))});const p=[];this.interceptors.response.forEach(function(L){p.push(L.fulfilled,L.rejected)});let g,w=0,T;if(!f){const A=[TT.bind(this),void 0];for(A.unshift(...d),A.push(...p),T=A.length,g=Promise.resolve(t);w<T;)g=g.then(A[w++],A[w++]);return g}T=d.length;let N=t;for(;w<T;){const A=d[w++],L=d[w++];try{N=A(N)}catch(V){L.call(this,V);break}}try{g=TT.call(this,N)}catch(A){return Promise.reject(A)}for(w=0,T=p.length;w<T;)g=g.then(p[w++],p[w++]);return g}getUri(e){e=ha(this.defaults,e);const t=gA(e.baseURL,e.url,e.allowAbsoluteUrls);return dA(t,e.params,e.paramsSerializer)}};G.forEach(["delete","get","head","options"],function(e){Zo.prototype[e]=function(t,r){return this.request(ha(r||{},{method:e,url:t,data:(r||{}).data}))}});G.forEach(["post","put","patch"],function(e){function t(r){return function(a,l,d){return this.request(ha(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Zo.prototype[e]=t(),Zo.prototype[e+"Form"]=t(!0)});let t5=class EA{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(s=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](s);r._listeners=null}),this.promise.then=s=>{let a;const l=new Promise(d=>{r.subscribe(d),a=d}).then(s);return l.cancel=function(){r.unsubscribe(a)},l},e(function(a,l,d){r.reason||(r.reason=new lc(a,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new EA(function(s){e=s}),cancel:e}}};function n5(n){return function(t){return n.apply(null,t)}}function r5(n){return G.isObject(n)&&n.isAxiosError===!0}const Py={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Py).forEach(([n,e])=>{Py[e]=n});function IA(n){const e=new Zo(n),t=Zb(Zo.prototype.request,e);return G.extend(t,Zo.prototype,e,{allOwnKeys:!0}),G.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return IA(ha(n,s))},t}const Ft=IA(Cd);Ft.Axios=Zo;Ft.CanceledError=lc;Ft.CancelToken=t5;Ft.isCancel=pA;Ft.VERSION=wA;Ft.toFormData=Fp;Ft.AxiosError=Oe;Ft.Cancel=Ft.CanceledError;Ft.all=function(e){return Promise.all(e)};Ft.spread=n5;Ft.isAxiosError=r5;Ft.mergeConfig=ha;Ft.AxiosHeaders=Wn;Ft.formToJSON=n=>fA(G.isHTMLForm(n)?new FormData(n):n);Ft.getAdapter=vA.getAdapter;Ft.HttpStatusCode=Py;Ft.default=Ft;const{Axios:N5,AxiosError:D5,CanceledError:V5,isCancel:O5,CancelToken:L5,VERSION:M5,all:F5,Cancel:j5,isAxiosError:U5,spread:B5,toFormData:z5,AxiosHeaders:$5,HttpStatusCode:q5,formToJSON:W5,getAdapter:H5,mergeConfig:G5}=Ft,Gt={onBooksSnapshot(n,e){return Tt.collection("books").orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));n(r)},t=>{console.error("Books snapshot error:",t),e&&e(t)})},getMyBooks(n,e){return Tt.collection("books").where("sellerId","==",n).orderBy("timestamp","desc").onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async createBook(n){return Tt.collection("books").add({...n,status:"Available",views:0})},async incrementBookView(n){return Tt.collection("books").doc(n).update({views:hn.firestore.FieldValue.increment(1)})},async deleteBook(n){const{functions:e}=await ss(async()=>{const{functions:r}=await Promise.resolve().then(()=>cs);return{functions:r}},void 0);return e.httpsCallable("deleteBook")({bookId:n})},async reserveBook(n,e,t,r){try{return(await Ft.post("https://us-central1-schoolbook-290b6.cloudfunctions.net/handleBookTransaction",{bookId:n,buyerId:e,agreedPrice:Number(t),meetingTime:r})).data}catch(s){throw s}},async startTransaction(n,e,t){if(!e)return alert("");if(e.uid===n.sellerId)return alert("");try{const r=Tt.collection("transactions"),a=await r.where("bookId","==",n.id).where("buyerId","==",e.uid).get();if(!a.empty)t(a.docs[0].id);else{const l=await r.add({bookId:n.id,bookTitle:n.title,sellerId:n.sellerId,buyerId:e.uid,price:n.price,agreedPrice:n.price,status:"Pending",timestamp:new Date});await this.addNotification({userId:n.sellerId,content:`${n.title}~`,type:"inquiry"}),t(l.id)}}catch(r){console.error(r),alert(": "+r.message)}},async confirmTransactionTime(n){const{functions:e}=await ss(async()=>{const{functions:r}=await Promise.resolve().then(()=>cs);return{functions:r}},void 0);return e.httpsCallable("confirmTransactionTime")({transactionId:n})},getUserTransactions(n,e){return Tt.collection("transactions").where("buyerId","==",n).onSnapshot(e)},getSellerTransactions(n,e){return Tt.collection("transactions").where("sellerId","==",n).onSnapshot(e)},async updateTransactionStatus(n,e){const{functions:t}=await ss(async()=>{const{functions:s}=await Promise.resolve().then(()=>cs);return{functions:s}},void 0);return t.httpsCallable("updateTransactionStatus")({transactionId:n,newStatus:e})},async requestReschedule(n,e,t){const{functions:r}=await ss(async()=>{const{functions:a}=await Promise.resolve().then(()=>cs);return{functions:a}},void 0);return r.httpsCallable("requestReschedule")({transactionId:n,newTime:e,reason:t})},async respondToReschedule(n,e){const{functions:t}=await ss(async()=>{const{functions:s}=await Promise.resolve().then(()=>cs);return{functions:s}},void 0);return t.httpsCallable("respondToReschedule")({transactionId:n,response:e})},onWishesSnapshot(n){return Tt.collection("wishes").orderBy("timestamp","desc").onSnapshot(e=>{const t=e.docs.map(r=>({id:r.id,...r.data()}));n(t)})},async addWish({content:n,user:e,avatarId:t,image:r}){return Tt.collection("wishes").add({uid:hn.auth().currentUser?.uid||"anonymous",user:e||"",avatarId:t||"default",content:n,image:r||null,timestamp:new Date})},async deleteWish(n){return Tt.collection("wishes").doc(n).delete()},async addBook(n){return Tt.collection("books").add({...n,status:"Available",timestamp:new Date})},async deleteTransaction(n){return Tt.collection("transactions").doc(n).delete()},async markAsRead(n,e){return Tt.collection("transactions").doc(n).update({unreadBy:hn.firestore.FieldValue.arrayRemove(e)})},subscribeToNotifications(n,e){return Tt.collection("notifications").where("userId","==",n).orderBy("timestamp","desc").limit(20).onSnapshot(t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));e(r)})},async markNotificationAsRead(n){return Tt.collection("notifications").doc(n).update({isRead:!0})},async markAllNotificationsAsRead(n){const e=Tt.batch(),t=await Tt.collection("notifications").where("userId","==",n).where("isRead","==",!1).get();if(!t.empty)return t.forEach(r=>{e.update(r.ref,{isRead:!0})}),e.commit()},async addNotification({userId:n,content:e,type:t="system"}){return Tt.collection("notifications").add({userId:n,content:e,type:t,isRead:!1,timestamp:new Date})},recordCheckIn(){localStorage.setItem("lastCheckIn",new Date().toDateString())},hasCheckedInToday(){return localStorage.getItem("lastCheckIn")===new Date().toDateString()}},ST={async sendMessage(n,e,t,r,s=null,a=null){if(!(!r?.trim()&&!s))try{const l=Tt.collection("transactions").doc(n),d=l.collection("messages"),f=await l.get();if(f.exists){const p=f.data(),g=e===p.buyerId?p.sellerId:p.buyerId;await d.add({senderId:e,senderName:t,content:r?.trim()||"",image:s,timestamp:new Date});const w={lastMessage:r?.trim()||(s?"[]":""),lastTimestamp:new Date,unreadBy:hn.firestore.FieldValue.arrayUnion(g)};a&&(w.meetingTime=a.meetingTime||"",w.meetingLocation=a.meetingLocation||"",w.invoiceSentAt=a.invoiceSentAt||new Date,w.status="Invoiced"),await l.update(w)}}catch(l){throw console.error("Error sending message:",l),l}},subscribeToMessages(n,e){return Tt.collection("transactions").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(r=>{const s=r.docs.map(a=>({id:a.id,...a.data()}));e(s)},r=>{console.error("Error subscribing to messages:",r)})}},Tl={fontFamily:'"Noto Sans TC", "PMingLiU", sans-serif'},Se={whiteBucks:"#E8E3DF",fossilGray:"#C9C3B6",brushwood:"#9E9081",chocolateBubble:"#A58976",brownWindmill:"#756256",bgLight:"#F9F7F5"},s5=["","","","",""],bT=[{id:"all",name:""},{id:"chi",name:""},{id:"eng",name:""},{id:"math",name:""},{id:"sci",name:""},{id:"soc",name:""},{id:"extra",name:""}],AT=({title:n,avatars:e,onPurchase:t,onEquip:r,currentAvatarId:s,myAvatars:a,coins:l})=>v.jsxs("div",{className:"mb-8",children:[v.jsxs("h4",{className:"font-bold text-[#756256] mb-4 flex items-center gap-2 px-1 text-sm md:text-base",children:[v.jsx("span",{className:"w-1.5 h-5 bg-[#A58976] rounded-full"}),n]}),v.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar",children:e.map(d=>{const f=a.includes(d.id)||d.id==="classic-1",p=s===d.id,g=l>=d.price;return v.jsxs("div",{className:"min-w-[110px] bg-white border rounded-2xl p-3 flex flex-col items-center shadow-sm",style:{borderColor:"#E8E3DF"},children:[v.jsx("div",{className:"w-14 h-14 rounded-full overflow-hidden mb-3 bg-gray-50 border p-1",children:v.jsx("img",{src:cc(d.src),alt:d.name,className:"w-full h-full object-cover rounded-full"})}),v.jsx("div",{className:"font-bold text-xs text-[#5D4037] mb-3 truncate w-full text-center",children:d.name}),v.jsx("button",{onClick:()=>f?r(d.id):t(d.id,d.price),disabled:!f&&!g,className:`w-full py-1.5 rounded-full text-[10px] font-bold flex items-center justify-center gap-1 transition-colors ${f?p?"bg-gray-100 text-gray-400":"bg-[#756256] text-white hover:bg-[#5D4E44]":"bg-yellow-500 text-white hover:bg-yellow-600"} ${!f&&!g?"opacity-50 cursor-not-allowed":""}`,children:f?p?"":"":v.jsxs(v.Fragment,{children:["NT$ ",d.price]})})]},d.id)})})]}),ps=[{id:"classic-1",name:"",price:0,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cat&backgroundColor=FFD700"},{id:"pony-gift",name:"",price:0,src:"https://i.postimg.cc/9fW28Bc0/niu.jpg"},{id:"special1",name:"",price:100,src:"https://i.postimg.cc/zyP43KbN/tu-zi.jpg"},{id:"special2",name:"",price:100,src:"https://i.postimg.cc/pd2vGBP9/zhu.jpg"},{id:"special3",name:"",price:100,src:"https://i.postimg.cc/wB6zfk97/gou.jpg"},{id:"special4",name:"",price:100,src:"https://i.postimg.cc/qNvyYNG3/EE1D91FC-D76E-4FBA-A85F-33F8D82EAFEB.jpg"},{id:"special5",name:"",price:100,src:"https://i.postimg.cc/VkjgJMr4/84AD5380-E492-4603-B7C7-4BD68372B94A.jpg"},{id:"classic-2",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=glasses&backgroundColor=4ADE80"},{id:"classic-3",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=cool&backgroundColor=A58976"},{id:"classic-4",name:"",price:100,src:"https://api.dicebear.com/7.x/miniavs/svg?seed=artist&backgroundColor=FFB6C1"},{id:"classic-5",name:"",price:100,src:"https://api.dicebear.com/7.x/bottts/svg?seed=robot&backgroundColor=E0E0E0"}],i5=[],o5={uid:"guest",email:"guest@example.com",nickname:"",isGuest:!0,photoURL:null,coins:0,myAvatars:[],currentAvatarId:"classic-1"},xv=n=>{if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=Math.floor((new Date-e)/1e3);return r<60?"":r<3600?`${Math.floor(r/60)}`:r<86400?`${Math.floor(r/3600)}`:r<2592e3?`${Math.floor(r/86400)}`:e.toLocaleDateString()},cc=(n,e=150,t=50)=>n,a5=n=>{if(!n)return"";const e=/(\d{1,2})\/(\d{1,2})\s+(\d{1,2}):(\d{1,2})/,t=n.match(e);if(t){const[r,s,a,l,d]=t;return`${s.padStart(2,"0")}/${a.padStart(2,"0")} ${l.padStart(2,"0")}:${d.padStart(2,"0")}`}return n},Sv=({type:n,price:e,originalPrice:t,large:r=!1})=>n==="exchange"?v.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:Se.brushwood},children:[v.jsx(VT,{size:r?20:14}),v.jsx("span",{children:""})]}):n==="gift"||e===0?v.jsxs("div",{className:`flex items-center gap-1 font-bold ${r?"text-2xl":"text-sm"}`,style:{color:Se.chocolateBubble},children:[v.jsx(DT,{size:r?20:14}),v.jsx("span",{children:""})]}):v.jsxs("div",{className:"flex flex-col",children:[v.jsxs("div",{className:`font-bold ${r?"text-3xl":"text-lg"}`,style:{color:Se.brownWindmill},children:["NT$ ",e]}),t&&v.jsxs("span",{className:"text-xs line-through",style:{color:Se.fossilGray},children:[" $",t]})]}),TA=({score:n=100,size:e=14})=>{const t=Math.max(0,Math.min(5,Math.round(n/10)/2));return v.jsxs("div",{className:"flex items-center gap-0.5",title:`: ${n}`,children:[[1,2,3,4,5].map(r=>t>=r?v.jsx(GE,{size:e,fill:"#fbbf24",className:"text-yellow-400"},r):t>=r-.5?v.jsx(MP,{size:e,fill:"#fbbf24",className:"text-yellow-400"},r):v.jsx(GE,{size:e,className:"text-gray-200"},r)),v.jsx("span",{className:"ml-1 text-xs font-bold text-gray-500",children:t.toFixed(1)})]})},bv=(n,e=800,t=800,r=.6)=>new Promise(s=>{const a=new Image;a.src=n,a.onload=()=>{const l=document.createElement("canvas");let d=a.width,f=a.height;d>f?d>e&&(f*=e/d,d=e):f>t&&(d*=t/f,f=t),l.width=d,l.height=f,l.getContext("2d").drawImage(a,0,0,d,f),s(l.toDataURL("image/jpeg",r))}}),l5=({items:n,onNavigate:e,currentUser:t})=>{const[r,s]=he.useState(0),a=(n||[]).slice(0,5),[l,d]=he.useState([]);if(he.useEffect(()=>{if(a.length===0)return;const p=setInterval(()=>{s(g=>(g+1)%a.length)},4e3);return()=>clearInterval(p)},[a.length]),he.useEffect(()=>{const p=[];t&&p.push(""),[...n||[]].sort((w,T)=>{const N=w.timestamp?.toDate?w.timestamp.toDate():new Date(w.timestamp||0);return(T.timestamp?.toDate?T.timestamp.toDate():new Date(T.timestamp||0))-N}).slice(0,8).forEach(w=>{const T=xv(w.timestamp),N=w.seller?.nickname||"";p.push(`${T} ${N} ${w.title}`)}),d(p)},[n,t]),a.length===0)return null;const f=a[r];return v.jsxs("div",{className:"h-full",children:[v.jsx("div",{className:"flex items-center justify-between mb-3",children:v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("span",{className:"bg-orange-500 text-white p-1 rounded-full animate-pulse flex-shrink-0",children:v.jsx(pP,{size:16,fill:"currentColor"})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide flex-shrink-0",style:{color:Se.brownWindmill},children:""}),l.length>0&&v.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 ml-2 overflow-hidden flex-1 max-w-[500px]",children:[v.jsx(LT,{size:14,className:"text-red-500 flex-shrink-0",fill:"currentColor"}),v.jsx("div",{className:"flex-1 overflow-hidden relative h-5",children:v.jsxs("div",{className:"whitespace-nowrap absolute animate-marquee font-medium flex items-center h-full",children:[l.map((p,g)=>v.jsx("span",{className:"mr-12 inline-block",children:p},g)),l.map((p,g)=>v.jsx("span",{className:"mr-12 inline-block",children:p},`dup-${g}`))]})})]})]})}),v.jsxs("div",{className:"relative w-full h-48 bg-white rounded-2xl shadow-md overflow-hidden border cursor-pointer group",style:{borderColor:Se.whiteBucks},onClick:()=>e("product",f),children:[v.jsx("div",{className:"absolute inset-0 bg-cover bg-center blur-xl opacity-30 animate-pulse-slow transition-all duration-1000 transform scale-110",style:{backgroundImage:`url(${f.cover||f.imageBase64})`}},f.id+"-bg"),v.jsxs("div",{className:"absolute inset-0 flex items-center p-4 z-10",children:[v.jsx("div",{className:"w-28 h-36 flex-shrink-0 rounded-lg overflow-hidden shadow-lg border border-white transform transition-transform duration-500 hover:scale-105 animate-fade-in-up",children:v.jsx("img",{src:f.cover||f.imageBase64,alt:f.title,className:"w-full h-full object-cover"})},f.id+"-img"),v.jsxs("div",{className:"flex-1 ml-4 flex flex-col justify-center h-full animate-fade-in-right",children:[v.jsxs("div",{className:"flex items-start justify-between mb-1",children:[v.jsx("span",{className:"text-xs font-bold text-orange-500 bg-orange-50 px-2 py-0.5 rounded-md",children:"HOT"}),v.jsxs("span",{className:"text-xs text-gray-400",children:[r+1," / ",a.length]})]}),v.jsx("h3",{className:"font-bold text-lg text-[#5D4037] line-clamp-2 leading-tight mb-2",children:f.title}),v.jsxs("div",{className:"mt-auto",children:[v.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.grade||""}),v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.subject}),v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:f.conditionLevel})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Sv,{type:f.type,price:f.price,originalPrice:f.originalPrice}),v.jsx("div",{className:"w-8 h-8 rounded-full bg-[#756256] text-white flex items-center justify-center shadow-md transform translate-x-16 group-hover:translate-x-0 transition-all duration-300 opacity-0 group-hover:opacity-100",children:v.jsx(Cy,{size:16})})]})]})]},f.id+"-text")]}),v.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-1.5 z-20",children:a.map((p,g)=>v.jsx("div",{className:`h-1 rounded-full overflow-hidden transition-all duration-300 ${g===r?"w-6 bg-gray-200":"w-1.5 bg-gray-300"}`,children:g===r&&v.jsx("div",{className:"h-full bg-[#756256] animate-progress-fill",style:{width:"100%"}})},g))})]}),v.jsx("style",{children:`
        @keyframes progress-fill {
          from { width: 0%; }
          to { width: 100%; }
        }
        .animate-progress-fill {
          animation: progress-fill 4s linear;
        }
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.5s ease-out forwards;
        }
        @keyframes fade-in-right {
          from { opacity: 0; transform: translateX(10px); }
          to { opacity: 1; transform: translateX(0); }
        }
        .animate-fade-in-right {
          animation: fade-in-right 0.5s ease-out forwards;
        }
        @keyframes marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(-50%); } 
        }
        .animate-marquee {
          animation: marquee 30s linear infinite;
        }
      `})]})},c5=({examCountdown:n})=>{const[e,t]=he.useState(0),r=n?.exams||[],s=r.length>0&&r[e]?r[e]:{title:r.length===0&&n?"...":"",daysLeft:0};return v.jsxs("div",{className:"h-full",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[v.jsx("span",{className:"bg-red-500 text-white p-1 rounded-full",children:v.jsx(tP,{size:16})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:Se.brownWindmill},children:""})]}),v.jsxs("div",{className:"bg-white p-3 rounded-2xl border flex flex-col justify-between h-48 relative overflow-hidden shadow-md",style:{borderColor:Se.whiteBucks},children:[v.jsx("a",{href:"https://calendar.google.com/calendar/embed?src=shsh.ylc.edu.tw_fcpdcjkto9mpulh1gg2eetr4s4%40group.calendar.google.com&ctz=Asia%2FTaipei",target:"_blank",rel:"noopener noreferrer",className:"absolute top-0 right-0 w-12 h-12 bg-red-50 rounded-bl-2xl z-20 flex items-center justify-center text-red-400 hover:text-red-500 hover:bg-red-100 transition-colors cursor-pointer",children:v.jsx(uP,{size:18})}),v.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-center items-center",children:[v.jsxs("div",{className:"relative mb-2",children:[v.jsxs("div",{className:"text-base text-gray-500 font-bold truncate flex items-center justify-center gap-1 cursor-pointer hover:text-gray-700 transition-colors",children:[" ",s.title," ",v.jsx(sP,{size:14})]}),r.length>1&&v.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:e,onChange:a=>t(Number(a.target.value)),children:r.map((a,l)=>v.jsxs("option",{value:l,children:[a.title," (",a.displayDate||`${a.date.substring(4,6)}/${a.date.substring(6,8)}`,")"]},l))}),v.jsx("div",{className:"text-xs text-gray-400 mt-1 text-center",children:s.displayDate||s.date})]}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-7xl font-bold text-[#756256]",children:s.daysLeft}),v.jsx("span",{className:"text-lg text-[#756256]",children:""})]})]})]})]})},u5=({wishes:n,onAddWish:e,onDeleteWish:t,currentUser:r,currentAvatar:s})=>{const[a,l]=he.useState(!1),[d,f]=he.useState(""),[p,g]=he.useState(null),[w,T]=he.useState(null),[N,A]=he.useState(null),L=he.useRef(null),[V,se]=he.useState(1),ie=5,Q=Math.ceil(n.length/ie),pe=n.slice((V-1)*ie,V*ie),te=b=>{const S=b.target.files[0];if(S){const k=new FileReader;k.onloadend=async()=>{const D=await bv(k.result,400,400,.5);g(D)},k.readAsDataURL(S)}},ae=()=>{!d.trim()&&!p||(e(d,p),f(""),g(null),l(!1),se(1))};return v.jsxs("div",{className:"mb-8 px-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"bg-yellow-400 text-white p-1 rounded-full",children:v.jsx(OT,{size:16,fill:"currentColor"})}),v.jsx("h2",{className:"text-lg font-bold tracking-wide",style:{color:Se.brownWindmill},children:""})]}),Q>1&&v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[v.jsx("button",{onClick:()=>se(b=>Math.max(1,b-1)),disabled:V===1,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:v.jsx(Ny,{size:18})}),v.jsxs("span",{className:"text-gray-500 font-bold px-1",children:[V," / ",Q]}),v.jsx("button",{onClick:()=>se(b=>Math.min(Q,b+1)),disabled:V===Q,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent text-gray-500",children:v.jsx(kT,{size:18})})]})]}),v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 space-y-3",style:{borderColor:Se.whiteBucks},children:[pe.map(b=>{const S=ps.find(R=>R.id===b.avatarId)||ps[0],k=b.uid===r?.uid,D=N===b.id;return v.jsxs("div",{className:"flex gap-3 border-b last:border-0 pb-3 last:pb-0",style:{borderColor:Se.bgLight},children:[v.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden cursor-pointer transition-all duration-300 ${D?"bg-red-500 scale-90":"bg-gray-100"}`,onClick:()=>{k&&(D?(t(b.id),A(null)):A(b.id))},children:D?v.jsx(us,{size:20,className:"text-white animate-bounce-short"}):v.jsx("img",{src:cc(S.src,100,60),alt:"avatar",className:"w-full h-full object-cover"})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("span",{className:"text-sm font-bold text-[#756256]",children:b.user}),v.jsx("span",{className:"text-xs font-normal text-gray-400",children:xv(b.timestamp)})]}),v.jsx("p",{className:"text-sm text-[#9E9081]",children:b.content}),b.image&&v.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-gray-100 h-24 inline-block bg-gray-50",children:v.jsx("img",{src:b.image,alt:"wish thumbnail",onClick:()=>T(b.image),className:"h-full w-auto object-contain cursor-zoom-in hover:opacity-90 transition-opacity"})})]})]},b.id)}),v.jsxs("button",{onClick:()=>{if(r?.isGuest){alert("");return}l(!0)},className:"w-full py-2 mt-2 text-xs font-bold text-[#9E9081] border border-dashed hover:bg-[#F9F7F5] rounded-lg transition-colors flex items-center justify-center gap-1",style:{borderColor:Se.fossilGray},children:[v.jsx(AP,{size:14})," "]})]}),w&&v.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 animate-fade-in",onClick:()=>T(null),children:[v.jsx("button",{className:"absolute top-6 right-6 text-white hover:text-gray-300 transition-colors z-10 p-2",onClick:b=>{b.stopPropagation(),T(null)},children:v.jsx(us,{size:32})}),v.jsx("img",{src:w,alt:"full preview",className:"max-w-full max-h-full object-contain rounded animate-scale-up",onClick:b=>b.stopPropagation()})]}),a&&v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:v.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl overflow-hidden shadow-2xl animate-scale-up flex flex-col max-h-[90vh]",children:[v.jsxs("div",{className:"flex justify-between items-center p-3 border-b",style:{borderColor:Se.whiteBucks},children:[v.jsx("button",{onClick:()=>l(!1),className:"p-1",children:v.jsx(us,{size:24,className:"text-gray-600"})}),v.jsx("span",{className:"font-bold text-[#756256] text-lg",children:""}),v.jsx("button",{onClick:ae,className:"text-blue-500 font-bold text-sm px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50 disabled:hover:bg-transparent",disabled:!d.trim()&&!p,children:""})]}),v.jsxs("div",{className:"p-4 flex flex-col flex-1 overflow-y-auto",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden border border-gray-100",children:v.jsx("img",{src:s.src,alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("span",{className:"font-bold text-[#5D4037]",children:r.nickname||r.email})]}),v.jsx("textarea",{className:"w-full resize-none outline-none text-[#5D4037] placeholder-gray-400 text-lg leading-relaxed min-h-[100px]",placeholder:"...",value:d,onChange:b=>f(b.target.value),autoFocus:!0}),p&&v.jsxs("div",{className:"relative mt-2 rounded-lg overflow-hidden border border-gray-100 group",children:[v.jsx("img",{src:p,alt:"preview",className:"w-full h-auto"}),v.jsx("button",{onClick:()=>g(null),className:"absolute top-2 right-2 p-1 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors",children:v.jsx(us,{size:16})})]})]}),v.jsxs("div",{className:"p-3 border-t bg-gray-50 flex gap-4 text-gray-400",children:[v.jsx("input",{type:"file",ref:L,className:"hidden",accept:"image/*",onChange:te}),v.jsx("button",{onClick:()=>L.current.click(),className:"p-1 hover:text-[#756256] transition-colors",children:v.jsx(PT,{size:20})})]})]})})]})},d5=({onLogin:n,onGuestLogin:e})=>{const[t,r]=he.useState("login"),[s,a]=he.useState(null),[l,d]=he.useState(""),[f,p]=he.useState(""),[g,w]=he.useState(""),[T,N]=he.useState(""),[A,L]=he.useState(!1),[V,se]=he.useState(!1),[ie,Q]=he.useState(!1),pe=he.useRef(!1);he.useEffect(()=>{(async()=>{if(!pe.current&&mr.isSignInWithEmailLink(window.location.href)){pe.current=!0;let k=window.localStorage.getItem("emailForSignIn");k||(k=window.prompt(" Email "));try{Q(!0),await mr.signInWithLink(k,window.location.href),window.localStorage.removeItem("emailForSignIn");const D=JSON.parse(window.localStorage.getItem("registrationForm"))||{};D.role&&a(D.role),D.realName&&w(D.realName),D.studentId&&N(D.studentId),d(k),r("register-form"),se(!0),alert("")}catch(D){console.error(D),alert(""),pe.current=!1}finally{Q(!1)}}})()},[]);const te=async()=>{if(s==="teacher"){if(!l.endsWith("@shsh.ylc.edu.tw"))return alert(" @shsh.ylc.edu.tw ");if(!g)return alert("")}else{if(!l.endsWith("@shsh.tw"))return alert(" @shsh.tw ");if(!g)return alert("");const S=l.split("@")[0];if(!(/^stu\d+$/.test(S)||/^u\d+$/.test(S)))return alert(" ( stu/u )");const D=S.startsWith("stu")?S.substring(3):S.substring(1);N(D);try{Q(!0),await mr.sendVerificationLink(l),window.localStorage.setItem("emailForSignIn",l),window.localStorage.setItem("registrationForm",JSON.stringify({role:s,realName:g,studentId:D})),L(!0),setTimeout(()=>{alert(` ${l}`)},100)}catch(R){alert(": "+R.message)}finally{Q(!1)}return}try{Q(!0),await mr.sendVerificationLink(l),window.localStorage.setItem("emailForSignIn",l),window.localStorage.setItem("registrationForm",JSON.stringify({role:s,realName:g})),L(!0),alert(` ${l}`)}catch(S){alert(": "+S.message)}finally{Q(!1)}},ae=async()=>{if(!f||f.length<6)return alert(" 6 ");try{Q(!0),await mr.updateUserPassword(f);const S=(g.trim()[0]||"")+(s==="teacher"?"":"");await mr.completeProfile({realName:g,studentId:T,nickname:S}),window.localStorage.removeItem("registrationForm"),alert("")}catch(S){console.error(S),alert(": "+S.message)}finally{Q(!1)}},b=async S=>{S.preventDefault();try{Q(!0),await mr.login(l,f)}catch(k){k.code==="auth/wrong-password"?alert(""):k.code==="auth/user-not-found"||k.code==="auth/invalid-email"?alert(""):alert(": "+k.message)}finally{Q(!1)}};return t==="register-role"?v.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",style:{...Tl,backgroundColor:Se.bgLight},children:v.jsxs("div",{className:"max-w-2xl w-full",children:[v.jsx("h2",{className:"text-3xl font-bold text-center mb-8",style:{color:Se.brownWindmill},children:""}),v.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[v.jsxs("button",{onClick:()=>{a("teacher"),r("register-form")},className:"bg-white p-8 rounded-2xl shadow-lg border-2 border-transparent hover:border-[#A58976] transition-all flex flex-col items-center gap-4 group",children:[v.jsx("div",{className:"w-24 h-24 bg-orange-100 rounded-full flex items-center justify-center text-4xl group-hover:scale-110 transition-transform",children:""}),v.jsx("h3",{className:"text-xl font-bold text-[#5D4037]",children:""}),v.jsx("p",{className:"text-gray-500 text-sm",children:" @shsh.ylc.edu.tw "})]}),v.jsxs("button",{onClick:()=>{a("student"),r("register-form")},className:"bg-white p-8 rounded-2xl shadow-lg border-2 border-transparent hover:border-[#A58976] transition-all flex flex-col items-center gap-4 group",children:[v.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center text-4xl group-hover:scale-110 transition-transform",children:""}),v.jsx("h3",{className:"text-xl font-bold text-[#5D4037]",children:""}),v.jsx("p",{className:"text-gray-500 text-sm",children:" @shsh.tw "})]})]}),v.jsx("button",{onClick:()=>r("login"),className:"block mx-auto mt-8 text-gray-500 hover:underline",children:""})]})}):t==="register-form"?v.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",style:{...Tl,backgroundColor:Se.bgLight},children:v.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 border",style:{borderColor:Se.whiteBucks},children:[v.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",style:{color:Se.brownWindmill},children:s==="teacher"?"":""}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold ml-1 mb-1 text-[#756256]",children:""}),v.jsx("input",{type:"text",value:g,onChange:S=>w(S.target.value),disabled:V,className:"w-full p-3 border rounded-xl bg-gray-50",placeholder:s==="teacher"?"":""}),v.jsxs("p",{className:"text-xs text-gray-400 mt-1 ml-1",children:["",g?g[0]:"",s==="teacher"?"":""]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold ml-1 mb-1 text-[#756256]",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"email",value:l,onChange:S=>d(S.target.value),disabled:V||A,className:"flex-1 p-3 border rounded-xl bg-gray-50",placeholder:s==="teacher"?"xxx@shsh.ylc.edu.tw":"u/stu + @shsh.tw"}),V?v.jsx("div",{className:"flex items-center justify-center px-3 bg-green-100 text-green-600 rounded-xl",children:v.jsx(CT,{size:20})}):v.jsx("button",{onClick:te,disabled:A||ie,className:`px-4 rounded-xl font-bold text-sm whitespace-nowrap transition-colors ${A?"bg-gray-200 text-gray-500":"bg-[#756256] text-white hover:bg-[#5D4E44]"}`,children:A?"":""})]})]}),!V&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold ml-1 mb-1 text-gray-400",children:""}),v.jsx("input",{type:"text",disabled:!0,className:"w-full p-3 border rounded-xl bg-gray-100 text-gray-400 cursor-not-allowed",placeholder:""})]}),V&&v.jsxs("div",{className:"animate-fade-in-up",children:[v.jsx("label",{className:"block text-sm font-bold ml-1 mb-1 text-[#756256]",children:""}),v.jsx("input",{type:"password",value:f,onChange:S=>p(S.target.value),className:"w-full p-3 border rounded-xl bg-white focus:ring-2 ring-[#A58976]",placeholder:" 6 "}),v.jsx("button",{onClick:ae,disabled:ie,className:"w-full mt-6 py-3 rounded-xl bg-[#A58976] text-white font-bold hover:bg-[#8D7362] shadow-md transition-transform active:scale-95",children:ie?"...":""})]}),!V&&v.jsx("button",{onClick:()=>r("register-role"),className:"w-full mt-4 text-gray-400 text-sm hover:underline",children:""})]})]})}):v.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",style:{...Tl,backgroundColor:Se.bgLight,color:Se.brownWindmill},children:v.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center border",style:{borderColor:Se.whiteBucks},children:[v.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:Se.brownWindmill},children:""}),v.jsx("p",{className:"text-sm mb-6",style:{color:Se.brushwood},children:""}),v.jsxs("form",{onSubmit:b,className:"space-y-3 mb-6",children:[v.jsx("input",{type:"email",value:l,onChange:S=>d(S.target.value),placeholder:"Email",className:"w-full p-3 border rounded-xl",required:!0}),v.jsx("input",{type:"password",value:f,onChange:S=>p(S.target.value),placeholder:"Password",className:"w-full p-3 border rounded-xl",required:!0}),v.jsx("button",{type:"submit",disabled:ie,className:"w-full py-3 rounded-xl border-2 font-bold hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:Se.whiteBucks,color:Se.brownWindmill},children:ie?"...":""})]}),v.jsxs("div",{className:"border-t pt-4",style:{borderColor:Se.whiteBucks},children:[v.jsx("p",{className:"text-sm text-gray-400 mb-3",children:""}),v.jsx("button",{onClick:()=>r("register-role"),className:"w-full py-3 rounded-xl bg-[#756256] text-white font-bold hover:bg-[#5D4E44] shadow-md transition-transform active:scale-95 mb-3",children:""}),v.jsxs("button",{onClick:e,className:"w-full py-2 rounded-xl text-[#9E9081] font-bold hover:bg-gray-50 text-sm transition-colors flex items-center justify-center gap-1",children:[v.jsx("span",{className:"opacity-70",children:""})," ",v.jsx(Cy,{size:14})]})]})]})})},h5=({product:n,onBack:e,onContact:t,currentUser:r})=>{if(!n)return null;const s=r?.uid&&n.sellerId&&String(r.uid)===String(n.sellerId)||r?.studentId&&n.seller?.studentId&&r.studentId===n.seller.studentId,[a,l]=he.useState(null);return he.useEffect(()=>{n?.sellerId&&(async()=>{try{const{db:f}=await ss(async()=>{const{db:g}=await Promise.resolve().then(()=>cs);return{db:g}},void 0),p=await f.collection("users").doc(n.sellerId).get();p.exists&&l(p.data())}catch(f){console.error("Failed to fetch seller profile",f)}})()},[n?.sellerId]),he.useEffect(()=>{window.scrollTo(0,0)},[]),v.jsxs("div",{className:"min-h-screen pb-24 bg-white",style:Tl,children:[v.jsx("nav",{className:"fixed top-0 w-full z-50 flex justify-between items-center px-4 py-3 bg-white/80 backdrop-blur-md border-b",style:{borderColor:Se.whiteBucks},children:v.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200",children:v.jsx(Ny,{size:20,color:Se.brownWindmill})})}),v.jsxs("div",{className:"pt-16 pb-6 md:pt-20 md:pb-12 md:px-8 max-w-6xl mx-auto md:flex md:gap-10 md:items-start",children:[v.jsx("div",{className:"aspect-[4/3] bg-gray-100 relative md:w-1/2 md:aspect-square md:rounded-2xl md:overflow-hidden md:shadow-sm md:sticky md:top-24",children:v.jsx("img",{src:n.cover||n.imageBase64||"https://dummyimage.com/600x400/eee/aaa",alt:n.title,className:"w-full h-full object-contain bg-[#F9F7F5]"})}),v.jsxs("div",{className:"px-5 mt-6 md:w-1/2 md:px-0 md:mt-0",children:[v.jsxs("div",{className:"flex gap-2 mb-2",children:[v.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.grade}),v.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded bg-[#F9F7F5] text-[#9E9081]",children:n.subject})]}),v.jsx("h1",{className:"text-2xl md:text-3xl font-bold mt-4 mb-2 leading-tight",style:{color:Se.brownWindmill},children:n.title}),v.jsx("div",{className:"flex items-end gap-3 mb-6 pb-6 border-b",style:{borderColor:Se.whiteBucks},children:v.jsx(Sv,{type:n.type,price:n.price,originalPrice:n.originalPrice,large:!0})}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081]",children:""}),v.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-2",children:[v.jsxs("span",{children:[n.views||0," "]}),v.jsx("span",{children:""}),v.jsxs("span",{className:"whitespace-nowrap",children:["",(()=>{const d=n.timestamp?.toDate?n.timestamp.toDate():new Date(n.timestamp||0),f=d.getFullYear(),p=String(d.getMonth()+1).padStart(2,"0"),g=String(d.getDate()).padStart(2,"0"),w=String(d.getHours()).padStart(2,"0"),T=String(d.getMinutes()).padStart(2,"0");return`${f}-${p}-${g} ${w}:${T}`})()]})]})]}),v.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg inline-block border border-gray-100",children:n.conditionLevel})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:n.description||""})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-[#F9F7F5] border border-stone-100",children:[v.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-white shadow-sm overflow-hidden",children:(()=>{const d=a?.currentAvatarId||n.seller?.currentAvatarId||n.seller?.avatar,f=ps.find(p=>p.id===d)?.src||ps[0].src;return v.jsx("img",{src:cc(f),className:"w-full h-full object-cover",alt:"Seller"})})()}),v.jsxs("div",{children:[v.jsx("div",{className:"font-bold text-[#756256] text-lg",children:a?.nickname||n.seller?.nickname||n.seller?.name}),v.jsx("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-0.5",children:v.jsx(TA,{score:a?.creditScore||n.seller?.score||100})})]})]})]}),!s&&v.jsx("div",{className:"hidden md:block pt-4",children:v.jsxs("button",{onClick:()=>{if(r?.isGuest){alert("");return}t()},className:`w-full py-4 ${r?.isGuest?"bg-gray-400 hover:bg-gray-500":"bg-[#756256] hover:bg-[#5D4E44]"} text-white rounded-xl font-bold shadow-lg transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2 text-lg`,children:[v.jsx(Lu,{size:20})," ",r?.isGuest?"":" / "]})})]})]})]}),!s&&v.jsx("div",{className:"fixed bottom-0 left-0 w-full p-4 bg-white border-t safe-area-bottom flex gap-3 md:hidden z-40",style:{borderColor:Se.whiteBucks},children:v.jsxs("button",{onClick:()=>{if(r?.isGuest){alert("");return}t()},className:"flex-1 py-3 bg-[#756256] text-white rounded-xl font-bold shadow-lg hover:bg-[#5D4E44] transition-colors flex items-center justify-center gap-2",children:[v.jsx(Lu,{size:18})," ",r?.isGuest?"":""]})})]})},f5=({onNavigate:n,user:e,currentAvatarId:t,coins:r,wishes:s,onAddWish:a,onDeleteWish:l,books:d,isLoading:f,examCountdown:p,onToggleNotifications:g,hasUnreadNotifications:w,onLogout:T})=>{const[N,A]=he.useState(""),[L,V]=he.useState("all"),[se,ie]=he.useState("all"),[Q,pe]=he.useState("all"),[te,ae]=he.useState("all"),[b,S]=he.useState(1),k=20,D=()=>{ie("all"),pe("all"),ae("all"),A(""),V("all"),S(1),window.scrollTo({top:0,behavior:"smooth"})};he.useEffect(()=>{S(1)},[N,L]);const R=d.filter(ue=>{const Y=N.toLowerCase(),ve=!Y.trim()||ue.title.toLowerCase().includes(Y)||ue.author&&ue.author.toLowerCase().includes(Y);let de=!0;if(L!=="all")if(L==="extra")de=ue.subject===""||ue.publisher==="";else if(L==="sci")de=["","","","",""].includes(ue.subject);else if(L==="soc")de=["","","",""].includes(ue.subject);else{const j=bT.find(K=>K.id===L)?.name;de=ue.subject===j}return ve&&de}).sort((ue,Y)=>{const ve=ue.timestamp?.toDate?ue.timestamp.toDate():new Date(ue.timestamp||0);return(Y.timestamp?.toDate?Y.timestamp.toDate():new Date(Y.timestamp||0))-ve}),M=Math.ceil(R.length/k),P=R.slice((b-1)*k,b*k),Ce=ps.find(ue=>ue.id===t)||ps[0],tt=he.useRef(null),$e=()=>{if(tt.current){const Y=tt.current.getBoundingClientRect().top+window.pageYOffset+-80;window.scrollTo({top:Y,behavior:"smooth"})}};return v.jsxs("div",{className:"min-h-screen pb-20",style:{...Tl,backgroundColor:Se.bgLight,color:Se.brownWindmill},children:[v.jsx("div",{className:"pt-6 pb-12 px-4 rounded-b-[2rem] shadow-lg",style:{background:`linear-gradient(135deg, ${Se.chocolateBubble}, ${Se.brownWindmill})`,color:Se.bgLight},children:v.jsxs("div",{className:"max-w-6xl mx-auto",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-8 h-8 backdrop-blur rounded-sm flex items-center justify-center font-bold font-serif",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:""}),v.jsx("span",{className:"text-xl font-bold tracking-widest",children:""})]}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:D,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:v.jsx(HE,{size:20})}),v.jsxs("button",{onClick:g,className:"relative p-2 hover:bg-white/10 rounded-full transition-colors",children:[v.jsx(Mg,{size:20}),w&&v.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full border border-white"})]}),e.isGuest?v.jsx("button",{onClick:T,className:"px-4 py-1.5 rounded-full bg-white text-[#756256] text-sm font-bold shadow-sm hover:bg-gray-100 transition-colors",children:" / "}):v.jsxs("button",{onClick:()=>n("profile"),className:"flex items-center gap-2 hover:bg-white/20 pl-1 pr-3 py-1 rounded-full transition-all border border-white/20",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:[v.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center overflow-hidden bg-white/20",children:v.jsx("img",{src:cc(Ce.src,100,50),alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("span",{className:"hidden sm:inline text-sm font-medium tracking-wide",children:e.nickname||e.email})]})]})]}),v.jsxs("div",{className:"max-w-3xl mx-auto mt-2",children:[v.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4 tracking-widest text-center",children:""}),v.jsx("div",{className:"bg-[#FDFBF7] rounded-xl shadow-xl overflow-hidden p-2",children:v.jsxs("div",{className:"flex items-center border-b px-2",style:{borderColor:Se.whiteBucks},children:[v.jsx(kP,{className:"text-[#9E9081]",size:20}),v.jsx("input",{type:"text",value:N,onChange:ue=>A(ue.target.value),placeholder:"...",className:"w-full py-3 px-4 bg-transparent text-[#756256] placeholder-[#C9C3B6] outline-none"}),N&&v.jsx("button",{onClick:()=>A(""),className:"text-[#9E9081]",children:v.jsx(us,{size:16})})]})})]})]})}),v.jsxs("div",{className:"max-w-6xl mx-auto px-4 -mt-6",children:[v.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 no-scrollbar mb-4",children:bT.map(ue=>v.jsx("button",{onClick:()=>V(ue.id),className:`whitespace-nowrap px-5 py-2 rounded-full text-sm tracking-wide shadow-sm transition-all border ${L===ue.id?"bg-[#756256] text-white border-[#756256]":"bg-[#F9F7F5] text-[#756256] border-[#E8E3DF]"}`,children:ue.name},ue.id))}),!N&&L==="all"&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[v.jsx("div",{className:"flex-1 min-w-0",children:v.jsx(l5,{items:d,onNavigate:n,currentUser:e})}),v.jsx("div",{className:"w-full md:w-[320px] flex-shrink-0",children:v.jsx(c5,{examCountdown:p})})]}),v.jsx(u5,{wishes:s,onAddWish:a,onDeleteWish:l,currentUser:e,currentAvatar:Ce})]}),v.jsxs("div",{className:"pb-8",children:[v.jsx("div",{ref:tt,className:"flex justify-between items-end mb-4 px-1 border-b pb-2",style:{borderColor:Se.whiteBucks},children:v.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 tracking-wide",style:{color:Se.brownWindmill},children:[v.jsx(ZR,{size:20,style:{color:Se.chocolateBubble}}),N||L!=="all"?"":""]})}),f?v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:Array.from({length:10}).map((ue,Y)=>v.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-sm border border-gray-100 flex flex-col h-full",children:[v.jsx("div",{className:"aspect-square bg-gray-100 animate-pulse"}),v.jsxs("div",{className:"p-3 space-y-2 flex-1",children:[v.jsx("div",{className:"h-4 bg-gray-100 rounded w-3/4 animate-pulse"}),v.jsx("div",{className:"h-3 bg-gray-100 rounded w-1/2 animate-pulse"}),v.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-50 flex justify-between",children:[v.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/3 animate-pulse"}),v.jsx("div",{className:"h-4 bg-gray-100 rounded w-1/4 animate-pulse"})]})]})]},Y))}):P.length>0?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 animate-fade-in",children:P.map(ue=>v.jsxs("div",{onClick:()=>n("product",ue),className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all cursor-pointer border flex flex-col h-full group",style:{borderColor:Se.whiteBucks},children:[v.jsxs("div",{className:"relative aspect-square bg-[#F9F7F5] overflow-hidden",children:[v.jsx("img",{src:ue.cover||ue.imageBase64||"https://dummyimage.com/400x400/eee/aaa",alt:ue.title,className:"w-full h-full object-contain group-hover:scale-105 transition-transform duration-500"}),v.jsx("div",{className:"absolute top-0 right-0 px-3 py-1.5 text-xs font-bold shadow-sm rounded-bl-lg z-10",style:{backgroundColor:ue.type==="gift"||ue.price===0?"#E6DBC6":Se.brownWindmill,color:ue.type==="gift"||ue.price===0?"#756256":"#FFFFFF"},children:ue.type==="gift"||ue.price===0?"":""})]}),v.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[v.jsx("h3",{className:"font-bold text-[#756256] text-base leading-tight mb-2 line-clamp-2 min-h-[2.5em]",children:ue.title}),v.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ue.subject}),ue.grade&&ue.grade!==""&&v.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[#F9F7F5] text-[#9E9081]",children:ue.grade})]}),v.jsxs("div",{className:"mt-auto flex items-end justify-between border-t pt-2 border-[#E8E3DF]",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsxs("span",{className:"text-[10px] text-gray-400 mb-1",children:["",ue.seller?.nickname||""]}),v.jsx(Sv,{type:ue.type,price:ue.price})]}),v.jsxs("div",{className:"text-[10px] text-gray-400 flex items-center gap-1 scale-90",children:[v.jsx(hP,{size:12,className:"text-gray-400"}),v.jsx("span",{className:"font-bold",children:ue.views||0})]})]})]})]},ue.id))}),M>1&&v.jsxs("div",{className:"mt-8 flex justify-center items-center gap-2",children:[v.jsx("button",{onClick:()=>{S(ue=>Math.max(1,ue-1)),$e()},disabled:b===1,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:v.jsx(Ny,{size:20})}),v.jsx("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar max-w-[200px] sm:max-w-none px-2",children:Array.from({length:M}).map((ue,Y)=>v.jsx("button",{onClick:()=>{S(Y+1),$e()},className:`w-10 h-10 rounded-lg font-bold flex-shrink-0 transition-all shadow-sm ${b===Y+1?"bg-[#756256] text-white":"bg-white text-[#756256] border border-gray-100 hover:bg-gray-50"}`,children:Y+1},Y))}),v.jsx("button",{onClick:()=>{S(ue=>Math.min(M,ue+1)),$e()},disabled:b===M,className:"p-2 rounded-lg bg-white border border-gray-200 text-[#756256] disabled:opacity-30 hover:bg-gray-50 transition-colors shadow-sm",children:v.jsx(kT,{size:20})})]})]}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-20 w-full animate-fade-in text-center col-span-full",children:[v.jsx("p",{className:"text-gray-500 text-lg font-medium mb-6",children:""}),v.jsxs("button",{onClick:D,className:"px-8 py-3 rounded-xl bg-[#756256] text-white font-bold hover:bg-[#5D4E44] transition-all transform hover:-translate-y-1 shadow-md flex items-center gap-2",children:[v.jsx(HE,{size:18})," "]})]})]})]})]})},p5=({onBack:n,onNavigate:e,user:t,onLogout:r,coins:s,myAvatars:a,currentAvatarId:l,onPurchase:d,onEquip:f})=>{const[p,g]=he.useState("shelf"),w=[],[T,N]=he.useState(w),[A,L]=he.useState({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null}),[V,se]=he.useState(!1),[ie,Q]=he.useState(null);he.useEffect(()=>{if(t?.uid){const R=Gt.getMyBooks(t.uid,M=>{N(M)});return()=>R()}},[t?.uid]);const pe=R=>{const M=R.target.files[0];if(M){const P=new FileReader;P.onloadend=async()=>{const Ce=await bv(P.result,600,600,.5);L({...A,coverImagePreview:Ce})},P.readAsDataURL(M)}},te=async()=>{if(!A.coverImagePreview){alert("");return}if(!A.title){alert("");return}if(A.transactionType==="sell"&&!A.price){alert("");return}if(A.bookType==="textbook"){if(!A.gradeLevel){alert("");return}if(!A.subject){alert("");return}}se(!0);try{const R={title:A.title,author:"",publisher:A.bookType==="textbook"?"":"",subject:A.bookType==="textbook"?A.subject:"",grade:A.bookType==="textbook"?A.gradeLevel:"",price:A.transactionType==="gift"?0:Number(A.price),type:A.transactionType==="gift"?"gift":"sell",conditionLevel:A.conditionLevel,description:A.description,sellerId:t.uid,seller:{nickname:t.nickname||t.email,studentId:t.studentId||"",score:t.creditScore||5},cover:A.coverImagePreview,timestamp:new Date};await Gt.addBook(R),alert(""),g("shelf"),L({title:"",bookType:"textbook",gradeLevel:"",subject:"",transactionType:"sell",price:"",conditionLevel:"",description:"",coverImagePreview:null})}catch(R){console.error(":",R),alert(": "+R.message)}finally{se(!1)}},ae=(R,M)=>{M.stopPropagation(),Q(R)},b=async()=>{if(!ie)return;const R=ie,M=T.find(P=>P.id===R);if(M&&(M.status==="Reserved"||M.status==="Sold")){alert(""),Q(null);return}try{await Gt.deleteBook(R),Q(null)}catch(P){console.error("Deletion failed:",P),alert(": "+P.message)}},S=async()=>{try{const M=(await mr.getBindingCode()).data.code;alert(` 6  LINE 

${M}

( 10 )`)}catch(R){console.error(R),alert(": "+R.message)}},k=async()=>{if(window.confirm(` LINE 
`))try{await mr.unbindLineAccount(),alert("")}catch(R){console.error(R),alert(": "+R.message)}},D=ps.find(R=>R.id===l)||ps[0];return v.jsxs("div",{className:"min-h-screen pb-20",style:{...Tl,backgroundColor:Se.bgLight,color:Se.brownWindmill},children:[v.jsx("nav",{className:"backdrop-blur-md shadow-sm border-b sticky top-0 z-50",style:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:Se.whiteBucks},children:v.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:v.jsx(Cy,{size:20,className:"rotate-180 text-[#9E9081]"})}),v.jsx("div",{className:"font-bold text-lg tracking-wide",children:""})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[t.isLineNotifyEnabled?v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:"hidden sm:flex items-center gap-1 px-2 py-1 bg-green-50 text-green-600 text-xs font-bold rounded-md border border-green-200 cursor-default",children:[v.jsx(CT,{size:12})," "]}),v.jsx("button",{onClick:k,className:"px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-gray-100 text-gray-500 border border-gray-200 transition-colors",children:""})]}):v.jsxs("button",{onClick:S,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold bg-[#06C755] hover:bg-[#05b34c] text-white shadow-sm transition-colors",children:[v.jsx(Lu,{size:14}),"  LINE"]}),v.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-red-50 text-red-700 border border-red-200",children:[v.jsx(wP,{size:14})," "]})]})]})}),v.jsxs("main",{className:"max-w-2xl mx-auto px-4 py-8 space-y-8",children:[v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>g("store"),children:[v.jsx("div",{className:"w-24 h-24 rounded-full border-4 shadow-md overflow-hidden bg-white",style:{borderColor:Se.bgLight},children:v.jsx("img",{src:cc(D.src,200,70),className:"w-full h-full object-cover",alt:"User"})}),v.jsx("div",{className:"absolute bottom-0 right-0 text-white p-1.5 rounded-full border-2 border-white shadow-sm flex items-center justify-center",style:{backgroundColor:Se.chocolateBubble,width:28,height:28},children:v.jsx(SP,{size:14})})]}),v.jsx("h2",{className:"mt-4 text-xl font-bold tracking-widest",style:{color:Se.brownWindmill},children:t.nickname||t.email}),v.jsx("div",{className:"flex items-center justify-center mt-1 mb-2",children:v.jsx(TA,{score:t.creditScore||100,size:16})}),v.jsx("p",{className:"text-sm text-[#9E9081] mb-2",children:t.email})]}),v.jsxs("div",{className:"flex border rounded-lg overflow-hidden bg-white p-1",style:{borderColor:Se.whiteBucks},children:[v.jsx("button",{onClick:()=>g("shelf"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="shelf"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""}),v.jsx("button",{onClick:()=>g("upload"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all bg-[#A58976] text-white shadow-sm ring-1 ring-white/20",children:""}),v.jsx("button",{onClick:()=>g("store"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${p==="store"?"bg-[#F9F7F5] text-[#756256]":"text-gray-400 hover:text-gray-600"}`,children:""})]}),p==="upload"?v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6 space-y-4 animate-fade-in",style:{borderColor:Se.whiteBucks},children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsx("input",{type:"file",id:"cover-upload",accept:"image/*",onChange:pe,className:"hidden"}),v.jsx("label",{htmlFor:"cover-upload",className:"block text-center p-8 border-2 border-dashed rounded-lg bg-[#F9F7F5] cursor-pointer hover:bg-[#E6DBC6] transition-colors",style:{borderColor:Se.fossilGray},children:A.coverImagePreview?v.jsx("img",{src:A.coverImagePreview,alt:"",className:"max-h-48 mx-auto rounded"}):v.jsxs(v.Fragment,{children:[v.jsx(_P,{className:"mx-auto text-[#9E9081] mb-2",size:32}),v.jsx("span",{className:"text-sm text-[#756256]",children:""})]})})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsx("input",{type:"text",value:A.title,onChange:R=>L({...A,title:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>L({...A,bookType:"textbook"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${A.bookType==="textbook"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),v.jsx("button",{type:"button",onClick:()=>L({...A,bookType:"extracurricular"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${A.bookType==="extracurricular"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),A.bookType==="textbook"&&v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("select",{value:A.gradeLevel,onChange:R=>L({...A,gradeLevel:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsxs("select",{value:A.subject,onChange:R=>L({...A,subject:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" *"}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>L({...A,transactionType:"sell"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${A.transactionType==="sell"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""}),v.jsx("button",{type:"button",onClick:()=>L({...A,transactionType:"gift",price:"0"}),className:`py-1.5 px-4 rounded-lg font-bold transition-colors ${A.transactionType==="gift"?"bg-[#756256] text-white":"bg-[#F2F0EE] text-[#9E9081] hover:bg-[#E8E3DF]"}`,children:""})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:[" (NT$) ",A.transactionType==="sell"&&"*"]}),v.jsx("input",{type:"number",value:A.price,onChange:R=>{const M=R.target.value;Number(M)<0||(Number(M)===0&&M!==""?L({...A,price:0,transactionType:"gift"}):L({...A,price:M}))},className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",placeholder:"100",disabled:A.transactionType==="gift",required:A.transactionType==="sell"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:""}),v.jsx("select",{value:A.conditionLevel,onChange:R=>L({...A,conditionLevel:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm",children:s5.map(R=>v.jsx("option",{value:R,children:R},R))})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#9E9081] mb-2",children:" ()"}),v.jsx("textarea",{value:A.description,onChange:R=>L({...A,description:R.target.value}),className:"w-full p-3 border rounded-lg bg-gray-50 text-sm h-24 resize-none",placeholder:"..."})]}),v.jsx("button",{onClick:te,disabled:V,className:"w-full py-3 bg-[#756256] text-white rounded-xl font-bold shadow-md hover:bg-[#5D4E44] transition-colors disabled:opacity-50",children:V?"...":""})]}):p==="store"?v.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 animate-fade-in",style:{borderColor:Se.whiteBucks},children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2 text-lg",children:[v.jsx(UP,{size:22})," "]}),v.jsxs("div",{className:"flex items-center gap-1 bg-yellow-100 px-3 py-1 rounded-full text-xs font-bold text-yellow-700 shadow-sm border border-yellow-200",children:[v.jsx(NT,{size:14,fill:"currentColor"})," ",s," "]})]}),v.jsx(AT,{title:"",avatars:ps.filter(R=>R.id.startsWith("special")||R.id==="pony-gift"),onPurchase:d,onEquip:f,currentAvatarId:l,myAvatars:a,coins:s}),v.jsx(AT,{title:"",avatars:ps.filter(R=>!["pony-gift"].includes(R.id)&&!R.id.startsWith("special")),onPurchase:d,onEquip:f,currentAvatarId:l,myAvatars:a,coins:s})]}):v.jsx("div",{className:"space-y-4 animate-fade-in",children:T.length===0?v.jsx("div",{className:"text-center py-10 text-gray-400",children:""}):T.map(R=>v.jsxs("div",{onClick:()=>e("product",R),className:"bg-white rounded-xl shadow-sm border p-3 flex gap-4 items-center cursor-pointer hover:shadow-md transition-shadow",style:{borderColor:Se.whiteBucks},children:[v.jsx("div",{className:"w-16 h-20 bg-gray-200 rounded flex-shrink-0 overflow-hidden",children:v.jsx("img",{src:R.cover,className:"w-full h-full object-cover",alt:R.title})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("h3",{className:"font-bold text-[#756256] truncate",children:R.title}),R.status==="Reserved"&&v.jsx("span",{className:"flex-shrink-0 text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full font-bold whitespace-nowrap ml-2",children:""}),R.status==="Sold"&&v.jsx("span",{className:"flex-shrink-0 text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-bold whitespace-nowrap ml-2",children:""})]}),v.jsx("div",{className:"text-sm text-[#9E9081] font-medium",children:R.price===0||R.type==="gift"?"":`NT$ ${R.price}`}),v.jsxs("div",{className:"text-xs text-gray-400 mt-1 flex items-center gap-2",children:[v.jsxs("span",{children:[R.views||0," "]}),"  ",v.jsx("span",{children:R.date})]})]}),v.jsx("button",{onClick:M=>ae(R.id,M),className:"p-2 text-red-400 hover:bg-red-50 rounded-full",children:v.jsx(zP,{size:18})})]},R.id))})]}),ie&&v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>Q(null),children:v.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center shadow-xl transform transition-all scale-100",onClick:R=>R.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-4",children:""}),v.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:""}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:()=>Q(null),className:"flex-1 py-2.5 rounded-xl border border-gray-200 font-bold text-gray-500 hover:bg-gray-50 transition-colors",type:"button",children:""}),v.jsx("button",{onClick:b,className:"flex-1 py-2.5 rounded-xl bg-red-500 text-white font-bold hover:bg-red-600 transition-colors shadow-md",type:"button",children:""})]})]})})]})},m5=({transaction:n,currentUser:e,onClose:t,onBackToList:r})=>{const{id:s,sellerId:a,bookTitle:l,price:d}=n,[f,p]=he.useState([]),[g,w]=he.useState(""),[T,N]=he.useState(null),A=he.useRef(null),L=he.useRef(null),V=he.useRef(null);he.useEffect(()=>{if(!s)return;const te=ST.subscribeToMessages(s,ae=>{p(ae),Gt.markAsRead(s,e.uid),setTimeout(()=>A.current?.scrollIntoView({behavior:"smooth"}),100)});return Gt.markAsRead(s,e.uid),()=>te&&te()},[s,e.uid]),he.useEffect(()=>{L.current&&(L.current.style.height="auto",L.current.style.height=`${Math.min(L.current.scrollHeight,120)}px`)},[g]);const se=te=>{const ae=te.target.files[0];if(ae){const b=new FileReader;b.onloadend=async()=>{const S=await bv(b.result,800,800,.7);N(S)},b.readAsDataURL(ae)}},ie=async()=>{if(!(!g.trim()&&!T))try{let te=null;if(g.includes("")){const ae=g.match(/(?:\*\*|)?[\s\S]*?[:]\s*([^\n\r]*)/),b=g.match(/(?:\*\*|)?[\s\S]*?[:]\s*([^\n\r]*)/);if(ae||b){const S=a5(ae?.[1]?.trim());let k=null;if(S){const P=S.match(/(\d{1,2})\/(\d{1,2})\s+(\d{1,2}):(\d{1,2})/);if(P){const Ce=new Date;let tt=Ce.getFullYear();const $e=parseInt(P[1])-1;Ce.getMonth()===11&&$e===0&&(tt+=1),k=new Date(tt,$e,parseInt(P[2]),parseInt(P[3]),parseInt(P[4]))}}if(k&&k<new Date){alert("");return}te={meetingTime:k,meetingLocation:b?.[1]?.trim(),invoiceSentAt:new Date};const D=te.meetingTime&&!isNaN(k.getTime())&&te.meetingTime.toString()!=="Invalid Date",R=["","","","**"],M=te.meetingLocation&&!R.some(P=>te.meetingLocation.includes(P));if(!D){alert(" (: 1/5 8:20)");return}if(!M){alert(" ()");return}}else{alert("");return}}await ST.sendMessage(s,e.uid,e.name||e.nickname||"",g,T,te),w(""),N(null)}catch(te){console.error(te),alert(": "+te.message)}},Q=()=>{const te=`
LINE
----------------
(ex.1/5 15:20)

${l}
NT$ ${d}`;w(te)},pe=(te,ae)=>v.jsxs("div",{className:"flex flex-col gap-2",children:[ae&&v.jsx("div",{className:"rounded-lg overflow-hidden bg-gray-100 mb-1",children:v.jsx("img",{src:ae,alt:"chat",className:"max-w-full h-auto object-contain cursor-pointer",onClick:()=>window.open(ae,"_blank")})}),te&&te.split(/(\*\*.*?\*\*)/g).map((b,S)=>b.startsWith("**")&&b.endsWith("**")?v.jsx("strong",{children:b.slice(2,-2)},b+S):v.jsx("span",{className:"whitespace-pre-wrap",children:b},b+S))]});return v.jsxs("div",{className:"fixed bottom-4 right-4 w-80 h-[450px] bg-white rounded-t-xl rounded-bl-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[v.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center shadow-md",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:r,className:"hover:bg-white/20 p-1.5 rounded-lg transition-all active:scale-95 group",title:"",children:v.jsx(Lu,{size:18,className:"group-hover:animate-pulse"})}),v.jsx("span",{className:"font-bold text-sm truncate max-w-[150px]",children:l||""})]}),v.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1 transition-colors",children:v.jsx(us,{size:16})})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3 bg-[#F9F7F5]",children:[v.jsx("div",{className:"text-center text-xs text-gray-400 mt-4 mb-4 space-y-2",children:v.jsxs("div",{className:"opacity-80",children:["",v.jsx("br",{}),""]})}),f.map((te,ae)=>{const b=te.senderId===e.uid,S=te.timestamp?.toDate?te.timestamp.toDate():new Date(te.timestamp);let k=!1,D="";if(ae===0)k=!0;else{const P=f[ae-1],Ce=P.timestamp?.toDate?P.timestamp.toDate():new Date(P.timestamp);S.toLocaleDateString()!==Ce.toLocaleDateString()&&(k=!0)}k&&(D=`${S.getMonth()+1}/${S.getDate()}`);const M=(P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}):"")(te.timestamp);return v.jsxs(VR.Fragment,{children:[k&&v.jsx("div",{className:"flex items-center justify-center my-4",children:v.jsx("div",{className:"bg-gray-200/50 text-gray-500 text-[10px] px-3 py-1 rounded-full font-bold",children:D})}),v.jsxs("div",{className:`flex items-end gap-1.5 ${b?"justify-end":"justify-start"}`,children:[b&&v.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:M}),v.jsx("div",{className:`max-w-[85%] rounded-xl px-3 py-2 text-sm shadow-sm break-words ${b?"bg-[#756256] text-white rounded-tr-none":"bg-white text-gray-700 rounded-tl-none"}`,children:pe(te.content,te.image)}),!b&&v.jsx("span",{className:"text-[10px] text-gray-400 mb-1 flex-shrink-0",children:M})]})]},te.id)}),v.jsx("div",{ref:A})]}),v.jsxs("div",{className:"px-3 py-1.5 bg-[#F9F7F5] flex items-center justify-start gap-2 border-t border-stone-100",children:[v.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:V,onChange:se}),v.jsx("button",{onClick:()=>V.current?.click(),className:"p-1.5 text-gray-400 hover:text-[#756256] transition-colors rounded-lg hover:bg-white flex-shrink-0 border border-stone-200 bg-white shadow-sm",title:"",children:v.jsx(PT,{size:18})}),e.uid===a&&v.jsx("button",{onClick:Q,className:"text-[10px] w-fit font-bold text-[#756256] border border-[#756256] rounded-md px-3 py-1 transform hover:translate-y-[-1px] transition-all bg-white flex items-center gap-1 shadow-sm active:translate-y-0",children:""})]}),T&&v.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-t flex items-center gap-2",children:[v.jsxs("div",{className:"relative w-12 h-12 rounded-md overflow-hidden border border-gray-200",children:[v.jsx("img",{src:T,alt:"preview",className:"w-full h-full object-cover"}),v.jsx("button",{onClick:()=>N(null),className:"absolute top-0 right-0 bg-black/50 text-white rounded-full p-0.5",children:v.jsx(us,{size:10})})]}),v.jsx("span",{className:"text-[10px] text-gray-500",children:"..."})]}),v.jsxs("div",{className:"p-3 bg-white border-t flex items-end gap-2",children:[v.jsx("textarea",{ref:L,rows:"1",value:g,onChange:te=>w(te.target.value),onKeyDown:te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),ie())},placeholder:"...",className:"w-full bg-[#F9F7F5] border-none rounded-2xl px-4 py-2 text-sm focus:ring-1 focus:ring-[#756256] outline-none resize-none transition-all scrollbar-hide py-2"}),v.jsx("button",{onClick:ie,disabled:!g.trim()&&!T,className:"p-2 bg-[#756256] text-white rounded-full hover:bg-[#5D4E44] transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md flex-shrink-0",children:v.jsx(NP,{size:18})})]})]})},g5=({currentUser:n,onSelectChat:e,onClose:t,books:r})=>{const[s,a]=he.useState([]),l={Pending:{label:"",className:"bg-gray-100 text-gray-600"},Invoiced:{label:"",className:"bg-blue-50 text-blue-600"},Completed:{label:"",className:"bg-green-100 text-green-700"},Success:{label:"",className:"bg-green-100 text-green-700"},Failed:{label:"",className:"bg-red-50 text-red-600"}};he.useEffect(()=>{if(!n)return;const f=new Map,p=T=>{T.forEach(N=>{f.set(N.id,{id:N.id,...N.data()})}),a(Array.from(f.values()).sort((N,A)=>{const L=N.timestamp?.toDate?N.timestamp.toDate():new Date(N.timestamp);return(A.timestamp?.toDate?A.timestamp.toDate():new Date(A.timestamp))-L}))},g=Gt.getUserTransactions(n.uid,p),w=Gt.getSellerTransactions(n.uid,p);return()=>{g(),w()}},[n]);const d=async(f,p)=>{if(f.stopPropagation(),window.confirm(""))try{await Gt.deleteTransaction(p),a(g=>g.filter(w=>w.id!==p))}catch(g){console.error("Delete chat failed",g)}};return v.jsxs("div",{className:"fixed bottom-24 right-4 w-80 max-h-96 bg-white rounded-xl shadow-2xl flex flex-col z-50 animate-slide-up border border-stone-200 overflow-hidden",children:[v.jsxs("div",{className:"bg-[#756256] text-white p-3 flex justify-between items-center",children:[v.jsx("span",{className:"font-bold",children:""}),v.jsx("button",{onClick:t,className:"hover:bg-white/20 rounded-full p-1",children:v.jsx(us,{size:16})})]}),v.jsxs("div",{className:"overflow-y-auto p-2 space-y-2 bg-[#F9F7F5] flex-1",children:[s.length===0&&v.jsx("div",{className:"text-center text-gray-400 py-4 text-sm",children:""}),s.map(f=>{const p=r.some(g=>g.id===f.bookId);return v.jsxs("div",{onClick:p?()=>e(f):g=>d(g,f.id),className:`p-3 rounded-lg cursor-pointer transition-colors shadow-sm border border-gray-100 relative ${p?"bg-white hover:bg-gray-50":"bg-gray-100 grayscale hover:bg-gray-200"}`,children:[f.unreadBy?.includes(n.uid)&&v.jsx("div",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white shadow-sm z-10"}),v.jsx("div",{className:"font-bold text-[#756256] text-sm truncate pr-4",children:f.bookTitle}),v.jsx("div",{className:"text-xs text-gray-500 flex justify-between items-center mt-1",children:p?v.jsxs(v.Fragment,{children:[v.jsx("span",{children:f.buyerId===n.uid?"":""}),v.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${l[f.status]?.className||"bg-gray-100 text-gray-400"}`,children:l[f.status]?.label||f.status})]}):v.jsx("span",{className:"text-gray-500 font-bold w-full text-center",children:"()"})})]},f.id)})]})]})},y5=({notifications:n,onClose:e,onMarkAsRead:t,onClearAll:r})=>v.jsxs("div",{className:"fixed top-16 right-4 sm:right-20 w-80 max-h-[400px] bg-white rounded-2xl shadow-2xl flex flex-col z-[60] animate-slide-up border border-stone-100 overflow-hidden",children:[v.jsxs("div",{className:"bg-white p-4 border-b flex justify-between items-center",children:[v.jsxs("h3",{className:"font-bold text-[#756256] flex items-center gap-2",children:[v.jsx(Mg,{size:18,className:"text-[#A58976]"}),""]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(us,{size:18})})]}),v.jsx("div",{className:"overflow-y-auto flex-1 bg-[#F9F7F5] p-2 space-y-2",children:n.length===0?v.jsxs("div",{className:"py-12 text-center text-gray-400 text-sm flex flex-col items-center gap-2",children:[v.jsx(Mg,{size:32,className:"opacity-20"}),""]}):n.map(s=>v.jsxs("div",{onClick:()=>!s.isRead&&t(s.id),className:`p-3 rounded-xl transition-all cursor-pointer border relative ${s.isRead?"bg-white/50 border-transparent grayscale-[0.3]":"bg-white border-blue-50 shadow-sm font-medium"}`,children:[!s.isRead&&v.jsx("div",{className:"absolute top-3 left-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),v.jsx("div",{className:"text-xs text-[#756256] mb-1 leading-relaxed pl-2",children:s.content}),v.jsx("div",{className:"text-[12px] text-gray-400 pl-2",children:xv(s.timestamp)})]},s.id))}),n.length>0&&v.jsx("div",{className:"p-3 bg-white border-t text-center",children:v.jsx("button",{onClick:r,className:"text-[12px] font-bold text-[#A58976] hover:underline",children:""})})]}),_5=()=>{const[n,e]=he.useState("login"),[t,r]=he.useState(null),[s,a]=he.useState(null),[l,d]=he.useState(null),[f,p]=he.useState(!1),[g,w]=he.useState(!1),[T,N]=he.useState([]),A=T.some(Pe=>!Pe.isRead),[L,V]=he.useState([]),se=L.some(Pe=>Pe.unreadBy?.includes(t?.uid));he.useEffect(()=>{if(!t?.uid)return;const Pe=bt=>{const sn=bt.docs.map(jt=>({id:jt.id,...jt.data()}));V(jt=>{const Lr=new Map(jt.map(Ye=>[Ye.id,Ye]));return sn.forEach(Ye=>Lr.set(Ye.id,Ye)),Array.from(Lr.values())})},je=Gt.getUserTransactions(t.uid,Pe),lt=Gt.getSellerTransactions(t.uid,Pe);return()=>{je(),lt()}},[t?.uid]);const[ie,Q]=he.useState([]),[pe,te]=he.useState(!0),[ae,b]=he.useState({exams:[]});he.useEffect(()=>{(async()=>{try{const{functions:je}=await ss(async()=>{const{functions:sn}=await Promise.resolve().then(()=>cs);return{functions:sn}},void 0),bt=await je.httpsCallable("getExamCountdown")();bt.data&&bt.data.exams?b(bt.data):b({exams:[]})}catch(je){console.error("Failed to fetch countdown:",je),b({exams:[]})}})()},[]);const[S,k]=he.useState(0),[D,R]=he.useState(!1),[M,P]=he.useState(!1),[Ce,tt]=he.useState(i5),[$e,ue]=he.useState(["classic-1"]),[Y,ve]=he.useState("classic-1");he.useEffect(()=>{let Pe=null,je=null;const lt=mr.onAuthStateChanged(bt=>{bt?(r({uid:bt.uid,email:bt.email,...bt,nickname:bt.email.split("@")[0]}),Pe=mr.onProfileSnapshot(bt.uid,sn=>{if(sn.exists){const jt=sn.data();r(Ye=>({...Ye,...jt,uid:bt.uid})),k(jt.coins||0),ue(jt.myAvatars||["classic-1"]),jt.isProfileCompleted?e("home"):e("login"),jt.isProfileCompleted&&!jt.ponyGiftClaimed&&P(!0);const Lr=async()=>{try{const{functions:Ye}=await ss(async()=>{const{functions:lo}=await Promise.resolve().then(()=>cs);return{functions:lo}},void 0),Nn=await Ye.httpsCallable("dailyCheckIn")();Nn.data.success&&(R(!0),k(Nn.data.newBalance))}catch(Ye){console.error("Check-in failed",Ye)}};jt.isProfileCompleted&&Lr()}}),je=Gt.subscribeToNotifications(bt.uid,sn=>{N(sn)})):(r(null),e("login"),N([]),Pe&&Pe(),je&&je())});return()=>{lt(),Pe&&Pe(),je&&je()}},[]),he.useEffect(()=>{const Pe=Gt.onBooksSnapshot(lt=>{Q(lt),te(!1)},lt=>{console.error("Global books fetch failed:",lt),te(!1)}),je=Gt.onWishesSnapshot(lt=>{tt(lt)});return()=>{Pe&&Pe(),je&&je()}},[]);const de=()=>v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:v.jsxs("div",{className:"bg-white rounded-[2rem] p-8 w-full max-w-sm text-center relative shadow-2xl transform transition-all animate-scale-up",onClick:Pe=>Pe.stopPropagation(),children:[v.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2",children:v.jsx("div",{className:"bg-gradient-to-br from-yellow-300 to-orange-400 p-4 rounded-full shadow-lg border-4 border-white",children:v.jsx(OT,{size:40,className:"text-white animate-pulse"})})}),v.jsxs("div",{className:"mt-8",children:[v.jsx("h3",{className:"text-2xl font-black text-[#756256] mb-4",children:""}),v.jsxs("p",{className:"text-gray-500 mb-8 leading-relaxed",children:["",v.jsx("br",{})," ",v.jsx("span",{className:"text-orange-500 font-bold",children:""})," "]}),v.jsxs("div",{className:"flex flex-col items-center mb-8",children:[v.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-orange-100 p-1 bg-white shadow-inner mb-3",children:v.jsx("img",{src:cc("https://i.postimg.cc/9fW28Bc0/niu.jpg",200,70),alt:"Pony Gift",className:"w-full h-full object-cover rounded-full"})}),v.jsx("span",{className:"text-xs font-bold text-gray-400",children:""})]}),v.jsx("button",{onClick:j,className:"w-full py-4 rounded-2xl bg-gradient-to-r from-[#A58976] to-[#756256] text-white font-bold hover:shadow-xl transition-all active:scale-95 text-lg",children:""})]})]})}),j=async()=>{try{const{db:Pe,firebase:je}=await ss(async()=>{const{db:lt,firebase:bt}=await Promise.resolve().then(()=>cs);return{db:lt,firebase:bt}},void 0);await Pe.collection("users").doc(t.uid).update({myAvatars:je.firestore.FieldValue.arrayUnion("pony-gift"),ponyGiftClaimed:!0}),P(!1),alert(" ")}catch(Pe){console.error(Pe),alert("")}},K=()=>v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fade-in",onClick:()=>R(!1),children:v.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm text-center relative shadow-xl transform transition-all scale-100",onClick:Pe=>Pe.stopPropagation(),children:[v.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2",children:v.jsx("div",{className:"bg-yellow-400 p-3 rounded-full shadow-lg border-4 border-white",children:v.jsx(DT,{size:32,className:"text-white"})})}),v.jsxs("div",{className:"mt-6",children:[v.jsx("h3",{className:"text-xl font-bold text-[#756256] mb-2",children:""}),v.jsx("p",{className:"text-gray-500 mb-6",children:" 5 "}),v.jsxs("div",{className:"flex items-center justify-center gap-2 text-2xl font-bold text-yellow-600 mb-6 bg-yellow-50 py-3 rounded-xl border border-yellow-100",children:[v.jsx(NT,{size:28,fill:"currentColor"})," +5"]}),v.jsx("button",{onClick:()=>R(!1),className:"w-full py-3 rounded-xl bg-[#A58976] text-white font-bold hover:bg-[#8D735F] transition-colors",children:""})]})]})}),Re=(Pe,je)=>{Pe==="product"&&(a(je),je&&je.id&&Gt.incrementBookView(je.id)),e(Pe)},ke=async()=>{if(t?.isGuest){r(null),e("login"),N([]);return}await mr.logout()},Me=async(Pe,je)=>{try{await Gt.addWish({content:Pe,image:je,user:t.nickname||t.realName||t.email,avatarId:Y})}catch(lt){console.error("Failed to add wish:",lt),alert("")}},Fe=async Pe=>{try{window.confirm("")&&await Gt.deleteWish(Pe)}catch(je){console.error("Failed to delete wish:",je),alert("")}},Je=async(Pe,je)=>{if(S<je){alert("");return}if(window.confirm(` ${je} `))try{const{functions:lt}=await ss(async()=>{const{functions:sn}=await Promise.resolve().then(()=>cs);return{functions:sn}},void 0);await lt.httpsCallable("purchaseItem")({itemId:Pe,price:je,type:"avatar"}),alert("")}catch(lt){console.error(lt),alert(": "+lt.message)}},We=Pe=>{ve(Pe)},rt=async()=>{if(t)try{await Gt.markAllNotificationsAsRead(t.uid)}catch(Pe){console.error("Clear all failed",Pe)}},rn=()=>{r(o5),e("home"),k(0),N([])};if(!t&&n!=="login")return null;const Zs=()=>{switch(n){case"login":return v.jsx(d5,{onLogin:null,onGuestLogin:rn});case"home":return v.jsx(f5,{onNavigate:Re,user:t,coins:S,wishes:Ce,onAddWish:Me,onDeleteWish:Fe,books:ie,isLoading:pe,currentAvatarId:Y,unreadCount:0,examCountdown:ae,onToggleNotifications:()=>w(!g),hasUnreadNotifications:A,onLogout:ke});case"product":return v.jsx(h5,{product:s,currentUser:t,onBack:()=>Re("home"),onContact:async()=>{try{await Gt.startTransaction(s,t,Pe=>{d({id:Pe,bookId:s.id,bookTitle:s.title,sellerId:s.sellerId,price:s.price})})}catch(Pe){console.error(Pe),alert("")}}});case"profile":return v.jsx(p5,{user:t,onBack:()=>Re("home"),onNavigate:Re,onLogout:ke,coins:S,myAvatars:$e,currentAvatarId:Y,onPurchase:Je,onEquip:We});default:return v.jsx("div",{children:"404"})}};return v.jsxs("div",{className:"min-h-screen flex flex-col bg-[#F9F7F5]",children:[v.jsx("div",{className:"flex-1",children:Zs()}),n!=="login"&&v.jsx(v5,{}),D&&v.jsx(K,{}),M&&v.jsx(de,{}),l&&v.jsx(m5,{transaction:l,currentUser:t,onClose:()=>d(null),onBackToList:()=>{d(null),p(!0)}}),g&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed inset-0 z-[55] bg-transparent",onClick:()=>w(!1)}),v.jsx(y5,{notifications:T,onClose:()=>w(!1),onMarkAsRead:async Pe=>{await Gt.markNotificationAsRead(Pe)},onClearAll:rt})]}),t&&n!=="login"&&!l&&v.jsxs(v.Fragment,{children:[v.jsxs("button",{onClick:()=>p(!f),className:"fixed bottom-6 right-6 w-14 h-14 bg-[#756256] text-white rounded-full shadow-lg flex items-center justify-center hover:bg-[#5D4E44] transition-all transform hover:scale-105 z-40 border-2 border-white",children:[f?v.jsx(us,{size:24}):v.jsx(Lu,{size:24}),!f&&se&&v.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full border-2 border-white shadow-sm animate-pulse"})]}),f&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed inset-0 z-[45] bg-transparent",onClick:()=>p(!1)}),v.jsx(g5,{currentUser:t,books:ie,onSelectChat:Pe=>{d(Pe),p(!1)},onClose:()=>p(!1)})]})]})]})},v5=()=>v.jsx("footer",{className:"bg-[#756256] text-[#E8E3DF] py-12 px-6 mt-12 border-t border-white/10",children:v.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center gap-2 justify-center md:justify-start",children:[v.jsx(YR,{size:24,className:"text-[#A58976]"}),v.jsx("span",{className:"text-xl font-black tracking-tight text-white",children:"SchoolBook Exchange"})]}),v.jsxs("p",{className:"text-xs opacity-70 leading-relaxed font-medium",children:["",v.jsx("br",{}),""]})]}),v.jsxs("div",{className:"flex flex-col gap-3 justify-center",children:[v.jsx("div",{className:"text-sm font-bold text-white mb-2 underline underline-offset-4 decoration-[#A58976]",children:""}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(VP,{size:14})," "]}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(LT,{size:14})," "]}),v.jsxs("div",{className:"text-xs opacity-80 flex items-center gap-2 justify-center md:justify-start hover:opacity-100 transition-opacity cursor-default",children:[v.jsx(VT,{size:14})," "]})]}),v.jsxs("div",{className:"flex flex-col gap-3 justify-center",children:[v.jsx("div",{className:"text-sm font-bold text-white mb-2 underline underline-offset-4 decoration-[#A58976]",children:""}),v.jsxs("div",{className:"text-xs opacity-80 hover:opacity-100 transition-opacity flex items-center gap-2 justify-center md:justify-start",children:[v.jsx(IP,{size:14})," service@shsh.tw"]}),v.jsx("div",{className:"text-[10px] opacity-50 mt-4 font-mono",children:" 2025 SchoolBook Exchange. All rights reserved."})]})]})});UR.createRoot(document.getElementById("root")).render(v.jsx(he.StrictMode,{children:v.jsx(_5,{})}));
